var Box=Box||{};Box.WebAppComponents=Box.WebAppComponents||{},Box.WebAppComponents.common=webpackJsonpBox_WebAppComponents__name_([0],[function(e,t){e.exports=React},,function(e,t){e.exports=ReactIntl},,,function(e,t){e.exports=Immutable},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){return E.set(e,{selection:t,forceSelection:n,nativelyRenderedContent:null,inlineStyleOverride:null})}function o(e,t){return e.getBlockMap().map(function(n){return m.generate(e,n,t)}).toOrderedMap()}function a(e,t,n,r){var i=e.getCurrentContent().set("entityMap",n),o=i.getBlockMap(),a=e.getImmutable().get("treeMap");return a.merge(t.toSeq().filter(function(e,t){return e!==o.get(t)}).map(function(e){return m.generate(i,e,r)}))}function s(e,t,n,r,i){return n.merge(t.toSeq().filter(function(t){return r.getDecorations(t,e)!==i.getDecorations(t,e)}).map(function(t){return m.generate(e,t,r)}))}function l(e,t){var n=e.getLastChangeType();return t!==n||"insert-characters"!==t&&"backspace-character"!==t&&"delete-character"!==t}function c(e,t){var n=t.getStartKey(),r=t.getStartOffset(),i=e.getBlockForKey(n);return r>0?i.getInlineStyleAt(r-1):i.getLength()?i.getInlineStyleAt(0):d(e,n)}function u(e,t){var n=t.getStartKey(),r=t.getStartOffset(),i=e.getBlockForKey(n);return r<i.getLength()?i.getInlineStyleAt(r):r>0?i.getInlineStyleAt(r-1):d(e,n)}function d(e,t){for(var n,r=e.getBlockBefore(t);r;){if(n=r.getLength())return r.getInlineStyleAt(n-1);r=e.getBlockBefore(r.getKey())}return b()}var f=n(20),p=f||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=n(64),h=n(41),g=n(144),v=n(5),y=n(28),b=v.OrderedSet,_=v.Record,w=v.Stack,S={allowUndo:!0,currentContent:null,decorator:null,directionMap:null,forceSelection:!1,inCompositionMode:!1,inlineStyleOverride:null,lastChangeType:null,nativelyRenderedContent:null,redoStack:w(),selection:null,treeMap:null,undoStack:w()},k=_(S),E=function(){function e(t){r(this,e),this._immutable=t}return e.createEmpty=function(t){return e.createWithContent(h.createFromText(""),t)},e.createWithContent=function(t,n){var r=t.getBlockMap().first().getKey();return e.create({currentContent:t,undoStack:w(),redoStack:w(),decorator:n||null,selection:y.createEmpty(r)})},e.create=function(t){var n=t.currentContent,r=t.decorator,i=p({},t,{treeMap:o(n,r),directionMap:g.getDirectionMap(n)});return new e(new k(i))},e.set=function(t,n){var r=t.getImmutable().withMutations(function(e){var r=e.get("decorator"),i=r;null===n.decorator?i=null:n.decorator&&(i=n.decorator);var l=n.currentContent||t.getCurrentContent();if(i!==r){var c,u=e.get("treeMap");return c=i&&r?s(l,l.getBlockMap(),u,i,r):o(l,i),void e.merge({decorator:i,treeMap:c,nativelyRenderedContent:null})}var d=t.getCurrentContent();l!==d&&e.set("treeMap",a(t,l.getBlockMap(),l.getEntityMap(),i)),e.merge(n)});return new e(r)},e.prototype.toJS=function(){return this.getImmutable().toJS()},e.prototype.getAllowUndo=function(){return this.getImmutable().get("allowUndo")},e.prototype.getCurrentContent=function(){return this.getImmutable().get("currentContent")},e.prototype.getUndoStack=function(){return this.getImmutable().get("undoStack")},e.prototype.getRedoStack=function(){return this.getImmutable().get("redoStack")},e.prototype.getSelection=function(){return this.getImmutable().get("selection")},e.prototype.getDecorator=function(){return this.getImmutable().get("decorator")},e.prototype.isInCompositionMode=function(){return this.getImmutable().get("inCompositionMode")},e.prototype.mustForceSelection=function(){return this.getImmutable().get("forceSelection")},e.prototype.getNativelyRenderedContent=function(){return this.getImmutable().get("nativelyRenderedContent")},e.prototype.getLastChangeType=function(){return this.getImmutable().get("lastChangeType")},e.prototype.getInlineStyleOverride=function(){return this.getImmutable().get("inlineStyleOverride")},e.setInlineStyleOverride=function(t,n){return e.set(t,{inlineStyleOverride:n})},e.prototype.getCurrentInlineStyle=function(){var e=this.getInlineStyleOverride();if(null!=e)return e;var t=this.getCurrentContent(),n=this.getSelection();return n.isCollapsed()?c(t,n):u(t,n)},e.prototype.getBlockTree=function(e){return this.getImmutable().getIn(["treeMap",e])},e.prototype.isSelectionAtStartOfContent=function(){var e=this.getCurrentContent().getBlockMap().first().getKey();return this.getSelection().hasEdgeWithin(e,0,0)},e.prototype.isSelectionAtEndOfContent=function(){var e=this.getCurrentContent(),t=e.getBlockMap(),n=t.last(),r=n.getLength();return this.getSelection().hasEdgeWithin(n.getKey(),r,r)},e.prototype.getDirectionMap=function(){return this.getImmutable().get("directionMap")},e.acceptSelection=function(e,t){return i(e,t,!1)},e.forceSelection=function(e,t){return t.getHasFocus()||(t=t.set("hasFocus",!0)),i(e,t,!0)},e.moveSelectionToEnd=function(t){var n=t.getCurrentContent(),r=n.getLastBlock(),i=r.getKey(),o=r.getLength();return e.acceptSelection(t,new y({anchorKey:i,anchorOffset:o,focusKey:i,focusOffset:o,isBackward:!1}))},e.moveFocusToEnd=function(t){var n=e.moveSelectionToEnd(t);return e.forceSelection(n,n.getSelection())},e.push=function(t,n,r){if(t.getCurrentContent()===n)return t;var i="insert-characters"!==r,o=g.getDirectionMap(n,t.getDirectionMap());if(!t.getAllowUndo())return e.set(t,{currentContent:n,directionMap:o,lastChangeType:r,selection:n.getSelectionAfter(),forceSelection:i,inlineStyleOverride:null});var a=t.getSelection(),s=t.getCurrentContent(),c=t.getUndoStack(),u=n;a!==s.getSelectionAfter()||l(t,r)?(c=c.push(s),u=u.set("selectionBefore",a)):"insert-characters"!==r&&"backspace-character"!==r&&"delete-character"!==r||(u=u.set("selectionBefore",s.getSelectionBefore()));var d=t.getInlineStyleOverride(),f=["adjust-depth","change-block-type","split-block"];f.indexOf(r)===-1&&(d=null);var p={currentContent:u,directionMap:o,undoStack:c,redoStack:w(),lastChangeType:r,selection:n.getSelectionAfter(),forceSelection:i,inlineStyleOverride:d};return e.set(t,p)},e.undo=function(t){if(!t.getAllowUndo())return t;var n=t.getUndoStack(),r=n.peek();if(!r)return t;var i=t.getCurrentContent(),o=g.getDirectionMap(r,t.getDirectionMap());return e.set(t,{currentContent:r,directionMap:o,undoStack:n.shift(),redoStack:t.getRedoStack().push(i),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"undo",nativelyRenderedContent:null,selection:i.getSelectionBefore()})},e.redo=function(t){if(!t.getAllowUndo())return t;var n=t.getRedoStack(),r=n.peek();if(!r)return t;var i=t.getCurrentContent(),o=g.getDirectionMap(r,t.getDirectionMap());return e.set(t,{currentContent:r,directionMap:o,undoStack:t.getUndoStack().push(i),redoStack:n.shift(),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"redo",nativelyRenderedContent:null,selection:r.getSelectionAfter()})},e.prototype.getImmutable=function(){return this._immutable},e}();e.exports=E},function(e,t,n){var r,i;!function(){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r))e.push(n.apply(null,r));else if("object"===i)for(var a in r)o.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}var o={}.hasOwnProperty;"undefined"!=typeof e&&e.exports?e.exports=n:(r=[],i=function(){return n}.apply(t,r),!(void 0!==i&&(e.exports=i)))}()},function(e,t,n){"use strict";(function(t){var r=n(14),i=n(133),o=n(61),a=n(5),s=n(134),l=n(136),c=n(35),u=n(139),d=n(140),f=n(4),p=n(141),m=n(62),h=n(142),g=n(143),v=a.OrderedSet,y={replaceText:function(e,t,n,i,o){var a=m(e,t),s=h(a,t),l=r.create({style:i||v(),entity:o||null});return d(s,s.getSelectionAfter(),n,l)},insertText:function(e,n,r,i,o){return n.isCollapsed()?void 0:"production"!==t.env.NODE_ENV?f(!1,"Target range must be collapsed for `insertText`."):f(!1),y.replaceText(e,n,r,i,o)},moveText:function(e,t,n){var r=c(e,t),i=y.removeRange(e,t,"backward");return y.replaceWithFragment(i,n,r)},replaceWithFragment:function(e,t,n){var r=m(e,t),i=h(r,t);return u(i,i.getSelectionAfter(),n)},removeRange:function(e,t,n){var r=void 0,i=void 0,a=void 0,s=void 0;t.getIsBackward()&&(t=t.merge({anchorKey:t.getFocusKey(),anchorOffset:t.getFocusOffset(),focusKey:t.getAnchorKey(),focusOffset:t.getAnchorOffset(),isBackward:!1})),r=t.getAnchorKey(),i=t.getFocusKey(),a=e.getBlockForKey(r),s=e.getBlockForKey(i);var c=t.getStartOffset(),u=t.getEndOffset(),d=a.getEntityAt(c),f=s.getEntityAt(u-1);if(r===i&&d&&d===f){var p=l(e.getEntityMap(),a,s,t,n);return h(e,p)}var g=t;o.draft_segmented_entities_behavior&&(g=l(e.getEntityMap(),a,s,t,n));var v=m(e,g);return h(v,g)},splitBlock:function(e,t){var n=m(e,t),r=h(n,t);return g(r,r.getSelectionAfter())},applyInlineStyle:function(e,t,n){return i.add(e,t,n)},removeInlineStyle:function(e,t,n){return i.remove(e,t,n)},setBlockType:function(e,t,n){return p(e,t,function(e){return e.merge({type:n,depth:0})})},setBlockData:function(e,t,n){return p(e,t,function(e){return e.merge({data:n})})},mergeBlockData:function(e,t,n){return p(e,t,function(e){return e.merge({data:e.getData().merge(n)})})},applyEntity:function(e,t,n){var r=m(e,t);return s(r,t,n)}};e.exports=y}).call(t,n(3))},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(226),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsPropType=t.UserPropType=t.SelectorItemPropType=t.SelectorItemsPropType=t.ActionItemErrorPropType=void 0;var i=n(1),o=r(i),a=n(130),s=r(a),l=o.default.shape({avatarUrl:o.default.string,id:o.default.number.isRequired,name:o.default.string.isRequired}),c=o.default.shape({id:o.default.oneOfType([o.default.number,o.default.string]),name:o.default.string.isRequired}),u=o.default.shape({title:o.default.string.isRequired,message:o.default.string.isRequired,action:o.default.shape({text:o.default.string.isRequired,onAction:o.default.func.isRequired})}),d=o.default.arrayOf(c),f={text:o.default.string.isRequired,value:o.default.oneOfType([o.default.number,o.default.string]).isRequired},p=o.default.oneOfType([o.default.arrayOf(o.default.shape(f)),s.default.listOf(s.default.recordOf(f))]).isRequired;t.ActionItemErrorPropType=u,t.SelectorItemsPropType=d,t.SelectorItemPropType=c,t.UserPropType=l,t.OptionsPropType=p},function(e,t,n){"use strict";var r=function(e){if(null!=e)return e;throw new Error("Got unexpected null or undefined")};e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=(0,r.defineMessages)({approvalAddAssignee:{id:"boxui.activityFeed.approvalAddAssignee",defaultMessage:"Add an assignee"},approvalAddTask:{id:"boxui.activityFeed.approvalAddTask",defaultMessage:"Add Task"},approvalAddTaskTooltip:{id:"boxui.activityFeed.approvalAddTaskTooltip",defaultMessage:"Assigning a task to someone will send them a notification with the message in the comment box and allow them to approve or deny."},approvalAssignees:{id:"boxui.activityFeed.approvalAssignees",defaultMessage:"Assignees"},approvalDueDate:{id:"boxui.activityFeed.approvalDueDate",defaultMessage:"Due Date"},approvalSelectDate:{id:"boxui.activityFeed.approvalSelectDate",defaultMessage:"Select a date"},atMentionTip:{id:"boxui.activityFeed.atMentionTip",defaultMessage:"@mention users to notify them."},commentCancel:{id:"boxui.activityFeed.commentCancel",defaultMessage:"Cancel"},commentDeleteCancel:{id:"boxui.activityFeed.commentDeleteCancel",defaultMessage:"No"},taskDeletePrompt:{id:"boxui.activityFeed.taskDeletePrompt",defaultMessage:"Delete task?"},commentDeleteConfirm:{id:"boxui.activityFeed.commentDeleteConfirm",defaultMessage:"Yes"},commentDeletePrompt:{id:"boxui.activityFeed.commentDeletePrompt",defaultMessage:"Delete comment?"},commentPost:{id:"boxui.activityFeed.commentPost",defaultMessage:"Post"},commentShowOriginal:{id:"boxui.activityFeed.commentShowOriginal",defaultMessage:"Show Original"},commentTranslate:{id:"boxui.activityFeed.commentTranslate",defaultMessage:"Translate"},commentWrite:{id:"boxui.activityFeed.commentWrite",defaultMessage:"Write a comment"},commentPostedFullDateTime:{id:"boxui.activityFeed.commentPostedFullDateTime",defaultMessage:"{time, date, full} at {time, time, short}"},commentPostedTime:{id:"boxui.activityFeed.commentPostedTime",defaultMessage:"{time, date, medium}"},commentPostedTimeToday:{id:"boxui.activityFeed.commentPostedTimeToday",defaultMessage:"Today at {time, time, short}"},commentPostedTimeYesterday:{id:"boxui.activityFeed.commentPostedTimeYesterday",defaultMessage:"Yesterday at {time, time, short}"},completedAssignment:{id:"boxui.activityFeed.completedAssignment",defaultMessage:"Completed"},deleteLabel:{id:"boxui.activityFeed.deleteLabel",defaultMessage:"Delete"},editLabel:{id:"boxui.activityFeed.editLabel",defaultMessage:"Edit"},getVersionInfo:{id:"boxui.activityFeed.getVersionInfo",defaultMessage:"Get version information"},keywordsApplied:{id:"boxui.activityFeed.keywordsAppliedList",defaultMessage:"Keywords were applied"},keywordsList:{id:"boxui.activityFeed.keywordsList",defaultMessage:"Keywords: {words}"},noActivity:{id:"boxui.activityFeed.noActivity",defaultMessage:"No Activity Yet"},noActivityCommentPrompt:{id:"boxui.activityFeed.noActivityCommentPrompt",defaultMessage:"Comment and @mention people to notify them."},rejectedAssignment:{id:"boxui.activityFeed.rejectedAssignment",defaultMessage:"Rejected"},taskApprove:{id:"boxui.activityFeed.taskApprove",defaultMessage:"Complete"},taskDueDate:{id:"boxui.activityFeed.taskDueDate",defaultMessage:"Due"},tasksForApproval:{id:"boxui.activityFeed.tasksForApproval",defaultMessage:"Tasks"},taskReject:{id:"boxui.activityFeed.taskReject",defaultMessage:"Decline"},versionDeleted:{id:"boxui.activityFeed.versionDeleted",defaultMessage:"{name} deleted version {versionNumber}"},versionRestored:{id:"boxui.activityFeed.versionRestored",defaultMessage:"{name} restored version {versionNumber}"},versionMultipleUsersUploaded:{id:"boxui.activityFeed.versionMultipleUsersUploaded",defaultMessage:"{numberOfCollaborators} collaborators uploaded versions {versions}"},versionTooManyVersions:{id:"boxui.activityFeed.versionTooManyVersions",defaultMessage:"Multiple versions of this file"},versionUploadCollapsed:{id:"boxui.activityFeed.versionUploadCollapsed",defaultMessage:"{name} uploaded versions {versions}"},versionUploaded:{id:"boxui.activityFeed.versionUploaded",defaultMessage:"{name} uploaded version {versionNumber}"}});t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(5),s=a.Map,l=a.OrderedSet,c=a.Record,u=l(),d={style:u,entity:null},f=c(d),p=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return o(t,e),t.prototype.getStyle=function(){return this.get("style")},t.prototype.getEntity=function(){return this.get("entity")},t.prototype.hasStyle=function(e){return this.getStyle().includes(e)},t.applyStyle=function(e,n){var r=e.set("style",e.getStyle().add(n));return t.create(r)},t.removeStyle=function(e,n){var r=e.set("style",e.getStyle().remove(n));return t.create(r)},t.applyEntity=function(e,n){var r=e.getEntity()===n?e:e.set("entity",n);return t.create(r)},t.create=function(e){if(!e)return m;var n={style:u,entity:null},r=s(n).merge(e),i=h.get(r);if(i)return i;var o=new t(r);return h=h.set(r,o),o},t}(f),m=new p,h=s([[s(d),m]]);p.EMPTY=m,e.exports=p},,function(e,t,n){"use strict";function r(){for(var e=void 0;void 0===e||i.hasOwnProperty(e)||!isNaN(+e);)e=Math.floor(Math.random()*o).toString(32);return i[e]=!0,e}var i={},o=Math.pow(2,24);e.exports=r},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";function r(e,t,n,r){if(e===n)return!0;if(!n.startsWith(e))return!1;var i=n.slice(e.length);return!!t&&(i=r?r(i):i,a.contains(i,t))}function i(e){return"Windows"===o.platformName?e.replace(/^\s*NT/,""):e}var o=n(153),a=n(156),s=n(157),l=n(158),c={isBrowser:function(e){return r(o.browserName,o.browserFullVersion,e)},isBrowserArchitecture:function(e){return r(o.browserArchitecture,null,e)},isDevice:function(e){return r(o.deviceName,null,e)},isEngine:function(e){return r(o.engineName,o.engineVersion,e)},isPlatform:function(e){return r(o.platformName,o.platformFullVersion,e,i)},isPlatformArchitecture:function(e){return r(o.platformArchitecture,null,e)}};e.exports=s(c,l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(245),o=r(i);t.default=o.default},,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){return e.getStyle()===t.getStyle()}function s(e,t){return e.getEntity()===t.getEntity()}var l=n(5),c=n(34),u=l.List,d=l.Map,f=l.OrderedSet,p=l.Record,m=f(),h={key:"",type:"unstyled",text:"",characterList:u(),depth:0,data:d()},g=p(h),v=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return o(t,e),t.prototype.getKey=function(){return this.get("key")},t.prototype.getType=function(){return this.get("type")},t.prototype.getText=function(){return this.get("text")},t.prototype.getCharacterList=function(){return this.get("characterList")},t.prototype.getLength=function(){return this.getText().length},t.prototype.getDepth=function(){return this.get("depth")},t.prototype.getData=function(){return this.get("data")},t.prototype.getInlineStyleAt=function(e){var t=this.getCharacterList().get(e);return t?t.getStyle():m},t.prototype.getEntityAt=function(e){var t=this.getCharacterList().get(e);return t?t.getEntity():null},t.prototype.findStyleRanges=function(e,t){c(this.getCharacterList(),a,e,t)},t.prototype.findEntityRanges=function(e,t){c(this.getCharacterList(),s,e,t)},t}(g);e.exports=v},function(e,t,n){"use strict";(function(t){function r(e){return f<=e&&e<=h}function i(e,n){if(0<=n&&n<e.length?void 0:"production"!==t.env.NODE_ENV?d(!1,"isSurrogatePair: Invalid index %s for string length %s.",n,e.length):d(!1),n+1===e.length)return!1;var r=e.charCodeAt(n),i=e.charCodeAt(n+1);return f<=r&&r<=p&&m<=i&&i<=h}function o(e){return g.test(e)}function a(e,t){return 1+r(e.charCodeAt(t))}function s(e){if(!o(e))return e.length;for(var t=0,n=0;n<e.length;n+=a(e,n))t++;return t}function l(e,t,n){if(t=t||0,n=void 0===n?1/0:n||0,!o(e))return e.substr(t,n);var r=e.length;if(r<=0||t>r||n<=0)return"";var i=0;if(t>0){for(;t>0&&i<r;t--)i+=a(e,i);if(i>=r)return""}else if(t<0){for(i=r;t<0&&0<i;t++)i-=a(e,i-1);i<0&&(i=0)}var s=r;if(n<r)for(s=i;n>0&&s<r;n--)s+=a(e,s);return e.substring(i,s)}function c(e,t,n){t=t||0,n=void 0===n?1/0:n||0,t<0&&(t=0),n<0&&(n=0);var r=Math.abs(n-t);return t=t<n?t:n,l(e,t,r)}function u(e){for(var t=[],n=0;n<e.length;n+=a(e,n))t.push(e.codePointAt(n));return t}var d=n(4),f=55296,p=56319,m=56320,h=57343,g=/[\uD800-\uDFFF]/,v={getCodePoints:u,getUTF16Length:a,hasSurrogateUnit:o,isCodeUnitInSurrogateRange:r,isSurrogatePair:i,strlen:s,substring:c,substr:l};e.exports=v}).call(t,n(3))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(241),o=r(i);t.default=o.default},,function(e,t,n){"use strict";var r=n(132),i=n(27),o=n(14),a=n(147),s=n(21),l=n(41),c=n(44),u=n(67),d=n(148),f=n(69),p=n(36),m=n(8),h=n(65),g=n(6),v=n(50),y=n(208),b=n(28),_=n(210),w=n(82),S=n(213),k=n(16),E=n(84),C=n(217),x={Editor:d,EditorBlock:f,EditorState:g,CompositeDecorator:a,Entity:p,EntityInstance:h,BlockMapBuilder:i,CharacterMetadata:o,ContentBlock:s,ContentState:l,SelectionState:b,AtomicBlockUtils:r,KeyBindingUtil:v,Modifier:m,RichUtils:y,DefaultDraftBlockRenderMap:c,DefaultDraftInlineStyle:u,convertFromHTML:w,convertFromRaw:S,convertToRaw:_,genKey:k,getDefaultKeyBinding:E,getVisibleSelectionRect:C};e.exports=x},,function(e,t,n){"use strict";var r=n(5),i=r.OrderedMap,o={createFromArray:function(e){return i(e.map(function(e){return[e.getKey(),e]}))}};e.exports=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(5),s=a.Record,l={anchorKey:"",anchorOffset:0,focusKey:"",focusOffset:0,isBackward:!1,hasFocus:!1},c=s(l),u=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return o(t,e),t.prototype.serialize=function(){return"Anchor: "+this.getAnchorKey()+":"+this.getAnchorOffset()+", Focus: "+this.getFocusKey()+":"+this.getFocusOffset()+", Is Backward: "+String(this.getIsBackward())+", Has Focus: "+String(this.getHasFocus())},t.prototype.getAnchorKey=function(){return this.get("anchorKey")},t.prototype.getAnchorOffset=function(){return this.get("anchorOffset")},t.prototype.getFocusKey=function(){return this.get("focusKey")},t.prototype.getFocusOffset=function(){return this.get("focusOffset")},t.prototype.getIsBackward=function(){return this.get("isBackward")},t.prototype.getHasFocus=function(){return this.get("hasFocus")},t.prototype.hasEdgeWithin=function(e,t,n){var r=this.getAnchorKey(),i=this.getFocusKey();if(r===i&&r===e){var o=this.getStartOffset(),a=this.getEndOffset();return t<=a&&o<=n}if(e!==r&&e!==i)return!1;var s=e===r?this.getAnchorOffset():this.getFocusOffset();return t<=s&&n>=s},t.prototype.isCollapsed=function(){return this.getAnchorKey()===this.getFocusKey()&&this.getAnchorOffset()===this.getFocusOffset()},t.prototype.getStartKey=function(){return this.getIsBackward()?this.getFocusKey():this.getAnchorKey()},t.prototype.getStartOffset=function(){return this.getIsBackward()?this.getFocusOffset():this.getAnchorOffset()},t.prototype.getEndKey=function(){return this.getIsBackward()?this.getAnchorKey():this.getFocusKey()},t.prototype.getEndOffset=function(){return this.getIsBackward()?this.getAnchorOffset():this.getFocusOffset()},t.createEmpty=function(e){return new t({anchorKey:e,anchorOffset:0,focusKey:e,focusOffset:0,isBackward:!1,hasFocus:!1})},t}(c);e.exports=u},function(e,t,n){"use strict";function r(e){return"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}).map(i).join(" "):Array.prototype.map.call(arguments,i).join(" ")}function i(e){return e.replace(/\//g,"-")}e.exports=r},function(e,t,n){"use strict";function r(e,t,n){var r=e.getSelection(),o=e.getCurrentContent(),a=r;if(r.isCollapsed()){if("forward"===n){if(e.isSelectionAtEndOfContent())return o}else if(e.isSelectionAtStartOfContent())return o;if(a=t(e),a===r)return o}return i.removeRange(o,a,n)}var i=n(8);e.exports=r},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(286),a=r(o),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.default,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text";i(this,e),this.text=t,this.component=n,this.data=r,this.type=o,this.isMutable=!0}return s(e,[{key:"serializedText",get:function(){return this.text}}]),e}();t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.makeLoadable=void 0;var i=n(128),o=r(i),a=n(59),s=r(a);t.makeLoadable=o.default,t.default=s.default},function(e,t,n){"use strict";function r(e,t,n,r){if(e.size){var i=0;e.reduce(function(e,o,a){return t(e,o)||(n(e)&&r(i,a),i=a),o}),n(e.last())&&r(i,e.count())}}e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=t.getStartKey(),r=t.getStartOffset(),a=t.getEndKey(),s=t.getEndOffset(),l=o(e,t),c=l.getBlockMap(),u=c.keySeq(),d=u.indexOf(n),f=u.indexOf(a)+1,p=c.slice(d,f).map(function(e,t){var o=i(),l=e.getText(),c=e.getCharacterList();return n===a?e.merge({key:o,text:l.slice(r,s),characterList:c.slice(r,s)}):t===n?e.merge({key:o,text:l.slice(r),characterList:c.slice(r)}):t===a?e.merge({key:o,text:l.slice(0,s),characterList:c.slice(0,s)}):e.set("key",o)});return p.toOrderedMap()}var i=n(16),o=n(62);e.exports=r},function(e,t,n){"use strict";(function(t){function r(e,t){console.warn("WARNING: "+e+' will be deprecated soon!\nPlease use "'+t+'" instead.')}var i=n(20),o=i||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(65),s=n(5),l=n(4),c=s.Map,u=c(),d=0,f={getLastCreatedEntityKey:function(){return r("DraftEntity.getLastCreatedEntityKey","contentState.getLastCreatedEntityKey"),f.__getLastCreatedEntityKey()},create:function(e,t,n){return r("DraftEntity.create","contentState.createEntity"),f.__create(e,t,n)},add:function(e){return r("DraftEntity.add","contentState.addEntity"),f.__add(e)},get:function(e){return r("DraftEntity.get","contentState.getEntity"),f.__get(e)},mergeData:function(e,t){return r("DraftEntity.mergeData","contentState.mergeEntityData"),f.__mergeData(e,t)},replaceData:function(e,t){return r("DraftEntity.replaceData","contentState.replaceEntityData"),f.__replaceData(e,t)},__getLastCreatedEntityKey:function(){return""+d},__create:function(e,t,n){return f.__add(new a({type:e,mutability:t,data:n||{}}))},__add:function(e){var t=""+ ++d;return u=u.set(t,e),t},__get:function(e){var n=u.get(e);return n?void 0:"production"!==t.env.NODE_ENV?l(!1,"Unknown DraftEntity key."):l(!1),n},__mergeData:function(e,t){var n=f.__get(e),r=o({},n.getData(),t),i=n.set("data",r);return u=u.set(e,i),i},__replaceData:function(e,t){var n=f.__get(e),r=n.set("data",t);return u=u.set(e,r),r}};e.exports=f}).call(t,n(3))},function(e,t,n){"use strict";var r="-",i={encode:function(e,t,n){return e+r+t+r+n},decode:function(e){var t=e.split(r),n=t[0],i=t[1],o=t[2];return{blockKey:n,decoratorKey:parseInt(i,10),leafKey:parseInt(o,10)}}};e.exports=i},function(e,t,n){"use strict";function r(e){return"handled"===e||e===!0}e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=(0,r.defineMessages)({selectTemplate:{id:"boxui.searchMetadata.selectTemplate",defaultMessage:"Select a Template to Get Started"},apply:{id:"boxui.searchMetadata.apply",defaultMessage:"Apply"},reset:{id:"boxui.searchMetadata.reset",defaultMessage:"Reset"},numFiltersSet:{id:"boxui.searchMetadata.numFiltersSet",defaultMessage:"{numFiltersSet} Metadata Filter(s) Set"},metadata:{id:"boxui.searchMetadata.metadata",defaultMessage:"Metadata"},inputPlaceholder:{id:"boxui.searchMetadata.setValueInputPlaceholder",defaultMessage:"Set Value"}});t.default=i},,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(27),s=n(14),l=n(21),c=n(36),u=n(5),d=n(28),f=n(16),p=n(42),m=u.List,h=u.Record,g=u.Repeat,v={entityMap:null,blockMap:null,selectionBefore:null,selectionAfter:null},y=h(v),b=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return o(t,e),t.prototype.getEntityMap=function(){return c},t.prototype.getBlockMap=function(){return this.get("blockMap")},t.prototype.getSelectionBefore=function(){return this.get("selectionBefore")},t.prototype.getSelectionAfter=function(){return this.get("selectionAfter")},t.prototype.getBlockForKey=function(e){var t=this.getBlockMap().get(e);return t},t.prototype.getKeyBefore=function(e){return this.getBlockMap().reverse().keySeq().skipUntil(function(t){return t===e}).skip(1).first()},t.prototype.getKeyAfter=function(e){return this.getBlockMap().keySeq().skipUntil(function(t){return t===e}).skip(1).first()},t.prototype.getBlockAfter=function(e){return this.getBlockMap().skipUntil(function(t,n){return n===e}).skip(1).first()},t.prototype.getBlockBefore=function(e){return this.getBlockMap().reverse().skipUntil(function(t,n){return n===e}).skip(1).first()},t.prototype.getBlocksAsArray=function(){return this.getBlockMap().toArray()},t.prototype.getFirstBlock=function(){return this.getBlockMap().first()},t.prototype.getLastBlock=function(){return this.getBlockMap().last()},t.prototype.getPlainText=function(e){return this.getBlockMap().map(function(e){return e?e.getText():""}).join(e||"\n")},t.prototype.getLastCreatedEntityKey=function(){return c.__getLastCreatedEntityKey()},t.prototype.hasText=function(){var e=this.getBlockMap();return e.size>1||e.first().getLength()>0},t.prototype.createEntity=function(e,t,n){return c.__create(e,t,n),this},t.prototype.mergeEntityData=function(e,t){return c.__mergeData(e,t),this},t.prototype.replaceEntityData=function(e,t){return c.__replaceData(e,t),this},t.prototype.addEntity=function(e){return c.__add(e),this},t.prototype.getEntity=function(e){return c.__get(e)},t.createFromBlockArray=function(e,n){var r=Array.isArray(e)?e:e.contentBlocks,i=a.createFromArray(r),o=i.isEmpty()?new d:d.createEmpty(i.first().getKey());return new t({blockMap:i,entityMap:n||c,selectionBefore:o,selectionAfter:o})},t.createFromText=function(e){var n=arguments.length<=1||void 0===arguments[1]?/\r\n?|\n/g:arguments[1],r=e.split(n),i=r.map(function(e){return e=p(e),new l({key:f(),text:e,type:"unstyled",characterList:m(g(s.EMPTY,e.length))})});return t.createFromBlockArray(i)},t}(y);e.exports=b},function(e,t,n){"use strict";function r(e){return e.replace(i,"")}var i=new RegExp("\r","g");e.exports=r},function(e,t,n){"use strict";(function(t){function r(e){return e===d||e===f}function i(e){return r(e)?void 0:"production"!==t.env.NODE_ENV?c(!1,"`dir` must be a strong direction to be converted to HTML Direction"):c(!1),e===d?"ltr":"rtl";
}function o(e,n){return r(e)?void 0:"production"!==t.env.NODE_ENV?c(!1,"`dir` must be a strong direction to be converted to HTML Direction"):c(!1),r(n)?void 0:"production"!==t.env.NODE_ENV?c(!1,"`otherDir` must be a strong direction to be converted to HTML Direction"):c(!1),e===n?null:i(e)}function a(e){p=e}function s(){a(d)}function l(){return p||this.initGlobalDir(),p?void 0:"production"!==t.env.NODE_ENV?c(!1,"Global direction not set."):c(!1),p}var c=n(4),u="NEUTRAL",d="LTR",f="RTL",p=null,m={NEUTRAL:u,LTR:d,RTL:f,isStrong:r,getHTMLDir:i,getHTMLDirIfDifferent:o,setGlobalDir:a,initGlobalDir:s,getGlobalDir:l};e.exports=m}).call(t,n(3))},function(e,t,n){"use strict";var r=n(5),i=r.Map,o=n(0),a=n(29),s=o.createElement("ul",{className:a("public/DraftStyleDefault/ul")}),l=o.createElement("ol",{className:a("public/DraftStyleDefault/ol")}),c=o.createElement("pre",{className:a("public/DraftStyleDefault/pre")}),u=i({"header-one":{element:"h1"},"header-two":{element:"h2"},"header-three":{element:"h3"},"header-four":{element:"h4"},"header-five":{element:"h5"},"header-six":{element:"h6"},"unordered-list-item":{element:"li",wrapper:s},"ordered-list-item":{element:"li",wrapper:l},blockquote:{element:"blockquote"},atomic:{element:"figure"},"code-block":{element:"pre",wrapper:c},unstyled:{element:"div",aliasedElements:["p"]}});e.exports=u},function(e,t,n){"use strict";e.exports={BACKSPACE:8,TAB:9,RETURN:13,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,COMMA:188,PERIOD:190,A:65,Z:90,ZERO:48,NUMPAD_0:96,NUMPAD_9:105}},function(e,t,n){"use strict";function r(e,t){var n;if(t.isCollapsed()){var r=t.getAnchorKey(),o=t.getAnchorOffset();return o>0?(n=e.getBlockForKey(r).getEntityAt(o-1),i(e.getEntityMap(),n)):null}var a=t.getStartKey(),s=t.getStartOffset(),l=e.getBlockForKey(a);return n=s===l.getLength()?null:l.getEntityAt(s),i(e.getEntityMap(),n)}function i(e,t){if(t){var n=e.__get(t);return"MUTABLE"===n.getMutability()?t:null}return null}e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=o.get(e,t);return"auto"===n||"scroll"===n}var i=n(163),o={get:i,getScrollParent:function(e){if(!e)return null;for(var t=e.ownerDocument;e&&e!==t.body;){if(r(e,"overflow")||r(e,"overflowY")||r(e,"overflowX"))return e;e=e.parentNode}return t.defaultView||t.parentWindow}};e.exports=o},function(e,t,n){"use strict";function r(e){var t=i(e.ownerDocument||e.document);e.Window&&e instanceof e.Window&&(e=t);var n=o(e),r=e===t?e.ownerDocument.documentElement:e,a=e.scrollWidth-r.clientWidth,s=e.scrollHeight-r.clientHeight;return n.x=Math.max(0,Math.min(n.x,a)),n.y=Math.max(0,Math.min(n.y,s)),n}var i=n(168),o=n(169);e.exports=r},function(e,t,n){"use strict";function r(e){for(var t=e;t&&t!==document.documentElement;){var n=i(t);if(null!=n)return n;t=t.parentNode}return null}var i=n(74);e.exports=r},function(e,t,n){"use strict";var r=n(18),i=r.isPlatform("Mac OS X"),o={isCtrlKeyCommand:function(e){return!!e.ctrlKey&&!e.altKey},isOptionKeyCommand:function(e){return i&&e.altKey},hasCommandModifier:function(e){return i?!!e.metaKey&&!e.altKey:o.isCtrlKeyCommand(e)}};e.exports=o},function(e,t,n){"use strict";function r(e,t){var n=e.getSelection(),r=e.getCurrentContent(),i=n.getStartKey(),o=n.getStartOffset(),a=i,s=0;if(t>o){var l=r.getKeyBefore(i);if(null==l)a=i;else{a=l;var c=r.getBlockForKey(l);s=c.getText().length}}else s=o-t;return n.merge({focusKey:a,focusOffset:s,isBackward:!0})}e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(221),o=r(i);t.default=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=(0,r.defineMessages)({cancel:{id:"boxui.core.cancel",defaultMessage:"Cancel"},close:{id:"boxui.core.close",defaultMessage:"Close"},copy:{id:"boxui.core.copy",defaultMessage:"Copy"},copied:{id:"boxui.core.copied",defaultMessage:"Copied!"},okay:{id:"boxui.core.okay",defaultMessage:"Okay"},save:{id:"boxui.core.save",defaultMessage:"Save"},send:{id:"boxui.core.send",defaultMessage:"Send"},optional:{id:"boxui.core.optional",defaultMessage:"optional"},pillSelectorPlaceholder:{id:"boxui.share.pillSelectorPlaceholder",defaultMessage:"Names or email addresses"},invalidInputError:{id:"boxui.validation.genericError",defaultMessage:"Invalid Input"},minLengthError:{id:"boxui.validation.tooShortError",defaultMessage:"Input must be at least {min} characters"},maxLengthError:{id:"boxui.validation.tooLongError",defaultMessage:"Input cannot exceed {max} characters"},invalidEmailError:{id:"boxui.validation.emailError",defaultMessage:"Invalid Email Address"},invalidURLError:{id:"boxui.validation.URLError",defaultMessage:"Invalid URL"},requiredFieldError:{id:"boxui.validation.requiredError",defaultMessage:"Required Field"}});t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.LinkPrimaryButton=t.LinkButton=t.Link=t.LinkGroup=void 0;var i=n(273),o=r(i),a=n(274),s=r(a),l=n(106),c=r(l),u=n(275),d=r(u);t.LinkGroup=o.default,t.Link=s.default,t.LinkButton=c.default,t.LinkPrimaryButton=d.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=function(e){function t(){var e,n,r,a;i(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.handleDocumentClick=function(e){var t=r.domNode&&r.domNode.contains(e.target)||r.domNode===e.target,n=r.props,i=n.isVisible,o=n.onClick,a=n.onClickOutside;return!t&&i&&a?void a(e):void(t&&("contextmenu"===e.type?e.preventDefault():"function"==typeof o&&o(e)))},a=n,o(r,a)}return a(t,e),f(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocumentClick,!0),document.addEventListener("contextmenu",this.handleDocumentClick,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDocumentClick,!0),document.removeEventListener("contextmenu",this.handleDocumentClick,!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.className,i=void 0===r?"":r,o=t.isVisible,a=o?"is-visible":"";return d.default.createElement("div",{className:"overlay-wrapper "+a+" "+i,ref:function(t){e.domNode=t}},d.default.createElement("div",{className:"overlay"},n))}}]),t}(u.Component);p.propTypes={className:c.default.string,children:c.default.node.isRequired,onClick:c.default.func,onClickOutside:c.default.func,isVisible:c.default.bool},p.defaultProps={className:"",isVisible:!1},t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#000000":r,o=e.width,a=void 0===o?18:o,l=e.height,u=void 0===l?18:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-info-inverted "+n,title:f,width:a,height:u,viewBox:"0 0 18 18"},s.default.createElement("path",{className:"fill-color",fill:i,fillRule:"evenodd",d:"M8.1 13.5h1.8V8.1H8.1v5.4zM9 0C4.05 0 0 4.05 0 9s4.05 9 9 9 9-4.05 9-9-4.05-9-9-9zm0 16.2c-3.96 0-7.2-3.24-7.2-7.2S5.04 1.8 9 1.8s7.2 3.24 7.2 7.2-3.24 7.2-7.2 7.2zm-.9-9.9h1.8V4.5H8.1v1.8z"}))};u.displayName="IconInfoInverted",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t){},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a);n(129);var l=function(e){var t=e.className,n=void 0===t?"":t,r=e.size,i=void 0===r?"default":r;return s.default.createElement("div",{className:"crawler "+n+" is-"+i},s.default.createElement("div",null),s.default.createElement("div",null),s.default.createElement("div",null))};l.displayName="LoadingIndicator",l.propTypes={className:o.default.string,size:o.default.oneOf(["small","large","default"])},t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(131),o=r(i);t.default=o.default},function(e,t,n){"use strict";var r={draft_killswitch_allow_nontextnodes:!1,draft_segmented_entities_behavior:!1};e.exports=r},function(e,t,n){"use strict";(function(t){function r(e,t){var n=e.getBlockMap(),r=e.getEntityMap(),i={},a=t.getStartKey(),s=t.getStartOffset(),l=n.get(a),c=o(r,l,s);c!==l&&(i[a]=c);var u=t.getEndKey(),d=t.getEndOffset(),f=n.get(u);a===u&&(f=c);var p=o(r,f,d);return p!==f&&(i[u]=p),Object.keys(i).length?e.merge({blockMap:n.merge(i),selectionAfter:t}):e.set("selectionAfter",t)}function i(e,n,r){var i;return s(e,function(e,t){return e.getEntity()===t.getEntity()},function(e){return e.getEntity()===n},function(e,t){e<=r&&t>=r&&(i={start:e,end:t})}),"object"!=typeof i?"production"!==t.env.NODE_ENV?l(!1,"Removal range must exist within character list."):l(!1):void 0,i}function o(e,t,n){var r=t.getCharacterList(),o=n>0?r.get(n-1):void 0,s=n<r.count()?r.get(n):void 0,l=o?o.getEntity():void 0,c=s?s.getEntity():void 0;if(c&&c===l){var u=e.__get(c);if("MUTABLE"!==u.getMutability()){for(var d,f=i(r,c,n),p=f.start,m=f.end;p<m;)d=r.get(p),r=r.set(p,a.applyEntity(d,null)),p++;return t.set("characterList",r)}}return t}var a=n(14),s=n(34),l=n(4);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";function r(e,t,n){if(n===e.count())t.forEach(function(t){e=e.push(t)});else if(0===n)t.reverse().forEach(function(t){e=e.unshift(t)});else{var r=e.slice(0,n),i=e.slice(n);e=r.concat(t,i).toList()}return e}e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=[],r=e.map(function(e){return e.getStyle()}).toList();return s(r,i,d,function(e,r){n.push(new m({start:e+t,end:r+t}))}),l(n)}function i(e,t){return e===t}var o=n(5),a=n(24),s=n(34),l=o.List,c=o.Repeat,u=o.Record,d=a.thatReturnsTrue,f="-",p={start:null,end:null},m=u(p),h={start:null,end:null,decoratorKey:null,leaves:null},g=u(h),v={generate:function(e,t,n){var o=t.getLength();if(!o)return l.of(new g({start:0,end:0,decoratorKey:null,leaves:l.of(new m({start:0,end:0}))}));var a=[],u=n?n.getDecorations(t,e):l(c(null,o)),f=t.getCharacterList();return s(u,i,d,function(e,t){a.push(new g({start:e,end:t,decoratorKey:u.get(e),leaves:r(f.slice(e,t).toList(),e)}))}),l(a)},getFingerprint:function(e){return e.map(function(e){var t=e.get("decoratorKey"),n=null!==t?t+"."+(e.get("end")-e.get("start")):"";return""+n+"."+e.get("leaves").size}).join(f)}};e.exports=v},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(5),s=a.Record,l=s({type:"TOKEN",mutability:"IMMUTABLE",data:Object}),c=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return o(t,e),t.prototype.getType=function(){return this.get("type")},t.prototype.getMutability=function(){return this.get("mutability")},t.prototype.getData=function(){return this.get("data")},t}(l);e.exports=c},function(e,t,n){"use strict";(function(t){function r(e){var t=f.exec(e);return null==t?null:t[0]}function i(e){var t=r(e);return null==t?c.NEUTRAL:p.exec(t)?c.RTL:c.LTR}function o(e,t){if(t=t||c.NEUTRAL,!e.length)return t;var n=i(e);return n===c.NEUTRAL?t:n}function a(e,n){return n||(n=c.getGlobalDir()),c.isStrong(n)?void 0:"production"!==t.env.NODE_ENV?u(!1,"Fallback direction must be a strong direction"):u(!1),o(e,n)}function s(e,t){return a(e,t)===c.LTR}function l(e,t){return a(e,t)===c.RTL}var c=n(43),u=n(4),d={L:"A-Za-zªµºÀ-ÖØ-öø-ƺƻƼ-ƿǀ-ǃǄ-ʓʔʕ-ʯʰ-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͷͺͻ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҂Ҋ-ԯԱ-Ֆՙ՚-՟ա-և։ःऄ-हऻऽा-ीॉ-ौॎ-ॏॐक़-ॡ।-॥०-९॰ॱॲ-ঀং-ঃঅ-ঌএ-ঐও-নপ-রলশ-হঽা-ীে-ৈো-ৌৎৗড়-ঢ়য়-ৡ০-৯ৰ-ৱ৴-৹৺ਃਅ-ਊਏ-ਐਓ-ਨਪ-ਰਲ-ਲ਼ਵ-ਸ਼ਸ-ਹਾ-ੀਖ਼-ੜਫ਼੦-੯ੲ-ੴઃઅ-ઍએ-ઑઓ-નપ-રલ-ળવ-હઽા-ીૉો-ૌૐૠ-ૡ૦-૯૰ଂ-ଃଅ-ଌଏ-ଐଓ-ନପ-ରଲ-ଳଵ-ହଽାୀେ-ୈୋ-ୌୗଡ଼-ଢ଼ୟ-ୡ୦-୯୰ୱ୲-୷ஃஅ-ஊஎ-ஐஒ-கங-சஜஞ-டண-தந-பம-ஹா-ிு-ூெ-ைொ-ௌௐௗ௦-௯௰-௲ఁ-ఃఅ-ఌఎ-ఐఒ-నప-హఽు-ౄౘ-ౙౠ-ౡ౦-౯౿ಂ-ಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽಾಿೀ-ೄೆೇ-ೈೊ-ೋೕ-ೖೞೠ-ೡ೦-೯ೱ-ೲം-ഃഅ-ഌഎ-ഐഒ-ഺഽാ-ീെ-ൈൊ-ൌൎൗൠ-ൡ൦-൯൰-൵൹ൺ-ൿං-ඃඅ-ඖක-නඳ-රලව-ෆා-ෑෘ-ෟ෦-෯ෲ-ෳ෴ก-ะา-ำเ-ๅๆ๏๐-๙๚-๛ກ-ຂຄງ-ຈຊຍດ-ທນ-ຟມ-ຣລວສ-ຫອ-ະາ-ຳຽເ-ໄໆ໐-໙ໜ-ໟༀ༁-༃༄-༒༓༔༕-༗༚-༟༠-༩༪-༳༴༶༸༾-༿ཀ-ཇཉ-ཬཿ྅ྈ-ྌ྾-࿅࿇-࿌࿎-࿏࿐-࿔࿕-࿘࿙-࿚က-ဪါ-ာေးျ-ြဿ၀-၉၊-၏ၐ-ၕၖ-ၗၚ-ၝၡၢ-ၤၥ-ၦၧ-ၭၮ-ၰၵ-ႁႃ-ႄႇ-ႌႎႏ႐-႙ႚ-ႜ႞-႟Ⴀ-ჅჇჍა-ჺ჻ჼჽ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፠-፨፩-፼ᎀ-ᎏᎠ-Ᏼᐁ-ᙬ᙭-᙮ᙯ-ᙿᚁ-ᚚᚠ-ᛪ᛫-᛭ᛮ-ᛰᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱ᜵-᜶ᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳាើ-ៅះ-ៈ។-៖ៗ៘-៚ៜ០-៩᠐-᠙ᠠ-ᡂᡃᡄ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᤣ-ᤦᤩ-ᤫᤰ-ᤱᤳ-ᤸ᥆-᥏ᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧀᧁ-ᧇᧈ-ᧉ᧐-᧙᧚ᨀ-ᨖᨙ-ᨚ᨞-᨟ᨠ-ᩔᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪉᪐-᪙᪠-᪦ᪧ᪨-᪭ᬄᬅ-ᬳᬵᬻᬽ-ᭁᭃ-᭄ᭅ-ᭋ᭐-᭙᭚-᭠᭡-᭪᭴-᭼ᮂᮃ-ᮠᮡᮦ-ᮧ᮪ᮮ-ᮯ᮰-᮹ᮺ-ᯥᯧᯪ-ᯬᯮ᯲-᯳᯼-᯿ᰀ-ᰣᰤ-ᰫᰴ-ᰵ᰻-᰿᱀-᱉ᱍ-ᱏ᱐-᱙ᱚ-ᱷᱸ-ᱽ᱾-᱿᳀-᳇᳓᳡ᳩ-ᳬᳮ-ᳱᳲ-ᳳᳵ-ᳶᴀ-ᴫᴬ-ᵪᵫ-ᵷᵸᵹ-ᶚᶛ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℴℵ-ℸℹℼ-ℿⅅ-ⅉⅎ⅏Ⅰ-ↂↃ-ↄↅ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-Ⱞⰰ-ⱞⱠ-ⱻⱼ-ⱽⱾ-ⳤⳫ-ⳮⳲ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵰ⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々〆〇〡-〩〮-〯〱-〵〸-〺〻〼ぁ-ゖゝ-ゞゟァ-ヺー-ヾヿㄅ-ㄭㄱ-ㆎ㆐-㆑㆒-㆕㆖-㆟ㆠ-ㆺㇰ-ㇿ㈀-㈜㈠-㈩㈪-㉇㉈-㉏㉠-㉻㉿㊀-㊉㊊-㊰㋀-㋋㋐-㋾㌀-㍶㍻-㏝㏠-㏾㐀-䶵一-鿌ꀀ-ꀔꀕꀖ-ꒌꓐ-ꓷꓸ-ꓽ꓾-꓿ꔀ-ꘋꘌꘐ-ꘟ꘠-꘩ꘪ-ꘫꙀ-ꙭꙮꚀ-ꚛꚜ-ꚝꚠ-ꛥꛦ-ꛯ꛲-꛷Ꜣ-ꝯꝰꝱ-ꞇ꞉-꞊Ꞌ-ꞎꞐ-ꞭꞰ-Ʇꟷꟸ-ꟹꟺꟻ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꠣ-ꠤꠧ꠰-꠵꠶-꠷ꡀ-ꡳꢀ-ꢁꢂ-ꢳꢴ-ꣃ꣎-꣏꣐-꣙ꣲ-ꣷ꣸-꣺ꣻ꤀-꤉ꤊ-ꤥ꤮-꤯ꤰ-ꥆꥒ-꥓꥟ꥠ-ꥼꦃꦄ-ꦲꦴ-ꦵꦺ-ꦻꦽ-꧀꧁-꧍ꧏ꧐-꧙꧞-꧟ꧠ-ꧤꧦꧧ-ꧯ꧰-꧹ꧺ-ꧾꨀ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ꩐-꩙꩜-꩟ꩠ-ꩯꩰꩱ-ꩶ꩷-꩹ꩺꩻꩽꩾ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂꫛ-ꫜꫝ꫞-꫟ꫠ-ꫪꫫꫮ-ꫯ꫰-꫱ꫲꫳ-ꫴꫵꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚ꭛ꭜ-ꭟꭤ-ꭥꯀ-ꯢꯣ-ꯤꯦ-ꯧꯩ-ꯪ꯫꯬꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ-豈-舘並-龎ﬀ-ﬆﬓ-ﬗＡ-Ｚａ-ｚｦ-ｯｰｱ-ﾝﾞ-ﾟﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",R:"֐־׀׃׆׈-׏א-ת׫-ׯװ-ײ׳-״׵-׿߀-߉ߊ-ߪߴ-ߵߺ߻-߿ࠀ-ࠕࠚࠤࠨ࠮-࠯࠰-࠾࠿ࡀ-ࡘ࡜-࡝࡞࡟-࢟‏יִײַ-ﬨשׁ-זּ﬷טּ-לּ﬽מּ﬿נּ-סּ﭂ףּ-פּ﭅צּ-ﭏ",AL:"؈؋؍؛؜؝؞-؟ؠ-ؿـف-ي٭ٮ-ٯٱ-ۓ۔ەۥ-ۦۮ-ۯۺ-ۼ۽-۾ۿ܀-܍܎܏ܐܒ-ܯ݋-݌ݍ-ޥޱ޲-޿ࢠ-ࢲࢳ-ࣣﭐ-ﮱ﮲-﯁﯂-﯒ﯓ-ﴽ﵀-﵏ﵐ-ﶏ﶐-﶑ﶒ-ﷇ﷈-﷏ﷰ-ﷻ﷼﷾-﷿ﹰ-ﹴ﹵ﹶ-ﻼ﻽-﻾"},f=new RegExp("["+d.L+d.R+d.AL+"]"),p=new RegExp("["+d.R+d.AL+"]"),m={firstStrongChar:r,firstStrongCharDir:i,resolveBlockDir:o,getDirection:a,isDirectionLTR:s,isDirectionRTL:l};e.exports=m}).call(t,n(3))},function(e,t,n){"use strict";e.exports={BOLD:{fontWeight:"bold"},CODE:{fontFamily:"monospace",wordWrap:"break-word"},ITALIC:{fontStyle:"italic"},STRIKETHROUGH:{textDecoration:"line-through"},UNDERLINE:{textDecoration:"underline"}}},function(e,t,n){"use strict";function r(e){var t=e.getSelection(),n=t.getAnchorKey(),r=e.getBlockTree(n),i=t.getStartOffset(),o=!1;return r.some(function(e){return i===e.get("start")?(o=!0,!0):i<e.get("end")&&e.get("leaves").some(function(e){var t=e.get("start");return i===t&&(o=!0,!0)})}),o}e.exports=r},function(e,t,n){"use strict";(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){return e.getAnchorKey()===t||e.getFocusKey()===t}var s=n(20),l=s||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=n(151),u=n(37),d=n(0),f=n(17),p=n(72),m=n(47),h=n(66),g=n(43),v=n(29),y=n(166),b=n(48),_=n(170),w=n(4),S=n(12),k=10,E=function(e){function n(){return r(this,n),i(this,e.apply(this,arguments))}return o(n,e),n.prototype.shouldComponentUpdate=function(e){return this.props.block!==e.block||this.props.tree!==e.tree||this.props.direction!==e.direction||a(e.selection,e.block.getKey())&&e.forceSelection},n.prototype.componentDidMount=function(){var e=this.props.selection,n=e.getEndKey();if(e.getHasFocus()&&n===this.props.block.getKey()){var r,i=f.findDOMNode(this),o=m.getScrollParent(i),a=b(o);if(o===window){var s=y(i),l=s.y+s.height,c=_().height;r=l-c,r>0&&window.scrollTo(a.x,a.y+r+k)}else{i instanceof HTMLElement?void 0:"production"!==t.env.NODE_ENV?w(!1,"blockNode is not an HTMLElement"):w(!1);var u=i.offsetHeight+i.offsetTop,d=o.offsetHeight+a.y;r=u-d,r>0&&p.setTop(o,p.getTop(o)+r+k)}}},n.prototype._renderChildren=function(){var e=this,t=this.props.block,n=t.getKey(),r=t.getText(),i=this.props.tree.size-1,o=a(this.props.selection,n);return this.props.tree.map(function(a,s){var f=a.get("leaves"),p=f.size-1,m=f.map(function(a,l){var f=u.encode(n,s,l),m=a.get("start"),h=a.get("end");return d.createElement(c,{key:f,offsetKey:f,block:t,start:m,selection:o?e.props.selection:void 0,forceSelection:e.props.forceSelection,text:r.slice(m,h),styleSet:t.getInlineStyleAt(m),customStyleMap:e.props.customStyleMap,customStyleFn:e.props.customStyleFn,isLast:s===i&&l===p})}).toArray(),v=a.get("decoratorKey");if(null==v)return m;if(!e.props.decorator)return m;var y=S(e.props.decorator),b=y.getComponentForKey(v);if(!b)return m;var _=y.getPropsForKey(v),w=u.encode(n,s,0),k=r.slice(f.first().get("start"),f.last().get("end")),E=g.getHTMLDirIfDifferent(h.getDirection(k),e.props.direction);return d.createElement(b,l({},_,{contentState:e.props.contentState,decoratedText:k,dir:E,key:w,entityKey:t.getEntityAt(a.get("start")),offsetKey:w}),m)}).toArray()},n.prototype.render=function(){var e=this.props,t=e.direction,n=e.offsetKey,r=v({"public/DraftStyleDefault/block":!0,"public/DraftStyleDefault/ltr":"LTR"===t,"public/DraftStyleDefault/rtl":"RTL"===t});return d.createElement("div",{"data-offset-key":n,className:r},this._renderChildren())},n}(d.Component);e.exports=E}).call(t,n(3))},function(e,t,n){"use strict";function r(e,t){return!(!e||!t)&&(e===t||!i(e)&&(i(t)?r(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}var i=n(161);e.exports=r},function(e,t,n){"use strict";function r(e){if(e=e||("undefined"!=typeof document?document:void 0),"undefined"==typeof e)return null;try{return e.activeElement||e.body}catch(t){return e.body}}e.exports=r},function(e,t,n){"use strict";function r(e,t){return!!t&&(e===t.documentElement||e===t.body)}var i={getTop:function(e){var t=e.ownerDocument;return r(e,t)?t.body.scrollTop||t.documentElement.scrollTop:e.scrollTop},setTop:function(e,t){var n=e.ownerDocument;r(e,n)?n.body.scrollTop=n.documentElement.scrollTop=t:e.scrollTop=t},getLeft:function(e){var t=e.ownerDocument;return r(e,t)?t.body.scrollLeft||t.documentElement.scrollLeft:e.scrollLeft},setLeft:function(e,t){var n=e.ownerDocument;r(e,n)?n.body.scrollLeft=n.documentElement.scrollLeft=t:e.scrollLeft=t}};e.exports=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){if("file"==e.kind)return e.getAsFile()}var o=n(173),a=n(174),s=n(24),l=new RegExp("\r\n","g"),c="\n",u={"text/rtf":1,"text/html":1},d=function(){function e(t){r(this,e),this.data=t,this.types=t.types?a(t.types):[]}return e.prototype.isRichText=function(){return!(!this.getHTML()||!this.getText())||!this.isImage()&&this.types.some(function(e){return u[e]})},e.prototype.getText=function(){var e;return this.data.getData&&(this.types.length?this.types.indexOf("text/plain")!=-1&&(e=this.data.getData("text/plain")):e=this.data.getData("Text")),e?e.replace(l,c):null},e.prototype.getHTML=function(){if(this.data.getData){if(!this.types.length)return this.data.getData("Text");if(this.types.indexOf("text/html")!=-1)return this.data.getData("text/html")}},e.prototype.isLink=function(){return this.types.some(function(e){return e.indexOf("Url")!=-1||e.indexOf("text/uri-list")!=-1||e.indexOf("text/x-moz-url")})},e.prototype.getLink=function(){if(this.data.getData){if(this.types.indexOf("text/x-moz-url")!=-1){var e=this.data.getData("text/x-moz-url").split("\n");return e[0]}return this.types.indexOf("text/uri-list")!=-1?this.data.getData("text/uri-list"):this.data.getData("url")}return null},e.prototype.isImage=function e(){var e=this.types.some(function(e){return e.indexOf("application/x-moz-file")!=-1});if(e)return!0;for(var t=this.getFiles(),n=0;n<t.length;n++){var r=t[n].type;if(!o.isImage(r))return!1}return!0},e.prototype.getCount=function(){return this.data.hasOwnProperty("items")?this.data.items.length:this.data.hasOwnProperty("mozItemCount")?this.data.mozItemCount:this.data.files?this.data.files.length:null},e.prototype.getFiles=function(){return this.data.items?Array.prototype.slice.call(this.data.items).map(i).filter(s.thatReturnsArgument):this.data.files?Array.prototype.slice.call(this.data.files):[]},e.prototype.hasFiles=function(){return this.getFiles().length>0},e}();e.exports=d},function(e,t,n){"use strict";function r(e){if(e instanceof Element){var t=e.getAttribute("data-offset-key");if(t)return t;for(var n=0;n<e.childNodes.length;n++){var i=r(e.childNodes[n]);if(i)return i}}return null}e.exports=r},function(e,t,n){"use strict";(function(t){function n(e,t){var n=0,i=[];e.forEach(function(o){r(o,function(r){n++,r&&i.push(r.slice(0,a)),n==e.length&&t(i.join("\r"))})})}function r(e,n){if(!t.FileReader||e.type&&!(e.type in o))return void n("");if(""===e.type){var r="";return i.test(e.name)&&(r=e.name.replace(i,"")),void n(r)}var a=new FileReader;a.onload=function(){n(a.result)},a.onerror=function(){n("")},a.readAsText(e)}var i=/\.textClipping$/,o={"text/plain":!0,"text/html":!0,"text/rtf":!0},a=5e3;e.exports=n}).call(t,n(15))},function(e,t,n){"use strict";(function(t){function r(e,n,r,a,s){var l=o(e.getSelection());if(!("production"===t.env.NODE_ENV||n&&a))return console.warn("Invalid selection state.",arguments,e.toJS()),l;var c=i.decode(n),u=c.blockKey,d=e.getBlockTree(u).getIn([c.decoratorKey,"leaves",c.leafKey]),f=i.decode(a),p=f.blockKey,m=e.getBlockTree(p).getIn([f.decoratorKey,"leaves",f.leafKey]),h=d.get("start"),g=m.get("start"),v=d?h+r:null,y=m?g+s:null,b=l.getAnchorKey()===u&&l.getAnchorOffset()===v&&l.getFocusKey()===p&&l.getFocusOffset()===y;if(b)return l;var _=!1;if(u===p){var w=d.get("end"),S=m.get("end");_=g===h&&S===w?s<r:g<h}else{var k=e.getCurrentContent().getBlockMap().keySeq().skipUntil(function(e){return e===u||e===p}).first();_=k===p}return l.merge({anchorKey:u,anchorOffset:v,focusKey:p,focusOffset:y,isBackward:_})}var i=n(37),o=n(12);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";function r(e){var t=e.getSelection();return t.isCollapsed()?null:i(e.getCurrentContent(),t)}var i=n(35);e.exports=r},function(e,t,n){"use strict";(function(t){function r(e){for(var n=e.cloneRange(),r=[],i=e.endContainer;null!=i;i=i.parentNode){var a=i===e.commonAncestorContainer;a?n.setStart(e.startContainer,e.startOffset):n.setStart(n.endContainer,0);var s=Array.from(n.getClientRects());if(r.push(s),a){var l;return r.reverse(),(l=[]).concat.apply(l,r)}n.setEndBefore(i)}"production"!==t.env.NODE_ENV?o(!1,"Found an unexpected detached subtree when getting range client rects."):o(!1)}var i=n(18),o=n(4),a=i.isBrowser("Chrome"),s=a?r:function(e){return Array.from(e.getClientRects())};e.exports=s}).call(t,n(3))},function(e,t,n){"use strict";(function(t){function r(e,t,n,r,i,o){var s=n.nodeType===Node.TEXT_NODE,c=i.nodeType===Node.TEXT_NODE;if(s&&c)return{selectionState:u(e,f(l(n)),r,f(l(i)),o),needsRecovery:!1};var d=null,p=null,m=!0;return s?(d={key:f(l(n)),offset:r},p=a(t,i,o)):c?(p={key:f(l(i)),offset:o},d=a(t,n,r)):(d=a(t,n,r),p=a(t,i,o),n===i&&r===o&&(m=!!n.firstChild&&"BR"!==n.firstChild.nodeName)),{selectionState:u(e,d.key,d.offset,p.key,p.offset),needsRecovery:m}}function i(e){for(;e.firstChild&&c(e.firstChild);)e=e.firstChild;return e}function o(e){for(;e.lastChild&&c(e.lastChild);)e=e.lastChild;return e}function a(e,n,r){var a=n,u=l(a);if(null!=u||e&&(e===a||e.firstChild===a)?void 0:"production"!==t.env.NODE_ENV?d(!1,"Unknown node in selection range."):d(!1),e===a&&(a=a.firstChild,a instanceof Element&&"true"===a.getAttribute("data-contents")?void 0:"production"!==t.env.NODE_ENV?d(!1,"Invalid DraftEditorContents structure."):d(!1),r>0&&(r=a.childNodes.length)),0===r){var p=null;if(null!=u)p=u;else{var m=i(a);p=f(c(m))}return{key:p,offset:0}}var h=a.childNodes[r-1],g=null,v=null;if(c(h)){var y=o(h);g=f(c(y)),v=s(y)}else g=f(u),v=s(h);return{key:g,offset:v}}function s(e){var t=e.textContent;return"\n"===t?0:t.length}var l=n(49),c=n(74),u=n(76),d=n(4),f=n(12);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";function r(e,t){var n=t?d.exec(e):c.exec(e);return n?n[0]:e}var i=n(192),o=i.getPunctuation(),a="['‘’]",s="\\s|(?![_])"+o,l="^(?:"+s+")*(?:"+a+"|(?!"+s+").)*(?:(?!"+s+").)",c=new RegExp(l),u="(?:(?!"+s+").)(?:"+a+"|(?!"+s+").)*(?:"+s+")*$",d=new RegExp(u),f={getBackward:function(e){return r(e,!0)},getForward:function(e){return r(e,!1)}};e.exports=f},function(e,t,n){"use strict";function r(e,t){var n,r=e.getSelection(),i=r.getStartKey(),o=r.getStartOffset(),a=e.getCurrentContent(),s=i,l=a.getBlockForKey(i);return t>l.getText().length-o?(s=a.getKeyAfter(i),n=0):n=o+t,r.merge({focusKey:s,focusOffset:n})}e.exports=r},function(e,t,n){"use strict";(function(t){function r(){return{text:"",inlines:[],entities:[],blocks:[]}}function i(e){var t=new Array(1);return e&&(t[0]=e),{text:R,inlines:[P()],entities:t,blocks:[]}}function o(){return{text:"\n",inlines:[P()],entities:new Array(1),blocks:[]}}function a(e,t){return{text:"\r",inlines:[P()],entities:new Array(1),blocks:[{type:e,depth:Math.max(0,Math.min(F,t))}]}}function s(e,t){return"li"===e?"ol"===t?"ordered-list-item":"unordered-list-item":null}function l(e){var t=e.get("unstyled").element,n=new D([]);return e.forEach(function(e){e.aliasedElements&&e.aliasedElements.forEach(function(e){n=n.add(e)}),n=n.add(e.element)}),n.filter(function(e){return e&&e!==t}).toArray().sort()}function c(e,t,n){for(var r=0;r<n.length;r++){var i=n[r](e,t);if(i)return i}return null}function u(e,t,n){var r=n.filter(function(t){return t.element===e||t.wrapper===e||t.aliasedElements&&t.aliasedElements.some(function(t){return t===e})}).keySeq().toSet().toArray().sort();switch(r.length){case 0:return"unstyled";case 1:return r[0];default:return c(e,t,[s])||"unstyled"}}function d(e,t,n){var r=V[e];return r?n=n.add(r).toOrderedSet():t instanceof HTMLElement&&!function(){var e=t;n=n.withMutations(function(t){var n=e.style.fontWeight,r=e.style.fontStyle,i=e.style.textDecoration;H.indexOf(n)>=0?t.add("BOLD"):$.indexOf(n)>=0&&t.remove("BOLD"),"italic"===r?t.add("ITALIC"):"normal"===r&&t.remove("ITALIC"),"underline"===i&&t.add("UNDERLINE"),"line-through"===i&&t.add("STRIKETHROUGH"),"none"===i&&(t.remove("UNDERLINE"),t.remove("STRIKETHROUGH"))}).toOrderedSet()}(),n}function f(e,t){var n=e.text.slice(-1),r=t.text.slice(0,1);if("\r"===n&&"\r"===r&&(e.text=e.text.slice(0,-1),e.inlines.pop(),e.entities.pop(),e.blocks.pop()),"\r"===n){if(t.text===R||"\n"===t.text)return e;r!==R&&"\n"!==r||(t.text=t.text.slice(1),t.inlines.shift(),t.entities.shift())}return{text:e.text+t.text,inlines:e.inlines.concat(t.inlines),entities:e.entities.concat(t.entities),blocks:e.blocks.concat(t.blocks)}}function p(e,t){return t.some(function(t){return e.indexOf("<"+t)!==-1})}function m(e){e instanceof HTMLAnchorElement?void 0:"production"!==t.env.NODE_ENV?T(!1,"Link must be an HTMLAnchorElement."):T(!1);var n=e.protocol;return"http:"===n||"https:"===n||"mailto:"===n}function h(e,t,n,s,l,c,p,g,v){var b=t.nodeName.toLowerCase(),_=!1,w="unstyled",k=y,C=e;if("#text"===b){var x=t.textContent;return""===x.trim()&&"pre"!==l?{chunk:i(v),entityMap:e}:("pre"!==l&&(x=x.replace(q,R)),y=b,{chunk:{text:x,inlines:Array(x.length).fill(n),entities:Array(x.length).fill(v),blocks:[]},entityMap:e})}if(y=b,"br"===b)return"br"!==k||l&&"unstyled"!==u(l,s,g)?{chunk:o(),entityMap:e}:{chunk:a("unstyled",p),entityMap:e};"img"===b&&t instanceof HTMLImageElement&&t.attributes.getNamedItem("src")&&t.attributes.getNamedItem("src").value&&!function(){var e=t,n={};K.forEach(function(t){var r=e.getAttribute(t);r&&(n[t]=r)});var r=new E(n.src).toString();t.textContent=r,v=S.__create("IMAGE","MUTABLE",n||{})}();var T=r(),A=null;n=d(b,t,n),"ul"!==b&&"ol"!==b||(s&&(p+=1),s=b),l||c.indexOf(b)===-1?s&&"li"===l&&"li"===b&&(T=a(u(b,s,g),p),l=b,_=!0,w="ul"===s?"unordered-list-item":"ordered-list-item"):(T=a(u(b,s,g),p),l=b,_=!0);var I=t.firstChild;null!=I&&(b=I.nodeName.toLowerCase());for(var O=null;I;){I instanceof HTMLAnchorElement&&I.href&&m(I)?!function(){var e=I,t={};W.forEach(function(n){var r=e.getAttribute(n);r&&(t[n]=r)}),t.url=new E(e.href).toString(),O=S.__create("LINK","MUTABLE",t||{})}():O=void 0;var D=h(C,I,n,s,l,c,p,g,O||v),M=D.chunk,P=D.entityMap;A=M,C=P,T=f(T,A);var N=I.nextSibling;N&&c.indexOf(b)>=0&&l&&(T=f(T,o())),N&&(b=N.nodeName.toLowerCase()),I=N}return _&&(T=f(T,a(w,p))),{chunk:T,entityMap:C}}function g(e,t,n,r){e=e.trim().replace(B,"").replace(L,R).replace(j,"").replace(U,"");var i=l(n),o=t(e);if(!o)return null;y=null;var a=p(e,i)?i:["div"],s=h(r,o,P(),"ul",null,a,-1,n),c=s.chunk,u=s.entityMap;return 0===c.text.indexOf("\r")&&(c={text:c.text.slice(1),inlines:c.inlines.slice(1),entities:c.entities.slice(1),blocks:c.blocks}),"\r"===c.text.slice(-1)&&(c.text=c.text.slice(0,-1),c.inlines=c.inlines.slice(0,-1),c.entities=c.entities.slice(0,-1),c.blocks.pop()),0===c.blocks.length&&c.blocks.push({type:"unstyled",depth:0}),c.text.split("\r").length===c.blocks.length+1&&c.blocks.unshift({type:"unstyled",depth:0}),{chunk:c,entityMap:u}}function v(e){var t=arguments.length<=1||void 0===arguments[1]?x:arguments[1],n=arguments.length<=2||void 0===arguments[2]?w:arguments[2],r=g(e,t,n,S);if(null==r)return null;var i=r.chunk,o=r.entityMap,a=0;return{contentBlocks:i.text.split("\r").map(function(e,t){e=I(e);var n=a+e.length,r=A(i).inlines.slice(a,n),o=A(i).entities.slice(a,n),s=M(r.map(function(e,t){var n={style:e,entity:null};return o[t]&&(n.entity=o[t]),b.create(n)}));return a=n+1,new _({key:C(),type:A(i).blocks[t].type,depth:A(i).blocks[t].depth,text:e,characterList:s})}),entityMap:o}}var y,b=n(14),_=n(21),w=n(44),S=n(36),k=n(5),E=n(203),C=n(16),x=n(83),T=n(4),A=n(12),I=n(42),O=n(5),D=O.Set,M=k.List,P=k.OrderedSet,N="&nbsp;",R=" ",F=4,B=new RegExp("\r","g"),q=new RegExp("\n","g"),L=new RegExp(N,"g"),j=new RegExp("&#13;?","g"),U=new RegExp("&#8203;?","g"),H=["bold","bolder","500","600","700","800","900"],$=["light","lighter","100","200","300","400"],V={b:"BOLD",code:"CODE",del:"STRIKETHROUGH",em:"ITALIC",i:"ITALIC",s:"STRIKETHROUGH",strike:"STRIKETHROUGH",strong:"BOLD",u:"UNDERLINE"},W=["className","href","rel","target","title"],K=["alt","className","height","src","width"];
e.exports=v}).call(t,n(3))},function(e,t,n){"use strict";(function(t){function r(e){var n,r=null;return!a&&document.implementation&&document.implementation.createHTMLDocument&&(n=document.implementation.createHTMLDocument("foo"),n.documentElement?void 0:"production"!==t.env.NODE_ENV?o(!1,"Missing doc.documentElement"):o(!1),n.documentElement.innerHTML=e,r=n.getElementsByTagName("body")[0]),r}var i=n(18),o=n(4),a=i.isBrowser("IE <= 9");e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";function r(e){return d&&e.altKey||h(e)}function i(e){return m(e)?e.shiftKey?"redo":"undo":null}function o(e){return f&&e.shiftKey?null:r(e)?"delete-word":"delete"}function a(e){return m(e)&&d?"backspace-to-start-of-line":r(e)?"backspace-word":"backspace"}function s(e){switch(e.keyCode){case 66:return m(e)?"bold":null;case 68:return h(e)?"delete":null;case 72:return h(e)?"backspace":null;case 73:return m(e)?"italic":null;case 74:return m(e)?"code":null;case 75:return!f&&h(e)?"secondary-cut":null;case 77:return h(e)?"split-block":null;case 79:return h(e)?"split-block":null;case 84:return d&&h(e)?"transpose-characters":null;case 85:return m(e)?"underline":null;case 87:return d&&h(e)?"backspace-word":null;case 89:return h(e)?f?"redo":"secondary-paste":null;case 90:return i(e)||null;case c.RETURN:return"split-block";case c.DELETE:return o(e);case c.BACKSPACE:return a(e);case c.LEFT:return p&&m(e)?"move-selection-to-start-of-block":null;case c.RIGHT:return p&&m(e)?"move-selection-to-end-of-block":null;default:return null}}var l=n(50),c=n(45),u=n(18),d=u.isPlatform("Mac OS X"),f=u.isPlatform("Windows"),p=d&&u.isBrowser("Firefox < 29"),m=l.hasCommandModifier,h=l.isCtrlKeyCommand;e.exports=s},function(e,t,n){"use strict";var r={stringify:function(e){return"_"+String(e)},unstringify:function(e){return e.slice(1)}};e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.AvatarInitials=t.AvatarImage=void 0;var i=n(87),o=r(i),a=n(88),s=r(a),l=n(219),c=r(l);t.AvatarImage=o.default,t.AvatarInitials=s.default,t.default=c.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=function(e){var t=e.className,n=void 0===t?"":t,r=e.url;return s.default.createElement("img",{alt:"",className:"avatar-image "+n,src:r})};l.displayName="AvatarImage",l.propTypes={className:o.default.string,url:o.default.string.isRequired},t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=["#18BBF7","#0D67C7","#052E5C","#747679","#FDA308","#98C332","#159F45","#B800B2","#F22C44"],c=function(e){var t=e.slice(0,1),n=e.slice(e.lastIndexOf(" ")+1,e.lastIndexOf(" ")+2);return t+n},u=function(e){var t=e.className,n=void 0===t?"":t,r=e.id,i=e.name,o=parseInt(r,10)||0,a=l[o%l.length];return s.default.createElement("span",{className:"avatar-initials "+n,style:{backgroundColor:a}},c(i))};u.displayName="AvatarInitials",u.propTypes={className:o.default.string,id:o.default.oneOfType([o.default.string,o.default.number]),name:o.default.string.isRequired},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#000000":r,o=e.width,a=void 0===o?24:o,l=e.height,u=void 0===l?24:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-info themed "+n,title:f,width:a,height:u,viewBox:"-603 389 16 16"},s.default.createElement("path",{className:"fill-color",fill:i,fillRule:"evenodd",d:"M-595 403c5.5 0 8-7.1 3.9-10.6-4.2-3.6-10.8.3-9.8 5.7.5 2.8 3 4.9 5.9 4.9zm.9-6.7v3.7h-1.4v-3.7h1.4zm.1-2.2c0 1-1.7 1.1-1.7 0 .1-1.1 1.7-1.1 1.7 0z"}))};u.displayName="IconInfo",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(227),o=r(i);t.default=o.default,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(233),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(236),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#000000":r,o=e.height,a=void 0===o?24:o,l=e.width,u=void 0===l?24:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-alert "+n,title:f,height:a,width:u,viewBox:"0 0 24 24"},s.default.createElement("path",{className:"fill-color",fill:i,fillRule:"evenodd",d:"M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"}))};u.displayName="IconAlert",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(7),u=r(c),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(e){var t=e.children,n=e.className,r=e.labelContent,o=i(e,["children","className","labelContent"]);return l.default.createElement("label",null,l.default.createElement("span",d({className:(0,u.default)("label",n)},o),r),t)};f.propTypes={children:a.default.node.isRequired,className:a.default.string,labelContent:a.default.array.isRequired},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(247),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.name,n=e.onValidityStateUpdate;this.context.form&&this.context.form.registerInput(t,n)}},{key:"componentWillUnmount",value:function(){this.context.form&&this.context.form.unregisterInput(this.props.name)}},{key:"render",value:function(){return d.default.createElement("div",null,this.props.children)}}]),t}(u.Component);p.propTypes={children:c.default.node.isRequired,onValidityStateUpdate:c.default.func.isRequired,name:c.default.string.isRequired},p.contextTypes={form:c.default.shape({registerInput:c.default.func.isRequired,unregisterInput:c.default.func.isRequired})},t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(258),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return"boolean"==typeof e}function i(e,t,n,i,o){if(void 0===o&&(o={}),!(e&&e instanceof HTMLElement))throw new Error("Element is required in scrollIntoViewIfNeeded");var a={centerIfNeeded:!1,handleScroll:c};r(t)?a.centerIfNeeded=t:a=l({},a,t);var u={top:0,right:0,bottom:0,left:0};return a.offset=a.offset?l({},u,a.offset):u,n&&(a.duration=n.duration,a.easing=n.easing),i&&(a.boundary=i),o.offsetTop&&(a.offset.top=o.offsetTop),o.offsetRight&&(a.offset.right=o.offsetRight),o.offsetBottom&&(a.offset.bottom=o.offsetBottom),o.offsetLeft&&(a.offset.left=o.offsetLeft),Object(s.a)(e,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(259),a=n.n(o),s=n(261),l=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},c=function(e,t,n){var r=t.scrollLeft,i=t.scrollTop;n.duration?a()(e,{scrollLeft:r,scrollTop:i},{duration:n.duration,easing:n.easing}):(e.scrollLeft=r,e.scrollTop=i)}},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(25),c=function(e){var t=e.contentState,n=e.entityKey,r=e.children,i=t.getEntity(n).getData(),o=i.id;return s.default.createElement("a",{href:"/profile/"+o},r)};c.propTypes={children:o.default.arrayOf(o.default.element).isRequired,contentState:o.default.instanceOf(l.ContentState).isRequired,entityKey:o.default.string.isRequired},c.displayName="DraftMentionItem",t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(265),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){if(null===e||"undefined"==typeof e)return[];var t=e.match(/(".*?"|[^",\r\n]+)(?=\s*[,\r\n]|\s*$)/g);return t?t.map(function(e){for(e=e.trim();e.length>=2&&'"'===e.charAt(0)&&'"'===e.charAt(e.length-1);)e=e.substr(1,e.length-2);return e}):[]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(270),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(e){var t=e.children,n=e.href,r=void 0===n?"#":n,o=e.linkRef,a=i(e,["children","href","linkRef"]);return l.default.createElement("a",c({href:r,ref:o},a),t)};u.displayName="LinkBase",u.propTypes={href:a.default.string,children:a.default.node.isRequired,linkRef:a.default.func},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(105),u=r(c),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(e){var t=e.className,n=void 0===t?"":t,r=i(e,["className"]);return l.default.createElement(u.default,d({className:"btn "+n},r))};f.displayName="LinkButton",f.propTypes={className:a.default.string},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(54),s=n(285),l=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(e,t,n){var r=/((?:[@＠﹫]\[[0-9]+:[^\]]+])|(?:\b(?:(?:ht|f)tps?:\/\/)[\w\._\-]+(?::\d+)?(?:\/[\w\-_\.~\+\/#\?&%=:\[\]@!$'\(\)\*;,]*)?))/gim,i=e.split(r).map(function(e,r){var i=e.match(/([@＠﹫])\[([0-9]+):([^\]]+)]/i);if(i){var c=l(i,4),u=c[1],d=c[2],f=c[3];return n?""+u+f:o.default.createElement(s.Mention,{id:Number(d),key:r+"-"+t},""+u+f)}if(!n){var p=e.match(/((?:(?:ht|f)tps?:\/\/)[\w\._\-]+(?::\d+)?(?:\/[\w\-_\.~\+\/#\?&%=:\[\]@!$'\(\)\*;,]*)?)/i);if(p){var m=l(p,2),h=m[1];return o.default.createElement(a.Link,{key:r+"-"+t,href:h},h)}}return e});return n?i.join(""):i};t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(e){var t=e.children,n=e.id,r=i(e,["children","id"]);return delete r.mentionTrigger,l.default.createElement("a",c({},r,{style:{display:"inline-block"},href:"/profile/"+n}),t)};u.displayName="Mention",u.propTypes={children:a.default.node.isRequired,id:a.default.number.isRequired},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(110),c=r(l),u=n(108),d=r(u),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"@";i(this,t);var a=""+r+n,s={id:Number(e),name:n,mentionTrigger:r};return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a,d.default,s,"mention",!1))}return a(t,e),f(t,[{key:"serializedText",get:function(){var e=this.data,t=e.id,n=e.mentionTrigger,r=this.text.replace(n,"");return r.length?n+"["+t+":"+r+"]":""}}]),t}(c.default);t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(32),c=r(l),u=function(e){function t(){var e;i(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var s=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return s.isMutable=!1,s}return a(t,e),t}(c.default);t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=[];return e.forEach(function(e){var n=[];e.forEach(function(e){return n.push(e.serializedText)}),t.push(n.join(""))}),t.join("\n").replace(/\u00A0/g," ").replace(/\u200B/g,"")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(32),l=r(s),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=new a.List([new a.List([new l.default("")])]),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;i(this,e),this.data=t,this.text=o(t)}return c(e,[{key:"createNewState",value:function(t){return new e(t)}},{key:"findSelectionTarget",value:function(e){var t=e.blockID,n=e.itemID,r=this.data,i=r.get(t),o=i.get(n)||null,a=o?o.text:"";return{block:i,item:o,text:a}}},{key:"hasContent",value:function(){return this.text.length>0}},{key:"mergeBlocks",value:function(e,t,n){var r=this.data,i=t.blockID,o=t.itemID,a=t.offset,s=n.blockID,c=n.itemID,u=n.offset,d=this.findSelectionTarget(t),f=d.block,p=d.text,m=this.findSelectionTarget(n),h=m.block,g=m.text,v=p.slice(0,a)+e.text+g.slice(u);return this.createNewState(r.splice(i,s-i+1,f.splice(o,f.size-o,new l.default(v)).concat(h.splice(0,c+1))))}},{key:"mergeItems",value:function(e,t,n){var r=this.data,i=t.blockID,o=t.itemID,a=t.offset,s=n.itemID,c=n.offset,u=this.findSelectionTarget(t),d=u.block,f=u.text,p=this.findSelectionTarget(n),m=p.text,h=f.slice(0,a)+e.text+m.slice(c);return this.createNewState(r.set(i,d.splice(o,s-o+1,new l.default(h))))}},{key:"replaceInlineContent",value:function(e,t,n,r,i){var o=this.data,a=o.get(e),s=a.get(t),c=s.text;if(!s.isMutable)return this.createNewState(o.set(e,a.set(t,i)));if("text"!==i.type)return this.createNewState(o.set(e,a.splice(t,1,new l.default(c.slice(0,n)),i,new l.default(" "+c.slice(r)))));var u=c.slice(0,n)+i.text+c.slice(r),d=void 0;return d=!u.length||i.text.length?new l.default(u):new l.default(u,s.component,s.data),this.createNewState(o.set(e,a.set(t,d)))}},{key:"splitBlocks",value:function(e,t){var n=this.data,r=e.blockID,i=e.itemID,o=e.offset,a=t.blockID,s=t.itemID,c=t.offset,u=this.findSelectionTarget(e),d=u.block,f=u.text,p=this.findSelectionTarget(t),m=p.block,h=p.text;return this.createNewState(n.splice(r,a-r+1,d.splice(i,m.size-i,new l.default(f.slice(0,o))),m.splice(0,s+1,new l.default(h.slice(c)))))}},{key:"splitItem",value:function(e,t,n,r,i){var o=this.data,a=o.get(e),s=a.get(t),c=s.text;return this.createNewState(o.set(e,a.splice(t,1,new l.default(c.slice(0,n)),new l.default(i.text),new l.default(c.slice(r)))))}}]),e}();t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!t)return e;var n=e+t;return n<0?0:n}Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(111),l=r(s),c=n(32),u=r(c),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=new a.Record({blockID:0,itemID:0,offset:0}),m=new a.Record({contentState:new l.default,selectionState:new p}),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l.default,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new a.Stack,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new a.Stack,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];i(this,e),this.allowNativeRender=s,this.contentState=t,this.selectionState=n,this.redoStack=r,this.undoStack=o,this.inCompositionMode=c}return f(e,[{key:"setCompositionMode",value:function(e){var t=this.contentState,n=this.selectionRecord,r=this.redoStack,i=this.undoStack,o=this.allowNativeRender;return this.createNewState(t,n,r,i,o,e)}},{key:"addNewLine",value:function(e){var t=this.contentState,n=e.start,r=e.end,i=t.splitBlocks(n,r);return this.createNewState(i,new p({blockID:o(n.blockID,1),itemID:0,offset:0}),this.redoStack,this.pushUndoState(),!1)}},{key:"createNewState",value:function(t,n,r,i,o,a){return new e(t,n,r,i,o,a)}},{key:"hasContent",value:function(){return this.contentState.hasContent()}},{key:"insert",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.collapsed,i=t.collapsedTarget,a=t.start,s=t.end,l=a.blockID,c=a.itemID,u=a.offset,d=s.blockID,f=s.itemID,m=s.offset,h=r&&this.hasContent()&&this.undoStack.size?this.undoStack:this.pushUndoState(),g=void 0,v=new p({blockID:l,itemID:c,offset:o(u,e.text.length)});return r||i?("text"!==e.type&&(v=new p({blockID:l,itemID:o(c,2),offset:1})),g=this.contentState.replaceInlineContent(l,c,u,m,e)):g=c!==f&&l===d?this.contentState.mergeItems(e,a,s):this.contentState.mergeBlocks(e,a,s),this.createNewState(g,v,this.redoStack,h,n)}},{key:"mergeNextBlock",value:function(e){var t=e.start,n=t.blockID,r=t.itemID,i=t.offset,o=n+1,a=0,s=this.contentState.mergeBlocks(new u.default(""),t,{blockID:o,itemID:a,offset:0});return this.createNewState(s,new p({blockID:n,itemID:r,offset:i}),this.redoStack,this.undoStack,!1)}},{key:"mergePreviousBlock",value:function(e){var t=this.contentState.data,n=e.start,r=e.end,i=n.blockID,o=i-1,a=t.get(o),s=a.size-1,l=a.get(s),c=this.contentState.mergeBlocks(new u.default(""),{blockID:o,itemID:s,offset:l.text.length},r);return this.createNewState(c,new p({blockID:o,itemID:s,offset:l.text.length}),this.redoStack,this.undoStack,!1)}},{key:"remove",value:function(e,t){if(!this.contentState.hasContent())return this;var n=this.contentState.data,r=e.collapsed,i=e.collapsedTarget,a=e.start,s=e.end,l=a.blockID,c=a.itemID,f=a.offset,m=s.blockID,h=s.itemID,g=s.offset,v=r?this.undoStack:this.pushUndoState(),y=r&&"backward"===t?-1:0,b=void 0;if(r||i){var _=this.contentState.findSelectionTarget(a),w=_.block,S=_.text;if(r)if("forward"===t){if(f===S.length){if(c===w.size-1)return l<n.size-1?this.mergeNextBlock(e):this;var k={blockID:l,itemID:c+1},E=d({},k,{offset:0});return this.remove(d({},e,{start:E,end:E}),t)}b=this.contentState.replaceInlineContent(l,c,f,g+1,new u.default(""))}else{if(0===f){if(0===c)return l>0?this.mergePreviousBlock(e):this;var C={blockID:l,itemID:c-1},x=this.contentState.findSelectionTarget(C),T=d({},C,{offset:x.text.length});return this.remove(d({},e,{start:T,end:T}),t)}b=this.contentState.replaceInlineContent(l,c,f-1,g,new u.default(""))}else b=this.contentState.replaceInlineContent(l,c,f,g,new u.default(""))}else b=c!==h&&l===m?this.contentState.mergeItems(new u.default(""),a,s):this.contentState.mergeBlocks(new u.default(""),a,s);return this.createNewState(b,new p({blockID:l,itemID:c,offset:o(f,y)}),this.redoStack,v,!1)}},{key:"pushRedoState",value:function(){var e=this.contentState,t=this.selectionState;return this.redoStack.push(new m({contentState:e,selectionState:t}))}},{key:"pushUndoState",value:function(){var e=this.contentState,t=this.selectionState;return this.undoStack.push(new m({contentState:e,selectionState:t}))}},{key:"redo",value:function(){var e=this.redoStack.peek();if(!e)return null;var t=e.contentState,n=e.selectionState;return this.createNewState(t,n,this.redoStack.shift(),this.pushUndoState(),!1)}},{key:"undo",value:function(){var e=this.undoStack.peek();if(!e)return null;var t=e.contentState,n=e.selectionState;return this.createNewState(t,n,this.pushRedoState(),this.undoStack.shift(),!1)}},{key:"text",get:function(){return this.contentState.text}},{key:"contentData",get:function(){return this.contentState.data}}]),e}();t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(17),p=n(98),m=r(p),h=n(54),g=n(291),v=r(g);n(99);var y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClickOutside=function(e){var t=(0,f.findDOMNode)(n),r=t.contains(e.target)||t===e.target,i=n.state.isFocused;i&&!r&&(n.setState({isFocused:!1}),n.hide())},n.handleItemMouseEnter=function(e){n.selectItem(e,!1)},n.handleItemClick=function(e){return function(t){t.preventDefault(),n.selectItem(e)}},n.handleSelectorKeyDown=function(e){var t=n.props,r=t.children,i=t.selectOnTab,o=n.state.selectedItemIndex;switch(e.key){case"Enter":e.preventDefault(),n.selectItem(o);break;case"Escape":e.preventDefault(),n.hide();break;case"Tab":o>=0&&i&&r.length&&(e.preventDefault(),n.selectItem(o));break;case"ArrowDown":if(r.length){e.preventDefault(),n.show();var a=(o+1)%(r.length+1);n.selectItem(a,!1)}break;case"ArrowUp":if(r.length){e.preventDefault(),n.show();var s=o-1;s=s<0?r.length:s,n.selectItem(s,!1)}}},n.handleSelectorFocus=function(){var e=n.state.isFocused;e||n.setState({isFocused:!0}),n.props.showOnSelectorClick&&n.show()},n.handleUserInput=function(e){var t=n.props.onSelectorUserInput;t&&t(e.target.value),n.show()},n.state={isFocused:!1,isVisible:!1,selectedItemIndex:-1},n.links=[],n}return a(t,e),y(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.children,n=this.state,r=n.isFocused,i=n.isVisible;r&&i&&t&&t.length&&this.show()}},{key:"selectItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.props,r=n.children,i=n.onItemSelected;this.updateSelectedIndex(e),t&&r[e]?(i&&i(e),this.hide()):this.scrollLinkIntoViewIfNeeded(this.links[e])}},{key:"scrollLinkIntoViewIfNeeded",value:function(e){var t=(0,f.findDOMNode)(e);t&&(0,m.default)(t,!1)}},{key:"show",value:function(){this.state.isVisible||(this.setState({isVisible:!0}),this.updateSelectedIndex(0))}},{key:"hide",value:function(){this.setState({isVisible:!1})}},{key:"updateSelectedIndex",value:function(e){var t=this;this.setState({selectedItemIndex:e},function(){var n=t.props.onSelectedIndexChanged;n&&n(e)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.children,i=t.selector,o=this.state,a=o.isFocused,s=o.selectedItemIndex,l=o.isVisible;return d.default.createElement("div",{className:n+" selector-dropdown-wrapper",onBlur:this.handleBlur},d.default.createElement("div",{onKeyDown:this.handleSelectorKeyDown,onFocus:this.handleSelectorFocus,onInput:this.handleUserInput},i),d.default.createElement(v.default,{isVisible:a&&l&&r&&r.length>0,onClickOutside:this.handleClickOutside},d.default.createElement(h.LinkGroup,null,u.Children.map(r,function(t,n){return d.default.createElement(h.Link,{key:n,ref:function(t){e.links[n]=t},className:s===n?"is-selected":"",onClick:e.handleItemClick(n),onMouseEnter:e.handleItemMouseEnter.bind(e,n)},t)}))))}}]),t}(u.Component);b.propTypes={children:c.default.node,className:c.default.string,onItemSelected:c.default.func,onSelectedIndexChanged:c.default.func,onSelectorUserInput:c.default.func,selectOnTab:c.default.bool,selector:c.default.node.isRequired,showOnSelectorClick:c.default.bool},b.defaultProps={className:"",showOnSelectorClick:!0},t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(2),p=n(52),m=r(p),h=n(95),g=r(h),v=n(313),y=r(v),b=n(323),_=r(b),w=n(39),S=r(w);n(324);var k=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),E=function(){return d.default.createElement("div",{className:"box-ui-search-metadata-fields is-empty"},d.default.createElement(f.FormattedMessage,S.default.selectTemplate))},C=function(e){var t=e.templateName,n=e.fields,r=e.updateFilterData;return d.default.createElement("div",{className:"box-ui-search-metadata-fields","data-resin-metadatatemplatename":t},n.map(function(e){return d.default.createElement(y.default,{field:e,onChange:r,key:e.id})}))};C.propTypes={templateName:c.default.string,
fields:c.default.arrayOf(c.default.object),updateFilterData:c.default.func};var x=function(e){var t=e.filters;return d.default.createElement(g.default,{"data-resin-target":"applymetadatafilter","data-resin-metadatafilters":t},d.default.createElement(f.FormattedMessage,S.default.apply))};x.propTypes={filters:c.default.string};var T=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));A.call(n);var r=e.filterState,a=r.template,s=void 0===a?"":a,l=r.scope,c=void 0===l?"":l,u=r.typeKey,d=void 0===u?"":u,f=r.displayName,p=void 0===f?"":f,m=r.initialFilterMap,h=void 0===m?{}:m;return n.state={template:s,scope:c,typeKey:d,templateName:p,filterMap:h},n}return a(t,e),k(t,[{key:"componentWillReceiveProps",value:function(e){if(e.filterState!==this.props.filterState){var t=e.filterState,n=t.template,r=void 0===n?"":n,i=t.scope,o=void 0===i?"":i,a=t.typeKey,s=void 0===a?"":a,l=t.displayName,c=void 0===l?"":l,u=t.initialFilterMap,d=void 0===u?{}:u;this.setState({template:r,scope:o,typeKey:s,templateName:c,filterMap:d})}}},{key:"render",value:function(){var e=this.props,t=e.templates,n=e.filterState,r=e.includeFormButtons,i=this.state,o=i.templateName,a=i.typeKey,s=this.updateTemplateData,l=this.updateFilterData,c=this.aggregateFilters,u=this.resetForm,p=c();return d.default.createElement("div",{className:"box-ui-search-metadata"},d.default.createElement(_.default,{templates:t,onChange:s,selectedTemplateTypeKey:a}),a&&n.fields?d.default.createElement(C,{templateName:o,fields:n.fields,updateFilterData:l}):d.default.createElement(E,null),r?d.default.createElement("div",{className:"form-btns"},d.default.createElement(m.default,{type:"button",onClick:u,"data-resin-target":"resetmetadatafilter"},d.default.createElement(f.FormattedMessage,S.default.reset)),d.default.createElement(x,{filters:p})):null,d.default.createElement("input",{type:"hidden",name:"metadata",value:p}))}}]),t}(u.Component);T.propTypes={templates:c.default.arrayOf(c.default.shape({template:c.default.string.isRequired,scope:c.default.string.isRequired,typeKey:c.default.string.isRequired,displayName:c.default.string.isRequired})),filterState:c.default.shape({fields:c.default.arrayOf(c.default.shape({widget:c.default.string.isRequired,id:c.default.string.isRequired,format:c.default.string.isRequired,displayName:c.default.string.isRequired,isText:c.default.bool,description:c.default.string,options:c.default.arrayOf(c.default.shape({value:c.default.string.isRequired,displayName:c.default.string.isRequired})),initialValue:c.default.shape({enum:c.default.arrayOf(c.default.string),range:c.default.shape({gt:c.default.oneOfType([c.default.string,c.default.number]),lt:c.default.oneOfType([c.default.string,c.default.number])})})})),typeKey:c.default.string,template:c.default.string,scope:c.default.string,displayName:c.default.string,initialFilterMap:c.default.object}),handleTemplateChange:c.default.func.isRequired,includeFormButtons:c.default.bool},T.defaultProps={templates:[],filterState:{},includeFormButtons:!1};var A=function(){var e=this;this.updateTemplateData=function(t){e.props.handleTemplateChange(t.target.value)},this.updateFilterData=function(t,n){var r=Object.assign({},e.state.filterMap);n?r[t]=n:delete r[t],e.setState({filterMap:r})},this.aggregateFilters=function(){var t=e.state,n=t.template,r=t.scope,i=t.typeKey,o=t.filterMap,a=Object.keys(o).map(function(e){return o[e]});return n&&r?JSON.stringify({template:n,scope:r,typeKey:i,fields:a}):""},this.resetForm=function(){e.props.handleTemplateChange("")}};t.default=T},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(316),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(320),o=r(i);t.default=o.default},,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.SearchMetadataFilterUI=t.SearchMetadataUI=t.ProgressBar=t.PillSelectorDropdownUI=t.PillSelectorUI=t.ActivityFeedUI=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(0),s=r(a),l=n(122),c=r(l),u=n(312),d=n(102),f=r(d),p=n(330),m=r(p),h=n(333),g=r(h),v=n(117),y=r(v);n(118);var b=function(e){var t=e.text,n=e.secondaryText;return s.default.createElement("span",null,t,n?s.default.createElement("span",{className:"dropdown-secondary-text"},n):null)},_=function(e){return s.default.createElement(y.default,{locale:e.locale,messages:e.messages},s.default.createElement(c.default,e))},w=function(e){return s.default.createElement(y.default,{locale:e.locale,messages:e.messages},s.default.createElement(u.SearchMetadata,e))},S=function(e){return s.default.createElement(y.default,{locale:e.locale,messages:e.messages},s.default.createElement(u.SearchMetadataFilter,e))},k=function(e){var t=e.locale,n=e.messages,r=i(e,["locale","messages"]);return s.default.createElement(y.default,{locale:t,messages:n},s.default.createElement(f.default,r))},E=function(e){return s.default.createElement(y.default,{locale:e.locale,messages:e.messages},s.default.createElement(g.default,o({selectorRow:s.default.createElement(b,null)},e)))};t.ActivityFeedUI=_,t.PillSelectorUI=E,t.PillSelectorDropdownUI=k,t.ProgressBar=m.default,t.SearchMetadataUI=w,t.SearchMetadataFilterUI=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(123),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(124),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return e.reduce(function(e,t){var n=e.pop();if(!n)return e.concat([t]);if("file_version"===t.type&&"file_version"===n.type&&"upload"===t.action&&"upload"===n.action){var r=n.createdBy,i=n.versions,o=void 0===i?[n]:i,a=n.versionStart,l=void 0===a?n.versionNumber:a,c=n.versionEnd,u=void 0===c?n.versionNumber:c,d=t.action,f=t.createdBy,p=t.id,m=t.versionNumber,h=n.collaborators||s({},r.id,P({},r));return h[f.id]=P({},f),e.concat([{action:d,collaborators:h,id:p,type:"file_version",versions:o.concat([t]),versionStart:Math.min(l,m),versionEnd:Math.max(u,m)}])}return e.concat([n,t])},[])}function c(e){return 0===e.length||1===e.length&&"file_version"===e[0].type}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=n(1),f=r(d),p=n(0),m=r(p),h=n(2),g=n(33),v=r(g),y=n(11),b=n(60),_=r(b),w=n(104),S=r(w),k=n(297),E=n(299),C=r(E),x=n(304),T=r(x),A=n(308),I=r(A),O=n(13),D=r(O);n(311);var M=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N=function(e){var t=e.isLoading,n=e.showCommentMessage;return m.default.createElement("div",{className:"box-ui-activity-feed-empty-state"},m.default.createElement(k.IconActivityFeedEmptyState,null),t?m.default.createElement(v.default,null):m.default.createElement("div",{className:"empty-state-cta"},m.default.createElement("b",null,m.default.createElement(h.FormattedMessage,D.default.noActivity)),n?m.default.createElement("aside",null,m.default.createElement(h.FormattedMessage,D.default.noActivityCommentPrompt)):null))};N.propTypes={isLoading:f.default.bool,showCommentMessage:f.default.bool};var R=function(e){var t=e.currentUser,n=e.items,r=e.onCommentDelete,i=e.onTaskDelete,o=e.onTaskEdit,a=e.onTaskAssignmentUpdate,s=e.onVersionInfo,l=e.translations,c=e.inputState,u=e.handlers;return m.default.createElement("ul",{className:"box-ui-activity-feed-active-state"},n.map(function(e){switch(e.type){case"comment":return m.default.createElement("li",{className:"box-ui-activity-feed-comment",key:e.type+e.id},m.default.createElement(S.default,P({id:e.id,currentUser:t,onDelete:r},e,{translations:l,inputState:c,handlers:u})));case"task":return m.default.createElement("li",{className:"box-ui-activity-feed-task",key:e.type+e.id},m.default.createElement(C.default,P({currentUser:t},e,{onDelete:i,onEdit:o,onTaskAssignmentUpdate:a,translations:l,inputState:c,handlers:u})));case"file_version":return m.default.createElement("li",{className:"box-ui-version-item",key:e.type+e.id},e.versions?m.default.createElement(x.CollapsedVersion,P({},e,{onInfo:s})):m.default.createElement(T.default,P({},e,{onInfo:s})));case"file_version_error":return"tooManyVersions"!==e.errorCode?null:m.default.createElement("li",{className:"box-ui-version-item",key:e.type+e.errorCode},m.default.createElement(x.VersionError,e));case"keywords":return m.default.createElement("li",{className:"box-ui-keywords-item",key:e.type+e.id},m.default.createElement(I.default,e));default:return null}}))};R.propTypes={currentUser:y.UserPropType.isRequired,handlers:f.default.shape({comments:f.default.shape({create:f.default.func,delete:f.default.func}),tasks:f.default.shape({create:f.default.func,delete:f.default.func,onTaskAssignmentUpdate:f.default.func}),contacts:f.default.shape({getApproverWithQuery:f.default.func.isRequired,getMentionWithQuery:f.default.func.isRequired}),versions:f.default.shape({info:f.default.func})}),inputState:f.default.shape({approverSelectorContacts:y.SelectorItemsPropType,mentionSelectorContacts:y.SelectorItemsPropType,currentUser:y.UserPropType.isRequired,isDisabled:f.default.bool}),items:f.default.arrayOf(f.default.shape({type:f.default.oneOf(["comment","task","file_version","keywords"]),createdAt:f.default.any,createdBy:y.UserPropType,id:f.default.string.isRequired})),onCommentDelete:f.default.func,onTaskAssignmentUpdate:f.default.func,onTaskDelete:f.default.func,onTaskEdit:f.default.func,onVersionInfo:f.default.func,translations:f.default.shape({translationEnabled:f.default.bool,onTranslate:f.default.func})};var F=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onKeyDown=function(e){var t=e.nativeEvent;t.stopImmediatePropagation()},n.approvalCommentFormFocusHandler=function(){return n.setState({isInputOpen:!0})},n.approvalCommentFormCancelHandler=function(){return n.setState({isInputOpen:!1})},n.approvalCommentFormSubmitHandler=function(){return n.setState({isInputOpen:!1})},n.createCommentHandler=function(e){var t=n.props.handlers;t.comments.create(e),n.approvalCommentFormSubmitHandler()},n.createTaskHandler=function(e){var t=n.props.handlers;t.tasks.create(e),n.approvalCommentFormSubmitHandler()},n.state={isInputOpen:!1},n}return a(t,e),M(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.feedState,r=t.handlers,i=t.inputState,o=t.isLoading,a=t.translations,s=this.state.isInputOpen,u=i.approverSelectorContacts,d=i.mentionSelectorContacts,f=i.currentUser,p=!!(r&&r.comments&&r.comments.create),h=r&&r.tasks&&r.tasks.onTaskAssignmentUpdate,g=r&&r.comments&&r.comments.delete,v=r&&r.tasks&&r.tasks.delete,y=r&&r.tasks&&r.tasks.edit,b=r&&r.versions&&r.versions.info;return m.default.createElement("div",{className:"box-ui-activity-feed",onKeyDown:this.onKeyDown},m.default.createElement("div",{ref:function(t){e.feedContainer=t},className:"box-ui-activity-feed-items-container"},c(n)?m.default.createElement(N,{isLoading:o,showCommentMessage:p}):m.default.createElement(R,{handlers:r,items:l(n),currentUser:f,onTaskAssignmentUpdate:h,onCommentDelete:g,onTaskDelete:v,onTaskEdit:y,onVersionInfo:b,translations:a,inputState:i})),p?m.default.createElement(_.default,{onSubmit:function(){e.feedContainer.scrollTop=0},isDisabled:i.isDisabled,approverSelectorContacts:u,mentionSelectorContacts:d,className:"box-ui-activity-feed-comment-input "+(i.isDisabled?"is-disabled":""),createComment:this.createCommentHandler,createTask:r&&r.tasks?this.createTaskHandler:null,getApproverContactsWithQuery:r&&r.contacts?r.contacts.getApproverWithQuery:null,getMentionContactsWithQuery:r&&r.contacts?r.contacts.getMentionWithQuery:null,isOpen:s,user:f,onCancel:this.approvalCommentFormCancelHandler,onFocus:this.approvalCommentFormFocusHandler}):null)}}]),t}(p.Component);F.propTypes={isLoading:f.default.bool,feedState:f.default.arrayOf(f.default.shape({type:f.default.oneOf(["comment","task","file_version","keywords"]),createdAt:f.default.any,createdBy:y.UserPropType,id:f.default.string.isRequired})),inputState:f.default.shape({approverSelectorContacts:y.SelectorItemsPropType,mentionSelectorContacts:y.SelectorItemsPropType,currentUser:y.UserPropType.isRequired,isDisabled:f.default.bool}),handlers:f.default.shape({comments:f.default.shape({create:f.default.func,delete:f.default.func}),tasks:f.default.shape({create:f.default.func,delete:f.default.func,edit:f.default.func,onTaskAssignmentUpdate:f.default.func}),contacts:f.default.shape({getApproverWithQuery:f.default.func.isRequired,getMentionWithQuery:f.default.func.isRequired}),versions:f.default.shape({info:f.default.func})}),translations:f.default.shape({translationEnabled:f.default.bool,onTranslate:f.default.func})},F.defaultProps={isLoading:!1,feedState:[]},t.default=F},,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e){var t=function(t){var n=t.isLoading,r=void 0!==n&&n,o=t.loadingIndicatorProps,a=void 0===o?{}:o,s=i(t,["isLoading","loadingIndicatorProps"]);return r?c.default.createElement(d.default,a):c.default.createElement(e,s)};return t.displayName="Loadable"+e.displayName,t.propTypes={isLoading:s.default.bool,loadingIndicatorProps:s.default.shape(d.default.propTypes)},t}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=r(a),l=n(0),c=r(l),u=n(59),d=r(u);t.default=o},function(e,t){},function(e,t,n){"use strict";function r(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":e instanceof _.Iterable?"Immutable."+e.toSource().split(" ")[0]:t}function i(e){function t(t,n,r,i,o,a){for(var s=arguments.length,l=Array(s>6?s-6:0),c=6;c<s;c++)l[c-6]=arguments[c];if(a=a||r,i=i||w,null!=n[r])return e.apply(void 0,[n,r,i,o,a].concat(l));var u=o;return t?new Error("Required "+u+" `"+a+"` was not specified in "+("`"+i+"`.")):void 0}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function o(e,t){function n(n,i,o,a,s){var l=n[i];if(!t(l)){var c=r(l);return new Error("Invalid "+a+" `"+s+"` of type `"+c+"` "+("supplied to `"+o+"`, expected `"+e+"`."))}return null}return i(n)}function a(e,t,n){function o(i,o,a,s,l){for(var c=arguments.length,u=Array(c>5?c-5:0),d=5;d<c;d++)u[d-5]=arguments[d];var f=i[o];if(!n(f)){var p=s,m=r(f);return new Error("Invalid "+p+" `"+l+"` of type "+("`"+m+"` supplied to `"+a+"`, expected an Immutable.js "+t+"."))}if("function"!=typeof e)return new Error("Invalid typeChecker supplied to `"+a+"` "+("for propType `"+l+"`, expected a function."));for(var h=f.toArray(),g=0,v=h.length;g<v;g++){var y=e.apply(void 0,[h,g,a,s,""+l+"["+g+"]"].concat(u));if(y instanceof Error)return y}}return i(o)}function s(e){function t(t,n,r,i,o){for(var a=arguments.length,s=Array(a>5?a-5:0),l=5;l<a;l++)s[l-5]=arguments[l];var c=t[n];if("function"!=typeof e)return new Error("Invalid keysTypeChecker (optional second argument) supplied to `"+r+"` "+("for propType `"+o+"`, expected a function."));for(var u=c.keySeq().toArray(),d=0,f=u.length;d<f;d++){var p=e.apply(void 0,[u,d,r,i,""+o+" -> key("+u[d]+")"].concat(s));if(p instanceof Error)return p}}return i(t)}function l(e){return a(e,"List",_.List.isList)}function c(e,t,n,r){function o(){for(var i=arguments.length,o=Array(i),l=0;l<i;l++)o[l]=arguments[l];return a(e,n,r).apply(void 0,o)||t&&s(t).apply(void 0,o)}return i(o)}function u(e,t){return c(e,t,"Map",_.Map.isMap)}function d(e,t){return c(e,t,"OrderedMap",_.OrderedMap.isOrderedMap)}function f(e){return a(e,"Set",_.Set.isSet)}function p(e){return a(e,"OrderedSet",_.OrderedSet.isOrderedSet)}function m(e){return a(e,"Stack",_.Stack.isStack)}function h(e){return a(e,"Iterable",_.Iterable.isIterable)}function g(e){function t(t,n,i,o,a){for(var s=arguments.length,l=Array(s>5?s-5:0),c=5;c<s;c++)l[c-5]=arguments[c];var u=t[n];if(!(u instanceof _.Record)){var d=r(u),f=o;return new Error("Invalid "+f+" `"+a+"` of type `"+d+"` "+("supplied to `"+i+"`, expected an Immutable.js Record."))}for(var p in e){var m=e[p];if(m){var h=u.toObject(),g=m.apply(void 0,[h,p,i,o,""+a+"."+p].concat(l));if(g)return g}}}return i(t)}function v(e){function t(t,i,a,s,l){for(var c=arguments.length,u=Array(c>5?c-5:0),d=5;d<c;d++)u[d-5]=arguments[d];var f=t[i];if(!o(f)){var p=r(f),m=s;return new Error("Invalid "+m+" `"+l+"` of type `"+p+"` "+("supplied to `"+a+"`, expected an Immutable.js "+n+"."))}var h=f.toObject();for(var g in e){var v=e[g];if(v){var y=v.apply(void 0,[h,g,a,s,""+l+"."+g].concat(u));if(y)return y}}}var n=void 0===arguments[1]?"Iterable":arguments[1],o=void 0===arguments[2]?_.Iterable.isIterable:arguments[2];return i(t)}function y(e){return v(e)}function b(e){return v(e,"Map",_.Map.isMap)}var _=n(5),w="<<anonymous>>",S={listOf:l,mapOf:u,orderedMapOf:d,setOf:f,orderedSetOf:p,stackOf:m,iterableOf:h,recordOf:g,shape:y,contains:y,mapContains:b,list:o("List",_.List.isList),map:o("Map",_.Map.isMap),orderedMap:o("OrderedMap",_.OrderedMap.isOrderedMap),set:o("Set",_.Set.isSet),orderedSet:o("OrderedSet",_.OrderedSet.isOrderedSet),stack:o("Stack",_.Stack.isStack),seq:o("Seq",_.Seq.isSeq),record:o("Record",function(e){return e instanceof _.Record}),iterable:o("Iterable",_.Iterable.isIterable)};e.exports=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ApprovalCommentFormUnwrapped=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(7),p=r(f),m=n(25),h=n(2),g=n(86),v=r(g),y=n(52),b=r(y),_=n(222),w=r(_),S=n(231),k=r(S),E=n(92),C=r(E),x=n(95),T=r(x),A=n(248),I=r(A),O=n(251),D=r(O),M=n(102),P=r(M),N=n(11),R=n(53),F=r(R),B=n(13),q=r(B);n(269);var L=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),j=function(e){var t=e.onCancel;return d.default.createElement("div",{className:"comment-input-controls"},d.default.createElement(b.default,{className:"comment-input-cancel-btn",onClick:t,type:"button"},d.default.createElement(h.FormattedMessage,q.default.commentCancel)),d.default.createElement(T.default,{className:"comment-input-submit-btn"},d.default.createElement(h.FormattedMessage,q.default.commentPost)))};j.propTypes={onCancel:c.default.func};var U=function(e){var t=e.approvalDate,n=e.approvers,r=e.approverSelectorContacts,i=void 0===r?[]:r,o=e.approverSelectorError,a=e.formatMessage,s=e.onApprovalDateChange,l=e.onApproverSelectorInput,c=e.onApproverSelectorRemove,u=e.onApproverSelectorSelect,f=i.filter(function(e){var t=e.id;return!n.find(function(e){var n=e.value;return n===t})}).map(function(e){var t=e.id,n=e.item;return{email:n.email,text:n.name,value:t}});return d.default.createElement("div",{className:"comment-add-approver-fields-container"},d.default.createElement(P.default,{error:o,label:d.default.createElement(h.FormattedMessage,q.default.approvalAssignees),onInput:l,onRemove:c,onSelect:u,placeholder:a(q.default.approvalAddAssignee),selectedOptions:n,selectorOptions:f},f.map(function(e){var t=e.email,n=e.text,r=e.value;return d.default.createElement(k.default,{key:r,name:n,subtitle:t})})),d.default.createElement(C.default,{className:"comment-add-approver-date-input",label:d.default.createElement(h.FormattedMessage,q.default.approvalDueDate),minDate:new Date,name:"approverDateInput",placeholder:a(q.default.approvalSelectDate),onChange:s,value:t}))};U.propTypes={approvalDate:c.default.instanceOf(Date),approvers:N.OptionsPropType,approverSelectorContacts:N.SelectorItemsPropType,approverSelectorError:c.default.string,formatMessage:c.default.func.isRequired,onApprovalDateChange:c.default.func,onApproverSelectorInput:c.default.func.isRequired,onApproverSelectorRemove:c.default.func.isRequired,onApproverSelectorSelect:c.default.func.isRequired};var H=function(e){var t=e.approvalDate,n=e.approvers,r=e.approverSelectorContacts,i=e.approverSelectorError,o=e.formatMessage,a=e.isAddApprovalVisible,s=e.onApprovalDateChange,l=e.onApproverSelectorInput,c=e.onApproverSelectorRemove,u=e.onApproverSelectorSelect;return d.default.createElement("div",{className:"comment-add-approver"},d.default.createElement(w.default,{className:"box-ui-comment-add-approver-checkbox",label:o(q.default.approvalAddTask),name:"addApproval",isChecked:a,tooltip:o(q.default.approvalAddTaskTooltip)}),a?d.default.createElement(U,{approvalDate:t,approvers:n,approverSelectorContacts:r,approverSelectorError:i,formatMessage:o,onApproverSelectorInput:l,onApproverSelectorRemove:c,onApproverSelectorSelect:u,onApprovalDateChange:s}):null)};H.propTypes={approvalDate:c.default.instanceOf(Date),approvers:N.OptionsPropType,approverSelectorContacts:N.SelectorItemsPropType,approverSelectorError:c.default.string,formatMessage:c.default.func,isAddApprovalVisible:c.default.bool,onApprovalDateChange:c.default.func,onApproverSelectorInput:c.default.func,onApproverSelectorRemove:c.default.func,onApproverSelectorSelect:c.default.func};var $=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFormChangeHandler=function(e){return n.setState({isAddApprovalVisible:"on"===e.addApproval})},n.onFormValidSubmitHandler=function(e){var t=n.props,r=t.createComment,i=t.createTask,o=t.intl,a=t.updateTask,s=t.onSubmit,l=t.entityId,c=n.getFormattedCommentText();if(c){if("on"===e.addApproval){var u=n.state.approvers;if(0===u.length)return void n.setState({approverSelectorError:o.formatMessage(F.default.requiredFieldError)});i({text:c,approvers:u.map(function(e){var t=e.value;return t}),dueDate:e.approverDateInput})}else l?a({text:c,id:l}):r({text:c});s&&s(),n.setState({commentEditorState:m.EditorState.createEmpty(O.DraftMentionDecorator),isAddApprovalVisible:!1,approvalDate:null,approvers:[]})}},n.onMentionSelectorChangeHandler=function(e){return n.setState({commentEditorState:e})},n.onApprovalDateChangeHandler=function(e){return n.setState({approvalDate:e})},n.getFormattedCommentText=function(){var e=n.state.commentEditorState,t=e.getCurrentContent(),r=t.getBlockMap(),i=[];return r.forEach(function(e){var n=e.getText(),r=[];e.findEntityRanges(function(){return!0},function(i,o){var a=e.getEntityAt(i);if(a){var s=t.getEntity(a),l="@["+s.getData().id+":"+n.substring(i+1,o)+"]";r.push(l)}else r.push(n.substring(i,o))}),i.push(r.join(""))}),i.join("\n")},n.handleApproverSelectorInput=function(e){n.props.getApproverContactsWithQuery(e),n.setState({approverSelectorError:""})},n.handleApproverSelectorSelect=function(e){n.setState({approvers:n.state.approvers.concat(e)})},n.handleApproverSelectorRemove=function(e,t){var r=n.state.approvers.slice();r.splice(t,1),n.setState({approvers:r})},n.state={approvalDate:null,approvers:[],approverSelectorError:"",commentEditorState:m.EditorState.createEmpty(O.DraftMentionDecorator),isAddApprovalVisible:!1},n}return a(t,e),L(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.isOpen;t===this.props.isOpen||t||this.setState({commentEditorState:m.EditorState.createEmpty(O.DraftMentionDecorator),isAddApprovalVisible:!1})}},{key:"render",value:function(){var e=this.props,t=e.approverSelectorContacts,n=e.className,r=e.createTask,i=e.getMentionContactsWithQuery,o=e.intl.formatMessage,a=e.isDisabled,s=e.isOpen,l=e.mentionSelectorContacts,c=void 0===l?[]:l,u=e.onCancel,f=e.onFocus,m=e.user,g=e.isEditing,y=e.taggedMessage,b=this.state,_=b.approvalDate,w=b.approvers,S=b.approverSelectorError,k=b.commentEditorState,E=b.isAddApprovalVisible,C=m.avatarUrl,x=m.id,T=m.name,A=(0,p.default)("comment-input-container",n,{"comment-input-is-open":s});return d.default.createElement("div",{className:A},!g&&d.default.createElement("div",{className:"avatar-container"},d.default.createElement(v.default,{id:x,avatarUrl:C,name:T})),d.default.createElement("div",{className:"comment-input-form-container"},d.default.createElement(I.default,{onChange:this.onFormChangeHandler,onValidSubmit:this.onFormValidSubmitHandler},d.default.createElement(D.default,{className:"comment-input",contacts:s?c:[],editorState:k,hideLabel:!0,isDisabled:a,isRequired:s,name:"commentText",label:"Comment",onChange:this.onMentionSelectorChangeHandler,onFocus:f,onMention:i,placeholder:y||o(q.default.commentWrite),validateOnBlur:!1}),d.default.createElement("aside",{className:(0,p.default)("at-mention-tip",{"accessibility-hidden":s})},d.default.createElement(h.FormattedMessage,q.default.atMentionTip)),r?d.default.createElement(H,{approvalDate:_,approvers:w,approverSelectorContacts:t,approverSelectorError:S,formatMessage:o,isAddApprovalVisible:E,onApprovalDateChange:this.onApprovalDateChangeHandler,onApproverSelectorInput:this.handleApproverSelectorInput,onApproverSelectorRemove:this.handleApproverSelectorRemove,onApproverSelectorSelect:this.handleApproverSelectorSelect}):null,d.default.createElement(j,{onCancel:u}))))}}]),t}(u.Component);$.propTypes={approverSelectorContacts:N.SelectorItemsPropType,className:c.default.string,createComment:c.default.func,createTask:c.default.func,updateTask:c.default.func,getApproverContactsWithQuery:c.default.func,getMentionContactsWithQuery:c.default.func,intl:h.intlShape.isRequired,isDisabled:c.default.bool,isOpen:c.default.bool,mentionSelectorContacts:N.SelectorItemsPropType,onCancel:c.default.func,onFocus:c.default.func,onSubmit:c.default.func,user:N.UserPropType.isRequired,isEditing:c.default.bool,entityId:c.default.string,taggedMessage:c.default.string},$.defaultProps={isOpen:!1},t.ApprovalCommentFormUnwrapped=$,t.default=(0,h.injectIntl)($)},function(e,t,n){"use strict";var r=n(27),i=n(14),o=n(21),a=n(8),s=n(6),l=(n(28),n(5)),c=n(16),u=n(146),d=l.List,f=l.Repeat,p={insertAtomicBlock:function(e,t,n){var l=e.getCurrentContent(),u=e.getSelection(),p=a.removeRange(l,u,"backward"),m=p.getSelectionAfter(),h=a.splitBlock(p,m),g=h.getSelectionAfter(),v=a.setBlockType(h,g,"atomic"),y=i.create({entity:t}),b=[new o({key:c(),type:"atomic",text:n,characterList:d(f(y,n.length))}),new o({key:c(),type:"unstyled",text:"",characterList:d()})],_=r.createFromArray(b),w=a.replaceWithFragment(v,g,_),S=w.merge({selectionBefore:u,selectionAfter:w.getSelectionAfter().set("hasFocus",!0)});return s.push(e,S,"insert-fragment")},moveAtomicBlock:function(e,t,n,r){var i=e.getCurrentContent(),o=e.getSelection(),l=void 0;if("before"===r||"after"===r){var c=i.getBlockForKey("before"===r?n.getStartKey():n.getEndKey());l=u(i,t,c,r)}else{var d=a.removeRange(i,n,"backward"),f=d.getSelectionAfter(),p=d.getBlockForKey(f.getFocusKey());if(0===f.getStartOffset())l=u(d,t,p,"before");else if(f.getEndOffset()===p.getLength())l=u(d,t,p,"after");else{var m=a.splitBlock(d,f),h=m.getSelectionAfter(),g=m.getBlockForKey(h.getFocusKey());l=u(m,t,g,"before")}}var v=l.merge({selectionBefore:o,selectionAfter:l.getSelectionAfter().set("hasFocus",!0)});return s.push(e,v,"move-block")}};e.exports=p},function(e,t,n){"use strict";function r(e,t,n,r){var o=e.getBlockMap(),s=t.getStartKey(),l=t.getStartOffset(),c=t.getEndKey(),u=t.getEndOffset(),d=o.skipUntil(function(e,t){return t===s}).takeUntil(function(e,t){return t===c}).concat(a([[c,o.get(c)]])).map(function(e,t){var o,a;s===c?(o=l,a=u):(o=t===s?l:0,a=t===c?u:e.getLength());for(var d,f=e.getCharacterList();o<a;)d=f.get(o),f=f.set(o,r?i.applyStyle(d,n):i.removeStyle(d,n)),o++;return e.set("characterList",f)});return e.merge({blockMap:o.merge(d),selectionBefore:t,selectionAfter:t})}var i=n(14),o=n(5),a=o.Map,s={add:function(e,t,n){return r(e,t,n,!0)},remove:function(e,t,n){return r(e,t,n,!1)}};e.exports=s},function(e,t,n){"use strict";function r(e,t,n){var r=e.getBlockMap(),a=t.getStartKey(),s=t.getStartOffset(),l=t.getEndKey(),c=t.getEndOffset(),u=r.skipUntil(function(e,t){return t===a}).takeUntil(function(e,t){return t===l}).toOrderedMap().merge(i.OrderedMap([[l,r.get(l)]])).map(function(e,t){var r=t===a?s:0,i=t===l?c:e.getLength();return o(e,r,i,n)});return e.merge({blockMap:r.merge(u),selectionBefore:t,selectionAfter:t})}var i=n(5),o=n(135);e.exports=r},function(e,t,n){"use strict";function r(e,t,n,r){for(var o=e.getCharacterList();t<n;)o=o.set(t,i.applyEntity(o.get(t),r)),t++;return e.set("characterList",o)}var i=n(14);e.exports=r},function(e,t,n){"use strict";(function(t){function r(e,t,n,r,o){var a=r.getStartOffset(),s=r.getEndOffset(),l=t.getEntityAt(a),c=n.getEntityAt(s-1);if(!l&&!c)return r;var u=r;if(l&&l===c)u=i(e,t,u,o,l,!0,!0);else if(l&&c){var d=i(e,t,u,o,l,!1,!0),f=i(e,n,u,o,c,!1,!1);u=u.merge({anchorOffset:d.getAnchorOffset(),focusOffset:f.getFocusOffset(),isBackward:!1})}else if(l){var p=i(e,t,u,o,l,!1,!0);u=u.merge({anchorOffset:p.getStartOffset(),isBackward:!1})}else if(c){var m=i(e,n,u,o,c,!1,!1);u=u.merge({focusOffset:m.getEndOffset(),isBackward:!1})}return u}function i(e,n,r,i,l,c,u){var d=r.getStartOffset(),f=r.getEndOffset(),p=e.__get(l),m=p.getMutability(),h=u?d:f;if("MUTABLE"===m)return r;var g=a(n,l).filter(function(e){return h<=e.end&&h>=e.start});1!=g.length?"production"!==t.env.NODE_ENV?s(!1,"There should only be one entity range within this removal range."):s(!1):void 0;var v=g[0];if("IMMUTABLE"===m)return r.merge({anchorOffset:v.start,focusOffset:v.end,isBackward:!1});c||(u?f=v.end:d=v.start);
var y=o.getRemovalRange(d,f,n.getText().slice(v.start,v.end),v.start,i);return r.merge({anchorOffset:y.start,focusOffset:y.end,isBackward:!1})}var o=n(137),a=n(138),s=n(4);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";var r={getRemovalRange:function(e,t,n,r,i){var o=n.split(" ");o=o.map(function(e,t){if("forward"===i){if(t>0)return" "+e}else if(t<o.length-1)return e+" ";return e});for(var a,s,l=r,c=null,u=null,d=0;d<o.length;d++){if(s=o[d],a=l+s.length,e<a&&l<t)null!==c?u=a:(c=l,u=a);else if(null!==c)break;l=a}var f=r+n.length,p=c===r,m=u===f;return(!p&&m||p&&!m)&&("forward"===i?u!==f&&u++:c!==r&&c--),{start:c,end:u}}};e.exports=r},function(e,t,n){"use strict";(function(t){function r(e,n){var r=[];return e.findEntityRanges(function(e){return e.getEntity()===n},function(e,t){r.push({start:e,end:t})}),r.length?void 0:"production"!==t.env.NODE_ENV?i(!1,"Entity key not found in this range."):i(!1),r}var i=n(4);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";(function(t){function r(e,n,r){n.isCollapsed()?void 0:"production"!==t.env.NODE_ENV?s(!1,"`insertFragment` should only be called with a collapsed selection state."):s(!1);var l,c,u=n.getStartKey(),d=n.getStartOffset(),f=e.getBlockMap(),p=r.size;if(1===p){var m=f.get(u),h=r.first(),g=m.getText(),v=m.getCharacterList(),y=m.merge({text:g.slice(0,d)+h.getText()+g.slice(d),characterList:a(v,h.getCharacterList(),d),data:h.getData()});return f=f.set(u,y),l=u,c=d+h.getText().length,e.merge({blockMap:f.set(u,y),selectionBefore:n,selectionAfter:n.merge({anchorKey:l,anchorOffset:c,focusKey:l,focusOffset:c,isBackward:!1})})}var b=[];return e.getBlockMap().forEach(function(e,t){if(t!==u)return void b.push(e);var n=e.getText(),i=e.getCharacterList(),a=n.length,s=n.slice(0,d),c=i.slice(0,d),f=r.first(),m=e.merge({text:s+f.getText(),characterList:c.concat(f.getCharacterList()),type:s?e.getType():f.getType(),data:f.getData()});b.push(m),r.slice(1,p-1).forEach(function(e){b.push(e.set("key",o()))});var h=n.slice(d,a),g=i.slice(d,a),v=r.last();l=o();var y=v.merge({key:l,text:v.getText()+h,characterList:v.getCharacterList().concat(g),data:v.getData()});b.push(y)}),c=r.last().getLength(),e.merge({blockMap:i.createFromArray(b),selectionBefore:n,selectionAfter:n.merge({anchorKey:l,anchorOffset:c,focusKey:l,focusOffset:c,isBackward:!1})})}var i=n(27),o=n(16),a=n(63),s=n(4);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";(function(t){function r(e,n,r,i){n.isCollapsed()?void 0:"production"!==t.env.NODE_ENV?a(!1,"`insertText` should only be called with a collapsed range."):a(!1);var l=r.length;if(!l)return e;var c=e.getBlockMap(),u=n.getStartKey(),d=n.getStartOffset(),f=c.get(u),p=f.getText(),m=f.merge({text:p.slice(0,d)+r+p.slice(d,f.getLength()),characterList:o(f.getCharacterList(),s(i,l).toList(),d)}),h=d+l;return e.merge({blockMap:c.set(u,m),selectionAfter:n.merge({anchorOffset:h,focusOffset:h})})}var i=n(5),o=n(63),a=n(4),s=i.Repeat;e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";function r(e,t,n){var r=t.getStartKey(),i=t.getEndKey(),a=e.getBlockMap(),s=a.toSeq().skipUntil(function(e,t){return t===r}).takeUntil(function(e,t){return t===i}).concat(o([[i,a.get(i)]])).map(n);return e.merge({blockMap:a.merge(s),selectionBefore:t,selectionAfter:t})}var i=n(5),o=i.Map;e.exports=r},function(e,t,n){"use strict";function r(e,t){if(t.isCollapsed())return e;var n,r=e.getBlockMap(),a=t.getStartKey(),s=t.getStartOffset(),l=t.getEndKey(),c=t.getEndOffset(),u=r.get(a),d=r.get(l);n=u===d?i(u.getCharacterList(),s,c):u.getCharacterList().slice(0,s).concat(d.getCharacterList().slice(c));var f=u.merge({text:u.getText().slice(0,s)+d.getText().slice(c),characterList:n}),p=r.toSeq().skipUntil(function(e,t){return t===a}).takeUntil(function(e,t){return t===l}).concat(o.Map([[l,null]])).map(function(e,t){return t===a?f:null});return r=r.merge(p).filter(function(e){return!!e}),e.merge({blockMap:r,selectionBefore:t,selectionAfter:t.merge({anchorKey:a,anchorOffset:s,focusKey:a,focusOffset:s,isBackward:!1})})}function i(e,t,n){if(0===t)for(;t<n;)e=e.shift(),t++;else if(n===e.count())for(;n>t;)e=e.pop(),n--;else{var r=e.slice(0,t),i=e.slice(n);e=r.concat(i).toList()}return e}var o=n(5);e.exports=r},function(e,t,n){"use strict";(function(t){function r(e,n){n.isCollapsed()?void 0:"production"!==t.env.NODE_ENV?a(!1,"Selection range must be collapsed."):a(!1);var r=n.getAnchorKey(),i=n.getAnchorOffset(),l=e.getBlockMap(),c=l.get(r),u=c.getText(),d=c.getCharacterList(),f=c.merge({text:u.slice(0,i),characterList:d.slice(0,i)}),p=o(),m=f.merge({key:p,text:u.slice(i),characterList:d.slice(i),data:s()}),h=l.toSeq().takeUntil(function(e){return e===c}),g=l.toSeq().skipUntil(function(e){return e===c}).rest(),v=h.concat([[f.getKey(),f],[m.getKey(),m]],g).toOrderedMap();return e.merge({blockMap:v,selectionBefore:n,selectionAfter:n.merge({anchorKey:p,anchorOffset:0,focusKey:p,focusOffset:0,isBackward:!1})})}var i=n(5),o=n(16),a=n(4),s=i.Map;e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";var r,i=n(5),o=n(145),a=n(12),s=i.OrderedMap,l={getDirectionMap:function(e,t){r?r.reset():r=new o;var n=e.getBlockMap(),l=n.valueSeq().map(function(e){return a(r).getDirection(e.getText())}),c=s(n.keySeq().zip(l));return null!=t&&i.is(t,c)?t:c}};e.exports=l},function(e,t,n){"use strict";(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=n(66),o=n(43),a=n(4),s=function(){function e(n){r(this,e),n?o.isStrong(n)?void 0:"production"!==t.env.NODE_ENV?a(!1,"Default direction must be a strong direction (LTR or RTL)"):a(!1):n=o.getGlobalDir(),this._defaultDir=n,this.reset()}return e.prototype.reset=function(){this._lastDir=this._defaultDir},e.prototype.getDirection=function(e){return this._lastDir=i.getDirection(e,this._lastDir),this._lastDir},e}();e.exports=s}).call(t,n(3))},function(e,t,n){"use strict";(function(t){function r(e,n,r,o){n.getKey()===r.getKey()?"production"!==t.env.NODE_ENV?i(!1,"Block cannot be moved next to itself."):i(!1):void 0,"replace"===o?"production"!==t.env.NODE_ENV?i(!1,"Replacing blocks is not supported."):i(!1):void 0;var a=r.getKey(),s=e.getBlockBefore(a),l=e.getBlockAfter(a),c=e.getBlockMap(),u=c.delete(n.getKey()),d=u.toSeq().takeUntil(function(e){return e===r}),f=u.toSeq().skipUntil(function(e){return e===r}).skip(1),p=void 0;return"before"===o?(s&&s.getKey()===n.getKey()?"production"!==t.env.NODE_ENV?i(!1,"Block cannot be moved next to itself."):i(!1):void 0,p=d.concat([[n.getKey(),n],[r.getKey(),r]],f).toOrderedMap()):"after"===o&&(l&&l.getKey()===n.getKey()?"production"!==t.env.NODE_ENV?i(!1,"Block cannot be moved next to itself."):i(!1):void 0,p=d.concat([[r.getKey(),r],[n.getKey(),n]],f).toOrderedMap()),e.merge({blockMap:p,selectionBefore:e.getSelectionAfter(),selectionAfter:e.getSelectionAfter().merge({anchorKey:n.getKey(),focusKey:n.getKey()})})}var i=n(4);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){for(var r=t;r<n;r++)if(null!=e[r])return!1;return!0}function o(e,t,n,r){for(var i=t;i<n;i++)e[i]=r}var a=n(5),s=a.List,l=".",c=function(){function e(t){r(this,e),this._decorators=t.slice()}return e.prototype.getDecorations=function(e,t){var n=Array(e.getText().length).fill(null);return this._decorators.forEach(function(r,a){var s=0,c=r.strategy,u=function(e,t){i(n,e,t)&&(o(n,e,t,a+l+s),s++)};c(e,u,t)}),s(n)},e.prototype.getComponentForKey=function(e){var t=parseInt(e.split(l)[0],10);return this._decorators[t].component},e.prototype.getPropsForKey=function(e){var t=parseInt(e.split(l)[0],10);return this._decorators[t].props},e}();e.exports=c},function(e,t,n){"use strict";(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(20),s=a||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=n(44),c=n(67),u=n(149),d=n(150),f=n(172),p=n(175),m=n(207),h=n(6),g=n(0),v=n(17),y=n(72),b=n(47),_=n(18),w=n(29),S=n(24),k=n(16),E=n(84),C=n(48),x=n(4),T=n(12),A=_.isBrowser("IE"),I=!A,O={edit:p,composite:u,drag:f,cut:null,render:null},D=function(e){function n(t){r(this,n);var o=i(this,e.call(this,t));return o._blockSelectEvents=!1,o._clipboard=null,o._handler=null,o._dragCount=0,o._editorKey=t.editorKey||k(),o._placeholderAccessibilityID="placeholder-"+o._editorKey,o._latestEditorState=t.editorState,o._onBeforeInput=o._buildHandler("onBeforeInput"),o._onBlur=o._buildHandler("onBlur"),o._onCharacterData=o._buildHandler("onCharacterData"),o._onCompositionEnd=o._buildHandler("onCompositionEnd"),o._onCompositionStart=o._buildHandler("onCompositionStart"),o._onCopy=o._buildHandler("onCopy"),o._onCut=o._buildHandler("onCut"),o._onDragEnd=o._buildHandler("onDragEnd"),o._onDragOver=o._buildHandler("onDragOver"),o._onDragStart=o._buildHandler("onDragStart"),o._onDrop=o._buildHandler("onDrop"),o._onInput=o._buildHandler("onInput"),o._onFocus=o._buildHandler("onFocus"),o._onKeyDown=o._buildHandler("onKeyDown"),o._onKeyPress=o._buildHandler("onKeyPress"),o._onKeyUp=o._buildHandler("onKeyUp"),o._onMouseDown=o._buildHandler("onMouseDown"),o._onMouseUp=o._buildHandler("onMouseUp"),o._onPaste=o._buildHandler("onPaste"),o._onSelect=o._buildHandler("onSelect"),o.focus=o._focus.bind(o),o.blur=o._blur.bind(o),o.setMode=o._setMode.bind(o),o.exitCurrentMode=o._exitCurrentMode.bind(o),o.restoreEditorDOM=o._restoreEditorDOM.bind(o),o.setClipboard=o._setClipboard.bind(o),o.getClipboard=o._getClipboard.bind(o),o.getEditorKey=function(){return o._editorKey},o.update=o._update.bind(o),o.onDragEnter=o._onDragEnter.bind(o),o.onDragLeave=o._onDragLeave.bind(o),o.state={contentsKey:0},o}return o(n,e),n.prototype._buildHandler=function(e){var t=this;return function(n){if(!t.props.readOnly){var r=t._handler&&t._handler[e];r&&r(t,n)}}},n.prototype._showPlaceholder=function(){return!!this.props.placeholder&&!this.props.editorState.isInCompositionMode()&&!this.props.editorState.getCurrentContent().hasText()},n.prototype._renderPlaceholder=function(){return this._showPlaceholder()?g.createElement(m,{text:T(this.props.placeholder),editorState:this.props.editorState,textAlignment:this.props.textAlignment,accessibilityID:this._placeholderAccessibilityID}):null},n.prototype.render=function(){var e=this.props,t=e.readOnly,n=e.textAlignment,r=w({"DraftEditor/root":!0,"DraftEditor/alignLeft":"left"===n,"DraftEditor/alignRight":"right"===n,"DraftEditor/alignCenter":"center"===n}),i={outline:"none",whiteSpace:"pre-wrap",wordWrap:"break-word"};return g.createElement("div",{className:r},this._renderPlaceholder(),g.createElement("div",{className:w("DraftEditor/editorContainer"),ref:"editorContainer"},g.createElement("div",{"aria-activedescendant":t?null:this.props.ariaActiveDescendantID,"aria-autocomplete":t?null:this.props.ariaAutoComplete,"aria-describedby":this._showPlaceholder()?this._placeholderAccessibilityID:null,"aria-expanded":t?null:this.props.ariaExpanded,"aria-haspopup":t?null:this.props.ariaHasPopup,"aria-label":this.props.ariaLabel,"aria-owns":t?null:this.props.ariaOwneeID,autoCapitalize:this.props.autoCapitalize,autoComplete:this.props.autoComplete,autoCorrect:this.props.autoCorrect,className:w({notranslate:!t,"public/DraftEditor/content":!0}),contentEditable:!t,"data-testid":this.props.webDriverTestID,onBeforeInput:this._onBeforeInput,onBlur:this._onBlur,onCompositionEnd:this._onCompositionEnd,onCompositionStart:this._onCompositionStart,onCopy:this._onCopy,onCut:this._onCut,onDragEnd:this._onDragEnd,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this._onDragOver,onDragStart:this._onDragStart,onDrop:this._onDrop,onFocus:this._onFocus,onInput:this._onInput,onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onKeyUp:this._onKeyUp,onMouseUp:this._onMouseUp,onPaste:this._onPaste,onSelect:this._onSelect,ref:"editor",role:t?null:this.props.role||"textbox",spellCheck:I&&this.props.spellCheck,style:i,suppressContentEditableWarning:!0,tabIndex:this.props.tabIndex},g.createElement(d,{blockRenderMap:this.props.blockRenderMap,blockRendererFn:this.props.blockRendererFn,blockStyleFn:this.props.blockStyleFn,customStyleMap:s({},c,this.props.customStyleMap),customStyleFn:this.props.customStyleFn,editorKey:this._editorKey,editorState:this.props.editorState,key:"contents"+this.state.contentsKey,textDirectionality:this.props.textDirectionality}))))},n.prototype.componentDidMount=function(){this.setMode("edit"),A&&document.execCommand("AutoUrlDetect",!1,!1)},n.prototype.componentWillUpdate=function(e){this._blockSelectEvents=!0,this._latestEditorState=e.editorState},n.prototype.componentDidUpdate=function(){this._blockSelectEvents=!1},n.prototype._focus=function(e){var n=this.props.editorState,r=n.getSelection().getHasFocus(),i=v.findDOMNode(this.refs.editor),o=b.getScrollParent(i),a=e||C(o),s=a.x,l=a.y;i instanceof HTMLElement?void 0:"production"!==t.env.NODE_ENV?x(!1,"editorNode is not an HTMLElement"):x(!1),i.focus(),o===window?window.scrollTo(s,l):y.setTop(o,l),r||this.update(h.forceSelection(n,n.getSelection()))},n.prototype._blur=function(){var e=v.findDOMNode(this.refs.editor);e instanceof HTMLElement?void 0:"production"!==t.env.NODE_ENV?x(!1,"editorNode is not an HTMLElement"):x(!1),e.blur()},n.prototype._setMode=function(e){this._handler=O[e]},n.prototype._exitCurrentMode=function(){this.setMode("edit")},n.prototype._restoreEditorDOM=function(e){var t=this;this.setState({contentsKey:this.state.contentsKey+1},function(){t._focus(e)})},n.prototype._setClipboard=function(e){this._clipboard=e},n.prototype._getClipboard=function(){return this._clipboard},n.prototype._update=function(e){this._latestEditorState=e,this.props.onChange(e)},n.prototype._onDragEnter=function(){this._dragCount++},n.prototype._onDragLeave=function(){this._dragCount--,0===this._dragCount&&this.exitCurrentMode()},n}(g.Component);D.defaultProps={blockRenderMap:l,blockRendererFn:S.thatReturnsNull,blockStyleFn:S.thatReturns(""),keyBindingFn:E,readOnly:!1,spellCheck:!1,stripPastedStyles:!1},e.exports=D}).call(t,n(3))},function(e,t,n){"use strict";var r=n(8),i=n(6),o=n(45),a=n(46),s=n(68),l=20,c=!1,u=!1,d="",f={onBeforeInput:function(e,t){d=(d||"")+t.data},onCompositionStart:function(e){u=!0},onCompositionEnd:function(e){c=!1,u=!1,setTimeout(function(){c||f.resolveComposition(e)},l)},onKeyDown:function(e,t){return u?void(t.which!==o.RIGHT&&t.which!==o.LEFT||t.preventDefault()):(f.resolveComposition(e),void e._onKeyDown(t))},onKeyPress:function(e,t){t.which===o.RETURN&&t.preventDefault()},resolveComposition:function(e){if(!u){c=!0;var t=d;d="";var n=i.set(e._latestEditorState,{inCompositionMode:!1}),o=n.getCurrentInlineStyle(),l=a(n.getCurrentContent(),n.getSelection()),f=!t||s(n)||o.size>0||null!==l;if(f&&e.restoreEditorDOM(),e.exitCurrentMode(),t){var p=r.replaceText(n.getCurrentContent(),n.getSelection(),t,o,l);return void e.update(i.push(n,p,"insert-characters"))}f&&e.update(i.set(n,{nativelyRenderedContent:null,forceSelection:!0}))}}};e.exports=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n,r){return f({"public/DraftStyleDefault/unorderedListItem":"unordered-list-item"===e,"public/DraftStyleDefault/orderedListItem":"ordered-list-item"===e,"public/DraftStyleDefault/reset":n,"public/DraftStyleDefault/depth0":0===t,"public/DraftStyleDefault/depth1":1===t,"public/DraftStyleDefault/depth2":2===t,"public/DraftStyleDefault/depth3":3===t,"public/DraftStyleDefault/depth4":4===t,"public/DraftStyleDefault/listLTR":"LTR"===r,"public/DraftStyleDefault/listRTL":"RTL"===r})}var s=n(20),l=s||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=n(69),u=n(37),d=(n(6),n(0)),f=n(29),p=n(171),m=n(12),h=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return o(t,e),t.prototype.shouldComponentUpdate=function(e){var t=this.props.editorState,n=e.editorState,r=t.getDirectionMap(),i=n.getDirectionMap();if(r!==i)return!0;var o=t.getSelection().getHasFocus(),a=n.getSelection().getHasFocus();if(o!==a)return!0;var s=n.getNativelyRenderedContent(),l=t.isInCompositionMode(),c=n.isInCompositionMode();if(t===n||null!==s&&n.getCurrentContent()===s||l&&c)return!1;var u=t.getCurrentContent(),d=n.getCurrentContent(),f=t.getDecorator(),p=n.getDecorator();return l!==c||u!==d||f!==p||n.mustForceSelection()},t.prototype.render=function(){for(var e=this.props,t=e.blockRenderMap,n=e.blockRendererFn,r=e.customStyleMap,i=e.customStyleFn,o=e.editorState,s=o.getCurrentContent(),f=o.getSelection(),h=o.mustForceSelection(),g=o.getDecorator(),v=m(o.getDirectionMap()),y=s.getBlocksAsArray(),b=[],_=null,w=null,S=0;S<y.length;S++){var k=y[S],E=k.getKey(),C=k.getType(),x=n(k),T=void 0,A=void 0,I=void 0;x&&(T=x.component,A=x.props,I=x.editable);var O=this.props.textDirectionality,D=O?O:v.get(E),M=u.encode(E,0,0),P={contentState:s,block:k,blockProps:A,customStyleMap:r,customStyleFn:i,decorator:g,direction:D,forceSelection:h,key:E,offsetKey:M,selection:f,tree:o.getBlockTree(E)},N=t.get(C),R=N.wrapper,F=N.element||t.get("unstyled").element,B=k.getDepth(),q=this.props.blockStyleFn(k);if("li"===F){var L=w!==R||null===_||B>_;q=p(q,a(C,B,L,D))}var j=T||c,U={className:q,"data-block":!0,"data-editor":this.props.editorKey,"data-offset-key":M,key:E};void 0!==I&&(U=l({},U,{contentEditable:I,suppressContentEditableWarning:!0}));var H=d.createElement(F,U,d.createElement(j,P));b.push({block:H,wrapperTemplate:R,key:E,offsetKey:M}),_=R?k.getDepth():null,w=R}for(var $=[],V=0;V<b.length;){var W=b[V];if(W.wrapperTemplate){var K=[];do K.push(b[V].block),V++;while(V<b.length&&b[V].wrapperTemplate===W.wrapperTemplate);var z=d.cloneElement(W.wrapperTemplate,{key:W.key+"-wrap","data-offset-key":W.offsetKey},K);$.push(z)}else $.push(W.block),V++}return d.createElement("div",{"data-contents":"true"},$)},t}(d.Component);e.exports=h},function(e,t,n){"use strict";(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(20),s=(n(21),n(152)),l=n(0),c=n(17),u=n(4),d=n(159),f=function(e){function n(){return r(this,n),i(this,e.apply(this,arguments))}return o(n,e),n.prototype._setSelection=function(){var e=this.props.selection;if(null!=e&&e.getHasFocus()){var n=this.props,r=n.block,i=n.start,o=n.text,a=r.getKey(),s=i+o.length;if(e.hasEdgeWithin(a,i,s)){var l=c.findDOMNode(this);l?void 0:"production"!==t.env.NODE_ENV?u(!1,"Missing node"):u(!1);var f=l.firstChild;f?void 0:"production"!==t.env.NODE_ENV?u(!1,"Missing child"):u(!1);var p=void 0;f.nodeType===Node.TEXT_NODE?p=f:"BR"===f.tagName?p=l:(p=f.firstChild,p?void 0:"production"!==t.env.NODE_ENV?u(!1,"Missing targetNode"):u(!1)),d(e,p,a,i,s)}}},n.prototype.shouldComponentUpdate=function(e){var n=c.findDOMNode(this.refs.leaf);return n?void 0:"production"!==t.env.NODE_ENV?u(!1,"Missing leafNode"):u(!1),n.textContent!==e.text||e.styleSet!==this.props.styleSet||e.forceSelection},n.prototype.componentDidUpdate=function(){this._setSelection()},n.prototype.componentDidMount=function(){this._setSelection()},n.prototype.render=function(){var e=this.props.block,t=this.props.text;t.endsWith("\n")&&this.props.isLast&&(t+="\n");var n=this.props,r=n.customStyleMap,i=n.customStyleFn,o=n.offsetKey,c=n.styleSet,u=c.reduce(function(e,t){var n={},i=r[t];return void 0!==i&&e.textDecoration!==i.textDecoration&&(n.textDecoration=[e.textDecoration,i.textDecoration].join(" ").trim()),a(e,i,n)},{});if(i){var d=i(c,e);u=a(u,d)}return l.createElement("span",{"data-offset-key":o,ref:"leaf",style:u},l.createElement(s,null,t))},n}(l.Component);e.exports=f}).call(t,n(3))},function(e,t,n){"use strict";(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return d?"\n"===e.textContent:"BR"===e.tagName}var s=n(0),l=n(17),c=n(18),u=n(4),d=c.isBrowser("IE <= 11"),f=d?s.createElement("span",{key:"A","data-text":"true"},"\n"):s.createElement("br",{key:"A","data-text":"true"}),p=d?s.createElement("span",{key:"B","data-text":"true"},"\n"):s.createElement("br",{key:"B","data-text":"true"}),m=function(e){function n(t){r(this,n);var o=i(this,e.call(this,t));return o._forceFlag=!1,o}return o(n,e),n.prototype.shouldComponentUpdate=function(e){var n=l.findDOMNode(this),r=""===e.children;return n instanceof Element?void 0:"production"!==t.env.NODE_ENV?u(!1,"node is not an Element"):u(!1),r?!a(n):n.textContent!==e.children},n.prototype.componentWillUpdate=function(){this._forceFlag=!this._forceFlag},n.prototype.render=function(){return""===this.props.children?this._forceFlag?f:p:s.createElement("span",{key:this._forceFlag?"A":"B","data-text":"true"},this.props.children)},n}(s.Component);e.exports=m}).call(t,n(3))},function(e,t,n){"use strict";function r(e){return s[e]||e}function i(e){if(!e)return{major:"",minor:""};var t=e.split(".");return{major:t[0],minor:t[1]}}var o=n(154),a="Unknown",s={"Mac OS":"Mac OS X"},l=new o,c=l.getResult(),u=i(c.browser.version),d={browserArchitecture:c.cpu.architecture||a,browserFullVersion:c.browser.version||a,browserMinorVersion:u.minor||a,browserName:c.browser.name||a,browserVersion:c.browser.major||a,deviceName:c.device.model||a,engineName:c.engine.name||a,engineVersion:c.engine.version||a,platformArchitecture:c.cpu.architecture||a,platformName:r(c.os.name)||a,platformVersion:c.os.version||a,platformFullVersion:c.os.version||a};e.exports=d},function(e,t,n){var r;!function(i,o){"use strict";var a="0.7.17",s="",l="?",c="function",u="undefined",d="object",f="string",p="major",m="model",h="name",g="type",v="vendor",y="version",b="architecture",_="console",w="mobile",S="tablet",k="smarttv",E="wearable",C="embedded",x={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2===0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===f?e.replace(/[^\d\.]/g,"").split(".")[0]:o},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},T={rgx:function(e,t){for(var n,r,i,a,s,l,u=0;u<t.length&&!s;){var f=t[u],p=t[u+1];for(n=r=0;n<f.length&&!s;)if(s=f[n++].exec(e))for(i=0;i<p.length;i++)l=s[++r],a=p[i],typeof a===d&&a.length>0?2==a.length?typeof a[1]==c?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3==a.length?typeof a[1]!==c||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):o:this[a[0]]=l?a[1].call(this,l,a[2]):o:4==a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):o):this[a]=l?l:o;u+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===d&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(x.has(t[n][r],e))return n===l?o:n}else if(x.has(t[n],e))return n===l?o:n;return e}},A={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},I={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[h,y],[/(opios)[\/\s]+([\w\.]+)/i],[[h,"Opera Mini"],y],[/\s(opr)\/([\w\.]+)/i],[[h,"Opera"],y],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i],[h,y],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[h,"IE"],y],[/(edge)\/((\d+)?[\w\.]+)/i],[h,y],[/(yabrowser)\/([\w\.]+)/i],[[h,"Yandex"],y],[/(puffin)\/([\w\.]+)/i],[[h,"Puffin"],y],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[h,"UCBrowser"],y],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],y],[/(micromessenger)\/([\w\.]+)/i],[[h,"WeChat"],y],[/(QQ)\/([\d\.]+)/i],[h,y],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[h,y],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[y,[h,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[y,[h,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[y,[h,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[h,/(.+)/,"$1 WebView"],y],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[h,/(.+(?:g|us))(.+)/,"$1 $2"],y],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[y,[h,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[h,y],[/(dolfin)\/([\w\.]+)/i],[[h,"Dolphin"],y],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[h,"Chrome"],y],[/(coast)\/([\w\.]+)/i],[[h,"Opera Coast"],y],[/fxios\/([\w\.-]+)/i],[y,[h,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[y,[h,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[y,h],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[h,"GSA"],y],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[h,[y,T.str,A.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[h,y],[/(navigator|netscape)\/([\w\.-]+)/i],[[h,"Netscape"],y],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[h,y]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[b,"amd64"]],[/(ia32(?=;))/i],[[b,x.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[b,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[b,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[b,/ower/,"",x.lowerize]],[/(sun4\w)[;\)]/i],[[b,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[b,x.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[m,v,[g,S]],[/applecoremedia\/[\w\.]+ \((ipad)/],[m,[v,"Apple"],[g,S]],[/(apple\s{0,1}tv)/i],[[m,"Apple TV"],[v,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[v,m,[g,S]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[m,[v,"Amazon"],[g,S]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[m,T.str,A.device.amazon.model],[v,"Amazon"],[g,w]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[m,v,[g,w]],[/\((ip[honed|\s\w*]+);/i],[m,[v,"Apple"],[g,w]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[v,m,[g,w]],[/\(bb10;\s(\w+)/i],[m,[v,"BlackBerry"],[g,w]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[m,[v,"Asus"],[g,S]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[v,"Sony"],[m,"Xperia Tablet"],[g,S]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[m,[v,"Sony"],[g,w]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[v,m,[g,_]],[/android.+;\s(shield)\sbuild/i],[m,[v,"Nvidia"],[g,_]],[/(playstation\s[34portablevi]+)/i],[m,[v,"Sony"],[g,_]],[/(sprint\s(\w+))/i],[[v,T.str,A.device.sprint.vendor],[m,T.str,A.device.sprint.model],[g,w]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[v,m,[g,S]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[v,[m,/_/g," "],[g,w]],[/(nexus\s9)/i],[m,[v,"HTC"],[g,S]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[m,[v,"Huawei"],[g,w]],[/(microsoft);\s(lumia[\s\w]+)/i],[v,m,[g,w]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[m,[v,"Microsoft"],[g,_]],[/(kin\.[onetw]{3})/i],[[m,/\./g," "],[v,"Microsoft"],[g,w]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[m,[v,"Motorola"],[g,w]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[m,[v,"Motorola"],[g,S]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[v,x.trim],[m,x.trim],[g,k]],[/hbbtv.+maple;(\d+)/i],[[m,/^/,"SmartTV"],[v,"Samsung"],[g,k]],[/\(dtv[\);].+(aquos)/i],[m,[v,"Sharp"],[g,k]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[v,"Samsung"],m,[g,S]],[/smart-tv.+(samsung)/i],[v,[g,k],m],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[v,"Samsung"],m,[g,w]],[/sie-(\w+)*/i],[m,[v,"Siemens"],[g,w]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[v,"Nokia"],m,[g,w]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[m,[v,"Acer"],[g,S]],[/android.+([vl]k\-?\d{3})\s+build/i],[m,[v,"LG"],[g,S]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[v,"LG"],m,[g,S]],[/(lg) netcast\.tv/i],[v,m,[g,k]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i,/android.+lg(\-?[\d\w]+)\s+build/i],[m,[v,"LG"],[g,w]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[m,[v,"Lenovo"],[g,S]],[/linux;.+((jolla));/i],[v,m,[g,w]],[/((pebble))app\/[\d\.]+\s/i],[v,m,[g,E]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[v,m,[g,w]],[/crkey/i],[[m,"Chromecast"],[v,"Google"]],[/android.+;\s(glass)\s\d/i],[m,[v,"Google"],[g,E]],[/android.+;\s(pixel c)\s/i],[m,[v,"Google"],[g,S]],[/android.+;\s(pixel xl|pixel)\s/i],[m,[v,"Google"],[g,w]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+)?)\s+build/i],[[m,/_/g," "],[v,"Xiaomi"],[g,w]],[/android.+(mi[\s\-_]*(?:pad)?(?:[\s_]*[\w\s]+)?)\s+build/i],[[m,/_/g," "],[v,"Xiaomi"],[g,S]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[m,[v,"Meizu"],[g,S]],[/android.+a000(1)\s+build/i],[m,[v,"OnePlus"],[g,w]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[m,[v,"RCA"],[g,S]],[/android.+[;\/]\s*(Venue[\d\s]*)\s+build/i],[m,[v,"Dell"],[g,S]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[m,[v,"Verizon"],[g,S]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[v,"Barnes & Noble"],m,[g,S]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[m,[v,"NuVision"],[g,S]],[/android.+[;\/]\s*(zte)?.+(k\d{2})\s+build/i],[[v,"ZTE"],m,[g,S]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[m,[v,"Swiss"],[g,w]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[m,[v,"Swiss"],[g,S]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[m,[v,"Zeki"],[g,S]],[/(android).+[;\/]\s+([YR]\d{2}x?.*)\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(.+)\s+build/i],[[v,"Dragon Touch"],m,[g,S]],[/android.+[;\/]\s*(NS-?.+)\s+build/i],[m,[v,"Insignia"],[g,S]],[/android.+[;\/]\s*((NX|Next)-?.+)\s+build/i],[m,[v,"NextBook"],[g,S]],[/android.+[;\/]\s*(Xtreme\_?)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[v,"Voice"],m,[g,w]],[/android.+[;\/]\s*(LVTEL\-?)?(V1[12])\s+build/i],[[v,"LvTel"],m,[g,w]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[m,[v,"Envizen"],[g,S]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(.*\b)\s+build/i],[v,m,[g,S]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[m,[v,"MachSpeed"],[g,S]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[v,m,[g,S]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[m,[v,"Rotor"],[g,S]],[/android.+(KS(.+))\s+build/i],[m,[v,"Amazon"],[g,S]],[/android.+(Gigaset)[\s\-]+(Q.+)\s+build/i],[v,m,[g,S]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[g,x.lowerize],v,m],[/(android.+)[;\/].+build/i],[m,[v,"Generic"]]],
engine:[[/windows.+\sedge\/([\w\.]+)/i],[y,[h,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[h,y],[/rv\:([\w\.]+).*(gecko)/i],[y,h]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[h,y],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[h,[y,T.str,A.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[h,"Windows"],[y,T.str,A.os.windows.version]],[/\((bb)(10);/i],[[h,"BlackBerry"],y],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[h,y],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[h,"Symbian"],y],[/\((series40);/i],[h],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[h,"Firefox OS"],y],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[h,y],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[h,"Chromium OS"],y],[/(sunos)\s?([\w\.]+\d)*/i],[[h,"Solaris"],y],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[h,y],[/(haiku)\s(\w+)/i],[h,y],[/cfnetwork\/.+darwin/i,/ip[honead]+(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[y,/_/g,"."],[h,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[h,"Mac OS"],[y,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[h,y]]},O=function(e,t){if("object"==typeof e&&(t=e,e=o),!(this instanceof O))return new O(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:s),r=t?x.extend(I,t):I;return this.getBrowser=function(){var e={name:o,version:o};return T.rgx.call(e,n,r.browser),e.major=x.major(e.version),e},this.getCPU=function(){var e={architecture:o};return T.rgx.call(e,n,r.cpu),e},this.getDevice=function(){var e={vendor:o,model:o,type:o};return T.rgx.call(e,n,r.device),e},this.getEngine=function(){var e={name:o,version:o};return T.rgx.call(e,n,r.engine),e},this.getOS=function(){var e={name:o,version:o};return T.rgx.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};O.VERSION=a,O.BROWSER={NAME:h,MAJOR:p,VERSION:y},O.CPU={ARCHITECTURE:b},O.DEVICE={MODEL:m,VENDOR:v,TYPE:g,CONSOLE:_,MOBILE:w,SMARTTV:k,TABLET:S,WEARABLE:E,EMBEDDED:C},O.ENGINE={NAME:h,VERSION:y},O.OS={NAME:h,VERSION:y},typeof t!==u?(typeof e!==u&&e.exports&&(t=e.exports=O),t.UAParser=O):"function"===c&&n(155)?(r=function(){return O}.call(t,n,t,e),!(r!==o&&(e.exports=r))):i&&(i.UAParser=O);var D=i&&(i.jQuery||i.Zepto);if(typeof D!==u){var M=new O;D.ua=M.getResult(),D.ua.get=function(){return M.getUA()},D.ua.set=function(e){M.setUA(e);var t=M.getResult();for(var n in t)D.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";(function(t){function r(e,t){var n=e.split(S);return n.length>1?n.some(function(e){return x.contains(e,t)}):(e=n[0].trim(),i(e,t))}function i(e,n){var r=e.split(k);if(r.length>0&&r.length<=2?void 0:"production"!==t.env.NODE_ENV?_(!1,'the "-" operator expects exactly 2 operands'):_(!1),1===r.length)return o(r[0],n);var i=r[0],a=r[1];return m(i)&&m(a)?void 0:"production"!==t.env.NODE_ENV?_(!1,'operands to the "-" operator must be simple (no modifiers)'):_(!1),o(">="+i,n)&&o("<="+a,n)}function o(e,t){if(e=e.trim(),""===e)return!0;var n=t.split(w),r=f(e),i=r.modifier,o=r.rangeComponents;switch(i){case"<":return a(n,o);case"<=":return s(n,o);case">=":return c(n,o);case">":return u(n,o);case"~":case"~>":return d(n,o);default:return l(n,o)}}function a(e,t){return b(e,t)===-1}function s(e,t){var n=b(e,t);return n===-1||0===n}function l(e,t){return 0===b(e,t)}function c(e,t){var n=b(e,t);return 1===n||0===n}function u(e,t){return 1===b(e,t)}function d(e,t){var n=t.slice(),r=t.slice();r.length>1&&r.pop();var i=r.length-1,o=parseInt(r[i],10);return p(o)&&(r[i]=o+1+""),c(e,n)&&a(e,r)}function f(e){var n=e.split(w),r=n[0].match(E);return r?void 0:"production"!==t.env.NODE_ENV?_(!1,"expected regex to match but it did not"):_(!1),{modifier:r[1],rangeComponents:[r[2]].concat(n.slice(1))}}function p(e){return!isNaN(e)&&isFinite(e)}function m(e){return!f(e).modifier}function h(e,t){for(var n=e.length;n<t;n++)e[n]="0"}function g(e,t){e=e.slice(),t=t.slice(),h(e,t.length);for(var n=0;n<t.length;n++){var r=t[n].match(/^[x*]$/i);if(r&&(t[n]=e[n]="0","*"===r[0]&&n===t.length-1))for(var i=n;i<e.length;i++)e[i]="0"}return h(t,e.length),[e,t]}function v(e,t){var n=e.match(C)[1],r=t.match(C)[1],i=parseInt(n,10),o=parseInt(r,10);return p(i)&&p(o)&&i!==o?y(i,o):y(e,t)}function y(e,n){return typeof e!=typeof n?"production"!==t.env.NODE_ENV?_(!1,'"a" and "b" must be of the same type'):_(!1):void 0,e>n?1:e<n?-1:0}function b(e,t){for(var n=g(e,t),r=n[0],i=n[1],o=0;o<i.length;o++){var a=v(r[o],i[o]);if(a)return a}return 0}var _=n(4),w=/\./,S=/\|\|/,k=/\s+\-\s+/,E=/^(<=|<|=|>=|~>|~|>|)?\s*(.+)/,C=/^(\d*)(.*)/,x={contains:function(e,t){return r(e.trim(),t.trim())}};e.exports=x}).call(t,n(3))},function(e,t,n){"use strict";function r(e,t,n){if(!e)return null;var r={};for(var o in e)i.call(e,o)&&(r[o]=t.call(n,e[o],o,e));return r}var i=Object.prototype.hasOwnProperty;e.exports=r},function(e,t,n){"use strict";function r(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}e.exports=r},function(e,t,n){"use strict";(function(t,r){function i(e){if(!e)return"[empty]";var n=o(e);return n.nodeType===Node.TEXT_NODE?n.textContent:(n instanceof Element?void 0:"production"!==t.env.NODE_ENV?m(!1,"Node must be an Element if it is not a text node."):m(!1),n.innerHTML)}function o(e){if(e.nodeType===Node.TEXT_NODE){var t=e.textContent.length;return document.createTextNode("[text "+t+"]")}for(var n=e.cloneNode(),r=e.childNodes,i=0;i<r.length;i++)n.appendChild(o(r[i]));return n}function a(e){for(var t=e;t;){if(t instanceof Element&&t.hasAttribute("contenteditable"))return i(t);t=t.parentNode}return"Could not find contentEditable parent of node"}function s(e){return null===e.nodeValue?e.childNodes.length:e.nodeValue.length}function l(e,t,n,i,o){if(f(document.documentElement,t)){var a=r.getSelection(),s=e.getAnchorKey(),l=e.getAnchorOffset(),d=e.getFocusKey(),p=e.getFocusOffset(),m=e.getIsBackward();if(!a.extend&&m){var h=s,g=l;s=d,l=p,d=h,p=g,m=!1}var v=s===n&&i<=l&&o>=l,y=d===n&&i<=p&&o>=p;if(v&&y)return a.removeAllRanges(),u(a,t,l-i,e),void c(a,t,p-i,e);if(m){if(y&&(a.removeAllRanges(),u(a,t,p-i,e)),v){var b=a.focusNode,_=a.focusOffset;a.removeAllRanges(),u(a,t,l-i,e),c(a,b,_,e)}}else v&&(a.removeAllRanges(),u(a,t,l-i,e)),y&&c(a,t,p-i,e)}}function c(e,t,n,r){if(e.extend&&f(p(),t))n>s(t)&&d.logSelectionStateFailure({anonymizedDom:a(t),extraParams:JSON.stringify({offset:n}),selectionState:JSON.stringify(r.toJS())}),e.extend(t,n);else{var i=e.getRangeAt(0);i.setEnd(t,n),e.addRange(i.cloneRange())}}function u(e,t,n,r){var i=document.createRange();n>s(t)&&d.logSelectionStateFailure({anonymizedDom:a(t),extraParams:JSON.stringify({offset:n}),selectionState:JSON.stringify(r.toJS())}),i.setStart(t,n),e.addRange(i)}var d=n(160),f=n(70),p=n(71),m=n(4);e.exports=l}).call(t,n(3),n(15))},function(e,t,n){"use strict";e.exports={logSelectionStateFailure:function(){return null}}},function(e,t,n){"use strict";function r(e){return i(e)&&3==e.nodeType}var i=n(162);e.exports=r},function(e,t,n){"use strict";function r(e){var t=e?e.ownerDocument||e:document,n=t.defaultView||window;return!(!e||!("function"==typeof n.Node?e instanceof n.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}e.exports=r},function(e,t,n){"use strict";function r(e){return null==e?e:String(e)}function i(e,t){var n=void 0;if(window.getComputedStyle&&(n=window.getComputedStyle(e,null)))return r(n.getPropertyValue(a(t)));if(document.defaultView&&document.defaultView.getComputedStyle){if(n=document.defaultView.getComputedStyle(e,null))return r(n.getPropertyValue(a(t)));if("display"===t)return"none"}return r(e.currentStyle?"float"===t?e.currentStyle.cssFloat||e.currentStyle.styleFloat:e.currentStyle[o(t)]:e.style&&e.style[o(t)])}var o=n(164),a=n(165);e.exports=i},function(e,t,n){"use strict";function r(e){return e.replace(i,function(e,t){return t.toUpperCase()})}var i=/-(.)/g;e.exports=r},function(e,t,n){"use strict";function r(e){return e.replace(i,"-$1").toLowerCase()}var i=/([A-Z])/g;e.exports=r},function(e,t,n){"use strict";function r(e){var t=i(e);return{x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top}}var i=n(167);e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.ownerDocument.documentElement;if(!("getBoundingClientRect"in e&&i(t,e)))return{left:0,right:0,top:0,bottom:0};var n=e.getBoundingClientRect();return{left:Math.round(n.left)-t.clientLeft,right:Math.round(n.right)-t.clientLeft,top:Math.round(n.top)-t.clientTop,bottom:Math.round(n.bottom)-t.clientTop}}var i=n(70);e.exports=r},function(e,t,n){"use strict";function r(e){return e=e||document,e.scrollingElement?e.scrollingElement:i||"CSS1Compat"!==e.compatMode?e.body:e.documentElement}var i="undefined"!=typeof navigator&&navigator.userAgent.indexOf("AppleWebKit")>-1;e.exports=r},function(e,t,n){"use strict";function r(e){return e.Window&&e instanceof e.Window?{x:e.pageXOffset||e.document.documentElement.scrollLeft,y:e.pageYOffset||e.document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}e.exports=r},function(e,t,n){"use strict";function r(){var e=void 0;return document.documentElement&&(e=document.documentElement.clientWidth),!e&&document.body&&(e=document.body.clientWidth),e||0}function i(){var e=void 0;return document.documentElement&&(e=document.documentElement.clientHeight),!e&&document.body&&(e=document.body.clientHeight),e||0}function o(){return{width:window.innerWidth||r(),height:window.innerHeight||i()}}o.withoutScrollbars=function(){return{width:r(),height:i()}},e.exports=o},function(e,t,n){"use strict";function r(e){e||(e="");var t=void 0,n=arguments.length;if(n>1)for(var r=1;r<n;r++)t=arguments[r],t&&(e=(e?e+" ":"")+t);return e}e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=null,r=null;if("function"==typeof document.caretRangeFromPoint){var i=document.caretRangeFromPoint(e.x,e.y);n=i.startContainer,r=i.startOffset}else{if(!e.rangeParent)return null;n=e.rangeParent,r=e.rangeOffset}n=f(n),r=f(r);var o=f(c(n));return d(t,o,r,o,r)}function i(e,t){var n=s.moveText(e.getCurrentContent(),e.getSelection(),t);return l.push(e,n,"insert-fragment")}function o(e,t,n){var r=s.insertText(e.getCurrentContent(),t,n,e.getCurrentInlineStyle());return l.push(e,r,"insert-fragment")}var a=n(73),s=n(8),l=n(6),c=n(49),u=n(75),d=n(76),f=n(12),p=n(38),m={onDragEnd:function(e){e.exitCurrentMode()},onDrop:function(e,t){var n=new a(t.nativeEvent.dataTransfer),s=e._latestEditorState,l=r(t.nativeEvent,s);if(t.preventDefault(),e.exitCurrentMode(),null!=l){var c=n.getFiles();if(c.length>0){if(e.props.handleDroppedFiles&&p(e.props.handleDroppedFiles(l,c)))return;return void u(c,function(t){t&&e.update(o(s,l,t))})}var d=e._internalDrag?"internal":"external";if(!e.props.handleDrop||!p(e.props.handleDrop(l,n,d)))return e._internalDrag?void e.update(i(s,l)):void e.update(o(s,l,n.getText()))}}};e.exports=m},function(e,t,n){"use strict";function r(e){return e.split("/")}var i={isImage:function(e){return"image"===r(e)[0]},isJpeg:function(e){var t=r(e);return i.isImage(e)&&("jpeg"===t[1]||"pjpeg"===t[1])}};e.exports=i},function(e,t,n){"use strict";(function(t){function r(e){var n=e.length;if(Array.isArray(e)||"object"!=typeof e&&"function"!=typeof e?"production"!==t.env.NODE_ENV?a(!1,"toArray: Array-like object expected"):a(!1):void 0,"number"!=typeof n?"production"!==t.env.NODE_ENV?a(!1,"toArray: Object needs a length property"):a(!1):void 0,0===n||n-1 in e?void 0:"production"!==t.env.NODE_ENV?a(!1,"toArray: Object should have keys for indices"):a(!1),"function"==typeof e.callee?"production"!==t.env.NODE_ENV?a(!1,"toArray: Object can't be `arguments`. Use rest params (function(...args) {}) or Array.from() instead."):a(!1):void 0,e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(e){}for(var r=Array(n),i=0;i<n;i++)r[i]=e[i];return r}function i(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function o(e){return i(e)?Array.isArray(e)?e.slice():r(e):[e]}var a=n(4);e.exports=o}).call(t,n(3))},function(e,t,n){"use strict";var r=n(176),i=n(179),o=n(180),a=n(181),s=n(182),l=n(183),c=n(184),u=n(185),d=n(186),f=n(187),p=n(201),m=n(205),h={onBeforeInput:r,onBlur:i,onCompositionStart:o,onCopy:a,onCut:s,onDragOver:l,onDragStart:c,onFocus:u,onInput:d,onKeyDown:f,onPaste:p,onSelect:m};e.exports=h},function(e,t,n){"use strict";function r(e){return v&&(e==h||e==g)}function i(e,t,n,r){var i=s.replaceText(e.getCurrentContent(),e.getSelection(),t,n,r);return l.push(e,i,"insert-characters")}function o(e,t){void 0!==e._pendingStateFromBeforeInput&&(e.update(e._pendingStateFromBeforeInput),e._pendingStateFromBeforeInput=void 0);var n=e._latestEditorState,o=t.data;if(o){if(e.props.handleBeforeInput&&m(e.props.handleBeforeInput(o,n)))return void t.preventDefault();var s=n.getSelection();if(!s.isCollapsed())return t.preventDefault(),void e.update(i(n,o,n.getCurrentInlineStyle(),u(n.getCurrentContent(),n.getSelection())));var c=!d(n),h=i(n,o,n.getCurrentInlineStyle(),u(n.getCurrentContent(),n.getSelection()));if(!c)return t.preventDefault(),void e.update(h);var g=s.getAnchorKey(),v=n.getBlockTree(g),y=a.getFingerprint(v),b=a.getFingerprint(h.getBlockTree(g));r(o)||y!==b||f(h.getDirectionMap()).get(g)!==f(n.getDirectionMap()).get(g)?(t.preventDefault(),e.update(h)):(h=l.set(h,{nativelyRenderedContent:h.getCurrentContent()}),e._pendingStateFromBeforeInput=h,p(function(){void 0!==e._pendingStateFromBeforeInput&&(e.update(e._pendingStateFromBeforeInput),e._pendingStateFromBeforeInput=void 0)}))}}var a=n(64),s=n(8),l=n(6),c=n(18),u=n(46),d=n(68),f=n(12),p=n(177),m=n(38),h="'",g="/",v=c.isBrowser("Firefox");e.exports=o},function(e,t,n){"use strict";(function(t){n(178),e.exports=t.setImmediate}).call(t,n(15))},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return h[m]=r,p(m),m++}function i(e){delete h[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(g)setTimeout(a,0,e);else{var t=h[e];if(t){g=!0;try{o(t)}finally{i(e),g=!1}}}}function s(){p=function(e){t.nextTick(function(){a(e)})}}function l(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function c(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),p=function(n){e.postMessage(t+n,"*")}}function u(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;a(t)},p=function(t){e.port2.postMessage(t)}}function d(){var e=v.documentElement;p=function(t){var n=v.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function f(){p=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var p,m=1,h={},g=!1,v=e.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e,"[object process]"==={}.toString.call(e.process)?s():l()?c():e.MessageChannel?u():v&&"onreadystatechange"in v.createElement("script")?d():f(),y.setImmediate=r,y.clearImmediate=i}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(t,n(15),n(3))},function(e,t,n){"use strict";(function(t){function r(e,n){s&&a()===document.body&&t.getSelection().removeAllRanges();var r=e._latestEditorState,o=r.getSelection();if(o.getHasFocus()){var l=o.set("hasFocus",!1);e.props.onBlur&&e.props.onBlur(n),e.update(i.acceptSelection(r,l))}}var i=n(6),o=n(18),a=n(71),s=o.isEngine("WebKit");e.exports=r}).call(t,n(15))},function(e,t,n){"use strict";function r(e,t){e.setMode("composite"),e.update(i.set(e._latestEditorState,{inCompositionMode:!0})),e._onCompositionStart(t)}var i=n(6);e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=e._latestEditorState,r=n.getSelection();return r.isCollapsed()?void t.preventDefault():void e.setClipboard(i(e._latestEditorState))}var i=n(77);e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=e._latestEditorState,r=n.getSelection();if(r.isCollapsed())return void t.preventDefault();var o=s.getScrollParent(t.target),a=c(o),u=a.x,d=a.y,f=l(n);e.setClipboard(f),e.setMode("cut"),setTimeout(function(){e.restoreEditorDOM({x:u,y:d}),e.exitCurrentMode(),e.update(i(n))},0)}function i(e){var t=o.removeRange(e.getCurrentContent(),e.getSelection(),"forward");return a.push(e,t,"remove-range")}var o=n(8),a=n(6),s=n(47),l=n(77),c=n(48);e.exports=r},function(e,t,n){"use strict";function r(e,t){e._internalDrag=!1,e.setMode("drag"),t.preventDefault()}e.exports=r},function(e,t,n){"use strict";function r(e){e._internalDrag=!0,e.setMode("drag")}e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=e._latestEditorState,r=n.getSelection();if(!r.getHasFocus()){var o=r.set("hasFocus",!0);e.props.onFocus&&e.props.onFocus(t),e.update(i.forceSelection(n,o))}}var i=n(6);e.exports=r},function(e,t,n){"use strict";(function(t){function r(e){void 0!==e._pendingStateFromBeforeInput&&(e.update(e._pendingStateFromBeforeInput),e._pendingStateFromBeforeInput=void 0);var n=t.getSelection(),r=n.anchorNode,l=n.isCollapsed,p=r.nodeType!==Node.TEXT_NODE,m=r.nodeType!==Node.TEXT_NODE&&r.nodeType!==Node.ELEMENT_NODE;if(i.draft_killswitch_allow_nontextnodes){if(p)return}else if(m)return;if(r.nodeType===Node.TEXT_NODE&&(null!==r.previousSibling||null!==r.nextSibling)){var h=r.parentNode;r.nodeValue=h.textContent;for(var g=h.firstChild;null!==g;g=g.nextSibling)g!==r&&h.removeChild(g)}var v=r.textContent,y=e._latestEditorState,b=u(c(r)),_=a.decode(b),w=_.blockKey,S=_.decoratorKey,k=_.leafKey,E=y.getBlockTree(w).getIn([S,"leaves",k]),C=E.start,x=E.end,T=y.getCurrentContent(),A=T.getBlockForKey(w),I=A.getText().slice(C,x);if(v.endsWith(f)&&(v=v.slice(0,-1)),v!==I){var O,D,M,P,N=y.getSelection(),R=N.merge({anchorOffset:C,focusOffset:x,isBackward:!1}),F=A.getEntityAt(C),B=F&&T.getEntity(F),q=B&&B.getMutability(),L="MUTABLE"===q,j=L?"spellcheck-change":"apply-entity",U=o.replaceText(T,R,v,A.getInlineStyleAt(C),L?A.getEntityAt(C):null);if(d)O=n.anchorOffset,D=n.focusOffset,M=C+Math.min(O,D),P=M+Math.abs(O-D),O=M,D=P;else{var H=v.length-I.length;M=N.getStartOffset(),P=N.getEndOffset(),O=l?P+H:M,D=P+H}var $=U.merge({selectionBefore:T.getSelectionAfter(),selectionAfter:N.merge({anchorOffset:O,focusOffset:D})});e.update(s.push(y,$,j))}}var i=n(61),o=n(8),a=n(37),s=n(6),l=n(18),c=n(49),u=n(12),d=l.isEngine("Gecko"),f="\n\n";e.exports=r}).call(t,n(15))},function(e,t,n){"use strict";function r(e,t){switch(e){case"redo":return a.redo(t);case"delete":return g(t);case"delete-word":return p(t);case"backspace":return h(t);case"backspace-word":return f(t);case"backspace-to-start-of-line":return d(t);case"split-block":return m(t);case"transpose-characters":return b(t);case"move-selection-to-start-of-block":return y(t);case"move-selection-to-end-of-block":return v(t);case"secondary-cut":return c.cut(t);case"secondary-paste":return c.paste(t);default:return t}}function i(e,t){var n=t.which,i=e._latestEditorState;switch(n){case l.RETURN:if(t.preventDefault(),e.props.handleReturn&&w(e.props.handleReturn(t,i)))return;break;case l.ESC:return t.preventDefault(),void(e.props.onEscape&&e.props.onEscape(t));case l.TAB:return void(e.props.onTab&&e.props.onTab(t));case l.UP:return void(e.props.onUpArrow&&e.props.onUpArrow(t));case l.DOWN:return void(e.props.onDownArrow&&e.props.onDownArrow(t));case l.SPACE:if(k&&S(t)){t.preventDefault();var s=o.replaceText(i.getCurrentContent(),i.getSelection()," ");return void e.update(a.push(i,s,"insert-characters"))}}var c=e.props.keyBindingFn(t);if(c){if("undo"===c)return void _(t,i,e.update);if(t.preventDefault(),!e.props.handleKeyCommand||!w(e.props.handleKeyCommand(c,i))){var u=r(c,i);u!==i&&e.update(u)}}}var o=n(8),a=n(6),s=n(50),l=n(45),c=n(188),u=n(18),d=n(189),f=n(191),p=n(193),m=n(194),h=n(195),g=n(196),v=n(197),y=n(198),b=n(199),_=n(200),w=n(38),S=s.isOptionKeyCommand,k=u.isBrowser("Chrome");e.exports=i},function(e,t,n){"use strict";var r=n(8),i=n(6),o=n(35),a=n(12),s=null,l={cut:function(e){var t=e.getCurrentContent(),n=e.getSelection(),l=null;if(n.isCollapsed()){var c=n.getAnchorKey(),u=t.getBlockForKey(c).getLength();if(u===n.getAnchorOffset())return e;l=n.set("focusOffset",u)}else l=n;l=a(l),s=o(t,l);var d=r.removeRange(t,l,"forward");return d===t?e:i.push(e,d,"remove-range")},paste:function(e){if(!s)return e;var t=r.replaceWithFragment(e.getCurrentContent(),e.getSelection(),s);return i.push(e,t,"insert-fragment")}};e.exports=l},function(e,t,n){"use strict";(function(t){function r(e){var n=l(e,function(e){var n=e.getSelection();if(n.isCollapsed()&&0===n.getAnchorOffset())return s(e,1);var r=t.getSelection(),i=r.getRangeAt(0);return i=o(i),a(e,null,i.endContainer,i.endOffset,i.startContainer,i.startOffset).selectionState},"backward");return n===e.getCurrentContent()?e:i.push(e,n,"remove-range")}var i=n(6),o=n(190),a=n(79),s=n(51),l=n(30);e.exports=r}).call(t,n(15))},function(e,t,n){"use strict";(function(t){function r(e){var n=getComputedStyle(e),r=document.createElement("div");r.style.fontFamily=n.fontFamily,r.style.fontSize=n.fontSize,r.style.fontStyle=n.fontStyle,r.style.fontWeight=n.fontWeight,r.style.lineHeight=n.lineHeight,r.style.position="absolute",r.textContent="M";var i=document.body;i?void 0:"production"!==t.env.NODE_ENV?c(!1,"Missing document.body"):c(!1),i.appendChild(r);var o=r.getBoundingClientRect();return i.removeChild(r),o.height}function i(e,t){for(var n=1/0,r=1/0,i=-(1/0),o=-(1/0),a=0;a<e.length;a++){var s=e[a];0!==s.width&&1!==s.width&&(n=Math.min(n,s.top),r=Math.min(r,s.bottom),i=Math.max(i,s.top),o=Math.max(o,s.bottom))}return i<=r&&i-n<t&&o-r<t}function o(e){switch(e.nodeType){case Node.DOCUMENT_TYPE_NODE:return 0;case Node.TEXT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.COMMENT_NODE:return e.length;default:return e.childNodes.length}}function a(e){e.collapsed?void 0:"production"!==t.env.NODE_ENV?c(!1,"expandRangeToStartOfLine: Provided range is not collapsed."):c(!1),e=e.cloneRange();var n=e.startContainer;1!==n.nodeType&&(n=n.parentNode);var a=r(n),u=e.endContainer,d=e.endOffset;for(e.setStart(e.startContainer,0);i(l(e),a)&&(u=e.startContainer,d=e.startOffset,u.parentNode?void 0:"production"!==t.env.NODE_ENV?c(!1,"Found unexpected detached subtree when traversing."):c(!1),e.setStartBefore(u),1!==u.nodeType||"inline"===getComputedStyle(u).display););for(var f=u,p=d-1;;){for(var m=f.nodeValue,h=p;h>=0;h--)if(!(null!=m&&h>0&&s.isSurrogatePair(m,h-1))){if(e.setStart(f,h),!i(l(e),a))break;u=f,d=h}if(h===-1||0===f.childNodes.length)break;f=f.childNodes[h],p=o(f)}return e.setStart(u,d),e}var s=n(22),l=n(78),c=n(4);e.exports=a}).call(t,n(3))},function(e,t,n){"use strict";function r(e){var t=s(e,function(e){var t=e.getSelection(),n=t.getStartOffset();if(0===n)return a(e,1);var r=t.getStartKey(),o=e.getCurrentContent(),s=o.getBlockForKey(r).getText().slice(0,n),l=i.getBackward(s);return a(e,l.length||1)},"backward");return t===e.getCurrentContent()?e:o.push(e,t,"remove-range")}var i=n(80),o=n(6),a=n(51),s=n(30);e.exports=r},function(e,t,n){"use strict";var r="[.,+*?$|#{}()'\\^\\-\\[\\]\\\\\\/!@%\"~=<>_:;・、。〈-】〔-〟：-？！-／［-｀｛-･⸮؟٪-٬؛،؍﴾﴿᠁।၊။‐-‧‰-⁞¡-±´-¸º»¿]";e.exports={getPunctuation:function(){return r}}},function(e,t,n){"use strict";function r(e){var t=s(e,function(e){var t=e.getSelection(),n=t.getStartOffset(),r=t.getStartKey(),o=e.getCurrentContent(),s=o.getBlockForKey(r).getText().slice(n),l=i.getForward(s);return a(e,l.length||1)},"forward");return t===e.getCurrentContent()?e:o.push(e,t,"remove-range")}var i=n(80),o=n(6),a=n(81),s=n(30);e.exports=r},function(e,t,n){"use strict";function r(e){var t=i.splitBlock(e.getCurrentContent(),e.getSelection());return o.push(e,t,"split-block")}var i=n(8),o=n(6);e.exports=r},function(e,t,n){"use strict";function r(e){var t=s(e,function(e){var t=e.getSelection(),n=e.getCurrentContent(),r=t.getAnchorKey(),i=t.getAnchorOffset(),s=n.getBlockForKey(r).getText()[i-1];return a(e,s?o.getUTF16Length(s,0):1)},"backward");if(t===e.getCurrentContent())return e;var n=e.getSelection();return i.push(e,t.set("selectionBefore",n),n.isCollapsed()?"backspace-character":"remove-range")}var i=n(6),o=n(22),a=n(51),s=n(30);e.exports=r},function(e,t,n){"use strict";function r(e){var t=s(e,function(e){var t=e.getSelection(),n=e.getCurrentContent(),r=t.getAnchorKey(),i=t.getAnchorOffset(),s=n.getBlockForKey(r).getText()[i];return a(e,s?o.getUTF16Length(s,0):1)},"forward");if(t===e.getCurrentContent())return e;var n=e.getSelection();return i.push(e,t.set("selectionBefore",n),n.isCollapsed()?"delete-character":"remove-range")}var i=n(6),o=n(22),a=n(81),s=n(30);e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.getSelection(),n=t.getEndKey(),r=e.getCurrentContent(),o=r.getBlockForKey(n).getLength();return i.set(e,{selection:t.merge({anchorKey:n,anchorOffset:o,focusKey:n,focusOffset:o,isBackward:!1}),forceSelection:!0})}var i=n(6);e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.getSelection(),n=t.getStartKey();return i.set(e,{selection:t.merge({anchorKey:n,anchorOffset:0,focusKey:n,focusOffset:0,isBackward:!1}),forceSelection:!0})}var i=n(6);e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.getSelection();if(!t.isCollapsed())return e;var n=t.getAnchorOffset();if(0===n)return e;var r=t.getAnchorKey(),s=e.getCurrentContent(),l=s.getBlockForKey(r),c=l.getLength();if(c<=1)return e;var u,d;n===c?(u=t.set("anchorOffset",n-1),d=t):(u=t.set("focusOffset",n+1),d=u.set("anchorOffset",n+1));var f=a(s,u),p=i.removeRange(s,u,"backward"),m=p.getSelectionAfter(),h=m.getAnchorOffset()-1,g=m.merge({anchorOffset:h,focusOffset:h}),v=i.replaceWithFragment(p,g,f),y=o.push(e,v,"insert-fragment");return o.acceptSelection(y,d)}var i=n(8),o=n(6),a=n(35);e.exports=r},function(e,t,n){"use strict";function r(e,t,n){var r=i.undo(t);if("spellcheck-change"===t.getLastChangeType()){var o=r.getCurrentContent();return void n(i.set(r,{nativelyRenderedContent:o}))}return e.preventDefault(),t.getNativelyRenderedContent()?(n(i.set(t,{nativelyRenderedContent:null})),void setTimeout(function(){n(r)},0)):void n(r)}var i=n(6);e.exports=r},function(e,t,n){"use strict";function r(e,t){t.preventDefault();var n=new l(t.clipboardData);if(!n.isRichText()){var r=n.getFiles(),g=n.getText();if(r.length>0){if(e.props.handlePastedFiles&&m(e.props.handlePastedFiles(r)))return;return void p(r,function(t){if(t=t||g){var n=e._latestEditorState,r=h(t),i=s.create({style:n.getCurrentInlineStyle(),entity:f(n.getCurrentContent(),n.getSelection())}),o=u.processText(r,i),l=a.createFromArray(o),p=c.replaceWithFragment(n.getCurrentContent(),n.getSelection(),l);e.update(d.push(n,p,"insert-fragment"))}})}}var v=[],y=n.getText(),b=n.getHTML(),_=e._latestEditorState;if(!e.props.handlePastedText||!m(e.props.handlePastedText(y,b,_))){if(y&&(v=h(y)),!e.props.stripPastedStyles){var w=e.getClipboard();if(n.isRichText()&&w){if(b.indexOf(e.getEditorKey())!==-1||1===v.length&&1===w.size&&w.first().getText()===y)return void e.update(i(e._latestEditorState,w))}else if(w&&n.types.includes("com.apple.webarchive")&&!n.types.includes("text/html")&&o(v,w))return void e.update(i(e._latestEditorState,w));if(b){var S=u.processHTML(b,e.props.blockRenderMap);if(S){var k=S.contentBlocks,E=S.entityMap;if(k){var C=a.createFromArray(k);return void e.update(i(e._latestEditorState,C,E))}}}e.setClipboard(null)}if(v.length){var x=s.create({style:_.getCurrentInlineStyle(),entity:f(_.getCurrentContent(),_.getSelection())}),T=u.processText(v,x),A=a.createFromArray(T);e.update(i(e._latestEditorState,A))}}}function i(e,t,n){var r=c.replaceWithFragment(e.getCurrentContent(),e.getSelection(),t);return d.push(e,r.set("entityMap",n),"insert-fragment")}function o(e,t){return e.length===t.size&&t.valueSeq().every(function(t,n){return t.getText()===e[n]})}var a=n(27),s=n(14),l=n(73),c=n(8),u=n(202),d=n(6),f=n(46),p=n(75),m=n(38),h=n(204);e.exports=r},function(e,t,n){"use strict";var r=(n(14),n(21)),i=n(5),o=n(82),a=n(16),s=n(83),l=n(42),c=i.List,u=i.Repeat,d={processHTML:function(e,t){return o(e,s,t)},processText:function(e,t){return e.map(function(e){return e=l(e),new r({key:a(),type:"unstyled",text:e,characterList:c(u(t,e.length))})})}};e.exports=d},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(t){r(this,e),this._uri=t}return e.prototype.toString=function(){return this._uri},e}();e.exports=i},function(e,t,n){"use strict";function r(e){return e.split(i)}var i=/\r\n?|\n/g;e.exports=r},function(e,t,n){"use strict";(function(t){function r(e){if(!e._blockSelectEvents&&e._latestEditorState===e.props.editorState){var n=e.props.editorState,r=o.findDOMNode(e.refs.editorContainer);r?void 0:"production"!==t.env.NODE_ENV?s(!1,"Missing editorNode"):s(!1),r.firstChild instanceof HTMLElement?void 0:"production"!==t.env.NODE_ENV?s(!1,"editorNode.firstChild is not an HTMLElement"):s(!1);var l=a(n,r.firstChild),c=l.selectionState;c!==n.getSelection()&&(n=l.needsRecovery?i.forceSelection(n,c):i.acceptSelection(n,c),e.update(n))}}var i=n(6),o=n(17),a=n(206),s=n(4);e.exports=r}).call(t,n(3))},function(e,t,n){"use strict";(function(t){function r(e,n){var r=t.getSelection();return 0===r.rangeCount?{selectionState:e.getSelection().set("hasFocus",!1),needsRecovery:!1}:i(e,n,r.anchorNode,r.anchorOffset,r.focusNode,r.focusOffset)}var i=n(79);e.exports=r}).call(t,n(15))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(0),s=n(29),l=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return o(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.text!==e.text||this.props.editorState.getSelection().getHasFocus()!==e.editorState.getSelection().getHasFocus()},t.prototype.render=function(){var e=this.props.editorState.getSelection().getHasFocus(),t=s({"public/DraftEditorPlaceholder/root":!0,"public/DraftEditorPlaceholder/hasFocus":e});return a.createElement("div",{className:t},a.createElement("div",{className:s("public/DraftEditorPlaceholder/inner"),id:this.props.accessibilityID
},this.props.text))},t}(a.Component);e.exports=l},function(e,t,n){"use strict";var r=n(8),i=n(6),o=(n(28),n(209)),a=n(12),s={currentBlockContainsLink:function(e){var t=e.getSelection(),n=e.getCurrentContent(),r=n.getEntityMap();return n.getBlockForKey(t.getAnchorKey()).getCharacterList().slice(t.getStartOffset(),t.getEndOffset()).some(function(e){var t=e.getEntity();return!!t&&"LINK"===r.__get(t).getType()})},getCurrentBlockType:function(e){var t=e.getSelection();return e.getCurrentContent().getBlockForKey(t.getStartKey()).getType()},getDataObjectForLinkURL:function(e){return{url:e.toString()}},handleKeyCommand:function(e,t){switch(t){case"bold":return s.toggleInlineStyle(e,"BOLD");case"italic":return s.toggleInlineStyle(e,"ITALIC");case"underline":return s.toggleInlineStyle(e,"UNDERLINE");case"code":return s.toggleCode(e);case"backspace":case"backspace-word":case"backspace-to-start-of-line":return s.onBackspace(e);case"delete":case"delete-word":case"delete-to-end-of-block":return s.onDelete(e);default:return null}},insertSoftNewline:function(e){var t=r.insertText(e.getCurrentContent(),e.getSelection(),"\n",e.getCurrentInlineStyle(),null),n=i.push(e,t,"insert-characters");return i.forceSelection(n,t.getSelectionAfter())},onBackspace:function(e){var t=e.getSelection();if(!t.isCollapsed()||t.getAnchorOffset()||t.getFocusOffset())return null;var n=e.getCurrentContent(),r=t.getStartKey(),o=n.getBlockBefore(r);if(o&&"atomic"===o.getType()){var a=n.getBlockMap().delete(o.getKey()),l=n.merge({blockMap:a,selectionAfter:t});if(l!==n)return i.push(e,l,"remove-range")}var c=s.tryToRemoveBlockStyle(e);return c?i.push(e,c,"change-block-type"):null},onDelete:function(e){var t=e.getSelection();if(!t.isCollapsed())return null;var n=e.getCurrentContent(),o=t.getStartKey(),a=n.getBlockForKey(o),s=a.getLength();if(t.getStartOffset()<s)return null;var l=n.getBlockAfter(o);if(!l||"atomic"!==l.getType())return null;var c=t.merge({focusKey:l.getKey(),focusOffset:l.getLength()}),u=r.removeRange(n,c,"forward");return u!==n?i.push(e,u,"remove-range"):null},onTab:function(e,t,n){var r=t.getSelection(),a=r.getAnchorKey();if(a!==r.getFocusKey())return t;var s=t.getCurrentContent(),l=s.getBlockForKey(a),c=l.getType();if("unordered-list-item"!==c&&"ordered-list-item"!==c)return t;e.preventDefault();var u=s.getBlockBefore(a);if(!u)return t;var d=u.getType();if("unordered-list-item"!==d&&"ordered-list-item"!==d)return t;var f=l.getDepth();if(!e.shiftKey&&f===n)return t;n=Math.min(u.getDepth()+1,n);var p=o(s,r,e.shiftKey?-1:1,n);return i.push(t,p,"adjust-depth")},toggleBlockType:function(e,t){var n=e.getSelection(),o=n.getStartKey(),s=n.getEndKey(),l=e.getCurrentContent(),c=n;if(o!==s&&0===n.getEndOffset()){var u=a(l.getBlockBefore(s));s=u.getKey(),c=c.merge({anchorKey:o,anchorOffset:n.getStartOffset(),focusKey:s,focusOffset:u.getLength(),isBackward:!1})}var d=l.getBlockMap().skipWhile(function(e,t){return t!==o}).reverse().skipWhile(function(e,t){return t!==s}).some(function(e){return"atomic"===e.getType()});if(d)return e;var f=l.getBlockForKey(o).getType()===t?"unstyled":t;return i.push(e,r.setBlockType(l,c,f),"change-block-type")},toggleCode:function(e){var t=e.getSelection(),n=t.getAnchorKey(),r=t.getFocusKey();return t.isCollapsed()||n!==r?s.toggleBlockType(e,"code-block"):s.toggleInlineStyle(e,"CODE")},toggleInlineStyle:function(e,t){var n=e.getSelection(),o=e.getCurrentInlineStyle();if(n.isCollapsed())return i.setInlineStyleOverride(e,o.has(t)?o.remove(t):o.add(t));var a,s=e.getCurrentContent();return a=o.has(t)?r.removeInlineStyle(s,n,t):r.applyInlineStyle(s,n,t),i.push(e,a,"change-inline-style")},toggleLink:function(e,t,n){var o=r.applyEntity(e.getCurrentContent(),t,n);return i.push(e,o,"apply-entity")},tryToRemoveBlockStyle:function(e){var t=e.getSelection(),n=t.getAnchorOffset();if(t.isCollapsed()&&0===n){var i=t.getAnchorKey(),o=e.getCurrentContent(),a=o.getBlockForKey(i);if(a.getLength()>0)return null;var s=a.getType(),l=o.getBlockBefore(i);if("code-block"===s&&l&&"code-block"===l.getType())return null;if("unstyled"!==s)return r.setBlockType(o,t,"unstyled")}return null}};e.exports=s},function(e,t,n){"use strict";function r(e,t,n,r){var i=t.getStartKey(),o=t.getEndKey(),a=e.getBlockMap(),s=a.toSeq().skipUntil(function(e,t){return t===i}).takeUntil(function(e,t){return t===o}).concat([[o,a.get(o)]]).map(function(e){var t=e.getDepth()+n;return t=Math.max(0,Math.min(t,r)),e.set("depth",t)});return a=a.merge(s),e.merge({blockMap:a,selectionBefore:t,selectionAfter:t})}e.exports=r},function(e,t,n){"use strict";function r(e){var t=0,n={},r=[];e.getBlockMap().forEach(function(e,s){e.findEntityRanges(function(e){return null!==e.getEntity()},function(r){var o=i.stringify(e.getEntityAt(r));n.hasOwnProperty(o)||(n[o]=""+t++)}),r.push({key:s,text:e.getText(),type:e.getType(),depth:e.getDepth(),inlineStyleRanges:a(e),entityRanges:o(e,n),data:e.getData().toObject()})});var s=Object.keys(n),l={};return s.forEach(function(t,n){var r=e.getEntity(i.unstringify(t));l[n]={type:r.getType(),mutability:r.getMutability(),data:r.getData()}}),{entityMap:l,blocks:r}}var i=n(85),o=n(211),a=n(212);e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=[];return e.findEntityRanges(function(e){return!!e.getEntity()},function(r,o){var s=e.getText(),l=e.getEntityAt(r);n.push({offset:a(s.slice(0,r)),length:a(s.slice(r,o)),key:Number(t[i.stringify(l)])})}),n}var i=n(85),o=n(22),a=o.strlen;e.exports=r},function(e,t,n){"use strict";function r(e,t,n){var r=[],i=t.map(function(e){return e.has(n)}).toList();return a(i,s,l,function(t,i){var a=e.getText();r.push({offset:o.strlen(a.slice(0,t)),length:o.strlen(a.slice(t,i)),style:n})}),r}function i(e){var t=e.getCharacterList().map(function(e){return e.getStyle()}).toList(),n=t.flatten().toSet().map(function(n){return r(e,t,n)});return Array.prototype.concat.apply(c,n.toJS())}var o=n(22),a=n(34),s=function(e,t){return e===t},l=function(e){return!!e},c=[];e.exports=i},function(e,t,n){"use strict";function r(e){var t=e.blocks,n=e.entityMap,r={};Object.keys(n).forEach(function(e){var t=n[e],i=t.type,o=t.mutability,a=t.data,s=l.__create(i,o,a||{});r[e]=s});var i=t.map(function(e){var t=e.key,n=e.type,i=e.text,s=e.depth,l=e.inlineStyleRanges,p=e.entityRanges,h=e.data;t=t||f(),n=n||"unstyled",s=s||0,l=l||[],p=p||[],h=m(h);var g=d(i,l),v=p.filter(function(e){return r.hasOwnProperty(e.key)}).map(function(e){return o({},e,{key:r[e.key]})}),y=u(i,v),b=c(g,y);return new a({key:t,type:n,text:i,depth:s,characterList:b,data:h})});return s.createFromBlockArray(i)}var i=n(20),o=i||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(21),s=n(41),l=n(36),c=n(214),u=n(215),d=n(216),f=n(16),p=n(5),m=p.Map;e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=e.map(function(e,n){var r=t[n];return i.create({style:e,entity:r})});return a(n)}var i=n(14),o=n(5),a=o.List;e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=Array(e.length).fill(null);return t&&t.forEach(function(t){for(var r=o(e,0,t.offset).length,i=r+o(e,t.offset,t.length).length,a=r;a<i;a++)n[a]=t.key}),n}var i=n(22),o=i.substr;e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=Array(e.length).fill(l);return t&&t.forEach(function(t){for(var r=s(e,0,t.offset).length,i=r+s(e,t.offset,t.length).length;r<i;)n[r]=n[r].add(t.style),r++}),n}var i=n(22),o=n(5),a=o.OrderedSet,s=i.substr,l=a();e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.getSelection();if(!t.rangeCount)return null;var n=t.getRangeAt(0),r=i(n),o=r.top,a=r.right,s=r.bottom,l=r.left;return 0===o&&0===a&&0===s&&0===l?null:r}var i=n(218);e.exports=r},function(e,t,n){"use strict";function r(e){var t=i(e),n=0,r=0,o=0,a=0;if(t.length){if(t.length>1&&0===t[0].width){var s=t[1];n=s.top,r=s.right,o=s.bottom,a=s.left}else{var l=t[0];n=l.top,r=l.right,o=l.bottom,a=l.left}for(var c=1;c<t.length;c++){var u=t[c];0!==u.height&&0!==u.width&&(n=Math.min(n,u.top),r=Math.max(r,u.right),o=Math.max(o,u.bottom),a=Math.min(a,u.left))}}return{top:n,right:r,bottom:o,left:a,width:r-a,height:o-n}}var i=n(78);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(87),c=r(l),u=n(88),d=r(u);n(220);var f=function(e){return e.avatarUrl||e.name?null:new Error("Avatar requires either an avatarUrl or a name")},p=function(e){var t=e.avatarUrl,n=e.className,r=void 0===n?"":n,i=e.name,o=e.id;return s.default.createElement("span",{className:"avatar "+r,role:"presentation"},t?s.default.createElement(c.default,{url:t}):s.default.createElement(d.default,{id:o,name:i}))};p.displayName="Avatar",p.propTypes={avatarUrl:f,className:o.default.string,id:o.default.oneOfType([o.default.string,o.default.number]),name:f},t.default=p},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(7),m=r(p),h=n(31),g=r(h),v=n(33),y=r(v),b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w=function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.setButtonRef=function(e){r.btnElement=e},r.handleClick=function(e){var t=r.props,n=t.isDisabled,i=t.onClick;return n||r.btnElement.classList.contains("is-disabled")?(e.preventDefault(),void e.stopPropagation()):void(i&&i(e))},i=n,a(r,i)}return s(t,e),_(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=void 0===n?"":n,o=e.isDisabled,a=e.isLoading,s=void 0!==a&&a,l=e.isSelected,c=e.type,u=void 0===c?"submit":c,d=i(e,["children","className","isDisabled","isLoading","isSelected","type"]),p=(0,g.default)(d,["onClick"]);o&&(p["aria-disabled"]=!0);var h=(0,m.default)("btn",{"is-disabled":o,"is-loading":s,"is-selected":l},r);return f.default.createElement("button",b({className:h,type:u,onClick:this.handleClick,ref:this.setButtonRef},p),f.default.createElement("span",{className:"btn-content"},t),s&&f.default.createElement(y.default,{className:"btn-loading-indicator"}))}}]),t}(d.Component);w.propTypes={children:u.default.node,className:u.default.string,isDisabled:u.default.bool,isLoading:u.default.bool,isSelected:u.default.bool,onClick:u.default.func,type:u.default.oneOf(["button","reset","submit"])},t.default=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(223),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(224),u=r(c);n(230);var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(e){var t=e.className,n=void 0===t?"":t,r=e.description,o=e.fieldLabel,a=void 0===o?"":o,s=e.hideLabel,c=e.id,f=e.isChecked,p=e.isDisabled,m=e.label,h=e.name,g=e.onChange,v=e.subsection,y=e.tooltip,b=i(e,["className","description","fieldLabel","hideLabel","id","isChecked","isDisabled","label","name","onChange","subsection","tooltip"]),_=l.default.createElement("label",{className:"checkbox-label"},l.default.createElement("input",d({id:c,disabled:p,name:h,onChange:g,type:"checkbox",checked:f},b)),l.default.createElement("span",null),l.default.createElement("span",{className:s?"accessibility-hidden":""},m));return l.default.createElement("div",{className:"checkbox-container "+n+" "+(p?"is-disabled":"")},a&&l.default.createElement("div",{className:"label"},a),y?l.default.createElement(u.default,{label:_,tooltip:y}):_,r?l.default.createElement("div",{className:"checkbox-description"},r):null,v?l.default.createElement("div",{className:"checkbox-subsection"},v):null)};f.propTypes={className:a.default.string,description:a.default.node,fieldLabel:a.default.node,hideLabel:a.default.bool,id:a.default.string,isChecked:a.default.bool,isDisabled:a.default.bool,label:a.default.node.isRequired,name:a.default.string.isRequired,onChange:a.default.func,subsection:a.default.node,tooltip:a.default.string},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(2),c=n(89),u=r(c),d=n(10),f=r(d),p=(0,l.defineMessages)({checkboxTooltipIconInfoText:{id:"boxui.checkboxTooltip.iconInfoText",defaultMessage:"Info"}}),m=function(e){var t=e.label,n=e.tooltip;return s.default.createElement("div",{className:"checkbox-tooltip-wrapper"},t,s.default.createElement(f.default,{text:n},s.default.createElement("div",{className:"info-tooltip"},s.default.createElement(u.default,{height:16,width:16,title:s.default.createElement(l.FormattedMessage,p.checkboxTooltipIconInfoText)}))))};m.displayName="CheckboxTooltip",m.propTypes={label:o.default.node.isRequired,tooltip:o.default.string.isRequired},t.default=m},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(7),m=r(p),h=n(26),g=r(h),v=n(90),y=r(v);n(229);var b,_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w="bottom-center",S="bottom-left",k="bottom-right",E="middle-left",C="middle-right",x="top-center",T="top-left",A="top-right",I="default",O="error",D=(b={},s(b,w,{attachment:"top center",targetAttachment:"bottom center"}),s(b,S,{attachment:"top right",targetAttachment:"bottom right"}),s(b,k,{attachment:"top left",targetAttachment:"bottom left"}),s(b,E,{attachment:"middle right",targetAttachment:"middle left"}),s(b,C,{attachment:"middle left",targetAttachment:"middle right"}),s(b,x,{attachment:"bottom center",targetAttachment:"top center"}),s(b,T,{attachment:"bottom right",targetAttachment:"top right"}),s(b,A,{attachment:"bottom left",targetAttachment:"top left"}),b),M=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.tooltipID=(0,g.default)("tooltip"),n.fireChildEvent=function(e,t){var r=n.props.children.props[e];r&&r(t)},n.handleMouseEnter=function(e){n.setState({isShown:!0}),n.fireChildEvent("onMouseEnter",e)},n.handleMouseLeave=function(e){n.setState({isShown:!1}),n.fireChildEvent("onMouseLeave",e)},n.handleFocus=function(e){n.setState({isShown:!0}),n.fireChildEvent("onFocus",e)},n.handleBlur=function(e){n.setState({isShown:!1}),n.fireChildEvent("onBlur",e)},n.handleKeyDown=function(e){"Escape"===e.key&&n.setState({isShown:!1}),n.fireChildEvent("onKeyDown",e)},n.state={isShown:!!e.isShown},n}return a(t,e),_(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.constrainToScrollParent,i=e.constrainToWindow,o=e.isShown,a=e.position,s=e.text,l=e.theme,c=(0,m.default)("tooltip",n,{"is-error":l===O}),u="undefined"!=typeof o,p=u?o:this.state.isShown,h=D[a],g=[],v={};return r&&g.push({to:"scrollParent",attachment:"together"}),i&&g.push({to:"window",attachment:"together"}),p&&(v["aria-describedby"]=this.tooltipID),u||(v.onBlur=this.handleBlur,v.onFocus=this.handleFocus,v.onKeyDown=this.handleKeyDown,v.onMouseEnter=this.handleMouseEnter,v.onMouseLeave=this.handleMouseLeave,v.tabIndex="0"),f.default.createElement(y.default,{attachment:h.attachment,classPrefix:"tooltip",constraints:g,enabled:p,targetAttachment:h.targetAttachment},(0,d.cloneElement)(d.Children.only(t),v),p&&f.default.createElement("div",{className:c,id:this.tooltipID,role:"tooltip"},s))}}]),t}(d.Component);M.propTypes={children:u.default.element.isRequired,className:u.default.string,constrainToScrollParent:u.default.bool.isRequired,constrainToWindow:u.default.bool.isRequired,isShown:u.default.bool,position:u.default.oneOf([w,S,k,E,C,x,T,A]).isRequired,text:u.default.node.isRequired,theme:u.default.oneOf([I,O]).isRequired},M.defaultProps={constrainToScrollParent:!1,constrainToWindow:!0,position:x,theme:I},t.default=M},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),d=(r(u),n(1)),f=r(d),p=n(17),m=r(p),h=n(228),g=r(h);g.default||console.error("It looks like Tether has not been included. Please load this dependency first https://github.com/HubSpot/tether");var v=[f.default.string,f.default.shape({appendChild:f.default.func.isRequired})],y=function(e,t,n){var r=e.children,i=u.Children.count(r);return i<=0?new Error(n+" expects at least one child to use as the target element."):i>2?new Error("Only a max of two children allowed in "+n+"."):void 0},b=["auto auto","top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],_=function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r._targetNode=null,r._elementParentNode=null,r._tether=!1,i=n,a(r,i)}return s(t,e),c(t,[{key:"componentDidMount",value:function(){this._targetNode=m.default.findDOMNode(this),this._update()}},{key:"componentDidUpdate",value:function(e){this._targetNode=m.default.findDOMNode(this),this._update()}},{key:"componentWillUnmount",value:function(){this._destroy()}},{key:"getTetherInstance",value:function(){return this._tether}},{key:"disable",value:function(){this._tether.disable()}},{key:"enable",value:function(){this._tether.enable()}},{key:"on",value:function(e,t,n){this._tether.on(e,t,n)}},{key:"once",value:function(e,t,n){this._tether.once(e,t,n)}},{key:"off",value:function(e,t){this._tether.off(e,t)}},{key:"position",value:function(){this._tether.position()}},{key:"_registerEventListeners",value:function(){var e=this,t=arguments;this.on("update",function(){return e.props.onUpdate&&e.props.onUpdate.apply(e,t)}),this.on("repositioned",function(){return e.props.onRepositioned&&e.props.onRepositioned.apply(e,t)})}},{key:"_destroy",value:function(){this._elementParentNode&&(m.default.unmountComponentAtNode(this._elementParentNode),this._elementParentNode.parentNode.removeChild(this._elementParentNode)),this._tether&&this._tether.destroy(),this._elementParentNode=null,this._tether=null}},{key:"_update",value:function(){var e=this,t=this.props,n=t.children,r=t.renderElementTag,i=u.Children.toArray(n)[1];return i?(this._elementParentNode||(this._elementParentNode=document.createElement(r),this._renderNode.appendChild(this._elementParentNode)),void m.default.unstable_renderSubtreeIntoContainer(this,i,this._elementParentNode,function(){e._elementParentNode&&e._updateTether()})):void(this._tether&&this._destroy())}},{key:"_updateTether",value:function(){var e=this,t=this.props,n=(t.children,t.renderElementTag,t.renderElementTo,t.id),r=t.className,o=t.style,a=i(t,["children","renderElementTag","renderElementTo","id","className","style"]),s=l({target:this._targetNode,element:this._elementParentNode},a);n&&(this._elementParentNode.id=n),r&&(this._elementParentNode.className=r),o&&Object.keys(o).forEach(function(t){e._elementParentNode.style[t]=o[t]}),this._tether?this._tether.setOptions(s):(this._tether=new g.default(s),this._registerEventListeners()),this._tether.position()}},{key:"render",value:function(){return u.Children.toArray(this.props.children)[0]}},{key:"_renderNode",get:function(){var e=this.props.renderElementTo;return"string"==typeof e?document.querySelector(e):e||document.body}}]),t}(u.Component);_.propTypes={renderElementTag:f.default.string,renderElementTo:f.default.oneOfType(v),attachment:f.default.oneOf(b).isRequired,targetAttachment:f.default.oneOf(b),offset:f.default.string,targetOffset:f.default.string,targetModifier:f.default.string,enabled:f.default.bool,classes:f.default.object,classPrefix:f.default.string,optimizations:f.default.object,constraints:f.default.array,id:f.default.string,className:f.default.string,style:f.default.object,onUpdate:f.default.func,onRepositioned:f.default.func,children:y},_.defaultProps={renderElementTag:"div",renderElementTo:null},t.default=_,e.exports=t.default},function(e,t,n){var r,i;!function(o,a){r=a,i="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==i&&(e.exports=i))}(this,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=e.getBoundingClientRect(),n={};for(var r in t)n[r]=t[r];if(e.ownerDocument!==document){var o=e.ownerDocument.defaultView.frameElement;if(o){var a=i(o);n.top+=a.top,n.bottom+=a.top,n.left+=a.left,n.right+=a.left}}return n}function o(e){var t=getComputedStyle(e)||{},n=t.position,r=[];if("fixed"===n)return[e];for(var i=e;(i=i.parentNode)&&i&&1===i.nodeType;){var o=void 0;try{o=getComputedStyle(i)}catch(e){}if("undefined"==typeof o||null===o)return r.push(i),r;var a=o,s=a.overflow,l=a.overflowX,c=a.overflowY;/(auto|scroll|overlay)/.test(s+c+l)&&("absolute"!==n||["relative","absolute","fixed"].indexOf(o.position)>=0)&&r.push(i)}return r.push(e.ownerDocument.body),e.ownerDocument!==document&&r.push(e.ownerDocument.defaultView),r}function a(){C&&document.body.removeChild(C),C=null}function s(e){var t=void 0;e===document?(t=document,e=document.documentElement):t=e.ownerDocument;var n=t.documentElement,r=i(e),o=A();return r.top-=o.top,r.left-=o.left,"undefined"==typeof r.width&&(r.width=document.body.scrollWidth-r.left-r.right),"undefined"==typeof r.height&&(r.height=document.body.scrollHeight-r.top-r.bottom),r.top=r.top-n.clientTop,r.left=r.left-n.clientLeft,r.right=t.body.clientWidth-r.width-r.left,r.bottom=t.body.clientHeight-r.height-r.top,r}function l(e){return e.offsetParent||document.documentElement}function c(){if(I)return I;var e=document.createElement("div");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");u(t.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;n===r&&(r=t.clientWidth),document.body.removeChild(t);var i=n-r;return I={width:i,height:i}}function u(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=[];return Array.prototype.push.apply(t,arguments),t.slice(1).forEach(function(t){if(t)for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}),e}function d(e,t){if("undefined"!=typeof e.classList)t.split(" ").forEach(function(t){t.trim()&&e.classList.remove(t)});else{var n=new RegExp("(^| )"+t.split(" ").join("|")+"( |$)","gi"),r=m(e).replace(n," ");h(e,r)}}function f(e,t){if("undefined"!=typeof e.classList)t.split(" ").forEach(function(t){t.trim()&&e.classList.add(t)});else{d(e,t);var n=m(e)+(" "+t);h(e,n)}}function p(e,t){if("undefined"!=typeof e.classList)return e.classList.contains(t);var n=m(e);return new RegExp("(^| )"+t+"( |$)","gi").test(n)}function m(e){return e.className instanceof e.ownerDocument.defaultView.SVGAnimatedString?e.className.baseVal:e.className}function h(e,t){e.setAttribute("class",t)}function g(e,t,n){n.forEach(function(n){t.indexOf(n)===-1&&p(e,n)&&d(e,n)}),t.forEach(function(t){p(e,t)||f(e,t)})}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function y(e,t){var n=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return e+n>=t&&t>=e-n}function b(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():+new Date}function _(){for(var e={top:0,left:0},t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){var n=t.top,r=t.left;"string"==typeof n&&(n=parseFloat(n,10)),"string"==typeof r&&(r=parseFloat(r,10)),e.top+=n,e.left+=r}),e}function w(e,t){return"string"==typeof e.left&&e.left.indexOf("%")!==-1&&(e.left=parseFloat(e.left,10)/100*t.width),"string"==typeof e.top&&e.top.indexOf("%")!==-1&&(e.top=parseFloat(e.top,10)/100*t.height),e}function S(e,t){return"scrollParent"===t?t=e.scrollParents[0]:"window"===t&&(t=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),t===document&&(t=t.documentElement),"undefined"!=typeof t.nodeType&&!function(){var e=t,n=s(t),r=n,i=getComputedStyle(t);if(t=[r.left,r.top,n.width+r.left,n.height+r.top],e.ownerDocument!==document){var o=e.ownerDocument.defaultView;t[0]+=o.pageXOffset,t[1]+=o.pageYOffset,t[2]+=o.pageXOffset,t[3]+=o.pageYOffset}X.forEach(function(e,n){e=e[0].toUpperCase()+e.substr(1),"Top"===e||"Left"===e?t[n]+=parseFloat(i["border"+e+"Width"]):t[n]-=parseFloat(i["border"+e+"Width"])})}(),t}var k=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),E=void 0;"undefined"==typeof E&&(E={modules:[]});var C=null,x=function(){var e=0;return function(){return++e}}(),T={},A=function(){var e=C;e&&document.body.contains(e)||(e=document.createElement("div"),e.setAttribute("data-tether-id",x()),u(e.style,{top:0,left:0,position:"absolute"}),document.body.appendChild(e),C=e);var t=e.getAttribute("data-tether-id");return"undefined"==typeof T[t]&&(T[t]=i(e),D(function(){delete T[t]})),T[t]},I=null,O=[],D=function(e){O.push(e)},M=function(){for(var e=void 0;e=O.pop();)e()},P=function(){function e(){r(this,e)}return k(e,[{key:"on",value:function(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[e]&&(this.bindings[e]=[]),this.bindings[e].push({handler:t,ctx:n,once:r})}},{key:"once",value:function(e,t,n){this.on(e,t,n,!0)}},{key:"off",value:function(e,t){if("undefined"!=typeof this.bindings&&"undefined"!=typeof this.bindings[e])if("undefined"==typeof t)delete this.bindings[e];else for(var n=0;n<this.bindings[e].length;)this.bindings[e][n].handler===t?this.bindings[e].splice(n,1):++n}},{key:"trigger",value:function(e){if("undefined"!=typeof this.bindings&&this.bindings[e]){for(var t=0,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(;t<this.bindings[e].length;){var o=this.bindings[e][t],a=o.handler,s=o.ctx,l=o.once,c=s;"undefined"==typeof c&&(c=this),a.apply(c,r),l?this.bindings[e].splice(t,1):++t}}}}]),e}();E.Utils={getActualBoundingClientRect:i,getScrollParents:o,getBounds:s,getOffsetParent:l,extend:u,addClass:f,removeClass:d,hasClass:p,updateClasses:g,defer:D,flush:M,uniqueId:x,Evented:P,getScrollBarSize:c,removeUtilElements:a};var N=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),R=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return;e=c,t=o,n=a,r=!0,s=c=void 0}};if("undefined"==typeof E)throw new Error("You must include the utils.js file before tether.js");var F=E.Utils,o=F.getScrollParents,s=F.getBounds,l=F.getOffsetParent,u=F.extend,f=F.addClass,d=F.removeClass,g=F.updateClasses,D=F.defer,M=F.flush,c=F.getScrollBarSize,a=F.removeUtilElements,B=function(){
if("undefined"==typeof document)return"";for(var e=document.createElement("div"),t=["transform","WebkitTransform","OTransform","MozTransform","msTransform"],n=0;n<t.length;++n){var r=t[n];if(void 0!==e.style[r])return r}}(),q=[],L=function(){q.forEach(function(e){e.position(!1)}),M()};!function(){var e=null,t=null,n=null,r=function r(){return"undefined"!=typeof t&&t>16?(t=Math.min(t-16,250),void(n=setTimeout(r,250))):void("undefined"!=typeof e&&b()-e<10||(null!=n&&(clearTimeout(n),n=null),e=b(),L(),t=b()-e))};"undefined"!=typeof window&&"undefined"!=typeof window.addEventListener&&["resize","scroll","touchmove"].forEach(function(e){window.addEventListener(e,r)})}();var j={center:"center",left:"right",right:"left"},U={middle:"middle",top:"bottom",bottom:"top"},H={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},$=function(e,t){var n=e.left,r=e.top;return"auto"===n&&(n=j[t.left]),"auto"===r&&(r=U[t.top]),{left:n,top:r}},V=function(e){var t=e.left,n=e.top;return"undefined"!=typeof H[e.left]&&(t=H[e.left]),"undefined"!=typeof H[e.top]&&(n=H[e.top]),{left:t,top:n}},W=function(e){var t=e.split(" "),n=N(t,2),r=n[0],i=n[1];return{top:r,left:i}},K=W,z=function(e){function t(e){var n=this;r(this,t),R(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.position=this.position.bind(this),q.push(this),this.history=[],this.setOptions(e,!1),E.modules.forEach(function(e){"undefined"!=typeof e.initialize&&e.initialize.call(n)}),this.position()}return v(t,e),k(t,[{key:"getClass",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],t=this.options.classes;return"undefined"!=typeof t&&t[e]?this.options.classes[e]:this.options.classPrefix?this.options.classPrefix+"-"+e:e}},{key:"setOptions",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]||arguments[1],r={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"};this.options=u(r,e);var i=this.options,a=i.element,s=i.target,l=i.targetModifier;if(this.element=a,this.target=s,this.targetModifier=l,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),["element","target"].forEach(function(e){if("undefined"==typeof t[e])throw new Error("Tether Error: Both element and target must be defined");"undefined"!=typeof t[e].jquery?t[e]=t[e][0]:"string"==typeof t[e]&&(t[e]=document.querySelector(t[e]))}),f(this.element,this.getClass("element")),this.options.addTargetClasses!==!1&&f(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=K(this.options.targetAttachment),this.attachment=K(this.options.attachment),this.offset=W(this.options.offset),this.targetOffset=W(this.options.targetOffset),"undefined"!=typeof this.scrollParents&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParents=[this.target]:this.scrollParents=o(this.target),this.options.enabled!==!1&&this.enable(n)}},{key:"getTargetBounds",value:function(){if("undefined"==typeof this.targetModifier)return s(this.target);if("visible"===this.targetModifier){if(this.target===document.body)return{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth};var e=s(this.target),t={height:e.height,width:e.width,top:e.top,left:e.left};return t.height=Math.min(t.height,e.height-(pageYOffset-e.top)),t.height=Math.min(t.height,e.height-(e.top+e.height-(pageYOffset+innerHeight))),t.height=Math.min(innerHeight,t.height),t.height-=2,t.width=Math.min(t.width,e.width-(pageXOffset-e.left)),t.width=Math.min(t.width,e.width-(e.left+e.width-(pageXOffset+innerWidth))),t.width=Math.min(innerWidth,t.width),t.width-=2,t.top<pageYOffset&&(t.top=pageYOffset),t.left<pageXOffset&&(t.left=pageXOffset),t}if("scroll-handle"===this.targetModifier){var e=void 0,n=this.target;n===document.body?(n=document.documentElement,e={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):e=s(n);var r=getComputedStyle(n),i=n.scrollWidth>n.clientWidth||[r.overflow,r.overflowX].indexOf("scroll")>=0||this.target!==document.body,o=0;i&&(o=15);var a=e.height-parseFloat(r.borderTopWidth)-parseFloat(r.borderBottomWidth)-o,t={width:15,height:.975*a*(a/n.scrollHeight),left:e.left+e.width-parseFloat(r.borderLeftWidth)-15},l=0;a<408&&this.target===document.body&&(l=-11e-5*Math.pow(a,2)-.00727*a+22.58),this.target!==document.body&&(t.height=Math.max(t.height,24));var c=this.target.scrollTop/(n.scrollHeight-a);return t.top=c*(a-t.height-l)+e.top+parseFloat(r.borderTopWidth),this.target===document.body&&(t.height=Math.max(t.height,24)),t}}},{key:"clearCache",value:function(){this._cache={}}},{key:"cache",value:function(e,t){return"undefined"==typeof this._cache&&(this._cache={}),"undefined"==typeof this._cache[e]&&(this._cache[e]=t.call(this)),this._cache[e]}},{key:"enable",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0];this.options.addTargetClasses!==!1&&f(this.target,this.getClass("enabled")),f(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParents.forEach(function(t){t!==e.target.ownerDocument&&t.addEventListener("scroll",e.position)}),t&&this.position()}},{key:"disable",value:function(){var e=this;d(this.target,this.getClass("enabled")),d(this.element,this.getClass("enabled")),this.enabled=!1,"undefined"!=typeof this.scrollParents&&this.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.position)})}},{key:"destroy",value:function(){var e=this;this.disable(),q.forEach(function(t,n){t===e&&q.splice(n,1)}),0===q.length&&a()}},{key:"updateAttachClasses",value:function(e,t){var n=this;e=e||this.attachment,t=t||this.targetAttachment;var r=["left","top","bottom","right","middle","center"];"undefined"!=typeof this._addAttachClasses&&this._addAttachClasses.length&&this._addAttachClasses.splice(0,this._addAttachClasses.length),"undefined"==typeof this._addAttachClasses&&(this._addAttachClasses=[]);var i=this._addAttachClasses;e.top&&i.push(this.getClass("element-attached")+"-"+e.top),e.left&&i.push(this.getClass("element-attached")+"-"+e.left),t.top&&i.push(this.getClass("target-attached")+"-"+t.top),t.left&&i.push(this.getClass("target-attached")+"-"+t.left);var o=[];r.forEach(function(e){o.push(n.getClass("element-attached")+"-"+e),o.push(n.getClass("target-attached")+"-"+e)}),D(function(){"undefined"!=typeof n._addAttachClasses&&(g(n.element,n._addAttachClasses,o),n.options.addTargetClasses!==!1&&g(n.target,n._addAttachClasses,o),delete n._addAttachClasses)})}},{key:"position",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0];if(this.enabled){this.clearCache();var n=$(this.targetAttachment,this.attachment);this.updateAttachClasses(this.attachment,n);var r=this.cache("element-bounds",function(){return s(e.element)}),i=r.width,o=r.height;if(0===i&&0===o&&"undefined"!=typeof this.lastSize){var a=this.lastSize;i=a.width,o=a.height}else this.lastSize={width:i,height:o};var u=this.cache("target-bounds",function(){return e.getTargetBounds()}),d=u,f=w(V(this.attachment),{width:i,height:o}),p=w(V(n),d),m=w(this.offset,{width:i,height:o}),h=w(this.targetOffset,d);f=_(f,m),p=_(p,h);for(var g=u.left+p.left-f.left,v=u.top+p.top-f.top,y=0;y<E.modules.length;++y){var b=E.modules[y],S=b.position.call(this,{left:g,top:v,targetAttachment:n,targetPos:u,elementPos:r,offset:f,targetOffset:p,manualOffset:m,manualTargetOffset:h,scrollbarSize:T,attachment:this.attachment});if(S===!1)return!1;"undefined"!=typeof S&&"object"==typeof S&&(v=S.top,g=S.left)}var k={page:{top:v,left:g},viewport:{top:v-pageYOffset,bottom:pageYOffset-v-o+innerHeight,left:g-pageXOffset,right:pageXOffset-g-i+innerWidth}},C=this.target.ownerDocument,x=C.defaultView,T=void 0;return x.innerHeight>C.documentElement.clientHeight&&(T=this.cache("scrollbar-size",c),k.viewport.bottom-=T.height),x.innerWidth>C.documentElement.clientWidth&&(T=this.cache("scrollbar-size",c),k.viewport.right-=T.width),["","static"].indexOf(C.body.style.position)!==-1&&["","static"].indexOf(C.body.parentElement.style.position)!==-1||(k.page.bottom=C.body.scrollHeight-v-o,k.page.right=C.body.scrollWidth-g-i),"undefined"!=typeof this.options.optimizations&&this.options.optimizations.moveElement!==!1&&"undefined"==typeof this.targetModifier&&!function(){var t=e.cache("target-offsetparent",function(){return l(e.target)}),n=e.cache("target-offsetparent-bounds",function(){return s(t)}),r=getComputedStyle(t),i=n,o={};if(["Top","Left","Bottom","Right"].forEach(function(e){o[e.toLowerCase()]=parseFloat(r["border"+e+"Width"])}),n.right=C.body.scrollWidth-n.left-i.width+o.right,n.bottom=C.body.scrollHeight-n.top-i.height+o.bottom,k.page.top>=n.top+o.top&&k.page.bottom>=n.bottom&&k.page.left>=n.left+o.left&&k.page.right>=n.right){var a=t.scrollTop,c=t.scrollLeft;k.offset={top:k.page.top-n.top+a-o.top,left:k.page.left-n.left+c-o.left}}}(),this.move(k),this.history.unshift(k),this.history.length>3&&this.history.pop(),t&&M(),!0}}},{key:"move",value:function(e){var t=this;if("undefined"!=typeof this.element.parentNode){var n={};for(var r in e){n[r]={};for(var i in e[r]){for(var o=!1,a=0;a<this.history.length;++a){var s=this.history[a];if("undefined"!=typeof s[r]&&!y(s[r][i],e[r][i])){o=!0;break}}o||(n[r][i]=!0)}}var c={top:"",left:"",right:"",bottom:""},d=function(e,n){var r="undefined"!=typeof t.options.optimizations,i=r?t.options.optimizations.gpu:null;if(i!==!1){var o=void 0,a=void 0;if(e.top?(c.top=0,o=n.top):(c.bottom=0,o=-n.bottom),e.left?(c.left=0,a=n.left):(c.right=0,a=-n.right),window.matchMedia){var s=window.matchMedia("only screen and (min-resolution: 1.3dppx)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3)").matches;s||(a=Math.round(a),o=Math.round(o))}c[B]="translateX("+a+"px) translateY("+o+"px)","msTransform"!==B&&(c[B]+=" translateZ(0)")}else e.top?c.top=n.top+"px":c.bottom=n.bottom+"px",e.left?c.left=n.left+"px":c.right=n.right+"px"},f=!1;if((n.page.top||n.page.bottom)&&(n.page.left||n.page.right)?(c.position="absolute",d(n.page,e.page)):(n.viewport.top||n.viewport.bottom)&&(n.viewport.left||n.viewport.right)?(c.position="fixed",d(n.viewport,e.viewport)):"undefined"!=typeof n.offset&&n.offset.top&&n.offset.left?!function(){c.position="absolute";var r=t.cache("target-offsetparent",function(){return l(t.target)});l(t.element)!==r&&D(function(){t.element.parentNode.removeChild(t.element),r.appendChild(t.element)}),d(n.offset,e.offset),f=!0}():(c.position="absolute",d({top:!0,left:!0},e.page)),!f)if(this.options.bodyElement)this.element.parentNode!==this.options.bodyElement&&this.options.bodyElement.appendChild(this.element);else{for(var p=!0,m=this.element.parentNode;m&&1===m.nodeType&&"BODY"!==m.tagName;){if("static"!==getComputedStyle(m).position){p=!1;break}m=m.parentNode}p||(this.element.parentNode.removeChild(this.element),this.element.ownerDocument.body.appendChild(this.element))}var h={},g=!1;for(var i in c){var v=c[i],b=this.element.style[i];b!==v&&(g=!0,h[i]=v)}g&&D(function(){u(t.element.style,h),t.trigger("repositioned")})}}}]),t}(P);z.modules=[],E.position=L;var G=u(z,E),N=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),F=E.Utils,s=F.getBounds,u=F.extend,g=F.updateClasses,D=F.defer,X=["left","top","right","bottom"];E.modules.push({position:function(e){var t=this,n=e.top,r=e.left,i=e.targetAttachment;if(!this.options.constraints)return!0;var o=this.cache("element-bounds",function(){return s(t.element)}),a=o.height,l=o.width;if(0===l&&0===a&&"undefined"!=typeof this.lastSize){var c=this.lastSize;l=c.width,a=c.height}var d=this.cache("target-bounds",function(){return t.getTargetBounds()}),f=d.height,p=d.width,m=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach(function(e){var t=e.outOfBoundsClass,n=e.pinnedClass;t&&m.push(t),n&&m.push(n)}),m.forEach(function(e){["left","top","right","bottom"].forEach(function(t){m.push(e+"-"+t)})});var h=[],v=u({},i),y=u({},this.attachment);return this.options.constraints.forEach(function(e){var o=e.to,s=e.attachment,c=e.pin;"undefined"==typeof s&&(s="");var u=void 0,d=void 0;if(s.indexOf(" ")>=0){var m=s.split(" "),g=N(m,2);d=g[0],u=g[1]}else u=d=s;var b=S(t,o);"target"!==d&&"both"!==d||(n<b[1]&&"top"===v.top&&(n+=f,v.top="bottom"),n+a>b[3]&&"bottom"===v.top&&(n-=f,v.top="top")),"together"===d&&("top"===v.top&&("bottom"===y.top&&n<b[1]?(n+=f,v.top="bottom",n+=a,y.top="top"):"top"===y.top&&n+a>b[3]&&n-(a-f)>=b[1]&&(n-=a-f,v.top="bottom",y.top="bottom")),"bottom"===v.top&&("top"===y.top&&n+a>b[3]?(n-=f,v.top="top",n-=a,y.top="bottom"):"bottom"===y.top&&n<b[1]&&n+(2*a-f)<=b[3]&&(n+=a-f,v.top="top",y.top="top")),"middle"===v.top&&(n+a>b[3]&&"top"===y.top?(n-=a,y.top="bottom"):n<b[1]&&"bottom"===y.top&&(n+=a,y.top="top"))),"target"!==u&&"both"!==u||(r<b[0]&&"left"===v.left&&(r+=p,v.left="right"),r+l>b[2]&&"right"===v.left&&(r-=p,v.left="left")),"together"===u&&(r<b[0]&&"left"===v.left?"right"===y.left?(r+=p,v.left="right",r+=l,y.left="left"):"left"===y.left&&(r+=p,v.left="right",r-=l,y.left="right"):r+l>b[2]&&"right"===v.left?"left"===y.left?(r-=p,v.left="left",r-=l,y.left="right"):"right"===y.left&&(r-=p,v.left="left",r+=l,y.left="left"):"center"===v.left&&(r+l>b[2]&&"left"===y.left?(r-=l,y.left="right"):r<b[0]&&"right"===y.left&&(r+=l,y.left="left"))),"element"!==d&&"both"!==d||(n<b[1]&&"bottom"===y.top&&(n+=a,y.top="top"),n+a>b[3]&&"top"===y.top&&(n-=a,y.top="bottom")),"element"!==u&&"both"!==u||(r<b[0]&&("right"===y.left?(r+=l,y.left="left"):"center"===y.left&&(r+=l/2,y.left="left")),r+l>b[2]&&("left"===y.left?(r-=l,y.left="right"):"center"===y.left&&(r-=l/2,y.left="right"))),"string"==typeof c?c=c.split(",").map(function(e){return e.trim()}):c===!0&&(c=["top","left","right","bottom"]),c=c||[];var _=[],w=[];n<b[1]&&(c.indexOf("top")>=0?(n=b[1],_.push("top")):w.push("top")),n+a>b[3]&&(c.indexOf("bottom")>=0?(n=b[3]-a,_.push("bottom")):w.push("bottom")),r<b[0]&&(c.indexOf("left")>=0?(r=b[0],_.push("left")):w.push("left")),r+l>b[2]&&(c.indexOf("right")>=0?(r=b[2]-l,_.push("right")):w.push("right")),_.length&&!function(){var e=void 0;e="undefined"!=typeof t.options.pinnedClass?t.options.pinnedClass:t.getClass("pinned"),h.push(e),_.forEach(function(t){h.push(e+"-"+t)})}(),w.length&&!function(){var e=void 0;e="undefined"!=typeof t.options.outOfBoundsClass?t.options.outOfBoundsClass:t.getClass("out-of-bounds"),h.push(e),w.forEach(function(t){h.push(e+"-"+t)})}(),(_.indexOf("left")>=0||_.indexOf("right")>=0)&&(y.left=v.left=!1),(_.indexOf("top")>=0||_.indexOf("bottom")>=0)&&(y.top=v.top=!1),v.top===i.top&&v.left===i.left&&y.top===t.attachment.top&&y.left===t.attachment.left||(t.updateAttachClasses(y,v),t.trigger("update",{attachment:y,targetAttachment:v}))}),D(function(){t.options.addTargetClasses!==!1&&g(t.target,h,m),g(t.element,h,m)}),{top:n,left:r}}});var F=E.Utils,s=F.getBounds,g=F.updateClasses,D=F.defer;E.modules.push({position:function(e){var t=this,n=e.top,r=e.left,i=this.cache("element-bounds",function(){return s(t.element)}),o=i.height,a=i.width,l=this.getTargetBounds(),c=n+o,u=r+a,d=[];n<=l.bottom&&c>=l.top&&["left","right"].forEach(function(e){var t=l[e];t!==r&&t!==u||d.push(e)}),r<=l.right&&u>=l.left&&["top","bottom"].forEach(function(e){var t=l[e];t!==n&&t!==c||d.push(e)});var f=[],p=[],m=["left","top","right","bottom"];return f.push(this.getClass("abutted")),m.forEach(function(e){f.push(t.getClass("abutted")+"-"+e)}),d.length&&p.push(this.getClass("abutted")),d.forEach(function(e){p.push(t.getClass("abutted")+"-"+e)}),D(function(){t.options.addTargetClasses!==!1&&g(t.target,p,f),g(t.element,p,f)}),!0}});var N=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return E.modules.push({position:function(e){var t=e.top,n=e.left;if(this.options.shift){var r=this.options.shift;"function"==typeof this.options.shift&&(r=this.options.shift.call(this,{top:t,left:n}));var i=void 0,o=void 0;if("string"==typeof r){r=r.split(" "),r[1]=r[1]||r[0];var a=r,s=N(a,2);i=s[0],o=s[1],i=parseFloat(i,10),o=parseFloat(o,10)}else i=r.top,o=r.left;return t+=i,n+=o,{top:t,left:n}}}}),G})},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(232),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(1),l=r(s),c=n(91),u=r(c);n(235);var d=function(e){var t=e.name,n=e.subtitle,r=i(e,["name","subtitle"]);return a.default.createElement(u.default,r,a.default.createElement("div",{className:"contact-text contact-name"},t),n&&a.default.createElement("div",{className:"contact-text contact-sub-name"},n))};d.displayName="ContactDatalistItem",d.propTypes={name:l.default.node.isRequired,subtitle:l.default.node},t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(7),m=r(p),h=n(31),g=r(h),v=n(26),y=r(v);n(234);var b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setActiveItemID=function(){var e=n.props.setActiveItemID;e&&e(n.id)},n.id=(0,y.default)("datalistitem"),n}return s(t,e),_(t,[{key:"componentWillMount",value:function(){this.props.isActive&&this.setActiveItemID()}},{key:"componentWillReceiveProps",value:function(e){e.isActive&&!this.props.isActive&&this.setActiveItemID()}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.isActive,o=i(e,["children","className","isActive"]),a=(0,m.default)("datalist-item",{"is-active":r},n),s=(0,g.default)(o,["setActiveItemID"]);return f.default.createElement("li",b({},s,{className:a,id:this.id,role:"option"}),t)}}]),t}(d.Component);w.propTypes={children:u.default.node.isRequired,className:u.default.string,isActive:u.default.bool,setActiveItemID:u.default.func},t.default=w},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.getTime(),n=e.getTimezoneOffset(),r=n*K,i=t-r;return i}function l(e){var t=e.toUTCString(),n=t.slice(0,-4);return new Date(n)}function c(e,t){if(!e)return"";var n=void 0;switch(t){case z:return e.toISOString();case G:return s(e);case J:return n=new Date(s(e)),n.toISOString();default:return e.getTime()}}Object.defineProperty(t,"__esModule",{value:!0}),t.DatePickerRaw=void 0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=n(1),f=r(d),p=n(0),m=r(p),h=n(2),g=n(7),v=r(g),y=n(237),b=r(y),_=n(238),w=r(_),S=n(93),k=r(S),E=n(239),C=r(E),x=n(240),T=r(x),A=n(23),I=r(A),O=n(19),D=r(O),M=n(10),P=r(M);n(246);var N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},R=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),F="bottom-center",B="bottom-left",q="bottom-right",L="middle-left",j="middle-right",U="top-center",H="top-left",$="top-right",V=(0,h.defineMessages)({previousMonth:{id:"boxui.base.previousMonth",defaultMessage:"Previous Month"},nextMonth:{id:"boxui.base.nextMonth",defaultMessage:"Next Month"},iconAlertText:{id:"boxui.datePicker.iconAlertText",defaultMessage:"Invalid Date"},dateClearButton:{id:"boxui.datePicker.dateClearButton",defaultMessage:"Clear Date"},chooseDate:{id:"boxui.datePicker.chooseDate",defaultMessage:"Choose Date"}}),W=300,K=6e4,z="isoString",G="utcTime",X="unixTime",J="utcISOString",Y=function(){},Q=function(e){function t(){var e,n,r,a;i(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.onSelectHandler=function(e){var t=r.props.onChange;if(t){var n=r.formatValue(e);t(e,n)}},r.shouldStayClosed=!1,r.focusDatePicker=function(){r.dateInputEl.focus()},r.handleInputKeyDown=function(e){r.datePicker.isVisible()&&e.stopPropagation(),"Tab"!==e.key&&e.preventDefault(),"Enter"!==e.key&&"Escape"!==e.key&&" "!==e.key||r.datePicker.isVisible()&&r.datePicker.hide()},r.handleInputBlur=function(e){var t=r.props.onBlur,n=e.relatedTarget||document.activeElement;r.datePicker.isVisible()&&n&&n===r.datePickerButtonEl&&(r.shouldStayClosed=!0,setTimeout(function(){r.shouldStayClosed=!1},W)),t&&t(e)},r.handleButtonClick=function(e){e.preventDefault(),r.shouldStayClosed||r.focusDatePicker()},r.formatDisplay=function(e){var t=r.props,n=t.displayFormat,i=t.intl;return e?i.formatDate(e,n):""},r.formatValue=function(e){var t=r.props.dateFormat;return c(e,t)},r.clearDate=function(e){e.preventDefault(),r.datePicker.setDate(null),r.onSelectHandler(null)},a=n,o(r,a)}return a(t,e),R(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dateFormat,n=e.intl,r=e.maxDate,i=e.minDate,o=e.value,a=e.yearRange,s=n.formatDate,c=n.formatMessage,u=V.nextMonth,d=V.previousMonth,f=o;t===G&&(f=l(o));var p=(new Date).getFullYear(),m={previousMonth:c(d),nextMonth:c(u),months:(0,w.default)(12).map(function(e){return s(new Date(p,e,15),{month:"long"})}),weekdays:(0,w.default)(1,8).map(function(e){return s(new Date(2016,4,e),{weekday:"long"})}),weekdaysShort:(0,w.default)(1,8).map(function(e){return s(new Date(2016,4,e),{weekday:"narrow"})})};this.datePicker=new b.default({blurFieldOnSelect:!1,setDefaultDate:!0,defaultDate:this.formatDisplay(f),field:this.dateInputEl,maxDate:r,minDate:i,position:"bottom left",i18n:m,showDaysInNextAndPreviousMonths:!0,onSelect:this.onSelectHandler,yearRange:a}),this.datePicker.setDate(f),this.forceUpdate()}},{key:"componentWillReceiveProps",value:function(e){var t=e.value,n=e.minDate,r=e.maxDate,i=this.props,o=i.value,a=i.minDate,s=i.maxDate;(t&&!o||!t&&o||t&&o&&t.getTime()!==o.getTime())&&this.datePicker.setDate(t),(n&&!a||!n&&a||n&&a&&n.getTime()!==a.getTime())&&(this.datePicker.setMinDate(n),this.datePicker.getDate()<n&&this.datePicker.gotoDate(n)),(r&&!s||!r&&s||r&&s&&r.getTime()!==s.getTime())&&(this.datePicker.setMaxDate(r),this.datePicker.getDate()>r&&this.datePicker.gotoDate(r))}},{key:"componentWillUnmount",value:function(){this.datePicker.destroy()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.error,i=t.errorTooltipPosition,o=t.hideLabel,a=t.hideOptionalLabel,s=t.inputProps,l=t.intl,c=t.isClearable,u=t.isDisabled,d=t.isRequired,f=t.label,p=t.name,g=t.onFocus,y=t.placeholder,b=t.resinTarget,_=t.value,w=l.formatMessage,S=(0,v.default)(n,"date-picker-wrapper",{"show-clear-btn":!!_,"show-error":!!r}),E=b?{"data-resin-target":b}:{};return m.default.createElement("div",{className:S},m.default.createElement(I.default,{hideLabel:o,text:f,showOptionalText:!a&&!d},m.default.createElement(P.default,{className:"date-picker-error-tooltip",isShown:!!r,position:i,text:r||"",theme:"error"},m.default.createElement("input",N({className:"date-picker-input",type:"text",ref:function(t){e.dateInputEl=t},disabled:u,placeholder:y||w(V.chooseDate),required:d,onBlur:this.handleInputBlur,onChange:Y,onFocus:g,onKeyDown:this.handleInputKeyDown,value:this.formatDisplay(_)},E,s)))),c&&_&&!u?m.default.createElement(D.default,{className:"date-picker-clear-btn",type:"button",onClick:this.clearDate,"aria-label":w(V.dateClearButton)},m.default.createElement(T.default,{width:12,height:12})):null,r?m.default.createElement(k.default,{className:"date-picker-icon-alert",width:13,height:13,title:m.default.createElement(h.FormattedMessage,V.iconAlertText)}):null,m.default.createElement(D.default,{className:"date-picker-open-btn",disabled:u,type:"button",onClick:this.handleButtonClick,"aria-label":w(V.chooseDate),getDOMRef:function(t){e.datePickerButtonEl=t}},m.default.createElement(C.default,{width:16,height:17})),m.default.createElement("input",{type:"hidden",className:"date-picker-unix-time-input",name:p,value:this.formatValue(_),readOnly:!0}))}}]),t}(p.Component);Q.propTypes={className:f.default.string,dateFormat:f.default.string,displayFormat:f.default.object,error:f.default.node,errorTooltipPosition:f.default.oneOf([F,B,q,L,j,U,H,$]),hideLabel:f.default.bool,hideOptionalLabel:f.default.bool,inputProps:f.default.object,intl:h.intlShape.isRequired,isClearable:f.default.bool,isDisabled:f.default.bool,isRequired:f.default.bool,label:f.default.node.isRequired,maxDate:f.default.instanceOf(Date),minDate:f.default.instanceOf(Date),name:f.default.string.isRequired,onBlur:f.default.func,onChange:f.default.func,onFocus:f.default.func,placeholder:f.default.string,resinTarget:f.default.string,value:f.default.instanceOf(Date),yearRange:f.default.oneOfType([f.default.number,f.default.arrayOf(f.default.number)])},Q.defaultProps={className:"",dateFormat:X,displayFormat:{},error:"",errorTooltipPosition:B,inputProps:{},isClearable:!0,yearRange:10},t.DatePickerRaw=Q,t.default=(0,h.injectIntl)(Q)},function(e,t){e.exports=Pikaday},function(e,t){function n(e,t,n,r){for(var i=-1,o=D(O((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}function r(e){return function(t,r,i){return i&&"number"!=typeof i&&o(t,r,i)&&(r=i=void 0),t=p(t),void 0===r?(r=t,t=0):r=p(r),i=void 0===i?t<r?1:-1:p(i),n(t,r,i,e)}}function i(e,t){return t=null==t?g:t,!!t&&("number"==typeof e||x.test(e))&&e>-1&&e%1==0&&e<t}function o(e,t,n){if(!u(n))return!1;var r=typeof t;return!!("number"==r?s(n)&&i(t,n.length):"string"==r&&t in n)&&a(n[t],e)}function a(e,t){return e===t||e!==e&&t!==t}function s(e){return null!=e&&c(e.length)&&!l(e)}function l(e){var t=u(e)?I.call(e):"";return t==b||t==_}function c(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=g}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function d(e){return!!e&&"object"==typeof e}function f(e){return"symbol"==typeof e||d(e)&&I.call(e)==w}function p(e){if(!e)return 0===e?e:0;if(e=m(e),e===h||e===-h){var t=e<0?-1:1;return t*v}return e===e?e:0}function m(e){if("number"==typeof e)return e;if(f(e))return y;if(u(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=u(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(S,"");var n=E.test(e);return n||C.test(e)?T(e.slice(2),n?2:8):k.test(e)?y:+e}var h=1/0,g=9007199254740991,v=1.7976931348623157e308,y=NaN,b="[object Function]",_="[object GeneratorFunction]",w="[object Symbol]",S=/^\s+|\s+$/g,k=/^[-+]0x[0-9a-f]+$/i,E=/^0b[01]+$/i,C=/^0o[0-7]+$/i,x=/^(?:0|[1-9]\d*)$/,T=parseInt,A=Object.prototype,I=A.toString,O=Math.ceil,D=Math.max,M=r();e.exports=M},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#BABABA":r,o=e.width,a=void 0===o?16:o,l=e.height,u=void 0===l?17:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-calendar "+n,title:f,width:a,height:u,viewBox:"0 0 16 17"},s.default.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(0 1)"},s.default.createElement("rect",{className:"fill-color",width:a,height:u,y:"2",fill:i,rx:"2"}),s.default.createElement("rect",{width:"13.75",height:"9",x:"1.25",y:"6",fill:"#FFF",rx:"1"}),s.default.createElement("path",{className:"fill-color",fill:i,d:"M11 7h2.5v2.5H11zM7 11h2.5v2.5H7zM3 11h2.5v2.5H3zM7 7h2.5v2.5H7zM3 7h2.5v2.5H3z"})))};u.displayName="IconCalendar",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#AEAEAE":r,o=e.height,a=void 0===o?12:o,l=e.width,u=void 0===l?12:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-clear "+n,title:f,height:a,viewBox:"0 0 12 13",width:u},s.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},s.default.createElement("g",{className:"fill-color",fill:i,transform:"translate(-1219.000000, -46.000000)"},s.default.createElement("g",{transform:"translate(855.000000, 35.000000)"},s.default.createElement("g",null,s.default.createElement("path",{d:"M370,16.1907436 L372.023141,14.1676025 C372.246611,13.9441325 372.608928,13.9441325 372.832398,14.1676025 C373.055867,14.3910725 373.055867,14.7533889 372.832398,14.9768589 L370.809256,17 L372.832398,19.0231411 C373.055867,19.2466111 373.055867,19.6089275 372.832398,19.8323975 C372.608928,20.0558675 372.246611,20.0558675 372.023141,19.8323975 L370,17.8092564 L367.976859,19.8323975 C367.753389,20.0558675 367.391072,20.0558675 367.167602,19.8323975 C366.944133,19.6089275 366.944133,19.2466111 367.167602,19.0231411 L369.190744,17 L367.167602,14.9768589 C366.944133,14.7533889 366.944133,14.3910725 367.167602,14.1676025 C367.391072,13.9441325 367.753389,13.9441325 367.976859,14.1676025 L370,16.1907436 Z M370,23 C373.313708,23 376,20.3137085 376,17 C376,13.6862915 373.313708,11 370,11 C366.686292,11 364,13.6862915 364,17 C364,20.3137085 366.686292,23 370,23 Z"
}))))))};u.displayName="IconClear",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(2),c=n(53),u=r(c),d=n(242),f=r(d),p=n(243),m=r(p);n(244);var h=function(){return s.default.createElement("span",{className:"label-optional"},"(",s.default.createElement(l.FormattedMessage,u.default.optional),")")},g=function(e){var t=e.text,n=e.tooltip,r=e.showOptionalText,i=e.hideLabel,o=e.children,a=[s.default.createElement("span",{key:"labelText"},t),r?s.default.createElement(h,{key:"optionalMessage"}):null];return i?s.default.createElement(m.default,{labelContent:a},o):s.default.createElement(f.default,{labelContent:a,tooltip:n},o)};g.propTypes={children:o.default.node.isRequired,text:o.default.oneOfType([o.default.string,o.default.node]).isRequired,showOptionalText:o.default.bool,tooltip:o.default.oneOfType([o.default.string,o.default.node]),hideLabel:o.default.bool},t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(10),c=r(l),u=n(94),d=r(u),f=function(e){var t=e.children,n=e.labelContent,r=e.tooltip,i=s.default.createElement(d.default,{labelContent:n},t);return r?s.default.createElement(c.default,{position:"top-right",text:r},i):i};f.displayName="StandardLabel",f.propTypes={children:o.default.node.isRequired,labelContent:o.default.array.isRequired,tooltip:o.default.oneOfType([o.default.string,o.default.node])},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(94),c=r(l),u="accessibility-hidden",d=function(e){var t=e.children,n=e.labelContent;return s.default.createElement(c.default,{labelContent:n,className:u},t)};d.propTypes={children:o.default.node.isRequired,labelContent:o.default.array.isRequired},t.default=d},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,o=e.type,a=void 0===o?"submit":o,s=e.getDOMRef,u=void 0===s?null:s,d=i(e,["children","className","type","getDOMRef"]);return l.default.createElement("button",c({className:"btn-plain "+r,type:a,ref:u},d),t)};u.displayName="PlainButton",u.propTypes={children:a.default.node,className:a.default.string,getDOMRef:a.default.func,type:a.default.oneOf(["button","reset","submit"])},t.default=u},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(52),u=r(c),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,o=e.isDisabled,a=e.isSelected,s=e.isLoading,c=i(e,["children","className","isDisabled","isSelected","isLoading"]);return l.default.createElement(u.default,d({className:"btn-primary "+r,isDisabled:o,isSelected:a,isLoading:s},c),t)};f.displayName="PrimaryButton",f.propTypes={children:a.default.node,className:a.default.string,isDisabled:a.default.bool,isSelected:a.default.bool,isLoading:a.default.bool},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FormInput=void 0;var i=n(96),o=r(i),a=n(249),s=r(a);t.FormInput=o.default,t.default=s.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return[].slice.call(e.elements).reduce(function(e,t){if(t.name&&!t.validity.valid){var n=t.validity;return t.validity.customError&&(n.customErrorCode=t.validationMessage),e[t.name]={validityState:n},e}return e},{})}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(250),m=r(p),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){var t=e.currentTarget;if(n.props.onChange){var r=(0,m.default)(t,{hash:!0,empty:!0});n.props.onChange(r)}},n.onSubmit=function(e){var t=e.target,r=t.checkValidity(),i=n.props,o=i.onInvalidSubmit,a=i.onValidSubmit,l=n.state.registeredInputs;if(r){var c=(0,m.default)(t,{hash:!0,empty:!0});a(c)}else{var u=s(t);Object.keys(u).forEach(function(e){return l[e]&&l[e](u[e].validityState)}),o&&o(u)}e.preventDefault()},n.registerInput=function(e,t){var r=n.state.registeredInputs;if(r[e])throw new Error("Input '"+e+"' is already registered.");var i=n.state;i.registeredInputs[e]=t,n.setState(i)},n.unregisterInput=function(e){var t=n.state;delete t.registeredInputs[e],n.setState(t)},n.state={registeredInputs:{}},n}return a(t,e),h(t,[{key:"getChildContext",value:function(){return{form:{registerInput:this.registerInput.bind(this),unregisterInput:this.unregisterInput.bind(this)}}}},{key:"componentWillUpdate",value:function(e,t){e.formValidityState&&Object.keys(e.formValidityState).forEach(function(n){t.registeredInputs[n]&&t.registeredInputs[n](e.formValidityState[n])})}},{key:"render",value:function(){var e=this.props.children;return f.default.createElement("form",{noValidate:!0,onChange:this.onChange,onSubmit:this.onSubmit},e)}}]),t}(d.Component);g.propTypes={children:u.default.node,onChange:u.default.func,onValidSubmit:u.default.func.isRequired,onInvalidSubmit:u.default.func,formValidityState:u.default.object},g.childContextTypes={form:u.default.shape({registerInput:u.default.func.isRequired,unregisterInput:u.default.func.isRequired}).isRequired},t.default=g},function(e,t){function n(e,t){"object"!=typeof t?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var n=t.hash?{}:"",r=t.serializer||(t.hash?o:a),i=e&&e.elements?e.elements:[],c=Object.create(null),u=0;u<i.length;++u){var d=i[u];if((t.disabled||!d.disabled)&&d.name&&l.test(d.nodeName)&&!s.test(d.type)){var f=d.name,p=d.value;if("checkbox"!==d.type&&"radio"!==d.type||d.checked||(p=void 0),t.empty){if("checkbox"!==d.type||d.checked||(p=""),"radio"===d.type&&(c[d.name]||d.checked?d.checked&&(c[d.name]=!0):c[d.name]=!1),void 0==p&&"radio"==d.type)continue}else if(!p)continue;if("select-multiple"!==d.type)n=r(n,f,p);else{p=[];for(var m=d.options,h=!1,g=0;g<m.length;++g){var v=m[g],y=t.empty&&!v.value,b=v.value||y;v.selected&&b&&(h=!0,n=t.hash&&"[]"!==f.slice(f.length-2)?r(n,f+"[]",v.value):r(n,f,v.value))}!h&&t.empty&&(n=r(n,f,""))}}}if(t.empty)for(var f in c)c[f]||(n=r(n,f,""));return n}function r(e){var t=[],n=/^([^\[\]]*)/,r=new RegExp(c),i=n.exec(e);for(i[1]&&t.push(i[1]);null!==(i=r.exec(e));)t.push(i[1]);return t}function i(e,t,n){if(0===t.length)return e=n;var r=t.shift(),o=r.match(/^\[(.+?)\]$/);if("[]"===r)return e=e||[],Array.isArray(e)?e.push(i(null,t,n)):(e._values=e._values||[],e._values.push(i(null,t,n))),e;if(o){var a=o[1],s=+a;isNaN(s)?(e=e||{},e[a]=i(e[a],t,n)):(e=e||[],e[s]=i(e[s],t,n))}else e[r]=i(e[r],t,n);return e}function o(e,t,n){var o=t.match(c);if(o){var a=r(t);i(e,a,n)}else{var s=e[t];s?(Array.isArray(s)||(e[t]=[s]),e[t].push(n)):e[t]=n}return e}function a(e,t,n){return n=n.replace(/(\r)?\n/g,"\r\n"),n=encodeURIComponent(n),n=n.replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+n}var s=/^(?:submit|button|image|reset|file)$/i,l=/^(?:input|select|textarea|keygen)/i,c=/(\[[^\[\]]*\])/g;e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DraftMentionDecorator=t.default=void 0;var i=n(252),o=r(i),a=n(264),s=r(a);t.default=o.default,t.DraftMentionDecorator=s.default},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=i(c),d=n(0),f=i(d),p=n(17),m=n(25),h=n(11),g=n(253),v=i(g),y=n(101),b=i(y),_=n(96),w=i(_),S=n(263),k=r(S),E=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),C=function(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity(),r=null!==t&&"MENTION"===n.getEntity(t).getType();return r},t)},x=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleBlur=function(e){n.props.validateOnBlur&&!(0,p.findDOMNode)(n).contains(e.relatedTarget)&&n.checkValidity(),n.setState({hasReceivedFirstInteraction:!0})},n.handleFocus=function(e){var t=n.props.onFocus;t&&t(e)},n.handleChange=function(e){var t=n.state.internalEditorState,r=n.props.onChange;t?n.setState({internalEditorState:e},function(){r&&r(e),n.checkValidity()}):(r&&r(e),n.checkValidity())},n.handleValidityStateUpdateHandler=function(){if(n.state.hasReceivedFirstInteraction){var e=n.getErrorFromValidityState();n.setState({error:e})}},n.checkValidity=function(){n.handleValidityStateUpdateHandler()};var r=new m.CompositeDecorator([{strategy:C,component:b.default}]);return n.state={contacts:[],hasReceivedFirstInteraction:!1,internalEditorState:e.editorState?null:m.EditorState.createEmpty(r),error:null},n}return s(t,e),E(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.contacts;n&&this.setState({contacts:n},function(){t.checkValidity()})}},{key:"getErrorFromValidityState",value:function(){var e=this.props,t=e.editorState,n=e.isRequired,r=e.maxLength,i=e.minLength,o=this.state.internalEditorState,a=(o||t).getCurrentContent().getPlainText().trim().length;return n&&!a?k.valueMissing():a<i?k.tooShort(i):a>r?k.tooLong(r):null}},{key:"render",value:function(){var e=this.props,t=e.className,n=void 0===t?"":t,r=e.editorState,i=e.hideLabel,o=e.isDisabled,a=e.isRequired,s=e.label,l=e.mentionTriggers,c=e.name,u=e.onMention,d=e.placeholder,p=e.selectorRow,m=e.startMentionMessage,h=e.onReturn,g=this.state,y=g.contacts,b=g.internalEditorState,_=g.error,S=this.handleBlur,k=this.handleChange,E=this.handleFocus;return f.default.createElement("div",{className:n},f.default.createElement(w.default,{name:c,onValidityStateUpdate:this.handleValidityStateUpdateHandler},f.default.createElement(v.default,{contacts:y,editorState:b||r,error:_,hideLabel:i,isDisabled:o,isRequired:a,label:s,mentionTriggers:l,onBlur:S,onChange:k,onFocus:E,onMention:u,onReturn:h,placeholder:d,selectorRow:p,startMentionMessage:m})))}}]),t}(d.Component);x.propTypes={className:u.default.string,contacts:h.SelectorItemsPropType.isRequired,editorState:u.default.instanceOf(m.EditorState),hideLabel:u.default.bool,isDisabled:u.default.bool,isRequired:u.default.bool,label:u.default.node.isRequired,mentionTriggers:u.default.arrayOf(u.default.string),maxLength:u.default.number,minLength:u.default.number,name:u.default.string.isRequired,onChange:u.default.func,onFocus:u.default.func,onMention:u.default.func.isRequired,onReturn:u.default.func,placeholder:u.default.string,selectorRow:u.default.node,startMentionMessage:u.default.node,validateOnBlur:u.default.bool},x.defaultProps={isRequired:!1,validateOnBlur:!0},t.default=x},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(2),m=n(7),h=r(m),g=n(25),v=n(11),y=n(91),b=r(y),_=n(254),w=r(_),S=n(97),k=r(S),E=n(262),C=r(E);n(100);var x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=function(e){var t=e.item,n=s(e,["item"]);return f.default.createElement(b.default,n,t.name," ",f.default.createElement("span",{className:"dropdown-secondary-text"},t.email))};A.propTypes={item:u.default.shape({name:u.default.string,email:u.default.string})};var I=function(){return f.default.createElement(p.FormattedMessage,C.default.startMention)};I.displayName="DefaultStartMentionMessage";var O=function(e){var t=e.message;return f.default.createElement("div",{className:"mention-start-state"},t)};O.propTypes={message:u.default.node},O.displayName="MentionStartState";var D=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleMention=function(){var e=n.props.onMention,t=n.state.activeMention;e&&e(t?t.mentionString:"")},n.handleContactSelected=function(e){var t=n.props.contacts;n.addMention(t[e]),n.setState({activeMention:null,isFocused:!0},function(){n.handleMention()})},n.handleBlur=function(e){var t=n.props.onBlur;n.setState({isFocused:!1}),t&&t(e)},n.handleFocus=function(e){var t=n.props.onFocus;n.setState({isFocused:!0}),t&&t(e)},n.handleChange=function(e){var t=n.props.onChange,r=n.getActiveMentionForEditorState(e);n.setState({activeMention:r},function(){t&&t(e),r&&r.mentionString&&n.handleMention()})},n.shouldDisplayMentionLookup=function(){var e=n.props.contacts,t=n.state.activeMention;return!!(t&&t.mentionString&&e.length)};var r=e.mentionTriggers.reduce(function(e,t){return e+"\\"+t},"");return n.state={activeMention:null,isFocused:!1,mentionPattern:new RegExp("(["+r+"])([^"+r+"]*)$")},n}return a(t,e),T(t,[{key:"componentWillReceiveProps",value:function(e,t){var n=e.contacts,r=this.props.contacts,i=t.activeMention;null===i||n.length||n===r||n.length===r.length||this.setState({activeMention:null})}},{key:"getActiveMentionForEditorState",value:function(e){var t=this.state.mentionPattern,n=e.getCurrentContent(),r=e.getSelection(),i=r.getStartKey(),o=n.getBlockForKey(i),a=r.getStartOffset(),s=null;return o.findEntityRanges(function(e){return null===e.getEntity()},function(e,n){if(e<=a&&a<=n){var r=o.getText().substr(e,a-e),l=r.match(t);l&&(s={blockID:i,mentionString:l[2],mentionTrigger:l[1],start:e+l.index,end:a})}return null}),s}},{key:"addMention",value:function(e){var t=this,n=this.state.activeMention,r=this.props.editorState,i=n.start,o=n.end,a=e.id,s=e.name,l=r.getCurrentContent(),c=r.getSelection(),u=c.merge({anchorOffset:i,focusOffset:o}),d="@"+s,f=l.createEntity("MENTION","IMMUTABLE",{id:a}),p=f.getLastCreatedEntityKey(),m=g.Modifier.replaceText(l,u,d,null,p),h=u.getStartOffset()+d.length,v=u.merge({anchorOffset:h,focusOffset:h}),y=g.Modifier.insertText(m,v," "),b=g.EditorState.push(r,y,"change-block-type");this.setState({activeMention:null},function(){t.handleChange(b)})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.contacts,r=e.editorState,i=e.error,o=e.hideLabel,a=e.isDisabled,s=e.isRequired,l=e.label,c=e.onReturn,u=e.placeholder,p=e.selectorRow,m=e.startMentionMessage,g=this.state,v=g.activeMention,y=g.isFocused,b=(0,h.default)("mention-selector-wrapper",t),_=v&&!v.mentionString&&y;return f.default.createElement("div",{className:b},f.default.createElement(k.default,{onSelect:this.handleContactSelected,selector:f.default.createElement(w.default,{editorState:r,error:i,hideLabel:o,isDisabled:a,isFocused:y,isRequired:s,label:l,onBlur:this.handleBlur,onFocus:this.handleFocus,onChange:this.handleChange,onReturn:c,placeholder:u})},this.shouldDisplayMentionLookup()?n.map(function(e){return(0,d.cloneElement)(p,x({},p.props,e,{key:e.id}))}):[]),_?f.default.createElement(O,{message:m}):null)}}]),t}(d.Component);D.propTypes={className:u.default.string,contacts:v.SelectorItemsPropType.isRequired,editorState:u.default.object.isRequired,error:u.default.object,hideLabel:u.default.bool,isDisabled:u.default.bool,isRequired:u.default.bool,label:u.default.string,mentionTriggers:u.default.arrayOf(u.default.string),onBlur:u.default.func,onChange:u.default.func,onFocus:u.default.func,onMention:u.default.func,onReturn:u.default.func,placeholder:u.default.string,selectorRow:u.default.node,startMentionMessage:u.default.node},D.defaultProps={className:"",contacts:[],isDisabled:!1,isRequired:!1,mentionTriggers:["@","＠","﹫"],selectorRow:f.default.createElement(A,null),startMentionMessage:f.default.createElement(I,null)},t.default=D},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(255),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(7),p=r(f),m=n(25);n(256);var h=n(23),g=r(h),v=n(10),y=r(v);n(257);var b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){var t=n.props.onChange;t(e)},n.handleBlur=function(e){var t=n.props.onBlur;t(e)},n.handleReturn=function(e){var t=n.props,r=t.onReturn,i=t.inputProps;return r&&!i["aria-activedescendant"]&&r(e)?"handled":"not-handled"},n.state={error:e.error},n}return a(t,e),_(t,[{key:"render",value:function(){var e=this.props,t=e.editorState,n=e.error,r=e.hideLabel,i=e.inputProps,o=e.isDisabled,a=e.isRequired,s=e.label,l=e.onFocus,c=e.placeholder,u=this.handleBlur,f=this.handleChange,h=(0,p.default)({"draft-js-editor":!0,"is-disabled":o,"show-error":!!n}),v={};return i.role&&(v={ariaActiveDescendantID:i["aria-activedescendant"],ariaAutoComplete:i["aria-autocomplete"],ariaExpanded:i["aria-expanded"],ariaOwneeID:i["aria-owns"],role:i.role}),d.default.createElement("div",{className:h},d.default.createElement(g.default,{text:s,showOptionalText:!a,hideLabel:r},d.default.createElement(y.default,{isShown:!!n,text:n?n.message:"",theme:"error",position:"bottom-left"},d.default.createElement("div",null,d.default.createElement(m.Editor,b({},v,{editorState:t,onBlur:u,onChange:f,onFocus:l,placeholder:c,readOnly:o,handleReturn:this.handleReturn,stripPastedStyles:!0}))))))}}]),t}(u.Component);w.propTypes={editorState:c.default.object.isRequired,error:c.default.object,hideLabel:c.default.bool,inputProps:c.default.object,isDisabled:c.default.bool,isRequired:c.default.bool,label:c.default.node.isRequired,onBlur:c.default.func.isRequired,onFocus:c.default.func.isRequired,onChange:c.default.func.isRequired,onReturn:c.default.func,placeholder:c.default.string},w.defaultProps={inputProps:{},isRequired:!1,isFocused:!1},t.default=w},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(7),m=r(p),h=n(98),g=r(h),v=n(26),y=r(v);n(99);var b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setActiveItem=function(e){n.setState({activeItemIndex:e}),e===-1&&n.setActiveItemID(null)},n.setActiveItemID=function(e){n.setState({activeItemID:e}),n.scrollItemIntoView(e)},n.scrollItemIntoView=function(e){var t=document.getElementById(e);if(t){for(var n=t;n.parentElement instanceof HTMLElement&&!n.classList.contains("modal");)n=n.parentElement;(0,g.default)(t,!1,void 0,n)}},n.haveChildrenChanged=function(e){var t=n.props.children,r=d.Children.count(t),i=d.Children.count(e);if(r!==i)return!0;if(0===r)return!1;var o=d.Children.map(t,function(e){return e.key}),a=d.Children.map(e,function(e){return e.key});return o.some(function(e,t){return e!==a[t]})},n.resetActiveItem=function(){n.setState({activeItemID:null,activeItemIndex:-1})},n.handleFocus=function(){n.setState({isFocused:!0})},n.handleBlur=function(){n.setState({isFocused:!1})},n.handleInput=function(){n.openDropdown()},n.handleKeyDown=function(e){var t=n.props.children,r=n.state.activeItemIndex,i=d.Children.count(t);switch(e.key){case"ArrowDown":if(s(e),n.isDropdownOpen()){var o=r===i-1?-1:r+1;n.setActiveItem(o)}else n.openDropdown();break;case"ArrowUp":if(s(e),n.isDropdownOpen()){var a=r===-1?i-1:r-1;n.setActiveItem(a)}else n.openDropdown();break;case"Enter":r!==-1&&n.isDropdownOpen()&&(s(e),n.selectItem(r,e));break;case"Escape":n.isDropdownOpen()&&(s(e),n.closeDropdown(),n.resetActiveItem())}},n.isDropdownOpen=function(){var e=n.props.children,t=n.state,r=t.isFocused,i=t.shouldOpen,o=d.Children.count(e);return r&&o>0&&i},n.openDropdown=function(){n.state.shouldOpen||n.setState({shouldOpen:!0})},n.closeDropdown=function(){n.setState({shouldOpen:!1})},n.selectItem=function(e,t){var r=n.props.onSelect;r&&r(e,t),n.closeDropdown()},n.listboxID=(0,y.default)("listbox"),n.state={activeItemID:null,activeItemIndex:-1,isFocused:!1,shouldOpen:!1},n}return a(t,e),b(t,[{key:"componentWillReceiveProps",value:function(e){this.haveChildrenChanged(e.children)&&this.resetActiveItem()}},{key:"render",value:function(){var e=this.listboxID,t=this.selectItem,n=this.setActiveItem,r=this.setActiveItemID,i=this.props,o=i.children,a=i.className,s=i.selector,l=this.state,c=l.activeItemID,u=l.activeItemIndex,p=this.isDropdownOpen(),h={"aria-activedescendant":c,"aria-autocomplete":"list","aria-expanded":p,role:"combobox"};return p&&(h["aria-owns"]=e),f.default.createElement("div",{className:(0,m.default)("selector-dropdown-wrapper",a),onBlur:this.handleBlur,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,onKeyPress:this.handleInput,onPaste:this.handleInput},(0,d.cloneElement)(s,{inputProps:h}),p&&f.default.createElement("div",{className:"overlay-wrapper is-visible"},f.default.createElement("ul",{className:"overlay",id:e,role:"listbox"},d.Children.map(o,function(e,i){var o={onClick:function(e){t(i,e)},onMouseDown:function(e){e.preventDefault()},onMouseEnter:function(){n(i)},setActiveItemID:r};return i===u&&(o.isActive=!0),(0,d.cloneElement)(e,o)}))))}}]),t}(d.Component);_.propTypes={children:u.default.node,className:u.default.string,onSelect:u.default.func,selector:u.default.node.isRequired},t.default=_},function(e,t,n){function r(e,t,n){function r(){m.cancel(g),g=0}function a(){var t=d(b/y);b+=1,s(t),b<=y?(g=m.next(a),f(e)):(g=0,setTimeout(function(){p(e)},0))}function s(t){h.forEach(function(n){e[n]=u[n]*t+l[n]})}var l=Object.create(null),u=Object.create(null);n=n||{};var d="function"==typeof n.easing?n.easing:c[n.easing];d||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),d=c.ease);var f="function"==typeof n.step?n.step:i,p="function"==typeof n.done?n.done:i,m=o(n.scheduler),h=Object.keys(t);h.forEach(function(n){l[n]=e[n],u[n]=t[n]-e[n]});var g,v=n.duration||400,y=Math.max(1,.06*v),b=0;return g=m.next(a),{cancel:r}}function i(){}function o(e){if(!e){var t="undefined"!=typeof window&&window.requestAnimationFrame;return t?a():s()}if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}function a(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function s(){return{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}}}var l=n(260),c={ease:l(.25,.1,.25,1),easeIn:l(.42,0,1,1),easeOut:l(0,0,.58,1),easeInOut:l(.42,0,.58,1),linear:l(0,0,1,1)};e.exports=r},function(e,t){function n(e,t){return 1-3*t+3*e}function r(e,t){return 3*t-6*e}function i(e){return 3*e}function o(e,t,o){return((n(t,o)*e+r(t,o))*e+i(t))*e}function a(e,t,o){return 3*n(t,o)*e*e+2*r(t,o)*e+i(t)}function s(e,t,n,r,i){var a,s,l=0;do s=t+(n-t)/2,a=o(s,r,i)-e,a>0?n=s:t=s;while(Math.abs(a)>d&&++l<f);return s}function l(e,t,n,r){for(var i=0;i<c;++i){var s=a(t,n,r);if(0===s)return t;var l=o(t,n,r)-e;t-=l/s}return t}var c=4,u=.001,d=1e-7,f=10,p=11,m=1/(p-1),h="function"==typeof Float32Array;e.exports=function(e,t,n,r){function i(t){for(var r=0,i=1,o=p-1;i!==o&&c[i]<=t;++i)r+=m;--i;var d=(t-c[i])/(c[i+1]-c[i]),f=r+d*m,h=a(f,e,n);return h>=u?l(t,f,e,n):0===h?f:s(t,r,r+m,e,n)}if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");var c=h?new Float32Array(p):new Array(p);if(e!==t||n!==r)for(var d=0;d<p;++d)c[d]=o(d*m,e,n);return function(a){return e===t&&n===r?a:0===a?0:1===a?1:o(i(a),t,r)}}},function(e,t,n){"use strict";function r(e,t){function n(e,t,n,r){return a.centerIfNeeded===!1||n<=e+r&&e<=t+r?Math.min(n,Math.max(t,e)):(t+n)/2}function r(e,t,n,i){return{left:e+d,top:t+u,width:n,height:i,right:e+d+n+p,bottom:t+u+i+f,translate:function(o,a){return r(o+e+d,a+t+u,n,i)},relativeFromTo:function(o,a){var s=e+d,l=t+u;if(o=o.offsetParent,a=a.offsetParent,o===a)return m;for(;o;o=o.offsetParent)s+=o.offsetLeft+o.clientLeft,l+=o.offsetTop+o.clientTop;for(;a;a=a.offsetParent)s-=a.offsetLeft+a.clientLeft,l-=a.offsetTop+a.clientTop;return r(s,l,n,i)}}}if(!(e&&e instanceof HTMLElement))throw new Error("Element is required in scrollIntoViewIfNeeded");var a=i({handleScroll:o},t),s={top:0,right:0,bottom:0,left:0};a.offset=a.offset?i({},s,a.offset):s;for(var l,c=a.offset,u=c.top,d=c.left,f=c.bottom,p=c.right,m=r(e.offsetLeft,e.offsetTop,e.offsetWidth,e.offsetHeight);(l=e.parentNode)instanceof HTMLElement&&e!==a.boundary;){var h=l.offsetLeft+l.clientLeft,g=l.offsetTop+l.clientTop;m=m.relativeFromTo(e,l).translate(-h,-g);var v=n(l.scrollLeft,m.right-l.clientWidth,m.left,l.clientWidth),y=n(l.scrollTop,m.bottom-l.clientHeight,m.top,l.clientHeight);a.handleScroll(l,{scrollLeft:v,scrollTop:y},a),m=m.translate(h-l.scrollLeft,g-l.scrollTop),e=l}}t.a=r;var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},o=function(e,t){var n=t.scrollLeft,r=t.scrollTop;e.scrollLeft=n,e.scrollTop=r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=(0,r.defineMessages)({startMention:{id:"boxui.draftjs.mentionSelector.startMention",
defaultMessage:"Mention someone to notify them"}});t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.valueMissing=t.typeMismatchUrl=t.typeMismatchEmail=t.tooLong=t.tooShort=t.patternMismatch=t.badInput=t.OptionalMessage=void 0;var i=n(0),o=r(i),a=n(2),s=n(53),l=r(s),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){return o.default.createElement(a.FormattedMessage,l.default)},d=function(){return{code:"badInput",message:o.default.createElement(a.FormattedMessage,l.default.invalidInputError)}},f=function(){return{code:"patternMismatch",message:o.default.createElement(a.FormattedMessage,l.default.invalidInputError)}},p=function(e){return{code:"tooShort",message:o.default.createElement(a.FormattedMessage,c({},l.default.minLengthError,{values:{min:e}}))}},m=function(e){return{code:"tooLong",message:o.default.createElement(a.FormattedMessage,c({},l.default.maxLengthError,{values:{max:e}}))}},h=function(){return{code:"typeMismatch",message:o.default.createElement(a.FormattedMessage,l.default.invalidEmailError)}},g=function(){return{code:"typeMismatch",message:o.default.createElement(a.FormattedMessage,l.default.invalidURLError)}},v=function(){return{code:"valueMissing",message:o.default.createElement(a.FormattedMessage,l.default.requiredFieldError)}};t.OptionalMessage=u,t.badInput=d,t.patternMismatch=f,t.tooShort=p,t.tooLong=m,t.typeMismatchEmail=h,t.typeMismatchUrl=g,t.valueMissing=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(25),o=n(101),a=r(o),s=function(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity(),r=null!==t&&"MENTION"===n.getEntity(t).getType();return r},t)},l=new i.CompositeDecorator([{strategy:s,component:a.default}]);t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(7),p=r(f),m=n(23),h=r(m),g=n(97),v=r(g),y=n(103),b=r(y),_=n(11),w=n(266),S=r(w);n(268);var k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),C=function(e){function t(){var e,n,r,a;i(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.state={inputValue:""},r.parsePills=function(){var e=r.state.inputValue,t=r.props.validator,n=(0,b.default)(e);return t&&(n=n.filter(function(e){return t(e)})),n.map(function(e){return{text:e,value:e}})},r.addPillsFromInput=function(){var e=r.props,t=e.allowCustomPills,n=e.onInput,i=e.onSelect,o=e.selectedOptions,a=e.validateForError,s=r.state.inputValue;if(t){var l=r.parsePills();l.length>0?(i(l),r.setState({inputValue:""}),n("")):""===s&&0!==o.length||a(s)}},r.handleBlur=function(){r.addPillsFromInput()},r.handleInput=function(e){var t=e.target,n=t.value;r.setState({inputValue:n}),r.props.onInput(n)},r.handleKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),r.addPillsFromInput())},r.handlePaste=function(){setTimeout(r.addPillsFromInput,0)},r.handleSelect=function(e,t){var n=r.props,i=n.onSelect,o=n.selectorOptions,a="function"==typeof o.get?o.get(e):o[e];i([a],t),r.handleInput({target:{value:""}})},a=n,o(r,a)}return a(t,e),E(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.error,i=e.inputProps,o=e.label,a=e.onRemove,s=e.placeholder,l=e.selectedOptions;return d.default.createElement(v.default,{className:(0,p.default)("pill-selector-wrapper",n),onSelect:this.handleSelect,selector:d.default.createElement(h.default,{text:o},d.default.createElement(S.default,k({},i,{error:r,onBlur:this.handleBlur,onInput:this.handleInput,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste,onRemove:a,placeholder:s,selectedOptions:l,value:this.state.inputValue})))},t)}}]),t}(u.Component);C.propTypes={allowCustomPills:c.default.bool,children:c.default.node,className:c.default.string,error:c.default.node,inputProps:c.default.object.isRequired,label:c.default.node,onInput:c.default.func.isRequired,onRemove:c.default.func.isRequired,onSelect:c.default.func.isRequired,placeholder:c.default.string.isRequired,selectedOptions:_.OptionsPropType,selectorOptions:_.OptionsPropType,validateForError:c.default.func,validator:c.default.func},C.defaultProps={allowCustomPills:!1,error:"",inputProps:{},label:"",placeholder:"",selectedOptions:[],selectorOptions:[]},t.default=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=n(1),d=r(u),f=n(0),p=r(f),m=n(7),h=r(m),g=n(10),v=r(g),y=n(11),b=n(267),_=r(b),w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),k=function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.state={isFocused:!1,selectedIndex:-1},r.getNumSelected=function(){var e=r.props.selectedOptions;return"number"==typeof e.length?e.length:e.size},r.handleClick=function(){r.inputEl.focus()},r.handleFocus=function(){r.setState({isFocused:!0})},r.handleBlur=function(){r.setState({isFocused:!1})},r.handleKeyDown=function(e){var t=r.inputEl.value,n=r.getNumSelected(),i=r.state.selectedIndex;switch(e.key){case"Backspace":var o=-1;if(i>=0?(o=i,r.resetSelectedIndex(),r.inputEl.focus()):""===t&&(o=n-1),o>=0){var a=r.props,s=a.onRemove,c=a.selectedOptions,u="function"==typeof c.get?c.get(o):c[o];s(u,o),l(e)}break;case"ArrowLeft":i>=0?(r.setState({selectedIndex:Math.max(i-1,0)}),l(e)):""===t&&n>0&&(r.hiddenEl.focus(),r.setState({selectedIndex:n-1}),l(e));break;case"ArrowRight":if(i>=0){var d=i+1;d>=n?(r.resetSelectedIndex(),r.inputEl.focus()):r.setState({selectedIndex:d}),l(e)}}},r.hiddenRef=function(e){r.hiddenEl=e},r.resetSelectedIndex=function(){r.state.selectedIndex!==-1&&r.setState({selectedIndex:-1})},i=n,a(r,i)}return s(t,e),S(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.isFocused,r=t.selectedIndex,o=this.props,a=o.className,s=o.error,l=o.inputProps,c=o.onInput,u=o.onRemove,d=o.placeholder,f=o.selectedOptions,m=i(o,["className","error","inputProps","onInput","onRemove","placeholder","selectedOptions"]),g=(0,h.default)("pill-selector-input-wrapper",{"is-focused":n,"show-error":!!s});return p.default.createElement(v.default,{isShown:!!s,text:s,position:"middle-right",theme:"error"},p.default.createElement("span",{className:g,onBlur:this.handleBlur,onClick:this.handleClick,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown},f.map(function(t,n){return p.default.createElement(_.default,{isSelected:n===r,key:t.value,onRemove:u.bind(e,t,n),text:t.text})}),p.default.createElement("span",{"aria-hidden":"true",className:"accessibility-hidden",onBlur:this.resetSelectedIndex,ref:this.hiddenRef,tabIndex:-1}),p.default.createElement("input",w({},m,l,{autoComplete:"off",className:(0,h.default)("pill-selector-input",a),onInput:c,placeholder:0===this.getNumSelected()?d:"",ref:function(t){e.inputEl=t},type:"text"}))))}}]),t}(f.Component);k.propTypes={className:d.default.string,error:d.default.node,inputProps:d.default.object.isRequired,onInput:d.default.func.isRequired,onRemove:d.default.func.isRequired,placeholder:d.default.string.isRequired,selectedOptions:y.OptionsPropType},k.defaultProps={error:"",inputProps:{},placeholder:"",selectedOptions:[]},t.default=k},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(7),c=r(l),u=function(e){var t=e.isSelected,n=void 0!==t&&t,r=e.onRemove,i=e.text;return s.default.createElement("span",{className:(0,c.default)("pill",{"is-selected":n})},s.default.createElement("span",{className:"pill-text"},i),s.default.createElement("span",{"aria-hidden":"true",className:"close-btn",onClick:r},"✕"))};u.displayName="Pill",u.propTypes={isSelected:o.default.bool,onRemove:o.default.func.isRequired,text:o.default.string.isRequired},t.default=u},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(7),p=r(f),m=n(2),h=n(86),g=r(h),v=n(271),y=r(v),b=n(54),_=n(19),w=r(_),S=n(10),k=r(S),E=n(11),C=n(276),x=r(C),T=n(282),A=r(T),I=n(284),O=r(I),D=n(294),M=r(D),P=n(60),N=r(P),R=n(107),F=r(R),B=n(13),q=r(B);n(296);var L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),U=function(e){var t=e.action,n=e.message,r=e.title;return d.default.createElement(y.default,{className:"box-ui-comment-error",title:r},d.default.createElement("div",null,n),t?d.default.createElement(w.default,{className:"lnk box-ui-comment-error-action",onClick:t.onAction,type:"button"},t.text):null)};U.propTypes={action:c.default.shape({onAction:c.default.func,text:c.default.node}),message:c.default.node,title:c.default.node};var H=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onKeyDown=function(e){var t=e.nativeEvent;t.stopImmediatePropagation()},n.approvalCommentFormFocusHandler=function(){return n.setState({isInputOpen:!0})},n.approvalCommentFormCancelHandler=function(){return n.setState({isInputOpen:!1,isEditing:!1})},n.approvalCommentFormSubmitHandler=function(){return n.setState({isInputOpen:!1,isEditing:!1})},n.updateTaskHandler=function(e){var t=n.props.onEdit;t(e),n.approvalCommentFormSubmitHandler()},n.toEdit=function(){return n.setState({isEditing:!0,isInputOpen:!0})},n.handleCommentFocus=function(){n.setState({isFocused:!0})},n.handleCommentBlur=function(){n.setState({isFocused:!1})},n.state={isEditing:!1,isFocused:!1,isInputOpen:!1},n}return a(t,e),j(t,[{key:"render",value:function(){var e=this.props,t=e.createdBy,n=e.createdAt,r=e.permissions,i=e.id,o=e.isPending,a=e.error,s=e.onDelete,l=e.onEdit,c=e.taggedMessage,u=e.translatedTaggedMessage,f=e.translations,h=e.handlers,v=e.inputState,y=v.approverSelectorContacts,_=v.mentionSelectorContacts,w=v.currentUser,S=this.toEdit,E=this.state,C=E.isEditing,T=E.isFocused,I=E.isInputOpen,D=new Date(n).getTime();return d.default.createElement("div",{className:"box-ui-comment-container"},d.default.createElement("div",{className:(0,p.default)("box-ui-comment",{"is-pending":o||a,"is-focused":T}),onBlur:this.handleCommentBlur,onFocus:this.handleCommentFocus},d.default.createElement(g.default,L({className:"box-ui-comment-avatar"},t)),d.default.createElement("div",{className:"box-ui-comment-content"},d.default.createElement("div",{className:"box-ui-comment-headline"},d.default.createElement(b.Link,{className:"box-ui-comment-user-name",href:"/profile/"+t.id},t.name),d.default.createElement(k.default,{text:d.default.createElement(m.FormattedMessage,L({},q.default.commentPostedFullDateTime,{values:{time:D}}))},d.default.createElement("small",{className:"box-ui-comment-created-at"},d.default.createElement(M.default,{timestamp:D}))),l&&r&&r.task_edit?d.default.createElement(A.default,{id:i,toEdit:S}):null,s&&r&&(r.comment_delete||r.task_delete)?d.default.createElement(x.default,{id:i,message:r.task_delete?d.default.createElement(m.FormattedMessage,q.default.taskDeletePrompt):d.default.createElement(m.FormattedMessage,q.default.commentDeletePrompt),onDelete:s}):null),C?d.default.createElement(N.default,{onSubmit:function(){},isDisabled:v.isDisabled,approverSelectorContacts:y,mentionSelectorContacts:_,className:"box-ui-activity-feed-comment-input "+(v.isDisabled?"is-disabled":""),createComment:this.createCommentHandler,updateTask:this.updateTaskHandler,getApproverContactsWithQuery:h&&h.contacts?h.contacts.getApproverWithQuery:null,getMentionContactsWithQuery:h&&h.contacts?h.contacts.getMentionWithQuery:null,isOpen:I,user:w,onCancel:this.approvalCommentFormCancelHandler,onFocus:this.approvalCommentFormFocusHandler,isEditing:C,entityId:i,taggedMessage:(0,F.default)(c,i,!0)}):null,C?null:d.default.createElement(O.default,L({id:i,taggedMessage:c,translatedTaggedMessage:u},f,{translationFailed:!!a||null})))),a?d.default.createElement(U,a):null)}}]),t}(u.Component);H.displayName="Comment",H.propTypes={createdBy:E.UserPropType.isRequired,createdAt:c.default.any,permissions:c.default.shape({comment_delete:c.default.bool,comment_edit:c.default.bool}),id:c.default.string.isRequired,isPending:c.default.bool,error:E.ActionItemErrorPropType,onDelete:c.default.func,onEdit:c.default.func,taggedMessage:c.default.string.isRequired,translatedTaggedMessage:c.default.string,translations:c.default.shape({translationEnabled:c.default.bool,onTranslate:c.default.func}),handlers:c.default.shape({tasks:c.default.shape({update:c.default.func}),contacts:c.default.shape({getApproverWithQuery:c.default.func.isRequired,getMentionWithQuery:c.default.func.isRequired}),versions:c.default.shape({info:c.default.func})}),inputState:c.default.shape({approverSelectorContacts:E.SelectorItemsPropType,mentionSelectorContacts:E.SelectorItemsPropType,currentUser:E.UserPropType.isRequired,isDisabled:c.default.bool})},t.default=H},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(272),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=function(e){var t=e.children,n=e.className,r=e.title;return s.default.createElement("div",{className:"inline-alert inline-alert-visible inline-alert-error "+n},s.default.createElement("b",null,r),s.default.createElement("div",null,t))};l.displayName="InlineError",l.propTypes={children:o.default.node.isRequired,className:o.default.string,title:o.default.node.isRequired},t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),f(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.children,r=e.className;return d.default.createElement("div",{className:"link-group "+r},t?d.default.createElement("div",{className:"link-group-title"},t):null,d.default.createElement("ul",null,u.Children.map(n,function(e,t){return e?d.default.createElement("li",{key:t},e," "):null})))}}]),t}(u.Component);p.propTypes={title:c.default.node,children:c.default.node.isRequired,className:c.default.string},p.defaultProps={title:"",className:""},t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(105),m=r(p),h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),g(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=i(e,["className"]);return f.default.createElement(m.default,h({className:"link "+t},n))}}]),t}(d.Component);v.propTypes={className:u.default.string},v.defaultProps={className:""},t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(106),u=r(c),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(e){var t=e.className,n=void 0===t?"":t,r=i(e,["className"]);return l.default.createElement(u.default,d({className:"btn-primary "+n},r))};f.displayName="LinkPrimaryButton",f.propTypes={className:a.default.string},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.InlineDeleteBase=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(2),p=n(7),m=r(p),h=n(19),g=r(h),v=n(277),y=n(281),b=r(y),_=n(13),w=r(_),S=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),k=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDeleteConfirmedHandler=function(){var e=n.props,t=e.id,r=e.onDelete;r({id:t})},n.handleFlyoutOpen=function(){n.setState({isConfirming:!0})},n.handleFlyoutClose=function(){n.setState({isConfirming:!1})},n.state={isConfirming:!1},n}return a(t,e),S(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.message;return d.default.createElement("div",{className:(0,m.default)("box-ui-comment-delete-container",{"is-confirming":this.state.isConfirming})},d.default.createElement(v.Flyout,{onClose:this.handleFlyoutClose,onOpen:this.handleFlyoutOpen,position:"middle-left"},d.default.createElement(g.default,{"aria-label":t.formatMessage(w.default.deleteLabel),className:"box-ui-comment-delete"},d.default.createElement(b.default,null)),d.default.createElement(v.Overlay,null,d.default.createElement("b",null,n),d.default.createElement("div",null,d.default.createElement(g.default,{className:"lnk box-ui-comment-delete-yes",onClick:this.onDeleteConfirmedHandler,type:"button"},d.default.createElement(f.FormattedMessage,w.default.commentDeleteConfirm))," / ",d.default.createElement(g.default,{className:"lnk box-ui-comment-delete-no",type:"button"},d.default.createElement(f.FormattedMessage,w.default.commentDeleteCancel))))))}}]),t}(u.Component);k.propTypes={onDelete:c.default.func.isRequired,id:c.default.string.isRequired,intl:f.intlShape.isRequired,message:c.default.node.isRequired},t.InlineDeleteBase=k,t.default=(0,f.injectIntl)(k)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(278);Object.defineProperty(t,"Flyout",{enumerable:!0,get:function(){return r(i).default}});var o=n(280);Object.defineProperty(t,"Overlay",{enumerable:!0,get:function(){return r(o).default}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(90),m=r(p),h=n(26),g=r(h);n(279);var v,y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b="bottom-center",_="bottom-left",w="bottom-right",S="middle-left",k="middle-right",E="top-center",C="top-left",x="top-right",T=(v={},s(v,b,{attachment:"top center",targetAttachment:"bottom center"}),s(v,_,{attachment:"top right",targetAttachment:"bottom right"}),s(v,w,{attachment:"top left",targetAttachment:"bottom left"}),s(v,S,{attachment:"middle right",targetAttachment:"middle left"}),s(v,k,{attachment:"middle left",targetAttachment:"middle right"}),s(v,E,{attachment:"bottom center",targetAttachment:"top center"}),s(v,C,{attachment:"bottom right",targetAttachment:"top right"}),s(v,x,{attachment:"bottom left",targetAttachment:"top left"}),v),A=function(e,t){for(var n=t;n&&n.parentNode&&n!==e;){var r=n.nodeName.toUpperCase();if("A"===r||"BUTTON"===r)return!0;n=n.parentNode}return!1},I=function(e){function t(){var e,n,r,a;i(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.state={isVisible:r.props.isVisibleByDefault},r.handleOverlayClick=function(e){var t=document.getElementById(r.overlayID),n=r.props.closeOnClick;n&&A(t,e.target)&&r.handleOverlayClose()},r.handleButtonClick=function(e){var t=r.state.isVisible;t?r.closeOverlay():r.openOverlay(),e.preventDefault()},r.openOverlay=function(){r.setState({isVisible:!0});var e=r.props.onOpen;e&&e()},r.closeOverlay=function(){r.setState({isVisible:!1});var e=r.props.onClose;e&&e()},r.focusButton=function(){var e=document.getElementById(r.overlayButtonID);e&&e.focus()},r.handleOverlayClose=function(){r.focusButton(),r.closeOverlay()},r.handleDocumentClick=function(e){var t=r.props.closeOnClickOutside,n=r.state.isVisible;if(n&&t){var i=document.getElementById(r.overlayID),o=document.getElementById(r.overlayButtonID),a=o&&o.contains(e.target)||o===e.target,s=i&&i.contains(e.target)||i===e.target,l=a||s;l||r.closeOverlay()}},a=n,o(r,a)}return a(t,e),y(t,[{key:"componentWillMount",value:function(){this.overlayID=(0,g.default)("overlay"),this.overlayButtonID=(0,g.default)("flyoutbutton")}},{key:"componentDidUpdate",value:function(e,t){!t.isVisible&&this.state.isVisible?(document.addEventListener("click",this.handleDocumentClick,!0),document.addEventListener("contextmenu",this.handleDocumentClick,!0)):t.isVisible&&!this.state.isVisible&&(document.removeEventListener("contextmenu",this.handleDocumentClick,!0),document.removeEventListener("click",this.handleDocumentClick,!0))}},{key:"componentWillUnmount",value:function(){this.state.isVisible&&(document.removeEventListener("contextmenu",this.handleDocumentClick,!0),document.removeEventListener("click",this.handleDocumentClick,!0))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.constrainToScrollParent,i=e.constrainToWindow,o=e.offset,a=e.position,s=this.state.isVisible,l=d.Children.toArray(t),c=T[a];if(2!==l.length)throw new Error("Flyout must have exactly two children: A button component and a <Overlay>");var u=l[0],p=l[1],h={id:this.overlayButtonID,key:this.overlayButtonID,role:"button",onClick:this.handleButtonClick,"aria-haspopup":"true","aria-expanded":s?"true":"false"};s&&(h["aria-controls"]=this.overlayID);var g={id:this.overlayID,key:this.overlayID,role:"dialog",onClick:this.handleOverlayClick,onClose:this.handleOverlayClose,"aria-labelledby":this.overlayButtonID},v=[];r&&v.push({to:"scrollParent",attachment:"together"}),i&&v.push({to:"window",attachment:"together"});var y={classPrefix:"flyout-overlay",attachment:c.attachment,targetAttachment:c.targetAttachment,enabled:s,classes:{element:"flyout-overlay "+n},constraints:v};if(o)y.offset=o;else switch(a){case b:case _:case w:y.offset="-10px 0";break;case E:case C:case x:y.offset="10px 0";break;case S:y.offset="0 10px";break;case k:y.offset="0 -10px"}return f.default.createElement(m.default,y,(0,d.cloneElement)(u,h),s?(0,d.cloneElement)(p,g):null)}}]),t}(d.Component);I.propTypes={children:u.default.node.isRequired,className:u.default.string,closeOnClick:u.default.bool,closeOnClickOutside:u.default.bool,constrainToScrollParent:u.default.bool,constrainToWindow:u.default.bool,isVisibleByDefault:u.default.bool,onOpen:u.default.func,onClose:u.default.func,offset:u.default.string,position:u.default.oneOf(Object.keys(T))},I.defaultProps={className:"",closeOnClick:!0,closeOnClickOutside:!0,constrainToScrollParent:!0,constrainToWindow:!1,isVisibleByDefault:!1,position:w},t.default=I},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));
e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){e.stopPropagation(),e.preventDefault()}Object.defineProperty(t,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=n(1),d=r(u),f=n(0),p=r(f),m=n(31),h=r(m),g=n(26),v=r(g),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=["a[href]:not([tabindex='-1'])","area[href]:not([tabindex='-1'])","input:not([disabled]):not([tabindex='-1'])","select:not([disabled]):not([tabindex='-1'])","textarea:not([disabled]):not([tabindex='-1'])","button:not([disabled]):not([tabindex='-1'])","iframe:not([tabindex='-1'])","[tabindex]:not([tabindex='-1'])","[contentEditable=true]:not([tabindex='-1'])"].join(","),_=function(e){function t(){var e,n,r,i;o(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.updateAuxElementIDs=function(e){r.frontFocusableAuxElID=e+"-front-aux",r.backFocusableAuxElID=e+"-back-aux",r.trapFocusableAuxElID=e+"-trap-aux"},r.focusFirstItem=function(){var e=r.firstFocusableItem||r.trapFocusableItem;e.focus()},r.focusLastItem=function(){var e=r.lastFocusableItem||r.trapFocusableItem;e.focus()},r.closeOverlay=function(){var e=r.props.onClose;e&&setTimeout(function(){return e()},0)},r.handleKeyDown=function(e){switch(e.key){case"Escape":l(e),r.closeOverlay();break;case"Tab":if(e.target.id!==r.trapFocusableAuxElID)return;l(e)}},r.renderFrontFocusableAuxEl=function(){return p.default.createElement("div",{id:r.frontFocusableAuxElID,tabIndex:"0",onFocus:r.focusLastItem})},r.renderBackFocusableAuxEl=function(){return p.default.createElement("div",{id:r.backFocusableAuxElID,tabIndex:"0",onFocus:r.focusFirstItem})},r.renderFocusTrapEl=function(){return p.default.createElement("div",{id:r.trapFocusableAuxElID,tabIndex:"0",ref:function(e){r.trapFocusableItem=e}})},i=n,a(r,i)}return s(t,e),y(t,[{key:"componentWillMount",value:function(){var e=this.props.id;this.updateAuxElementIDs(e)}},{key:"componentDidMount",value:function(){var e=this,t=[].slice.call(this.overlayContentNode.querySelectorAll(b)),n=t.length;n&&(this.firstFocusableItem=t[0],this.lastFocusableItem=t[n-1]),setTimeout(function(){e.focusFirstItem()},0)}},{key:"componentWillUpdate",value:function(e){var t=e.id;this.updateAuxElementIDs(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.className,o=i(t,["children","className"]),a=(0,h.default)(o,["onClose"]);return a.className=r,a.onKeyDown=this.handleKeyDown,a.tabIndex=0,p.default.createElement("div",a,this.renderFrontFocusableAuxEl(),p.default.createElement("div",{className:"overlay",ref:function(t){e.overlayContentNode=t}},n),this.renderBackFocusableAuxEl(),this.renderFocusTrapEl())}}]),t}(f.Component);_.propTypes={children:d.default.node.isRequired,className:d.default.string,id:d.default.string,onClick:d.default.func,onClose:d.default.func},_.defaultProps={className:"",id:(0,v.default)("overlay")},t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#979797":r,o=e.width,a=void 0===o?12:o,l=e.height,u=void 0===l?12:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-trash "+n,title:f,width:a,height:u,viewBox:"0 0 12 12"},s.default.createElement("g",{className:"fill-color",fill:i},s.default.createElement("path",{d:"M11.2 0H0l1.8 11c.1.5.6 1 1.2 1h6c.5 0 1.1-.4 1.2-1L12 0h-.8zm-2 10.9s-.1.1-.2.1H3c-.1 0-.2-.1-.2-.1L1.2 1h9.6l-1.6 9.9z"}),s.default.createElement("path",{d:"M8.5 2h-5c-.3 0-.5.2-.5.5s.2.5.5.5h5c.3 0 .5-.2.5-.5S8.8 2 8.5 2z"})))};u.displayName="IconTrash",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.InlineEditBase=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(2),p=n(19),m=r(p),h=n(283),g=r(h),v=n(13),y=r(v),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=function(e){function t(){var e,n,r,a;i(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.onEdit=function(){var e=r.props,t=e.id,n=e.toEdit;n({id:t})},a=n,o(r,a)}return a(t,e),b(t,[{key:"render",value:function(){var e=this.onEdit;return d.default.createElement("div",{className:"box-ui-comment-edit-container"},d.default.createElement(m.default,{"aria-label":this.props.intl.formatMessage(y.default.editLabel),className:"box-ui-comment-edit",onClick:e,type:"button"},d.default.createElement(g.default,null)))}}]),t}(u.Component);_.propTypes={toEdit:c.default.func.isRequired,id:c.default.string.isRequired,intl:f.intlShape.isRequired},t.InlineEditBase=_,t.default=(0,f.injectIntl)(_)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#777777":r,o=e.width,a=void 0===o?13:o,l=e.height,u=void 0===l?13:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-pencil "+n,title:f,width:a,height:u,viewBox:"0 0 13 13"},s.default.createElement("path",{className:"fill-color",fill:i,d:"M12,1c-0.8-0.8-2.1-0.8-2.9,0L2,8.1c0,0,0,0-0.1,0.1l0,0c0,0,0,0,0,0.1l0,0L0.6,12c-0.1,0.2,0,0.4,0.2,0.5 c0.1,0,0.2,0,0.2,0l3.7-1.3l0,0c0,0,0,0,0.1,0l0,0c0,0,0,0,0.1-0.1l6.5-6.5l0,0L12,3.9C12.8,3.1,12.8,1.8,12,1z M4.6,10.2L2.8,8.4 l6-6l1.8,1.8L4.6,10.2z M2.4,9.1l1.5,1.5l-2.4,0.8L2.4,9.1z M11.5,3.4l-0.4,0.4L9.3,1.9l0.4-0.4c0.5-0.5,1.3-0.5,1.8,0 C12,2.1,12,2.9,11.5,3.4z"}))};u.displayName="IconPencil",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(2),p=n(33),m=r(p),h=n(19),g=r(h),v=n(107),y=r(v),b=n(13),_=r(b),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),S=function(e){var t=e.handleTranslate;return d.default.createElement(g.default,{className:"box-ui-comment-translate",onClick:t},d.default.createElement(f.FormattedMessage,_.default.commentTranslate))};S.propTypes={handleTranslate:c.default.func};var k=function(e){var t=e.handleShowOriginal;return d.default.createElement(g.default,{className:"box-ui-comment-translate",onClick:t},d.default.createElement(f.FormattedMessage,_.default.commentShowOriginal))};k.propTypes={handleShowOriginal:c.default.func};var E=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleTranslate=function(e){var t=n.props,r=t.id,i=t.taggedMessage,o=t.onTranslate,a=t.translatedTaggedMessage;a||(n.setState({isLoading:!0}),o({id:r,taggedMessage:i})),n.setState({isTranslation:!0}),e.preventDefault()},n.handleShowOriginal=function(e){n.setState({isTranslation:!1}),e.preventDefault()},n.state={isLoading:!1,isTranslation:!1},n}return a(t,e),w(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.translatedTaggedMessage,n=e.translationFailed;(t||n)&&this.setState({isLoading:!1})}},{key:"getButton",value:function(e){var t=null;return t=e?d.default.createElement(k,{handleShowOriginal:this.handleShowOriginal}):d.default.createElement(S,{handleTranslate:this.handleTranslate})}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.taggedMessage,r=e.translatedTaggedMessage,i=e.translationEnabled,o=this.state,a=o.isLoading,s=o.isTranslation,l=i&&s&&r?r:n;return a?d.default.createElement("div",{className:"box-ui-comment-text-loading"},d.default.createElement(m.default,{size:"small"})):d.default.createElement("div",{className:"box-ui-comment-text"},(0,y.default)(l,t,!1),i?this.getButton(s):null)}}]),t}(u.Component);E.propTypes={id:c.default.string.isRequired,taggedMessage:c.default.string.isRequired,translatedTaggedMessage:c.default.string,translationEnabled:c.default.bool,onTranslate:c.default.func,translationFailed:c.default.bool},E.defaultProps={translationEnabled:!1},t.default=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MentionItem=t.Mention=void 0;var i=n(108),o=r(i),a=n(109),s=r(a),l=n(287),c=r(l);t.Mention=o.default,t.MentionItem=s.default,t.default=c.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=function(e){var t=e.children,n=i(e,["children"]),r=t.replace(/\u200B/g,"");return l.default.createElement("span",n,r.length?r:"​")};c.displayName="DefaultContentSpan",c.propTypes={children:a.default.node.isRequired},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(2),m=n(7),h=r(m),g=n(31),v=r(g),y=n(11),b=n(288),_=r(b),w=n(109),S=r(w),k=n(113),E=r(k),C=n(293),x=r(C);n(100);var T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),I=function(e){var t=e.item;return f.default.createElement("span",null,t.name," ",f.default.createElement("span",{className:"dropdown-secondary-text"},t.email))};I.propTypes={item:u.default.shape({name:u.default.string,email:u.default.string})};var O=function(){return f.default.createElement(p.FormattedMessage,x.default.startMention)},D=function(e){var t=e.message;return f.default.createElement("div",{className:"mention-start-state"},t)};D.propTypes={message:u.default.node};var M=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onChange=function(e){var t=e.contentState,r=e.selectionState,i=n.props.onChange,o=n.state.mentionPattern,a=r.blockID,s=r.itemID,l=r.offset,c=t.findSelectionTarget(r),u=c.item,d=c.text;if("text"===u.type){var f=d.substr(0,l),p=f.match(o),m=p?{blockID:a,itemID:s,mentionString:p[2],mentionTrigger:p[1],start:p.index,end:p.index+p[0].length}:null;n.setState({activeMention:m},function(){m&&m.mentionString&&n.onMention()})}i&&i(e)},n.onMention=function(){var e=n.props.onMention,t=n.state.activeMention;e&&e(t?t.mentionString:"")},n.onContactSelection=function(e){var t=n.props.contacts;n.addMention(t[e]),n.setState({activeMention:null,isFocused:!0},function(){return n.onMention()})},n.onBlur=function(e){var t=n.props.onBlur;n.setState({isFocused:!1}),t&&t(e)},n.onFocus=function(e){var t=n.props.onFocus;n.setState({isFocused:!0}),t&&t(e)};var r=e.mentionTriggers.reduce(function(e,t){return e+"\\"+t},"");return n.state={activeMention:null,isFocused:!1,mentionPattern:new RegExp("(["+r+"])([^"+r+"]*)$")},n}return s(t,e),A(t,[{key:"componentWillReceiveProps",value:function(e,t){var n=e.contacts,r=this.props.contacts,i=t.activeMention;null===i||n.length||n===r||n.length===r.length||this.setState({activeMention:null})}},{key:"getMentionReplacement",value:function e(t,n){var e=this.props.getMentionReplacement;if(e)return e(t,n);var r=t.id,i=t.name;return new S.default(r,i,n)}},{key:"addMention",value:function(e){var t=this.props,n=t.editorState,r=t.onChange,i=this.state.activeMention,o=i.blockID,a=i.itemID,s=i.mentionTrigger,l=i.start,c=i.end,u=this.getMentionReplacement(e,s),d={collapsed:!1,collapsedTarget:!0,start:{blockID:o,itemID:a,offset:l},end:{blockID:o,itemID:a,offset:c}},f=n.insert(u,d);r&&r(f)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.contacts,r=e.contentEditableRef,o=e.editorState,a=e.error,s=e.isRequired,l=e.label,c=e.name,u=e.selectorRow,p=e.startMentionMessage,m=i(e,["className","contacts","contentEditableRef","editorState","error","isRequired","label","name","selectorRow","startMentionMessage"]),g=this.state,y=g.activeMention,b=g.isFocused,w=(0,v.default)(m,["onBlur","onChange","onFocus"]),S=(0,h.default)("mention-selector-wrapper",t),k=y&&y.mentionString&&n.length,C=y&&!y.mentionString&&b;return f.default.createElement("div",{className:S},f.default.createElement(E.default,{onItemSelected:this.onContactSelection,selectOnTab:!0,selector:f.default.createElement(_.default,T({editorState:o,error:a,inputRef:r,isFocused:b,isRequired:s,label:l,name:c,onBlur:this.onBlur,onFocus:this.onFocus,onChange:this.onChange},w))},k?n.map(function(e){return(0,d.cloneElement)(u,T({},u.props,e,{key:e.id}))}):[]),C?f.default.createElement(D,{message:p}):null)}}]),t}(d.Component);M.propTypes={className:u.default.string,contentEditableRef:u.default.func,contacts:y.SelectorItemsPropType.isRequired,editorState:u.default.instanceOf(b.EditorState).isRequired,error:u.default.object,getMentionReplacement:u.default.func,isRequired:u.default.bool,label:u.default.node.isRequired,mentionTriggers:u.default.arrayOf(u.default.string),name:u.default.string.isRequired,onBlur:u.default.func,onChange:u.default.func,onFocus:u.default.func,onMention:u.default.func,placeholder:u.default.string,selectorRow:u.default.node,startMentionMessage:u.default.node},M.defaultProps={className:"",isRequired:!1,mentionTriggers:["@","＠","﹫"],selectorRow:f.default.createElement(I,null),startMentionMessage:f.default.createElement(O,null)},t.default=M},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.EditorState=t.ContentState=t.ImmutableContentItem=t.ContentItem=void 0;var i=n(32),o=r(i),a=n(110),s=r(a),l=n(111),c=r(l),u=n(112),d=r(u),f=n(289),p=r(f);t.ContentItem=o.default,t.ImmutableContentItem=s.default,t.ContentState=c.default,t.EditorState=d.default,t.default=p.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){if(e.dataset&&e.dataset.block)return{blockID:parseInt(e.dataset.block,10),itemID:parseInt(e.firstElementChild.dataset.item,10)};for(;!e.dataset||!e.dataset.item;)e=e.parentNode;var t=e.parentNode,n=parseInt(t.dataset.block,10),r=parseInt(e.dataset.item,10);return{blockID:n,itemID:r}}function l(e){var t=e.metaKey,n=e.ctrlKey,r=e.key;return t&&"Meta"!==r?"Meta+"+r:n&&"Control"!==r?"Ctrl+"+r:r}function c(e){var t=e.types?"text/plain":"Text";return e.getData(t)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=n(1),f=r(d),p=n(0),m=r(p),h=n(7),g=r(h),v=n(112),y=r(v),b=n(32),_=r(b),w=n(23),S=r(w),k=n(10),E=r(k);n(290);var C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),T=function(e){function t(){var e,n,r,a;i(this,t);for(var s=arguments.length,u=Array(s),d=0;d<s;d++)u[d]=arguments[d];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.onBeforeInput=function(e){var t=e.data;if(t){var n=r.props.editorState,i=r.getSelectionState(),o=!1;e.preventDefault();var a=new _.default(t),s=n.insert(a,i,o);r.onChange(s)}},r.onChange=function(e){if(e){var t=r.props.onChange;t&&t(e)}},r.onCompositionStart=function(){var e=r.props.editorState,t=e.setCompositionMode(!0);r.onChange(t)},r.onCompositionEnd=function(e){var t=r.props.editorState,n=e.data;if(!n){var i=t.setCompositionMode(!1);r.onChange(i)}},r.onKeyDown=function(e){var t=r.props.editorState;if(t.inCompositionMode)return void e.preventDefault();var n=r.getSelectionState(),i=l(e);switch(i){case"Backspace":if(e.preventDefault(),!t.hasContent())return;r.onChange(t.remove(n,"backward"));break;case"Delete":if(e.preventDefault(),!t.hasContent())return;r.onChange(t.remove(n,"forward"));break;case"Enter":e.preventDefault(),r.onChange(t.addNewLine(n));break;case"Meta+x":case"Ctrl+x":if(e.preventDefault(),n.collapsed||!t.hasContent())return;document.execCommand("copy"),r.onChange(t.remove(n,"backward"));break;case"Meta+z":case"Ctrl+z":e.preventDefault(),r.onChange(t.undo());break;case"Meta+Z":case"Ctrl+y":e.preventDefault(),r.onChange(t.redo())}},r.onPaste=function(e){var t=e.clipboardData,n=t?c(t):null;if(n&&n.length){var i=r.props.editorState,o=r.getSelectionState();r.onChange(i.insert(new _.default(n),o,!1))}e.stopPropagation(),e.preventDefault()},a=n,o(r,a)}return a(t,e),x(t,[{key:"shouldComponentUpdate",value:function(e){var t=e.editorState,n=e.error,r=e.isFocused,i=this.props,o=i.editorState,a=i.error,s=i.isFocused;return s!==r||(!(a===n||n&&a&&a.code===n.code)||(!t.allowNativeRender||t!==o))}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.editorState,r=t.isFocused,i=e.editorState,o=e.isFocused,a=n.contentData!==i.contentData&&r;if(a){var s=n.selectionState,l=s.blockID,c=s.itemID,u=s.offset,d=this.editor.querySelector('div[data-block="'+l+'"] [data-item="'+c+'"]'),f=d.firstChild,p=document.createRange(),m=f?Math.min(u,f.length):0;p.setStart(f,m),p.setEnd(f,m);var h=window.getSelection();!o&&r?setTimeout(function(){h.removeAllRanges(),h.addRange(p)},0):(h.removeAllRanges(),h.addRange(p)),this.updateScrollPosition(d)}}},{key:"getSelectionState",value:function(){var e=window.getSelection().getRangeAt(0),t=e.collapsed,n=e.startOffset,r=e.startContainer,i=e.endContainer,o=e.endOffset;r===this.editor&&i===this.editor&&(r=r.firstElementChild.firstElementChild,i=i.lastElementChild.lastElementChild,o=i.innerText.length);var a=C({},s(r),{offset:n}),l=t?a:C({},s(i),{offset:o});return{collapsed:t,collapsedTarget:a.blockID===l.blockID&&a.itemID===l.itemID,start:a,end:l}}},{key:"updateScrollPosition",value:function(e){var t=this.editor,n=t.clientHeight,r=t.scrollHeight;if(!(r-n<=0)){var i=t.getBoundingClientRect(),o=i.top,a=e.getBoundingClientRect(),s=a.bottom,l=s-o;l<=n||(t.scrollTop+=l-n)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.editorState,r=t.error,i=t.inputRef,o=t.isDisabled,a=t.isRequired,s=t.label,l=t.maxLength,c=t.minLength,u=t.name,d=t.onBlur,f=t.onFocus,p=t.placeholder,h=this.onBeforeInput,v=this.onCompositionStart,y=this.onCompositionEnd,b=this.onKeyDown,_=this.onPaste,w=n.contentData,k=n.text,x=(0,g.default)({"content-editable-container":!0,"is-disabled":o,"show-error":!!r}),T=n.hasContent()||n.inCompositionMode;return m.default.createElement("div",{className:x},m.default.createElement("textarea",{className:"content-editable-hidden-input",maxLength:l,minLength:c,name:u,ref:i,required:a,value:k,readOnly:!0}),m.default.createElement(S.default,{text:s,showOptionalText:!a},m.default.createElement(E.default,{isShown:!!r,text:r?r.message:"",theme:"error",position:"bottom-left"},m.default.createElement("div",{className:"content-editable "+(T?"":"is-empty"),contentEditable:!o,onBeforeInput:h,onBlur:d,onCompositionStart:v,onCompositionEnd:y,onFocus:f,onKeyDown:b,onPaste:_,placeholder:p,ref:function(t){e.editor=t},suppressContentEditableWarning:!0},w.map(function(e,t){return m.default.createElement("div",{"data-block":t,key:t},e.map(function(e,t){var n=e.component,r=e.data,i=e.text;return m.default.createElement(n,C({key:t,"data-item":t},r),i)}))})))))}}]),t}(p.Component);T.propTypes={editorState:f.default.instanceOf(y.default).isRequired,error:f.default.object,inputRef:f.default.func,isDisabled:f.default.bool,isFocused:f.default.bool,isRequired:f.default.bool,label:f.default.node.isRequired,maxLength:f.default.number,minLength:f.default.number,name:f.default.string.isRequired,onBlur:f.default.func.isRequired,onFocus:f.default.func.isRequired,onChange:f.default.func,placeholder:f.default.string},T.defaultProps={isRequired:!1,isFocused:!1},t.default=T},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(55),p=r(f);n(292);var m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),m(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.isVisible,i=e.onClickOutside;return d.default.createElement(p.default,{className:n,isVisible:r,onClickOutside:i},d.default.createElement("menu",{className:"menu"},u.Children.map(t,function(e,t){return d.default.createElement("li",{key:t},e)})))}}]),t}(u.Component);h.propTypes={children:c.default.node.isRequired,className:c.default.string,isVisible:c.default.bool,onClickOutside:c.default.func},h.defaultProps={className:"",isVisible:!1},t.default=h},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=(0,r.defineMessages)({startMention:{id:"boxui.mentionSelector.startMention",defaultMessage:"Mention someone to notify them"}});t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(2),c=n(295),u=n(13),d=r(u),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=36e5,m=function(e){var t=e.timestamp,n=Date.now()-p,r=d.default.commentPostedTime;return(0,c.isToday)(t)?r=d.default.commentPostedTimeToday:(0,c.isYesterday)(t)&&(r=d.default.commentPostedTimeYesterday),t>n?s.default.createElement(l.FormattedRelative,{value:t}):s.default.createElement(l.FormattedMessage,f({},r,{values:{time:t}}))};m.displayName="CommentPostedTime",m.propTypes={timestamp:o.default.number.isRequired},t.default=m},function(e,t,n){"use strict";function r(e){return e*s}function i(e){var t=new Date,n=new Date(e);return t.toDateString()===n.toDateString()}function o(e){return i(e+l)}function a(e){return i(e-l)}Object.defineProperty(t,"__esModule",{value:!0});var s=1e3,l=86400*s;t.convertToMs=r,t.isToday=i,t.isTomorrow=a,t.isYesterday=o},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.IconActivityFeedEmptyState=void 0;var i=n(298),o=r(i);t.IconActivityFeedEmptyState=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.width,i=void 0===r?90:r,o=e.height,a=void 0===o?90:o;return s.default.createElement(c.default,{className:"box-ui-activity-feed-empty-state-illustration "+n,width:i,height:a,viewBox:"0 0 90 90"},s.default.createElement("g",{fill:"none",fillRule:"evenodd"},s.default.createElement("g",{className:"themed-fill",fill:"#1891D3"},s.default.createElement("path",{d:"M12.063 40.71v-.403c0-.17-.145-.307-.313-.307-.173 0-.313.134-.313.307v.402c-.094.054-.173.133-.228.227h-.403c-.17 0-.307.145-.307.313 0 .173.134.313.307.313h.402c.054.094.133.173.227.228v.403c0 .17.145.307.313.307.173 0 .313-.144.313-.303v-.406c.094-.054.173-.133.228-.227h.403c.17 0 .307-.145.307-.313 0-.173-.134-.313-.307-.313h-.402c-.054-.094-.133-.173-.227-.228zM86.063 65.71v-.403c0-.17-.145-.307-.313-.307-.173 0-.313.134-.313.307v.402c-.094.054-.173.133-.228.228h-.403c-.17 0-.307.144-.307.312 0 .173.134.313.307.313h.402c.054.094.133.173.227.228v.403c0 .17.145.307.313.307.173 0 .313-.144.313-.303v-.406c.094-.054.173-.133.228-.228h.403c.17 0 .307-.144.307-.312 0-.173-.134-.313-.307-.313h-.402c-.054-.094-.133-.173-.228-.228zM82.063 58.71v-.403c0-.17-.145-.307-.313-.307-.173 0-.313.134-.313.307v.402c-.094.054-.173.133-.228.227h-.403c-.17 0-.307.145-.307.313 0 .173.134.313.307.313h.402c.054.094.133.173.228.228v.403c0 .17.144.307.312.307.173 0 .313-.144.313-.303v-.406c.094-.054.173-.133.228-.227h.403c.17 0 .307-.145.307-.313 0-.173-.134-.313-.307-.313h-.402c-.054-.094-.133-.173-.228-.228zM5.5 48.134v-.642C5.5 47.22 5.268 47 5 47c-.276 0-.5.215-.5.49v.644c-.152.088-.278.214-.366.366H3.49c-.27 0-.49.232-.49.5 0 .276.215.5.49.5h.644c.088.152.214.278.366.366v.644c0 .27.232.49.5.49.276 0 .5-.23.5-.505v-.63c.152-.087.278-.213.366-.365h.644c.27 0 .49-.232.49-.5 0-.276-.215-.5-.49-.5h-.644c-.088-.152-.214-.278-.366-.366zM72.5 80.134v-.642c0-.272-.232-.492-.5-.492-.276 0-.5.215-.5.49v.644c-.152.088-.278.214-.366.366h-.644c-.27 0-.49.232-.49.5 0 .276.215.5.49.5h.644c.088.152.214.278.366.366v.644c0 .27.232.49.5.49.276 0 .5-.23.5-.505v-.63c.152-.087.278-.213.366-.365h.644c.27 0 .49-.232.49-.5 0-.276-.215-.5-.49-.5h-.644c-.088-.152-.214-.278-.366-.366zM9.5 24.134v-.642C9.5 23.22 9.268 23 9 23c-.276 0-.5.215-.5.49v.644c-.152.088-.278.214-.366.366H7.49c-.27 0-.49.232-.49.5 0 .276.215.5.49.5h.644c.088.152.214.278.366.366v.644c0 .27.232.49.5.49.276 0 .5-.23.5-.505v-.63c.152-.087.278-.213.366-.365h.644c.27 0 .49-.232.49-.5 0-.276-.215-.5-.49-.5h-.644c-.088-.152-.214-.278-.366-.366zM25.5 4.134v-.642C25.5 3.22 25.268 3 25 3c-.276 0-.5.215-.5.49v.644c-.152.088-.278.214-.366.366h-.644c-.27 0-.49.232-.49.5 0 .276.215.5.49.5h.644c.088.152.214.278.366.366v.644c0 .27.232.49.5.49.276 0 .5-.23.5-.505v-.63c.152-.087.278-.213.366-.365h.644c.27 0 .49-.232.49-.5 0-.276-.215-.5-.49-.5h-.644c-.088-.152-.214-.278-.366-.366z"})),s.default.createElement("g",{transform:"translate(31.482 4.398)"},s.default.createElement("path",{className:"themed-stroke",d:"M24.1 37.948c1.336 1.475-1.102 3.144-1.132 5.456-.02 1.52 8.14-4.42 8.71-6.216 5.084-.824 14.258-5.722 14.258-17.522C45.936 7.866 36.036 0 22.968 0 9.898 0 0 7.866 0 19.666S10.013 40.05 24.1 37.948z",stroke:"#1891D3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#FFF"}),s.default.createElement("path",{className:"themed-stroke",d:"M12.974 21.807c1.162 0 2.104-.945 2.104-2.11 0-1.166-.942-2.11-2.104-2.11-1.162 0-2.104.944-2.104 2.11 0 1.165.942 2.11 2.104 2.11z",
stroke:"#1891D3",strokeWidth:"2",fill:"#FFF"}),s.default.createElement("ellipse",{className:"themed-stroke",stroke:"#1891D3",strokeWidth:"2",fill:"#FFF",cx:"22.793",cy:"19.696",rx:"2.104",ry:"2.11"}),s.default.createElement("ellipse",{className:"themed-stroke",stroke:"#1891D3",strokeWidth:"2",fill:"#FFF",cx:"32.611",cy:"19.696",rx:"2.104",ry:"2.11"}),s.default.createElement("path",{className:"themed-fill",d:"M29.27 34.837c8.045 0 14.566-6.918 14.566-15.452 0-8.534-6.52-15.452-14.565-15.452-1.35 0 9.78 5.064 9.27 15.452-.694 14.103-14.178 15.452-9.27 15.452z",fillOpacity:".1",fill:"#1891D3"})),s.default.createElement("g",{transform:"translate(12.398 27.472)"},s.default.createElement("path",{className:"themed-stroke",d:"M32.44 20.89v12.887c0 5.89-4.78 10.665-10.662 10.665H13.77c-5.886 0-10.66-4.773-10.66-10.665V20.89",stroke:"#1891D3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.default.createElement("rect",{className:"themed-stroke",stroke:"#1891D3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#FFF",x:"7.11",width:"21.33",height:"40",rx:"7.144"}),s.default.createElement("path",{className:"themed-fill",d:"M9.332 31.536v-.71s2.503 2.462 5.344 1.686c1.562-.427 4.228 2.16 6.83 1.905 2.128-.208 4.712-2.694 4.712-2.694v-.19 2.233c0 2.207-1.792 3.996-4.002 3.996h-8.883c-2.21 0-4-1.78-4-3.996v-2.23z",fillOpacity:".1",fill:"#1891D3"}),s.default.createElement("path",{className:"themed-stroke",d:"M3.11 27.11v-6.22C1.394 20.89 0 22.28 0 24s1.393 3.11 3.11 3.11z",stroke:"#1891D3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#FFF"}),s.default.createElement("path",{className:"themed-stroke",d:"M3.555 24H7.11M7.11 7h7.11M21.33 7h7.11M7.11 12h7.11M21.33 12h7.11M7.11 17h7.11M21.33 17h7.11M28.884 24h3.555",stroke:"#1891D3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.default.createElement("path",{className:"themed-stroke",d:"M32.44 27.11v-6.22c1.717 0 3.11 1.392 3.11 3.11s-1.393 3.11-3.11 3.11zM6.665 21.778h22.218v4.444H6.665zM15.997 44.444h3.555V55.11h-3.555z",stroke:"#1891D3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#FFF"}),s.default.createElement("path",{className:"themed-stroke",stroke:"#1891D3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#FFF",d:"M10.665 53.778h14.22v4.444h-14.22z"}))))};u.displayName="IconActivityFeedEmptyState",u.propTypes={className:o.default.string,height:o.default.number,width:o.default.number},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(300),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(2),p=n(19),m=r(p),h=n(10),g=r(h),v=n(301),y=r(v),b=n(302),_=r(b),w=n(11),S=n(104),k=r(S),E=n(13),C=r(E);n(303);var x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A="approved",I="rejected",O="completed",D="incomplete",M=function(e){var t=e.name;return d.default.createElement("div",{className:"box-ui-task-completed-assignment"},d.default.createElement("div",{className:"box-ui-task-assignment-name"},t),d.default.createElement("div",{className:"box-ui-task-assignment-actions"},d.default.createElement(y.default,{className:"box-ui-task-check-icon",height:18,title:d.default.createElement(f.FormattedMessage,C.default.completedAssignment),width:18})))};M.propTypes={name:c.default.string};var P=function(e){var t=e.name;return d.default.createElement("div",{className:"box-ui-task-rejected-assignment"},d.default.createElement("div",{className:"box-ui-task-assignment-name"},t),d.default.createElement("div",{className:"box-ui-task-assignment-actions"},d.default.createElement(_.default,{className:"box-ui-task-x-icon",height:18,title:d.default.createElement(f.FormattedMessage,C.default.rejectedAssignment),width:18})))};P.propTypes={name:c.default.string};var N=function(e){var t=e.name,n=e.onTaskApproval,r=e.onTaskReject,i=e.shouldShowActions;return d.default.createElement("div",{className:"box-ui-task-pending-assignment"},d.default.createElement("div",{className:"box-ui-task-assignment-name"},t),i?d.default.createElement("div",{className:"box-ui-task-assignment-actions"},d.default.createElement(g.default,{position:"bottom-center",text:d.default.createElement(f.FormattedMessage,C.default.taskApprove)},d.default.createElement(m.default,{className:"box-ui-task-check-btn",onClick:n},d.default.createElement(y.default,{className:"box-ui-task-check-icon",height:18,width:18}))),d.default.createElement(g.default,{position:"bottom-center",text:d.default.createElement(f.FormattedMessage,C.default.taskReject)},d.default.createElement(m.default,{className:"box-ui-task-x-btn",onClick:r},d.default.createElement(_.default,{className:"box-ui-task-x-icon",height:18,width:18})))):null)};N.displayName="PendingAssignment",N.propTypes={name:c.default.string,onTaskApproval:c.default.func,onTaskReject:c.default.func,shouldShowActions:c.default.bool};var R=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),T(t,[{key:"render",value:function(){var e=this.props,t=e.assignees,n=e.createdAt,r=e.createdBy,i=e.currentUser,o=e.dueDate,a=e.error,s=e.handlers,l=e.id,c=e.inputState,u=e.isPending,p=e.onDelete,m=e.onEdit,h=e.onTaskAssignmentUpdate,g=e.permissions,v=e.taggedMessage,y=e.translatedTaggedMessage,b=e.translations;return d.default.createElement("div",{className:"box-ui-task "+(u||a?"is-pending":"")},d.default.createElement(k.default,{createdAt:n,createdBy:r,currentUser:i,error:a,handlers:s,id:l,inputState:c,isPending:u,onDelete:p,onEdit:m,permissions:g,taggedMessage:v,translatedTaggedMessage:y,translations:b}),d.default.createElement("div",{className:"box-ui-task-approvers-container"},d.default.createElement("div",{className:"box-ui-task-approvers-header"},d.default.createElement("strong",null,d.default.createElement(f.FormattedMessage,C.default.tasksForApproval)),o?d.default.createElement("span",{className:"box-ui-task-due-date"},d.default.createElement(f.FormattedMessage,C.default.taskDueDate),d.default.createElement(f.FormattedDate,{value:o,day:"numeric",month:"long",year:"numeric"})):null),d.default.createElement("div",{className:"box-ui-task-assignees"},t.map(function(e){var t=e.id,n=e.user,r=e.status;switch(r){case D:return d.default.createElement(N,x({},n,{key:n.id,onTaskApproval:function(){return h(l,t,A)},onTaskReject:function(){return h(l,t,I)},shouldShowActions:h&&n.id===i.id}));case O:case A:return d.default.createElement(M,x({},n,{key:n.id}));case I:return d.default.createElement(P,x({},n,{key:n.id}));default:return null}}))))}}]),t}(u.Component);R.propTypes={assignees:c.default.arrayOf(c.default.shape({id:c.default.number.isRequired,user:w.UserPropType.isRequired,status:c.default.string.isRequired})),createdAt:c.default.any,createdBy:w.UserPropType.isRequired,currentUser:w.UserPropType.isRequired,dueDate:c.default.any,error:w.ActionItemErrorPropType,handlers:c.default.shape({comments:c.default.shape({create:c.default.func,delete:c.default.func}),tasks:c.default.shape({create:c.default.func,delete:c.default.func,onTaskAssignmentUpdate:c.default.func}),contacts:c.default.shape({getApproverWithQuery:c.default.func.isRequired,getMentionWithQuery:c.default.func.isRequired}),versions:c.default.shape({info:c.default.func})}),id:c.default.string.isRequired,inputState:c.default.shape({approverSelectorContacts:w.SelectorItemsPropType,mentionSelectorContacts:w.SelectorItemsPropType,currentUser:w.UserPropType.isRequired,isDisabled:c.default.bool}),isPending:c.default.bool,onDelete:c.default.func,onEdit:c.default.func,onTaskAssignmentUpdate:c.default.func,permissions:c.default.shape({comment_delete:c.default.bool,comment_edit:c.default.bool}),translatedTaggedMessage:c.default.string,translations:c.default.shape({translationEnabled:c.default.bool,onTranslate:c.default.func}),taggedMessage:c.default.string.isRequired},t.default=R},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#000000":r,o=e.width,a=void 0===o?24:o,l=e.height,u=void 0===l?24:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-check "+n,title:f,height:u,viewBox:"0 0 24 24",width:a},s.default.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),s.default.createElement("path",{className:"fill-color",d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z",fill:i}))};u.displayName="IconCheck",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#000000":r,o=e.width,a=void 0===o?24:o,l=e.height,u=void 0===l?24:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-close "+n,title:f,width:a,height:u,viewBox:"0 0 24 24"},s.default.createElement("path",{className:"fill-color",d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:i}),s.default.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))};u.displayName="IconClose",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.VersionError=t.CollapsedVersion=void 0;var i=n(305),o=r(i),a=n(306),s=r(a),l=n(307),c=r(l);t.CollapsedVersion=o.default,t.VersionError=s.default,t.default=c.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){if("upload"!==e)return null;var i=Object.keys(t),o=i.length;if(1===o){var a=t[i[0]];return l.default.createElement(c.FormattedMessage,v({},g.default.versionUploadCollapsed,{values:{name:l.default.createElement("strong",null,a.name),versions:l.default.createElement("span",{className:"box-ui-version-range"},n," - ",r)}}))}return l.default.createElement(c.FormattedMessage,v({},g.default.versionMultipleUsersUploaded,{values:{numberOfCollaborators:o,versions:l.default.createElement("span",{className:"box-ui-version-range"},n," - ",r)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsedVersionBase=void 0;var o=n(1),a=r(o),s=n(0),l=r(s),c=n(2),u=n(19),d=r(u),f=n(56),p=r(f),m=n(11),h=n(13),g=r(h);n(57);var v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y=function(e){var t=e.action,n=e.collaborators,r=e.intl,o=e.onInfo,a=e.versions,s=e.versionStart,c=e.versionEnd;return l.default.createElement("div",{className:"box-ui-collapsed-version"},l.default.createElement("span",{className:"box-ui-version-message"},i(t,n,s,c)),o?l.default.createElement("span",{className:"box-ui-version-actions"},l.default.createElement(d.default,{"aria-label":r.formatMessage(g.default.getVersionInfo),className:"box-ui-version-info",onClick:function(){o({versions:a})},type:"button"},l.default.createElement(p.default,{height:16,width:16}))):null)};y.displayName="CollapsedVersion",y.propTypes={action:a.default.oneOf(["upload"]).isRequired,collaborators:a.default.objectOf(m.UserPropType).isRequired,intl:c.intlShape.isRequired,onInfo:a.default.func,versions:a.default.array,versionStart:a.default.number.isRequired,versionEnd:a.default.number.isRequired},t.CollapsedVersionBase=y,t.default=(0,c.injectIntl)(y)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){switch(e){case"tooManyVersions":return l.default.createElement(c.FormattedMessage,d.default.versionTooManyVersions);default:return null}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(2),u=n(13),d=r(u);n(57);var f=function(e){var t=e.errorCode;return l.default.createElement("div",{className:"box-ui-version error"},l.default.createElement("span",{className:"box-ui-version-message"},i(t)))};f.displayName="VersionError",f.propTypes={errorCode:a.default.string.isRequired},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){switch(t){case"upload":return l.default.createElement(c.FormattedMessage,v({},g.default.versionUploaded,{values:{name:l.default.createElement("strong",null,e),versionNumber:n}}));case"delete":return l.default.createElement(c.FormattedMessage,v({},g.default.versionDeleted,{values:{name:l.default.createElement("strong",null,e),versionNumber:n}}));case"restore":return l.default.createElement(c.FormattedMessage,v({},g.default.versionRestored,{values:{name:l.default.createElement("strong",null,e),versionNumber:n}}));default:return null}}Object.defineProperty(t,"__esModule",{value:!0}),t.VersionBase=void 0;var o=n(1),a=r(o),s=n(0),l=r(s),c=n(2),u=n(19),d=r(u),f=n(56),p=r(f),m=n(11),h=n(13),g=r(h);n(57);var v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y=function(e){var t=e.action,n=e.createdBy,r=e.id,o=e.intl,a=e.onInfo,s=e.versionNumber;return l.default.createElement("div",{className:"box-ui-version"},l.default.createElement("span",{className:"box-ui-version-message"},i(n.name,t,s)),a?l.default.createElement("span",{className:"box-ui-version-actions"},l.default.createElement(d.default,{"aria-label":o.formatMessage(g.default.getVersionInfo),className:"box-ui-version-info",onClick:function(){a({id:r,versionNumber:s})},type:"button"},l.default.createElement(p.default,{height:16,width:16}))):null)};y.displayName="Version",y.propTypes={action:a.default.oneOf(["delete","restore","upload"]).isRequired,createdBy:m.UserPropType.isRequired,id:a.default.string.isRequired,intl:c.intlShape.isRequired,onInfo:a.default.func,versionNumber:a.default.number},t.VersionBase=y,t.default=(0,c.injectIntl)(y)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(309),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){switch(e){case"applied":return l.default.createElement(c.FormattedMessage,h.default.keywordsApplied);default:return null}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(2),u=n(56),d=r(u),f=n(10),p=r(f),m=n(13),h=r(m);n(310);var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v=function(e){var t=e.words;return l.default.createElement("span",{className:"box-ui-keywords-actions"},l.default.createElement(p.default,{className:"box-ui-keywords-actions-tooltip",position:"bottom-left",text:l.default.createElement(c.FormattedMessage,g({},h.default.keywordsList,{values:{words:t}}))},l.default.createElement("div",{className:"box-ui-keywords-info"},l.default.createElement(d.default,{height:16,width:16}))))};v.displayName="Info",v.propTypes={words:a.default.string};var y=function(e){var t=e.action,n=e.words;return l.default.createElement("div",{className:"box-ui-keywords"},l.default.createElement("span",{className:"box-ui-keywords-message"},i(t)),n?l.default.createElement(v,{words:n}):null)};y.displayName="Keywords",y.propTypes={action:a.default.oneOf(["applied"]).isRequired,words:a.default.string.isRequired},t.default=y},function(e,t){},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SearchMetadataFilter=t.SearchMetadata=void 0;var i=n(114),o=r(i),a=n(325),s=r(a);t.SearchMetadata=o.default,t.SearchMetadataFilter=s.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(314),c=r(l),u=n(315),d=r(u),f=n(319),p=r(f),m=n(322),h=r(m),g=function(e){var t=e.field,n=e.onChange,r=t.widget,i=t.id,o=t.format,a=t.isText,l=t.displayName,u=t.options,f=t.description,m=t.initialValue;switch(r){case"text":return s.default.createElement(h.default,{id:i,format:o,isText:a,onChange:n,label:l,description:f,initialValue:m});case"dropdown":return s.default.createElement(p.default,{id:i,format:o,isText:a,onChange:n,label:l,options:u,description:f,initialValue:m});case"datetimeRange":return s.default.createElement(c.default,{id:i,format:o,onChange:n,label:l,description:f,initialValue:m});case"numericRange":return s.default.createElement(d.default,{id:i,format:o,onChange:n,label:l,description:f,initialValue:m});default:return null}};g.propTypes={field:o.default.shape({widget:o.default.string.isRequired,id:o.default.string.isRequired,format:o.default.string.isRequired,displayName:o.default.string.isRequired,isText:o.default.bool,description:o.default.string,options:o.default.arrayOf(o.default.shape({value:o.default.string.isRequired,displayName:o.default.string.isRequired})),initialValue:o.default.shape({enum:o.default.arrayOf(o.default.string),range:o.default.shape({gt:o.default.oneOfType([o.default.string,o.default.number]),lt:o.default.oneOfType([o.default.string,o.default.number])})})}).isRequired,onChange:o.default.func.isRequired},t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":l(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=new Date(e),n=t.getTime(),r=t.getTimezoneOffset(),i=r*y,o=n+i;return new Date(o)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),u=r(c),d=n(0),f=r(d),p=n(2),m=n(92),h=r(m),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=(0,p.defineMessages)({inputPlaceholder:{id:"boxui.searchMetadata.setDateInputPlaceholder",defaultMessage:"Set Date"},fromLabel:{id:"boxui.searchMetadata.fromDateInputLabel",defaultMessage:"From"},toLabel:{id:"boxui.searchMetadata.toDateInputLabel",defaultMessage:"To"}}),y=6e4,b=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.formatField=function(){var e=n.props,t=e.id,r=e.format,i=e.onChange,o=n.state,a=o.fromValue,s=o.toValue,l=null;if(a||s){var c={};a&&(c.gt=a),s&&(c.lt=s),l={key:t,format:r,value:{range:c}}}i(t,l)},n.handleFromChange=function(e,t){t!==n.state.fromValue&&n.setState({fromDate:e,fromValue:t},function(){n.formatField()})},n.handleToChange=function(e,t){t!==n.state.toValue&&n.setState({toDate:e,toValue:t},function(){n.formatField()})};var r=e.initialValue.range,a=r.gt,l=void 0===a?"":a,c=r.lt,u=void 0===c?"":c;return n.state={fromDate:l?s(l):null,toDate:u?s(u):null,fromValue:l,toValue:u},n}return a(t,e),g(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.label,r=e.description,i=this.state,o=i.fromDate,a=i.toDate,s=this.handleMouseEnter,l=this.handleMouseLeave,c=this.handleFromChange,u=this.handleToChange,d=t.formatMessage;return f.default.createElement("fieldset",{className:"metadata-field"},f.default.createElement("legend",{onMouseEnter:s,onMouseLeave:l},n),f.default.createElement(h.default,{dateFormat:"utcISOString",hideOptionalLabel:!0,label:d(v.fromLabel),maxDate:a||new Date("3000-01-01T00:00:00.000Z"),name:"",onChange:c,placeholder:d(v.inputPlaceholder),resinTarget:"metadatavalue",value:o}),f.default.createElement(h.default,{dateFormat:"utcISOString",hideOptionalLabel:!0,label:d(v.toLabel),minDate:o||new Date(0),name:"",onChange:u,placeholder:d(v.inputPlaceholder),resinTarget:"metadatavalue",value:a}),f.default.createElement("small",null,r))}}]),t}(d.Component);b.propTypes={intl:p.intlShape.isRequired,id:u.default.string.isRequired,format:u.default.string.isRequired,onChange:u.default.func.isRequired,label:u.default.string.isRequired,description:u.default.string,initialValue:u.default.shape({range:u.default.shape({gt:u.default.string,lt:u.default.string}).isRequired})},b.defaultProps={initialValue:{range:{}}},t.default=(0,p.injectIntl)(b)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){switch(t){case _:if(/^(\-|\+)?([0-9]+)$/.test(e))return parseInt(e,10);break;case w:if(/^(\-|\+)?([0-9]+)(.[0-9]+)?$/.test(e))return parseFloat(e)}return null}function l(e,t){switch(e){case _:return t(k.invalidIntegerValueError);case w:return t(k.invalidFloatValueError);case _+S:return t(k.invalidIntegerRangeError);case w+S:return t(k.invalidFloatRangeError);default:return""}}Object.defineProperty(t,"__esModule",{value:!0}),t.SearchMetadataNumericRangeFieldBase=void 0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=n(1),d=r(u),f=n(0),p=r(f),m=n(2),h=n(115),g=r(h),v=n(39),y=r(v),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_="integer",w="float",S="range",k=(0,m.defineMessages)({fromLabel:{id:"boxui.searchMetadata.fromNumericInputLabel",defaultMessage:"From"},toLabel:{id:"boxui.searchMetadata.toNumericInputLabel",defaultMessage:"To"},invalidIntegerValueError:{id:"boxui.searchMetadata.invalidIntegerValueError",defaultMessage:"Invalid integer value"},invalidFloatValueError:{id:"boxui.searchMetadata.invalidFloatValueError",defaultMessage:"Invalid float value"},invalidIntegerRangeError:{id:"boxui.searchMetadata.invalidIntegerRangeError",defaultMessage:"Invalid integer range"},invalidFloatRangeError:{id:"boxui.searchMetadata.invalidFloatRangeError",defaultMessage:"Invalid float range"}}),E=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.formatField=function(){var e=n.fromInputEl,t=n.toInputEl,r=n.props,i=r.id,o=r.format,a=r.onChange,s=n.state,l=s.fromValue,c=s.toValue,u=null!==l,d=!u&&e.value,f=null!==c,p=!f&&t.value,m=!(u&&f&&c<l),h=null;if((u||f)&&!d&&!p&&m){var g={};u&&(g.gt=l),f&&(g.lt=c),h={key:i,format:o,value:{range:g}}}a(i,h)},n.checkRangeValidity=function(e){var t=n.fromInputEl,r=n.toInputEl,i=n.props,o=i.format,a=i.intl,s=n.state,c=s.fromValue,u=s.toValue;null!==c&&null!==u&&u<c?e.setCustomValidity(l(o+S,a.formatMessage)):(t.setCustomValidity(""),r.setCustomValidity("")),n.setState({fromError:t.validationMessage,toError:r.validationMessage})},n.checkFromValidity=function(){var e=n.fromInputEl,t=n.props,r=t.format,i=t.intl,o=n.state.fromValue;e.value&&null===o?(e.setCustomValidity(l(r,i.formatMessage)),n.setState({fromError:e.validationMessage})):n.checkRangeValidity(e)},n.checkToValidity=function(){var e=n.toInputEl,t=n.props,r=t.format,i=t.intl,o=n.state.toValue;e.value&&null===o?(e.setCustomValidity(l(r,i.formatMessage)),n.setState({toError:e.validationMessage})):n.checkRangeValidity(e)},n.handleFromChange=function(e){var t=n.props.format,r=n.state.fromError,i=s(e.target.value,t);n.setState({fromValue:i},function(){r&&n.checkFromValidity(),n.formatField()})},n.handleToChange=function(e){var t=n.props.format,r=n.state.toError,i=s(e.target.value,t);n.setState({toValue:i},function(){r&&n.checkToValidity(),n.formatField()})};var r=e.initialValue.range,a=r.gt,c=void 0===a?null:a,u=r.lt,d=void 0===u?null:u;return n.state={fromValue:c,toValue:d,fromError:"",toError:""},n}return a(t,e),b(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl,r=t.label,i=t.description,o=this.state,a=o.fromValue,s=o.toValue,l=o.fromError,c=o.toError,u=n.formatMessage,d=this.handleMouseEnter,f=this.handleMouseLeave,m=this.handleFromChange,h=this.handleToChange,v=this.checkFromValidity,b=this.checkToValidity;return p.default.createElement("fieldset",{className:"metadata-field"},p.default.createElement("legend",{onMouseEnter:d,onMouseLeave:f},r),p.default.createElement(g.default,{className:"numeric-range-field",type:"number",step:"any",label:u(k.fromLabel),placeholder:u(y.default.inputPlaceholder),hideOptionalLabel:!0,onChange:m,defaultValue:a,inputRef:function(t){e.fromInputEl=t},onBlur:v,error:l,"data-resin-target":"metadatavalue"}),p.default.createElement(g.default,{className:"numeric-range-field",type:"number",step:"any",label:u(k.toLabel),placeholder:u(y.default.inputPlaceholder),hideOptionalLabel:!0,onChange:h,defaultValue:s,onBlur:b,inputRef:function(t){e.toInputEl=t},error:c,"data-resin-target":"metadatavalue"}),p.default.createElement("small",null,i))}}]),t}(f.Component);E.propTypes={intl:m.intlShape.isRequired,id:d.default.string.isRequired,format:d.default.string.isRequired,onChange:d.default.func.isRequired,label:d.default.string.isRequired,description:d.default.string,initialValue:d.default.shape({range:d.default.shape({gt:d.default.number,lt:d.default.number}).isRequired})},E.defaultProps={initialValue:{range:{}}},t.SearchMetadataNumericRangeFieldBase=E,t.default=(0,m.injectIntl)(E)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(7),u=r(c),d=n(317),f=r(d),p=n(23),m=r(p),h=n(33),g=r(h),v=n(10),y=r(v);n(318);var b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(e){var t=e.className,n=void 0===t?"":t,r=e.error,o=void 0===r?"":r,a=e.hideLabel,s=e.hideOptionalLabel,c=e.inputRef,d=e.isLoading,p=e.isRequired,h=e.isValid,v=e.label,_=e.labelTooltip,w=i(e,["className","error","hideLabel","hideOptionalLabel","inputRef","isLoading","isRequired","isValid","label","labelTooltip"]),S=(0,u.default)(n,"text-input-container",{"show-error":!!o});return l.default.createElement("div",{className:S},l.default.createElement(m.default,{text:v,showOptionalText:!s&&!p,hideLabel:a,tooltip:_},l.default.createElement(y.default,{isShown:!!o,text:o||"",position:"middle-right",theme:"error"},l.default.createElement("input",b({ref:c,required:p},w))),d&&!h&&l.default.createElement(g.default,{className:"text-input-loading"}),h&&!d&&l.default.createElement(f.default,{className:"text-input-verified"})))};_.displayName="TextInput",_.propTypes={className:a.default.string,error:a.default.node,hideLabel:a.default.bool,hideOptionalLabel:a.default.bool,inputRef:a.default.func,isLoading:a.default.bool,isRequired:a.default.bool,isValid:a.default.bool,label:a.default.node.isRequired,labelTooltip:a.default.string},t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#00E287":r,o=e.width,a=void 0===o?14:o,l=e.height,u=void 0===l?14:l,d=e.opacity,f=void 0===d?1:d,p=e.title,m=void 0===p?"":p;return s.default.createElement(c.default,{className:"icon-verified "+n,title:m,width:a,height:u,opacity:f,viewBox:"0 0 14 14"},s.default.createElement("path",{d:"M7 14c-3.865993 0-7-3.134007-7-7s3.134007-7 7-7 7 3.134007 7 7-3.134007 7-7 7zM5.31288 9.303048l1.44555 1.21296 4.499514-5.36231-1.44555-1.21296-4.499514 5.36231zM3 7.36231L5.31288 9.30305l1.21296-1.44555L4.21296 5.91676 3 7.36231z",fill:i,fillRule:"evenodd"}))};u.displayName="IconVerified",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,opacity:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(2),c=n(116),u=r(c),d=(0,l.defineMessages)({selectPlaceholder:{id:"boxui.searchMetadata.selectValueSelectPlaceholder",defaultMessage:"Select Value"}}),f=function(e){var t=e.intl,n=e.id,r=e.format,i=e.isText,o=e.onChange,a=e.label,l=e.options,c=e.description,f=e.initialValue,p=function(e){var t=e.target.value,a=null;t&&(a={key:n,format:r,value:{enum:[t]},isText:i}),o(n,a)};return s.default.createElement("div",{className:"metadata-field"},s.default.createElement(u.default,{name:"",label:a,onChange:p,defaultValue:f?f.enum[0]:"","data-resin-target":"metadatavalue"},s.default.createElement("option",{value:""},t.formatMessage(d.selectPlaceholder)),l.map(function(e){
return s.default.createElement("option",{value:e.value,key:e.value},e.displayName)})),s.default.createElement("small",null,c))};f.propTypes={intl:l.intlShape.isRequired,id:o.default.string.isRequired,format:o.default.string.isRequired,isText:o.default.bool.isRequired,onChange:o.default.func.isRequired,label:o.default.string.isRequired,options:o.default.arrayOf(o.default.shape({value:o.default.string.isRequired,displayName:o.default.string.isRequired})).isRequired,description:o.default.string,initialValue:o.default.shape({enum:o.default.arrayOf(o.default.string).isRequired})},t.default=(0,l.injectIntl)(f)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(0),l=r(s),c=n(89),u=r(c),d=n(10),f=r(d),p=n(23),m=r(p);n(321);var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,o=e.infoTooltip,a=e.infoIconProps,s=e.isDisabled,c=e.label,d=e.name,p=e.labelTooltip,g=e.onChange,v=e.showLabel,y=void 0===v||v,b=i(e,["children","className","infoTooltip","infoIconProps","isDisabled","label","name","labelTooltip","onChange","showLabel"]);return l.default.createElement("div",{className:"select-input-container "+r+" "+(s?"is-disabled":"")},l.default.createElement(m.default,{hideLabel:!y,text:c,tooltip:p},l.default.createElement("span",{className:"select-container"},l.default.createElement("span",{className:"select-container-inner"},l.default.createElement("select",h({name:d,disabled:s,onChange:g},b),t),l.default.createElement("span",{className:"select-overlay"})),o&&l.default.createElement(f.default,{text:o,position:"middle-right"},l.default.createElement("span",{className:"tooltip-icon-container"},l.default.createElement(u.default,h({height:16,width:16},a)))))))};g.displayName="Select",g.propTypes={children:a.default.node,className:a.default.string,infoTooltip:a.default.node,infoIconProps:a.default.object,isDisabled:a.default.bool,label:a.default.node.isRequired,name:a.default.string.isRequired,labelTooltip:a.default.string,onChange:a.default.func,showLabel:a.default.bool},t.default=g},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(2),c=n(115),u=r(c),d=n(39),f=r(d),p=function(e){var t=e.intl,n=e.id,r=e.format,i=e.isText,o=e.onChange,a=e.label,l=e.description,c=e.initialValue,d=function(e){var t=e.target.value.trim(),a=null;t&&(a={key:n,format:r,value:{enum:[t]},isText:i}),o(n,a)};return s.default.createElement("div",{className:"metadata-field"},s.default.createElement(u.default,{type:"text",label:a,hideOptionalLabel:!0,placeholder:t.formatMessage(f.default.inputPlaceholder),onChange:d,defaultValue:c?c.enum[0]:"","data-resin-target":"metadatavalue"}),s.default.createElement("small",null,l))};p.propTypes={intl:l.intlShape.isRequired,id:o.default.string.isRequired,format:o.default.string.isRequired,isText:o.default.bool.isRequired,onChange:o.default.func.isRequired,label:o.default.string.isRequired,description:o.default.string,initialValue:o.default.shape({enum:o.default.arrayOf(o.default.string).isRequired})},t.default=(0,l.injectIntl)(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(2),c=n(116),u=r(c),d=(0,l.defineMessages)({selectLabel:{id:"boxui.searchMetadata.metadataTemplate",defaultMessage:"Metadata Template"},selectPlaceholder:{id:"boxui.searchMetadata.selectATemplate",defaultMessage:"Select a Template"}}),f=function(e){var t=e.intl,n=e.templates,r=e.onChange,i=e.selectedTemplateTypeKey,o=t.formatMessage;return s.default.createElement(u.default,{className:"box-ui-metadata-template-select",name:"",label:o(d.selectLabel),onChange:r,value:i},s.default.createElement("option",{value:""},o(d.selectPlaceholder)),n.map(function(e){return s.default.createElement("option",{value:e.typeKey,key:e.typeKey,"data-metadata-template":e.template,"data-metadata-scope":e.scope,"data-resin-target":"metadatatemplate","data-resin-metadatatemplatename":e.displayName},e.displayName)}))};f.propTypes={intl:l.intlShape.isRequired,templates:o.default.arrayOf(o.default.shape({template:o.default.string.isRequired,scope:o.default.string.isRequired,typeKey:o.default.string.isRequired,displayName:o.default.string.isRequired})).isRequired,onChange:o.default.func.isRequired,selectedTemplateTypeKey:o.default.string},f.defaultProps={selectedTemplateTypeKey:""},t.default=(0,l.injectIntl)(f)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(2),c=n(19),u=r(c),d=n(326),f=n(328),p=r(f),m=n(114),h=r(m),g=n(39),v=r(g);n(329);var y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b=function(e){var t=e.numFiltersSet;return s.default.createElement("span",{className:"toggle-btn-text"},t?s.default.createElement(l.FormattedMessage,y({},v.default.numFiltersSet,{values:{numFiltersSet:t}})):s.default.createElement(l.FormattedMessage,v.default.metadata))};b.propTypes={numFiltersSet:o.default.number};var _=function(){return s.default.createElement(p.default,{width:5,height:3})},w=function(e){var t=e.templates,n=e.filterState,r=e.handleTemplateChange,i=e.numFiltersSet;return s.default.createElement(d.ToggleOverlay,{className:"box-ui-search-metadata-filter",toggler:s.default.createElement(u.default,{className:"toggle-btn",type:"button","data-resin-target":"metadatafilter"},s.default.createElement(b,{numFiltersSet:i}),s.default.createElement(_,null))},s.default.createElement(h.default,{templates:t,filterState:n,handleTemplateChange:r,includeFormButtons:!0}))};w.propTypes={templates:o.default.arrayOf(o.default.shape({template:o.default.string.isRequired,scope:o.default.string.isRequired,typeKey:o.default.string.isRequired,displayName:o.default.string.isRequired})),filterState:o.default.shape({fields:o.default.arrayOf(o.default.shape({widget:o.default.string.isRequired,id:o.default.string.isRequired,format:o.default.string.isRequired,displayName:o.default.string.isRequired,isText:o.default.bool,description:o.default.string,options:o.default.arrayOf(o.default.shape({value:o.default.string.isRequired,displayName:o.default.string.isRequired})),initialValue:o.default.shape({enum:o.default.arrayOf(o.default.string),range:o.default.shape({gt:o.default.oneOfType([o.default.string,o.default.number]),lt:o.default.oneOfType([o.default.string,o.default.number])})})})),typeKey:o.default.string,template:o.default.string,scope:o.default.string,displayName:o.default.string,initialFilterMap:o.default.object}),handleTemplateChange:o.default.func.isRequired,numFiltersSet:o.default.number},w.defaultProps={templates:[],filterState:{},numFiltersSet:0},t.default=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ToggleOverlay=t.Overlay=void 0;var i=n(55),o=r(i),a=n(327),s=r(a);t.Overlay=o.default,t.ToggleOverlay=s.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(55),p=r(f),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function(e,t){for(var n=t;n&&n.parentNode&&n!==e;){var r=n.nodeName.toUpperCase();if("A"===r||"BUTTON"===r)return!0;n=n.parentNode}return!1},g=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleOverlayClick=function(e){var t=n.props.closeOnClick;t&&h(n.domNode,e.target)&&n.setState({isVisible:!1})},n.handleClickOutside=function(e){e.target!==n.domNode&&n.domNode&&n.domNode.contains(e.target)||n.setState({isVisible:!1})},n.handleTogglerClick=function(e){n.setState({isVisible:!n.state.isVisible}),e.preventDefault()},n.state={isVisible:e.isVisibleByDefault},n}return a(t,e),m(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.children,i=t.toggler,o=this.state.isVisible,a=(0,u.cloneElement)(i,{onClick:this.handleTogglerClick});return d.default.createElement("div",{className:"toggle-overlay-container "+n,ref:function(t){e.domNode=t}},a,d.default.createElement(p.default,{isVisible:o,onClick:this.handleOverlayClick,onClickOutside:this.handleClickOutside},r))}}]),t}(u.Component);g.propTypes={className:c.default.string,children:c.default.node.isRequired,closeOnClick:c.default.bool,toggler:c.default.node.isRequired,isVisibleByDefault:c.default.bool},g.defaultProps={className:"",closeOnClick:!1,isVisibleByDefault:!1},t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(9),c=r(l),u=function(e){var t=e.className,n=void 0===t?"":t,r=e.color,i=void 0===r?"#000":r,o=e.height,a=void 0===o?6:o,l=e.width,u=void 0===l?10:l,d=e.title,f=void 0===d?"":d;return s.default.createElement(c.default,{className:"icon-caret-down "+n,title:f,height:a,width:u,viewBox:"0 0 10 6"},s.default.createElement("path",{className:"fill-color",fill:i,fillRule:"evenodd",d:"M0 .5l5 5 5-5H0z"}))};u.displayName="IconCaretDown",u.propTypes={className:o.default.string,color:o.default.string,height:o.default.number,width:o.default.number,title:o.default.oneOfType([o.default.string,o.default.element])},t.default=u},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(331),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a);n(332);var l=function(e){var t=e.className,n=void 0===t?"":t,r=e.progress,i=void 0===r?0:r,o={width:i+"%"};return s.default.createElement("div",{className:"progress-bar-container"},s.default.createElement("div",{className:"progress-bar "+n,style:o}))},c=function(e,t,n){if(!/progress/.test(t))return new Error("Invalid prop "+t+" supplied to "+n+". Validation failed.");var r=e.progress;return r<0||r>100?new Error("The progress specified to "+n+" must be between 0 and 100 inclusive."):null};l.displayName="ProgressBar",l.propTypes={className:o.default.string,progress:c},t.default=l},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(334),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UNLIMITED_NUM_OF_PILLS=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(1),c=r(l),u=n(0),d=r(u),f=n(7),p=r(f),m=n(2),h=n(93),g=r(h),v=n(23),y=r(v),b=n(10),_=r(b),w=n(11),S=n(103),k=r(S),E=n(335),C=r(E),x=n(337),T=r(x);n(338);var A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O=t.UNLIMITED_NUM_OF_PILLS=-1,D=function(e,t,n){var r=void 0;return e[t]&&e[t]<O&&(r=new Error("Invalid prop '"+t+"' supplied to '"+n+"'. Value must be greater than or equal to 0")),r},M=(0,m.defineMessages)({pillSelectorIconAlertText:{id:"boxui.pillSelector.iconAlertText",defaultMessage:"Input Error"}}),P=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleDocumentClick=function(e){var t=n.domNode&&n.domNode.contains(e.target)||n.domNode===e.target;t||n.handleInputFocusOut()},n.handleInputFocus=function(e){var t=n.props.onFocus;n.setState({isFocused:!0}),t&&t(e)},n.handleInputFocusOut=function(e){var t=n.state.isFocused,r=n.props.onBlur,i=n.addPillsFromInput();0===i?t&&(n.setState({isFocused:!1}),r&&r({target:n.pillSelectorInput})):e&&e.preventDefault()},n.hasHighlightedSelectorItem=function(){var e=n.props.selectorItems,t=n.state,r=t.isCompositionMode,i=t.selectedItemIndex,o=e.length>0&&i<e.length;return r||o},n.handleInputKeyDown=function(e){var t=n.props,r=t.onItemRemove,i=t.selectedItems;switch(e.key){case"Backspace":if(!e.target.value){e.preventDefault();var o=i.length-1;r(i[o],o)}break;case"Enter":if(n.hasHighlightedSelectorItem())return;n.addPillsFromInput();break;case"Tab":if(n.hasHighlightedSelectorItem())return;n.handleInputFocusOut(e)}},n.handleCompositionStart=function(){n.setState({isCompositionMode:!0})},n.handleCompositionEnd=function(){n.setState({isCompositionMode:!1})},n.handleItemSelection=function(e){var t=n.props.selectorItems;n.addPill(t[e]),n.focusSelectorInput(),setTimeout(n.scrollInputToBottom,0)},n.handleSelectedIndexChange=function(e){n.setState({selectedItemIndex:e})},n.addPill=function(e){var t=n.props.onItemAdd;t(e),n.updateUserInput("")},n.parsePills=function(e){var t=n.props,r=t.maxNumPills,i=t.parseItems,o=t.validator,a=i?i(e):(0,k.default)(e);return o&&(a=a.filter(function(e){return o(e)})),r!==O&&a.length>r&&(a=a.slice(0,r)),a.map(function(e){return{id:e,name:e}})},n.addPillsFromInput=function(){var e=n.parsePills(n.pillSelectorInput.value),t=e.length;return t>0&&n.addPill(e),t},n.handlePaste=function(){setTimeout(n.addPillsFromInput,0)},n.focusSelectorInput=function(){n.pillSelectorInput.focus()},n.scrollInputToBottom=function(){n.pillSelectorInputWrapper&&(n.pillSelectorInputWrapper.scrollTop=n.pillSelectorInputWrapper.scrollHeight)},n.updateUserInput=function(e){var t=n.props.onUserInput;n.pillSelectorInput.value=e,t(e)},n.hasReachedMaxPills=function(e,t){return e!==O&&t.length>=e},n.isTextareaDisabled=function(){var e=n.props,t=e.maxNumPills,r=e.isDisabled,i=e.selectedItems;return r||n.hasReachedMaxPills(t,i)},n.state={isCompositionMode:!1,isFocused:!1,selectedItemIndex:0},n}return a(t,e),I(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocumentClick,!0),document.addEventListener("contextmenu",this.handleDocumentClick,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDocumentClick,!0),document.removeEventListener("contextmenu",this.handleDocumentClick,!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.autoFocus,r=t.error,i=t.isRequired,o=t.label,a=t.name,s=t.onItemRemove,l=t.onUserInput,c=t.placeholder,f=t.selectedItems,h=t.selectorItems,v=t.selectorRow,b=t.showDropdownOnClick,w=this.state,S=w.isCompositionMode,k=w.isFocused,E=this.isTextareaDisabled(),x=(0,p.default)({"pill-selector-input-wrapper":!0,"is-focused":k,"is-disabled":E,"show-error":!!r});return d.default.createElement("div",{className:"pill-selector-wrapper",ref:function(t){e.domNode=t}},f.map(function(e,t){return d.default.createElement("input",{key:t,type:"text",name:a+"[]",value:e.id,hidden:!0,className:"pill-selector-hidden-input",readOnly:!0})}),d.default.createElement(y.default,{text:o,showOptionalText:!i},d.default.createElement(T.default,{onItemSelected:this.handleItemSelection,onSelectedIndexChanged:this.handleSelectedIndexChange,onSelectorUserInput:l,selectOnTab:!0,showOnSelectorClick:b,selector:d.default.createElement(_.default,{isShown:!!r,text:r||"",theme:"error",position:"bottom-left"},d.default.createElement("div",{className:x,onClick:this.focusSelectorInput,ref:function(t){e.pillSelectorInputWrapper=t}},f.map(function(t,n){return d.default.createElement(C.default,{key:n,onPillRemove:s.bind(e,t,n),text:t.name,tooltip:t.tooltip,isValid:t.isValid})}),d.default.createElement("textarea",{disabled:E,autoFocus:n,className:"pill-selector-input",autoComplete:"off",onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,ref:function(t){e.pillSelectorInput=t},rows:"1",style:{resize:"none"},onFocus:this.handleInputFocus,onKeyDown:this.handleInputKeyDown,onPaste:this.handlePaste,placeholder:0===f.length?c:""}),d.default.createElement(g.default,{height:16,width:16,title:d.default.createElement(m.FormattedMessage,M.pillSelectorIconAlertText)})))},S?[]:h.map(function(e){return(0,u.cloneElement)(v,A({},v.props,e,{key:e.id}))}))))}}]),t}(u.Component);P.propTypes={autoFocus:c.default.bool,error:c.default.node,isDisabled:c.default.bool,isRequired:c.default.bool,label:c.default.node.isRequired,maxNumPills:D,name:c.default.string.isRequired,onBlur:c.default.func,onFocus:c.default.func,onItemAdd:c.default.func.isRequired,onItemRemove:c.default.func.isRequired,onUserInput:c.default.func,parseItems:c.default.func,placeholder:c.default.string,selectedItems:w.SelectorItemsPropType,selectorItems:w.SelectorItemsPropType,selectorRow:c.default.node.isRequired,showDropdownOnClick:c.default.bool,validator:c.default.func},P.defaultProps={autoFocus:!1,isRequired:!1,maxNumPills:O,onUserInput:function(){},showDropdownOnClick:!1},t.default=P},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(336),o=r(i);t.default=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(0),s=r(a),l=n(7),c=r(l),u=n(10),d=r(u),f=function(e){var t=e.onPillRemove,n=e.text,r=e.tooltip,i=e.isValid,o=void 0===i||i,a=(0,c.default)("pill",{"is-invalid":!o}),l=s.default.createElement("span",{className:a},s.default.createElement("span",{className:"pill-text"},n),t?s.default.createElement("a",{className:"close-btn",onClick:t},"✕"):null);return r?s.default.createElement(d.default,{text:r},l):l};f.displayName="Pill",f.propTypes={onPillRemove:o.default.func,text:o.default.string.isRequired,tooltip:o.default.string,isValid:o.default.bool},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(113),o=r(i);t.default=o.default},function(e,t){}],[121]);var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};sjcl.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var t,n,r,i,o=this._tables[0][4],a=this._tables[1];t=e.length;var s=1;if(4!==t&&6!==t&&8!==t)throw new sjcl.exception.invalid("invalid aes key size");for(this._key=[r=e.slice(0),i=[]],e=t;e<4*t+28;e++)n=r[e-1],(0===e%t||8===t&&4===e%t)&&(n=o[n>>>24]<<24^o[n>>16&255]<<16^o[n>>8&255]<<8^o[255&n],0===e%t&&(n=n<<8^n>>>24^s<<24,s=s<<1^283*(s>>7))),r[e]=r[e-t]^n;for(t=0;e;t++,e--)n=r[3&t?e:e-4],i[t]=4>=e||4>t?n:a[0][o[n>>>24]]^a[1][o[n>>16&255]]^a[2][o[n>>8&255]]^a[3][o[255&n]]},sjcl.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e,t,n,r,i,o,a,s=this._tables[0],l=this._tables[1],c=s[4],u=l[4],d=[],f=[];for(e=0;256>e;e++)f[(d[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!c[t];t^=r||1,n=f[n]||1)for(o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^255&o^99,c[t]=o,u[o]=t,i=d[e=d[r=d[t]]],a=16843009*i^65537*e^257*r^16843008*t,i=257*d[o]^16843008*o,e=0;4>e;e++)s[e][t]=i=i<<24^i>>>8,l[e][o]=a=a<<24^a>>>8;for(e=0;5>e;e++)s[e]=s[e].slice(0),l[e]=l[e].slice(0)},_crypt:function(e,t){if(4!==e.length)throw new sjcl.exception.invalid("invalid aes block size");var n,r,i,o,a=this._key[t],s=e[0]^a[0],l=e[t?3:1]^a[1],c=e[2]^a[2],u=e[t?1:3]^a[3],d=a.length/4-2,f=4,p=[0,0,0,0];n=this._tables[t];var m=n[0],h=n[1],g=n[2],v=n[3],y=n[4];for(o=0;o<d;o++)n=m[s>>>24]^h[l>>16&255]^g[c>>8&255]^v[255&u]^a[f],r=m[l>>>24]^h[c>>16&255]^g[u>>8&255]^v[255&s]^a[f+1],i=m[c>>>24]^h[u>>16&255]^g[s>>8&255]^v[255&l]^a[f+2],u=m[u>>>24]^h[s>>16&255]^g[l>>8&255]^v[255&c]^a[f+3],f+=4,s=n,l=r,c=i;for(o=0;4>o;o++)p[t?3&-o:o]=y[s>>>24]<<24^y[l>>16&255]<<16^y[c>>8&255]<<8^y[255&u]^a[f++],n=s,s=l,l=c,c=u,u=n;return p}},sjcl.bitArray={bitSlice:function(e,t,n){return e=sjcl.bitArray._shiftRight(e.slice(t/32),32-(31&t)).slice(1),void 0===n?e:sjcl.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return((t+n-1^t)&-32?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],r=sjcl.bitArray.getPartial(n);return 32===r?e.concat(t):sjcl.bitArray._shiftRight(t,r,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+sjcl.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var n=e.length;return t&=31,0<n&&t&&(e[n-1]=sjcl.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(t))return!1;var n,r=0;for(n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},_shiftRight:function(e,t,n,r){var i;for(void 0===r&&(r=[]);32<=t;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(i=0;i<e.length;i++)r.push(n|e[i]>>>t),n=e[i]<<32-t;return e=sjcl.bitArray.getPartial(e.length?e[e.length-1]:0),r.push(sjcl.bitArray.partial(t+e&31,32<t+e?n:r.pop(),1)),r},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},sjcl.codec.utf8String={fromBits:function(e){var t,n,r="",i=sjcl.bitArray.bitLength(e);for(t=0;t<i/8;t++)0===(3&t)&&(n=e[t/4]),r+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(r))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,n=[],r=0;for(t=0;t<e.length;t++)r=r<<8|e.charCodeAt(t),3===(3&t)&&(n.push(r),r=0);return 3&t&&n.push(sjcl.bitArray.partial(8*(3&t),r)),n}},sjcl.codec.hex={fromBits:function(e){var t,n="";for(t=0;t<e.length;t++)n+=((0|e[t])+0xf00000000000).toString(16).substr(4);return n.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function(e){var t,n,r=[];for(e=e.replace(/\s|0x/g,""),n=e.length,e+="00000000",t=0;t<e.length;t+=8)r.push(0^parseInt(e.substr(t,8),16));return sjcl.bitArray.clamp(r,4*n)}},sjcl.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var r="",i=0,o=sjcl.codec.base64._chars,a=0,s=sjcl.bitArray.bitLength(e);for(n&&(o=o.substr(0,62)+"-_"),n=0;6*r.length<s;)r+=o.charAt((a^e[n]>>>i)>>>26),6>i?(a=e[n]<<6-i,i+=26,n++):(a<<=6,i-=6);for(;3&r.length&&!t;)r+="=";return r},toBits:function(e,t){e=e.replace(/\s|=/g,"");var n,r,i=[],o=0,a=sjcl.codec.base64._chars,s=0;for(t&&(a=a.substr(0,62)+"-_"),n=0;n<e.length;n++){if(r=a.indexOf(e.charAt(n)),0>r)throw new sjcl.exception.invalid("this isn't base64!");26<o?(o-=26,i.push(s^r>>>o),s=r<<32-o):(o+=6,s^=r<<32-o)}return 56&o&&i.push(sjcl.bitArray.partial(56&o,s,1)),i}},sjcl.codec.base64url={fromBits:function(e){return sjcl.codec.base64.fromBits(e,1,1)},toBits:function(e){return sjcl.codec.base64.toBits(e,1)}},sjcl.codec.bytes={fromBits:function(e){var t,n,r=[],i=sjcl.bitArray.bitLength(e);for(t=0;t<i/8;t++)0===(3&t)&&(n=e[t/4]),r.push(n>>>24),n<<=8;return r},toBits:function(e){var t,n=[],r=0;for(t=0;t<e.length;t++)r=r<<8|e[t],3===(3&t)&&(n.push(r),r=0);return 3&t&&n.push(sjcl.bitArray.partial(8*(3&t),r)),n}},sjcl.hash.sha512=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},sjcl.hash.sha512.hash=function(e){return(new sjcl.hash.sha512).update(e).finalize()},sjcl.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e));var t,n=this._buffer=sjcl.bitArray.concat(this._buffer,e);if(t=this._length,e=this._length=t+sjcl.bitArray.bitLength(e),9007199254740991<e)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var r=new Uint32Array(n),i=0;for(t=1024+t-(1024+t&1023);t<=e;t+=1024)this._block(r.subarray(32*i,32*(i+1))),i+=1;n.splice(0,32*i)}else for(t=1024+t-(1024+t&1023);t<=e;t+=1024)this._block(n.splice(0,32));return this},finalize:function(){var e,t=this._buffer,n=this._h,t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(1,1)]);for(e=t.length+4;31&e;e++)t.push(0);for(t.push(0),t.push(0),t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,32));return this.reset(),n},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}function t(e){return 1099511627776*(e-Math.floor(e))&255}for(var n,r,i=0,o=2;80>i;o++){for(r=!0,n=2;n*n<=o;n++)if(0===o%n){r=!1;break}r&&(8>i&&(this._init[2*i]=e(Math.pow(o,.5)),this._init[2*i+1]=t(Math.pow(o,.5))<<24|this._initr[i]),this._key[2*i]=e(Math.pow(o,1/3)),this._key[2*i+1]=t(Math.pow(o,1/3))<<24|this._keyr[i],i++)}},_block:function(e){var t,n,r,i=this._h,o=this._key,a=i[0],s=i[1],l=i[2],c=i[3],u=i[4],d=i[5],f=i[6],p=i[7],m=i[8],h=i[9],g=i[10],v=i[11],y=i[12],b=i[13],_=i[14],w=i[15];if("undefined"!=typeof Uint32Array){r=Array(160);for(var S=0;32>S;S++)r[S]=e[S]}else r=e;var S=a,k=s,E=l,C=c,x=u,T=d,A=f,I=p,O=m,D=h,M=g,P=v,N=y,R=b,F=_,B=w;for(e=0;80>e;e++){if(16>e)t=r[2*e],n=r[2*e+1];else{n=r[2*(e-15)];var q=r[2*(e-15)+1];t=(q<<31|n>>>1)^(q<<24|n>>>8)^n>>>7;var L=(n<<31|q>>>1)^(n<<24|q>>>8)^(n<<25|q>>>7);n=r[2*(e-2)];var j=r[2*(e-2)+1],q=(j<<13|n>>>19)^(n<<3|j>>>29)^n>>>6,j=(n<<13|j>>>19)^(j<<3|n>>>29)^(n<<26|j>>>6),U=r[2*(e-7)],H=r[2*(e-16)],$=r[2*(e-16)+1];n=L+r[2*(e-7)+1],t=t+U+(n>>>0<L>>>0?1:0),n+=j,t+=q+(n>>>0<j>>>0?1:0),n+=$,t+=H+(n>>>0<$>>>0?1:0)}r[2*e]=t|=0,r[2*e+1]=n|=0;var U=O&M^~O&N,V=D&P^~D&R,j=S&E^S&x^E&x,W=k&C^k&T^C&T,H=(k<<4|S>>>28)^(S<<30|k>>>2)^(S<<25|k>>>7),$=(S<<4|k>>>28)^(k<<30|S>>>2)^(k<<25|S>>>7),K=o[2*e],z=o[2*e+1],q=B+((O<<18|D>>>14)^(O<<14|D>>>18)^(D<<23|O>>>9)),L=F+((D<<18|O>>>14)^(D<<14|O>>>18)^(O<<23|D>>>9))+(q>>>0<B>>>0?1:0),q=q+V,L=L+(U+(q>>>0<V>>>0?1:0)),q=q+z,L=L+(K+(q>>>0<z>>>0?1:0)),q=q+n|0,L=L+(t+(q>>>0<n>>>0?1:0));n=$+W,t=H+j+(n>>>0<$>>>0?1:0),F=N,B=R,N=M,R=P,M=O,P=D,D=I+q|0,O=A+L+(D>>>0<I>>>0?1:0)|0,A=x,I=T,x=E,T=C,E=S,C=k,k=q+n|0,S=L+t+(k>>>0<q>>>0?1:0)|0}s=i[1]=s+k|0,i[0]=a+S+(s>>>0<k>>>0?1:0)|0,c=i[3]=c+C|0,i[2]=l+E+(c>>>0<C>>>0?1:0)|0,d=i[5]=d+T|0,i[4]=u+x+(d>>>0<T>>>0?1:0)|0,p=i[7]=p+I|0,i[6]=f+A+(p>>>0<I>>>0?1:0)|0,h=i[9]=h+D|0,i[8]=m+O+(h>>>0<D>>>0?1:0)|0,v=i[11]=v+P|0,i[10]=g+M+(v>>>0<P>>>0?1:0)|0,b=i[13]=b+R|0,i[12]=y+N+(b>>>0<R>>>0?1:0)|0,w=i[15]=w+B|0,i[14]=_+F+(w>>>0<B>>>0?1:0)|0}},sjcl.mode.cbc={name:"cbc",encrypt:function(e,t,n,r){if(r&&r.length)throw new sjcl.exception.invalid("cbc can't authenticate data");if(128!==sjcl.bitArray.bitLength(n))throw new sjcl.exception.invalid("cbc iv must be 128 bits");var i=sjcl.bitArray,o=i._xor4,a=i.bitLength(t),s=0,l=[];if(7&a)throw new sjcl.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(r=0;s+128<=a;r+=4,s+=128)n=e.encrypt(o(n,t.slice(r,r+4))),l.splice(r,0,n[0],n[1],n[2],n[3]);return a=16843009*(16-(a>>3&15)),n=e.encrypt(o(n,i.concat(t,[a,a,a,a]).slice(r,r+4))),l.splice(r,0,n[0],n[1],n[2],n[3]),l},decrypt:function(e,t,n,r){if(r&&r.length)throw new sjcl.exception.invalid("cbc can't authenticate data");if(128!==sjcl.bitArray.bitLength(n))throw new sjcl.exception.invalid("cbc iv must be 128 bits");if(127&sjcl.bitArray.bitLength(t)||!t.length)throw new sjcl.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var i,o=sjcl.bitArray,a=o._xor4,s=[];for(r=0;r<t.length;r+=4)i=t.slice(r,r+4),n=a(n,e.decrypt(i)),s.splice(r,0,n[0],n[1],n[2],n[3]),n=i;if(i=255&s[r-1],0===i||16<i)throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");if(n=16843009*i,!o.equal(o.bitSlice([n,n,n,n],0,8*i),o.bitSlice(s,32*s.length-8*i,32*s.length)))throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");return o.bitSlice(s,0,32*s.length-8*i)}},"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],function(){return sjcl}),function(){Box.Application&&Box.Application.on&&Box.Application.on("init",function(){var e=window.Box.Application,t=e.getGlobalConfig(),n=t.debug,r=e.getGlobal("localStorage");r&&r.getItem("debug")&&(n=!0),n&&e.on("error",function(e){throw e})})}(),function(){"use strict";function e(t,n){var r=[];for(var i in t)t.hasOwnProperty(i)&&("object"==typeof t[i]?r.push(e(t[i],n?n+"["+i+"]":i)):n?r.push(n+"["+i+"]="+encodeURIComponent(t[i])):r.push(i+"="+encodeURIComponent(t[i])));
return r.join("&")}function t(t){var n=new XMLHttpRequest;n.open("get","/gen204?"+e(t),!0),n.send(null)}function n(e){var t=Box.Application.getGlobal("performance");if(t){var n=t.timing,r=t.navigation;if(r&&r.type&&(e.nt_red_cnt=r.redirectCount,e.nt_nav_type=r.type),n)for(var i in n)i in l&&n[i]&&(e[l[i]]=n[i])}}function r(){var e=Box.Application.getGlobal("location")||{},r={current_rm:Box.Application.getGlobalConfig("currentRm")||"unknown",datacenterTag:Box.Application.getGlobalConfig("datacenterTag")||"unknown",uri:e.href,version:s.version||a},i={category:"boomerang",event_type:"beacon",keys_and_values:r,runmode_options:{splunk:1,add_geo:1}};n(r),r.nt_load_end&&r.nt_nav_st&&(r.t_done=r.nt_load_end-r.nt_nav_st),r.nt_req_st&&r.nt_res_st&&(r.t_resp=r.nt_res_st-r.nt_req_st),r.nt_res_st&&r.nt_load_end&&(r.t_page=r.nt_load_end-r.nt_res_st),Box.Timing.boomerangData=r,t(i)}function i(){var e=Box.Application.getGlobal("console");if(e&&e.groupCollapsed){var t=Box.Timing.boomerangData.t_done,n=Box.Timing.boomerangData.t_resp,r=Box.Timing.serverData,i=r.otherTime,o=r.primaryTime,a=r.totalTime;if(a>0){e.groupCollapsed("Performance Data - Page Load Time: %f ms, Server-side: %f ms",t,a),e.log("Time to First Byte: %f ms",n),e.group("Main Server-side Timers: %f ms",o);var s=r.timers.primary,l=Object.keys(s);l.forEach(function(t){var n=s[t]||0,r=(n/a*100).toFixed(2);n>.1&&e.log("%s: %f ms (%s%)",t,n,r)}),e.groupEnd(),e.groupCollapsed("Other Server-side Timers: %f ms",i);var c=r.timers.other,u=Object.keys(c);if(u.forEach(function(t){var n=c[t]||0,r=(n/a*100).toFixed(2);n>.1&&e.log("%s: %f ms (%s%)",t,n,r)}),e.groupEnd(),r.timers.cumulative&&Object.keys(r.timers.cumulative).length){e.groupCollapsed("Cumulative Timers (may overlap)");var d=r.timers.cumulative,f=Object.keys(d);f.forEach(function(t){var n=d[t]||0,r=(n/a*100).toFixed(2);n>.1&&e.log("%s: %f ms (%s%)",t,n,r)}),e.groupEnd()}e.groupEnd()}}}function o(){var e=Box.Application.getService("resin"),t=Box.Timing.boomerangData.t_done,n=s.resinPageName;e.recordAction({application:"files",page:n,component:"",feature:"",target:"pageloaded",action:"programmatic",data:{pageLoadTime:t}})}var a=2;window.Box=window.Box||{},Box.Timing=Box.Timing||{execution:[],scripts:{},events:{},serverData:{}};var s=Box.Timing.attributes=Box.Timing.attributes||{version:a};Box.Timing.events=Box.Timing.events||{};var l={navigationStart:"nt_nav_st",redirectStart:"nt_red_st",redirectEnd:"nt_red_end",fetchStart:"nt_fet_st",domainLookupStart:"nt_dns_st",domainLookupEnd:"nt_dns_end",connectStart:"nt_con_st",connectEnd:"nt_con_end",requestStart:"nt_req_st",responseStart:"nt_res_st",responseEnd:"nt_res_end",domLoading:"nt_domloading",domInteractive:"nt_domint",domContentLoadedEventStart:"nt_domcontloaded_st",domContentLoadedEventEnd:"nt_domcontloaded_end",domComplete:"nt_domcomp",loadEventStart:"nt_load_st",loadEventEnd:"nt_load_end",secureConnectionStart:"nt_ssl_st"},c={aggregate:r,logResinData:o,displayPerformanceData:i,handleWindowLoad:function(){setTimeout(function(){this.aggregate(),this.logResinData(),Box.Timing.displayPerfData&&this.displayPerformanceData()}.bind(this),0)}};window.sinon?window.performanceTiming=c:window.addEventListener("load",c.handleWindowLoad.bind(c))}(),Box.Application.addService("aria",function(e){"use strict";return{setRole:function(e,t){e.setAttribute("role",t)},setFocusable:function(e,t){e.tabIndex=t?0:-1},clearState:function(e,t){e.removeAttribute("aria-"+t)},hasState:function(e,t){return e.hasAttribute("aria-"+t)},setState:function(e,t){e.setAttribute("aria-"+t,!0)},hide:function(e){this.setState(e,"hidden")},show:function(e){this.clearState(e,"hidden")}}}),Box.Application.addService("array-utils",function(){"use strict";function e(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function t(e,t){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[++i]=a)}return o}function n(e){return function(t,n,r){var i=arguments.length<3;return e(t,n,r,i)}}function r(e,t,n,r){var i=-1,o=e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function i(e,t){for(var n=-1,r=e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function o(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function a(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function s(e,t){return $.inArray(t,e)}return{forEach:o,every:i,some:a,indexOf:s,map:e,filter:t,reduce:n(r)}}),Box.Application.addService("browser",function(e){"use strict";function t(e){var t,n,r,i=null,o=null;for(t=0,n=e.length;t<n;t++)if(r=e[t].string,_=e[t].versionSearch||e[t].identity,r&&r.indexOf(e[t].subString)!==-1){i=e[t].identity,o=e[t].device;break}return{identity:i,device:o}}function n(e){var t,n=e.indexOf(_);return n===-1?"":(t=e.substring(n+_.length+1).match(/[0-9]+(?:\.[0-9]*)?/),t&&t.length?t[0]:void 0)}function r(){var e=y.userAgent.match(/Mac OS X (([\d]+)_([\d]+)_([\d]+))/i);return e&&e[1]?{version:e[1].replace(/_/g,"."),major:parseInt(e[2],10),minor:parseInt(e[3],10),maintenance:parseInt(e[4],10)}:null}function i(){var e=r();return e?e.version:"Unknown"}function o(){var e,t=y.userAgent.match(/Windows NT (([\d]+).([\d]+))/i);return t&&t[1]?(e=t[1],"5.1"===e||"5.2"===e?"XP":"6.0"===e?"Vista":"6.1"===e?"7":"6.2"===e?"8":"6.3"===e?"8.1":"Unknown"):null}function a(){var e;return d.OS===g.MAC&&(e=r(),e.major>10||10===e.major&&e.minor>=7)}function s(){var e,t,n=y.plugins;if(!n)return!1;for(n.refresh&&n.refresh(!1),e=0;e<n.length;e++)if(t=n[e],t&&t.name.match(/^Java/))return!0;return!1}function l(){var t=e.getGlobal("ActiveXObject"),n=!1;try{"ActiveXObject"in window&&(n=!!new t("htmlfile"))}catch(e){n=!1}return n}function c(e,t){var n;if(0===e.indexOf("audio/"))n=b.createElement("audio");else{if(0!==e.indexOf("video/"))return!1;n=b.createElement("video")}return!(!n.canPlayType||n.canPlayType(e).replace(/^no$/,"")!==t)}function u(e){return c(e,"maybe")||c(e,"probably")}var d,f="9",p='video/mp4; codecs="avc1.42E01E"',m='video/mp4; codecs="avc1.4D401E"',h='video/mp4; codecs="avc1.64001E"',g={CHROME:"Chrome",EDGE:"Edge",FIREFOX:"Firefox",MAC:"Mac",SAFARI:"Safari"},v=e.getGlobal("window"),y=e.getGlobal("navigator"),b=e.getGlobal("document"),_="",w=[{string:y.userAgent,subString:g.EDGE,identity:g.EDGE},{string:y.userAgent,subString:g.CHROME,identity:g.CHROME},{string:y.userAgent,subString:"criOS",identity:g.CHROME,versionSearch:"criOS"},{string:y.vendor,subString:"Apple",identity:g.SAFARI,versionSearch:"Version"},{string:y.userAgent,subString:g.FIREFOX,identity:g.FIREFOX},{string:y.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:y.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:y.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}],S=[{string:y.platform,subString:"Win",identity:"Windows"},{string:y.userAgent,subString:"iPod",identity:"iOS",device:"iPod"},{string:y.userAgent,subString:"iPhone",identity:"iOS",device:"iPhone"},{string:y.userAgent,subString:"iPad",identity:"iOS",device:"iPad"},{string:y.platform,subString:g.MAC,identity:g.MAC},{string:y.userAgent,subString:"Android",identity:"Android"},{string:y.platform,subString:"Linux",identity:"Linux"}];return d={constants:g,init:function(){this.browser=t(w).identity||"an unknown browser",this.version=n(y.userAgent)||n(y.appVersion)||"an unknown version";var e=t(S);this.OS=e.identity||"an unknown OS",this.device=e.device||"an unknown device"},getName:function(){return this.browser},getVersion:function(){return this.version},getOSName:function(){return this.OS},getDeviceName:function(){return this.device},getOSVersionName:function(){switch(this.getOSName()){case g.MAC:return i();case"Windows":return o();default:return"Unknown"}},isFolderDragAndDropUploadSupported:function(){var e=b.createElement("input");return"webkitdirectory"in e},isMinBrowser:function(e,t){return this.browser.toLowerCase()===e.toLowerCase()&&parseFloat(this.version)>=parseFloat(t)},isHtml5EnabledIE:function(){return!(!this.isMinBrowser("explorer","10")||!b.documentMode)&&parseInt(b.documentMode,10)>=10},isIncompatibleChromeMacCombination:function(){return this.isChrome()&&a()&&!s()},isIncompatibleSafariMacCombination:function(){return!(d.OS!==g.MAC||!this.isSafari()||s())&&this.isMinBrowser(g.SAFARI,"6.1")},isMobileOS:function(){return"iOS"===this.getOSName()||"Android"===this.getOSName()},canUseFlash:function(){var t=e.getGlobal("swfobject");return!(!this.isIE()||!t)&&t.hasFlashPlayerVersion("9.28.0")},canUseHtml5:function(){return this.isMinBrowser(g.FIREFOX,"3.6")||this.isMinBrowser(g.CHROME,"5")||this.isHtml5EnabledIE()||this.isMinBrowser(g.SAFARI,"4")},canPlayH264Baseline:function(){return u(p)},canPlayH264Main:function(){return u(m)},canPlayH264High:function(){return u(h)},canPlayMP3:function(){return c("audio/mpeg","maybe")||c("audio/mpeg","probably")},supportsDash:function(){var t=e.getGlobal("MediaSource");return!!t&&("function"==typeof t.isTypeSupported?t.isTypeSupported(h):this.canPlayH264High())},supportsMSE:function(){return!!e.getGlobal("MediaSource")},supportsWebGL:function(){var e,t=b.createElement("canvas");try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(e){}return null!==e&&void 0!==e},canUseHtml5Dnd:function(){return this.isMinBrowser(g.FIREFOX,"3.6")||this.isMinBrowser(g.CHROME,"10")||this.isHtml5EnabledIE()||this.isEdge()||this.isMinBrowser(g.SAFARI,"5")},canUseSessionStorage:function(){var t=e.getGlobal("sessionStorage");try{return t.setItem("testKey","testValue"),t.removeItem("testKey"),!0}catch(e){return!1}},isSafari:function(){return this.browser===g.SAFARI},isFirefox:function(){return this.browser===g.FIREFOX},isChrome:function(){return this.browser===g.CHROME},isIE:function(){return"Explorer"===this.browser},isEdge:function(){return this.browser===g.EDGE},isBrowserPluginsSupported:function(){return y&&"object"==typeof y.plugins&&y.plugins.length>0||this.isIE()&&l()},isTransformSupported:function(){return!this.isIE()||this.isMinBrowser("explorer","9")},canFolderUpload:function(){return this.isMinBrowser(g.CHROME,"21")||this.isMinBrowser(g.EDGE,"14")||this.isMinBrowser(g.FIREFOX,"50")},hasMinimumFlashVersion:function(){var t=e.getGlobal("swfobject"),n=t.getFlashPlayerVersion();return n.major>=parseInt(f,10)},hasSVGSupport:function(){return b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},getMinimumFlashVersion:function(){return f},isFileApiSupported:function(){return"undefined"!=typeof Blob&&!!Blob.prototype.slice},isInlineWorkerSupported:function(){function e(){}if(!this.isFileApiSupported())return!1;var t=URL||webkitURL;if(!t)return!1;try{var n=new Blob(["("+e.toString()+").call()"],{type:"text/javascript"}),r=t.createObjectURL(n),i=new Worker(r);return i.terminate(),t.revokeObjectURL(r),!0}catch(e){return!1}},isCryptoSupported:function(){return!!(v.crypto||v.msCrypto||v.webkitCrypto)},isSubtleCryptoSupported:function(){return this.isCryptoSupported()&&!!(v.crypto||v.msCrypto||v.webkitCrypto).subtle}},d.init(),d}),Box.Application.addService("cookies",function(e){"use strict";var t=e.getGlobal("document");return{get:function(e){var n,r,i,o=t.cookie.split("; ");for(r=0,i=o.length;r<i;r++)if(n=o[r].split("="),n[0]===e)return n[1]?decodeURIComponent(n[1]):"";return""},remove:function(e){this.set(e,"",new Date(0))},set:function(n,r,i,o,a){var s,l=new Date;"undefined"==typeof i&&(i=l.getTime()+5184e6),l.setTime(i),o=o||"/";var c=e.getGlobalConfig("cookieDomain");!a&&c?a=c:a||"undefined"==typeof e.getGlobal("cookie_domain")||("undefined"!=typeof Tombstone&&Tombstone.marker("./js/common/services/cookies.js:82","2014-02-10","need to weed out usage of cookie_domain and move it over to globalconfig"),a=e.getGlobal("cookie_domain")),s=n+"="+encodeURIComponent(r),0!==i&&(s+="; expires="+l.toGMTString()),s+="; path="+o,a&&(s+="; domain="+a),s+="; secure",t.cookie=s},isEnabled:function(){return!!(t.cookie&&t.cookie.length>0)},setOnRootDomain:function(t,n,r,i,o){var a=e.getGlobalConfig("cookieRootDomain");this.set(t,n,r,i,a,o)}}}),Box.Application.addService("dom",function(e){"use strict";function t(e,t,n,r){r=r||{},$(e).on(t,r,n)}function n(e,t,n){$(e).off(t,n)}function r(e,t){return function(n){window.setTimeout(function(){t(e),n.data.detachHandler()},0)}}function i(e,t){return function(){for(var r=0,i=d.length;r<i;r++)n(e,d[r],t)}}function o(e,n){for(var o=r(e,n),a=i(e,o),s=0,l=d.length;s<l;s++)t(e,d[s],o,{detachHandler:a})}function a(){var e,t=document.createElement("fakeelement");for(e in u)"undefined"!=typeof t.style[e]&&d.push(u[e]);f=!0}function s(e,t,n){"add"===n?$(e).addClass(t):"remove"===n&&t?$(e).removeClass(t):"remove"===n&&$(e).removeClass()}function l(e,t,n){var r,i,o,a=/\s+/;if(p&&"string"==typeof t)if(Array.isArray(e))for(r=0,i=e.length;r<i;r++)l(e[r],t,n);else if(e instanceof HTMLElement)for(o=t.split(a),r=0,i=o.length;r<i;r++)e.classList[n](o[r].trim());else s(e,t,n);else s(e,t,n)}function c(e,t,n,r){d.length>0?(o(e,r),l(e,t,n)):(l(e,t,n),window.setTimeout(function(){r(e)},0))}var u={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",animation:"animationend",WebkitAnimation:"webkitAnimationEnd"},d=[],f=!1,p="undefined"!=typeof document&&"classList"in document.documentElement;return{query:function(e,t){return $(t||document).find(e)[0]},queryAll:function(e,t){return $(t||document).find(e).get()},setHTML:function(t,n){t&&1===t.nodeType?(e.stopAll(t),$(t).html(n),e.startAll(t)):e.reportError(new Error("setHTML() requires a valid DOM element"))},setText:function(e,t){"textContent"in e?e.textContent=t:e.innerText=t},insertAfter:function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},remove:function(e){e.parentNode.removeChild(e)},addClass:function(e,t,n){f||a(),"function"==typeof n?c(e,t,"add",n):l(e,t,"add")},hasClass:function(e,t){return p&&e instanceof HTMLElement?e.classList.contains(t):$(e).hasClass(t)},removeClass:function(e,t,n){f||a(),"function"==typeof n?c(e,t,"remove",n):l(e,t,"remove")},getNearestUnbounded:function(e,t){var n=$(e),r=n.closest(t);return r.length?r[0]:null},getNearest:function(e,t){for(var n=$(e),r=n.is(t);!r&&n.length&&!n.is("[data-module]");)n=n.parent(),r=n.is(t);return r?n[0]:null},getNearestTypeElement:function(e){return this.getNearest(e,"[data-type]")},getData:function(e,t){return $(e).data(t)},isVisible:function(e){return $(e).is(":visible")},on:t,off:n,createFragmentFromHtml:function(e){var t=document.createElement("div"),n=document.createDocumentFragment();for($(t).html(e);t.firstChild;)n.appendChild(t.firstChild);return n},getComputedCSS:function(t){var n,r,i={},o=$(t),a=e.getGlobal("getComputedStyle");if(a&&(n=a(t,null))){if(n.length)for(var s=0,l=n.length;s<l;s++)r=n[s],i[r]=o.css(r);else for(r in n)n.hasOwnProperty(r)&&(i[r]=o.css(r));return i}if(t.currentStyle){n=t.currentStyle;for(r in n)i[r]=o.css(r)}return i},getBoundingClientRect:function(e){var t=e.getBoundingClientRect();if("number"==typeof t.width)return t;var n={left:t.left,top:t.top,right:t.right,bottom:t.bottom},r=$(e);return n.width=r.outerWidth(),n.height=r.outerHeight(),n},getFirstElementChild:function(e){for(var t=3,n=e.firstChild;n&&n.nodeType===t;)n=n.nextSibling;return n}}}),Box.Application.addService("focus",function(e){"use strict";function t(e){for(var t=a.queryAll(o,e),n=[],r=0;r<t.length;r++)a.isVisible(t[r])&&n.push(t[r]);return n}function n(e){return function(n){var i=t(e);i.length>0&&n&&n.data&&n.data.field&&(n.data.field===r?i[0].focus():i[i.length-1].focus())}}var r="after",i="before",o="a[href], button:not(.popup-x-btn), input, select, textarea",a=e.getService("dom");return{wrap:function(e,o){if(!e.isFocusWrapped){e.isFocusWrapped=!0;var s=document.createElement("i");s.setAttribute("tabindex","0");var l=document.createElement("i");if(l.setAttribute("tabindex","0"),a.on(s,"focusin",n(e),{field:i}),a.on(l,"focusin",n(e),{field:r}),e.children.length>0&&(e.insertBefore(s,e.firstChild),e.appendChild(l)),"undefined"==typeof o||o===!0){var c=t(e);o=c[0]}o&&o.focus&&o.focus()}}}}),Box.Application.addService("form-validator",function(e){"use strict";function t(){return"function"==typeof P.createElement("input").checkValidity}function n(e){return e.tagName&&"form"===e.tagName.toLowerCase()}function r(e){var t=e.tagName?e.tagName.toLowerCase():"";return"input"===t||"textarea"===t||"select"===t}function i(e){var t=e.nodeName?e.nodeName.toLowerCase():"",n=N.getNearest(e,D);"select"===t&&n?(N.addClass(n,C),n.setAttribute(M,"true")):(N.addClass(e,C),e.setAttribute(M,"true"))}function o(e){var t=e.nodeName?e.nodeName.toLowerCase():"",n=N.getNearest(e,D);"select"===t&&n?(N.removeClass(n,C),n.removeAttribute(M)):(N.removeClass(e,C),e.removeAttribute(M))}function a(t){var n=_?t.validationMessage:t.getAttribute(w);i(t),t.setAttribute(A,""),t.setAttribute(x,"tooltip"),t.setAttribute(T,n),t.setAttribute(M,"true"),t.setAttribute(I,O),e.broadcast("formvalidatorerrorshown",t)}function s(t){o(t),t.removeAttribute(A),t.removeAttribute(x),t.removeAttribute(T),t.removeAttribute(M),t.removeAttribute(I),e.broadcast("formvalidatorerrorcleared",t)}function l(e){for(var t=0,n=R.length;t<n;t++)if(e.name===R[t].name)return!0;return!1}function c(e){return $t("Input must be at least %1 characters.","form_error_too_short",e)}function u(e,t){var n=t.getAttribute(E);return n&&(e=$t("%1 (%2)","form_validation_error_message_with_fieldname",e,n)),e}function d(e){var t,n=e.validity;if(n.valueMissing)t=$t("Field required.","form_error_required");else if(n.typeMismatch&&"email"===e.type)t=$t("Email address not valid.","form_email_not_valid");else if(n.typeMismatch&&"url"===e.type)t=$t("URL not valid.","form_url_not_valid");else if(n.tooLong)t=$t("Input must be no more than %1 characters.","form_error_too_long",e.maxLength);else if(n.tooShort)t=c(e.minLength);else if((n.rangeOverflow||n.rangeUnderflow)&&""!==e.min&&""!==e.max)t=$t("Value must be between %1 and %2.","form_error_between_values",e.min,e.max);else if(n.rangeUnderflow)t=$t("Value must be greater than or equal to %1.","form_error_under_min",e.min);else if(n.rangeOverflow)t=$t("Value must be less than or equal to %1.","form_error_over_max",e.max);else{if(!(n.stepMismatch||n.typeMismatch||n.patternMismatch||n.badInput))return;t=$t("Input not valid.","form_error_not_valid")}t=u(t,e),e.setCustomValidity(t)}function f(e){return!!r(e)&&(!e.disabled&&!N.getNearest(e,".disabled")&&!(_&&!e.willValidate))}function p(e,t){var n=e.getAttribute(k);if(n)for(var r=n.split(" "),i=0,o=r.length;i<o;i++)if(r[i]===t)return!0;return!1}function m(e){for(var t,n=N.queryAll("input, select, textarea",e),r=[],i=0,o=n.length;i<o;i++)t=n[i],f(t)&&r.push(t);return r}function h(e,t){t=u(t,e),_?(e.setCustomValidity(t),e.removeAttribute(w)):""===t?e.removeAttribute(w):e.setAttribute(w,t)}function g(e,t){h(e,t),e.setAttribute(S,!0),a(e)}function v(){return{setCustomValidity:h,hasValidatorAttribute:p}}function y(e){var t;if(_){if(e.setCustomValidity(""),e.removeAttribute(S),e.checkValidity(),!e.validity.valid)return d(e),a(e),!1;for(var n=N.getNearest(e,"form"),r=v(),i=0,o=R.length;i<o;i++)if(t=R[i],t.shouldValidate(r,n,e)&&!t.validate(r,n,e))return a(e),!1;return s(e),!0}return!e.hasAttribute(w)}function b(e){function t(e){var t=e.target;r(t)&&t.hasAttribute(S)&&(t.removeAttribute(S),h(t,""),s(t))}N.on(e,"input",t),N.on(e,"change",t)}var _,w="data-form-error",S="data-temp-error",k="data-validator",E="data-error-display-name",C="is-invalid",x="data-focus",T="aria-label",A="data-tooltip",I="data-tooltip-theme",O="error",D=".select-container",M="aria-invalid",P=e.getGlobal("document"),N=e.getService("dom"),R=[];_=t();var F={initForm:function(e){e.setAttribute("novalidate","novalidate");for(var t=m(e),n=0,r=t.length;n<r;n++){var i=t[n],o=i.getAttribute(w);o&&g(i,o)}b(e)},canValidate:f,checkValidity:function(e){if(n(e)){for(var t=m(e),i=!0,o=0,a=t.length;o<a;o++)y(t[o])||(i=!1);return i}if(r(e))return!f(e)||y(e);throw new Error("checkValidity() requires a form, input, select, or textarea element!")},setCustomError:g,addValidationRule:function(e){if("function"!=typeof e.shouldValidate||"function"!=typeof e.validate)throw new Error("Validation rules must have a shouldValidate() function and a validate() function");if("string"!=typeof e.name)throw new Error("Validation rules must have a unique `name` property");l(e)||R.push(e)}};return F.addValidationRule({name:"minlength",shouldValidate:function(e,t,n){return e.hasValidatorAttribute(n,"minlength")},validate:function(e,t,n){var r=n.value,i=parseInt(n.getAttribute("minlength"),10);return!(r&&r.length<i)||(e.setCustomValidity(n,c(i)),!1)}}),F.addValidationRule({name:"non-empty",shouldValidate:function(e,t,n){return e.hasValidatorAttribute(n,"non-empty")},validate:function(e,t,n){return!!n.value.trim()||(e.setCustomValidity(n,$t("Field cannot be empty.","field_cannot_be_empty_tooltip")),!1)}}),F}),Box.Application.addService("function-utils",function(e){"use strict";function t(e,t,n){var r,i,o,a,s,l=function(){var c=(new Date).getTime()-a;c<t&&c>0?r=setTimeout(l,t-c):(r=null,n||(s=e.apply(o,i),r||(o=i=null)))};return function(){var c=n&&!r;return o=this,i=arguments,a=(new Date).getTime(),r||(r=setTimeout(l,t)),c&&(s=e.apply(o,i),o=i=null),s}}function n(e,t){var n,r,i,o=null,a=0,s=function(){a=(new Date).getTime(),o=null,i=e.apply(n,r),o||(n=r=null)};return function(){var l=(new Date).getTime(),c=t-(l-a);return n=this,r=arguments,c<=0||c>t?(clearTimeout(o),o=null,a=l,i=e.apply(n,r),o||(n=r=null)):o||(o=setTimeout(s,c)),i}}function r(t,n,r,i){var o=0;r=r||0,i=i||1;var a=e.getService("promises");return a.create(function(e,s){function l(){o++,a.create(function(e,n){t(e,n,s)}).then(e,function(e){return o<n?(r*=i,void c(r)):void s(e)})}function c(e){setTimeout(function(){l()},e)}c(r)})}return{debounce:t,throttle:n,retryNumOfTimes:r}}),Box.Application.addService("google-translations",function(e){"use strict";var t=e.getService("ajax");return{getTranslation:function(e,n,r){return t.get("get_google_translation",{source:e,itemId:n,component:r})}}}),Box.Application.addService("local-store",function(e){"use strict";function t(e){return i+"/"+o+"/"+e}function n(){try{return r=e.getGlobal("localStorage"),r.setItem(t("TestKey"),"testValue"),r.removeItem(t("TestKey")),!0}catch(e){return!1}}var r,i="localStore",o="0",a={},s=n();return{setItem:function(e,n){if(s)try{r.setItem(t(e),JSON.stringify(n))}catch(e){}else a[e]=n},getItem:function(e){if(!s)return a[e];try{return JSON.parse(r.getItem(t(e)))}catch(e){return null}},removeItem:function(e){if(s)try{r.removeItem(t(e))}catch(e){}else a[e]&&delete a[e]}}}),Box.Application.addService("locales",function(){"use strict";var e=null;return{getBcp47Tag:function(){if(!e){var t=document.getElementsByTagName("html"),n=t.length>0?t[0]:null;n&&(e=n.getAttribute("lang")),e||(e="en-US")}return e}}}),Box.Application.addService("numbers",function(e){"use strict";function t(e){return e<1e3&&e===Math.floor(e)}function n(n,r,o){if(t(n))return n.toString();var a="",s=i.getBcp47Tag(),l={minimumFractionDigits:r,maximumFractionDigits:o},c=e.getGlobal("Intl"),u=c&&"object"==typeof c,d=u&&"function"==typeof c.NumberFormat;return a=u&&d?new c.NumberFormat(s,l).format(n):n.toString()}function r(t,n,r,a,s){var l,c=i.getBcp47Tag(),u={style:"currency",currency:n,currencyDisplay:r,minimumFractionDigits:a,maximumFractionDigits:s},d=e.getGlobal("Intl"),f=d&&"object"==typeof d,p=f&&"function"==typeof d.NumberFormat;l=f&&p?new d.NumberFormat(c,u).format(t):n+" "+t.toString();var m=i.getBcp47Tag(),h=o[n];if(h){var g=h[m];g&&(l=l.replace(g.extract,g.replaceWith))}return l}var i=e.getService("locales"),o={AUD:{"en-AU":{extract:"$",replaceWith:"AUD"}},CAD:{"en-CA":{extract:"$",replaceWith:"CA$"},"fr-CA":{extract:"$",replaceWith:"$ CA"}},TWD:{"zh-TW":{extract:"$",replaceWith:"NT$"}},USD:{"da-DK":{extract:"$",replaceWith:"US$"},"de-DE":{extract:"$",replaceWith:"US$"},"ja-JP":{extract:"$",replaceWith:"US$"},"ru-RU":{extract:"$",replaceWith:"US$"},"tr-TR":{extract:"$",replaceWith:"US$"}}};return{formatNumber:function(e){return n(e,0,2)},formatNumberAsCurrency:function(e,t){var n="symbol",i=e%1===0?0:2,o=2;return r(e,t,n,i,o)}}}),Box.Application.addService("priority-queue",function(){"use strict";function e(e){function t(){r&&(n.sort(e),r=!1)}var n=[],r=!1;return{queue:function(e){n.push(e),r=!0},peek:function(){return t(),0!==n.length?n[0]:null},dequeue:function(){return t(),0!==n.length?n.shift():null},clear:function(){n=[],r=!1}}}return{create:function(t){return new e(t)}}}),Box.Application.addService("promises",function(e){"use strict";return Promise.longStackTraces(),Promise.customUnhandledRejectionHandlerDisabled||Promise.onPossiblyUnhandledRejection(function(t,n){var r=n.reason();"undefined"!=typeof r&&("[object Object]"===t.message&&(t.message="Missing an error or rejection handler for "+(r.data||"a promise")),e.reportError(t))}),{CancellationError:Promise.CancellationError,TimeoutError:Promise.TimeoutError,all:Promise.all,settle:Promise.settle,some:Promise.some,one:function(e){var t,n=[],r=0;return new Promise(function(i,o){function a(i){return function(a){n[i]=a,++r===e.length&&(t=new Error("no promises resolved"),t.errors=n,o(t))}}e.forEach(function(e,t){e.then(i).catch(a(t))})})},any:Promise.any,create:function(e){return new Promise(e)},createResolved:function(e){return Promise.resolve(e)},createRejected:function(e){return Promise.reject(e)},createCancellable:function(e){return new Promise(e).cancellable()}}}),Box.Application.addService("react-component-renderer",function(e){"use strict";function t(e,t){this.klass=e,this.props=window.LANGUAGE&&window.TRANSLATIONS?{locale:window.LANGUAGE,messages:window.TRANSLATIONS}:{},this.mountNode=t}var n=e.getGlobal("React"),r=e.getGlobal("ReactDOM");return t.prototype.replaceProps=function(e,t){this.props={},this.setProps(e,t)},t.prototype.setProps=function(e,t){if(null==this.klass)return void console.warn("setProps(...): Can only update a mounted or mounting component. This usually means you called setProps() on an unmounted component. This is a no-op.");$.extend(this.props,e);var i=n.createElement(this.klass,this.props);this.component=r.render(i,this.mountNode,t)},t.prototype.unmount=function(){r.unmountComponentAtNode(this.mountNode)},{create:function(e,n){return new t(e,n)}}}),Box.Application.addService("screen",function(){"use strict";return{isHighDensity:function(){return window.devicePixelRatio>=2||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi)").matches}}}),Box.Application.addService("session-store",function(e){"use strict";function t(e){return i+"/"+o+"/"+e}function n(){try{return r=e.getGlobal("sessionStorage"),r.setItem(t("TestKey"),"testValue"),r.removeItem(t("TestKey")),!0}catch(e){return!1}}var r,i="sessionStore",o="0",a={},s=n();return{setItem:function(e,n){if(s)try{r.setItem(t(e),JSON.stringify(n))}catch(e){}else a[e]=n},getItem:function(e){if(!s)return a[e];try{return JSON.parse(r.getItem(t(e)))}catch(e){return null}},removeItem:function(e){if(s)try{r.removeItem(t(e))}catch(e){}else a[e]&&delete a[e]},removeAll:function(){if(s)try{r.clear()}catch(e){}else Object.keys(a).length>0&&(a={})}}}),Box.Application.addService("strings",function(e){"use strict";function t(e){var t=$("<div />").css({display:"block",left:0,position:"absolute",top:0,visibility:"hidden",whiteSpace:"nowrap"}).appendTo("body");if(e){var n=$(e);t.css({fontFamily:n.css("font-family"),fontSize:n.css("font-size"),fontWeight:n.css("font-weight")})}return t[0]}function n(e,t,n){return"undefined"!=typeof n.innerText?n.innerText=e:n.textContent=e,n.offsetWidth<=t}function r(e,t,r){for(var i=e.length,o=0,a=i,s=i,l=e;a-o>1;)n(l,t,r)?o=s:a=s,s=Math.floor((o+a)/2),o!==i&&(l=e.substr(0,s)+"...");return l}function i(e,t){for(var n,r,i="",o=0;o<e.length;o++){if("a"===e[o]){i+="(?!/?"+e[o]+"[^>]*>)";var a=new RegExp('<a\\s[^>]*(href="[^"]*")[^>]*>',"g");t=t.replace(a,'<a $1 target="_blank">'),a=new RegExp("<a\\s[^h][^>]*>","g"),t=t.replace(a,"&lt;a>")}else i+="(?!/?"+e[o]+">)",r=new RegExp("<"+e[o]+"\\s[^>]*>","g"),t=t.replace(r,"<"+e[o]+">");r=new RegExp("</"+e[o]+"\\s[^>]*>"),t=t.replace(r,"</"+e[o]+">")}try{n=new RegExp("<"+i,"gi")}catch(e){return $.log(e),""}return t=t.replace(n,"&lt;").replace(new RegExp("\n","g"),"<br>").replace(new RegExp("\r","g"),"<br>")}var o=/\b(ht|f)tps?:\/\/[\w\._\-]+(:\d+)?(\/[\w\-_\.~\+\/#\?&%=:\[\]@!\$'\(\)\*;,]*)?/gim,a=["B","KB","MB","GB","TB"],s=["b","strong","i","em","u","a","span"];return{getFastShortString:function(e,t){return e&&0!==e.length?e.length<=t?e:e.substring(0,t-3)+"...":""},getShortString:function(e,n,i){if(!e||0===e.length)return e;var o,a;return a=t(i),o=r(e,n,a),$(a).remove(),o},getHyperlinkedString:function(e){return e.replace(o,function(e){return'<a href="'+e+'" target="_blank">'+e+"</a>"})},getHumanReadableSize:function(e,t){var n,r;return"undefined"==typeof t&&(t=1),e=parseInt(e,10),e<=0?"0 "+a[0]:(n=Math.floor(Math.log(e)/Math.log(1024)),n=Math.min(Math.max(n,0),a.length-1),r=e/Math.pow(1024,n),n>0&&(r=r.toFixed(t)),r+" "+a[n])},capitalize:function(e){return(e+"").replace(/^([a-z])|\s+([a-z])|_([a-z])/g,function(e){return e.toUpperCase()})},escapeMarkupTags:function(e){return i(s,e)},removeInvisibleCharacters:function(e){return(e+"").replace(/\u200e/g,"")},trim:function(e){var t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return e.replace(t,"")},isEmail:function(e){var t=/^[^\s<>@,]+@[^\s<>@,\/\\]+\.[^\s<>@,]+$/i;return null!==t.exec(e)},getEmail:function(e){var t=/[^\s<>@,]+@[^\s<>@,]+\.[^\s<>@,]+/i,n=t.exec(e);return n?n[0]:""}}}),Box.Application.addService("templates",function(e){"use strict";function t(e){return e.replace(r,function(e){return i[e]})}function n(e,n){return n?e.replace(/<%=\s*(\w+)\s*%>/g,function(e,r){var i=n[r]||"";return i?t(i):""}):e}var r=/[<>"&'\/`]/g,i={"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;","'":"&#x27;","/":"&#x2f;","`":"&#x60;"},o=document;return{escapeHTML:t,getTemplateHTML:function(e,t){var r=o.getElementById("jst-"+e),i="";if(r){if(i=r.text.replace(/^\s+|\s+$/g,""))return n(i,t);throw new Error('Template "'+e+'" is an empty string.')}throw new Error('Template "'+e+'" not found.')},createTemplateFragment:function(t,r){if("string"!=typeof t)throw new TypeError("Template text must be a string.");var i=e.getService("dom"),o=n(t,r);return i.createFragmentFromHtml(o)},getTemplateFragment:function(t,n){var r=e.getService("dom"),i=this.getTemplateHTML(t,n);return r.createFragmentFromHtml(i)}}}),Box.Application.addBehavior("access-stats-instrumentation",function(e){"use strict";function t(){_.handleNewlyStarted||(_.handleNewlyStarted=!0,p=d.now(),c.sendLog(w,S))}function n(){return d.now()-p}function r(){if(!_.handleNewlyFinishedLoading&&(_.handleNewlyFinishedLoading=!0,m===y&&h===y)){var e=n();c.sendLog(w,k,{load_time:e}),u.recordAction({component:"modal",feature:"accessstatsnewsroom",target:"loaded",action:"",data:{loadTime:e}})}}function i(){c.sendLog(w,E,{error_message:A})}function o(e){e=e||"unknown",c.sendLog(w,E,{error_message:"stat_"+e+"_failure"})}function a(){c.sendLog(w,T)}function s(e){var t=D[e];_[t.name]||(_[t.name]=!0,c.sendLog(w,t.eventType,{load_time:n()}))}function l(e){e?c.sendLog(w,O):c.sendLog(w,I,{load_time:n()})}var c,u,d,f,p,m,h,g=0,v=1,y=2,b=3,_={},w="access_stats",S="load_started",k="load_success",E="load_failure",C="load_success_feed",x="load_success_totals",T="stat_count_totals_load_failure",A="activity_feed_load_failure",I="access_stats_popup_closed_before_loaded",O="access_stats_popup_closed_after_loaded",D={feed:{name:"handleActivityFeedFullyLoaded",eventType:C},totals:{name:"handleAccessStatsTotalsFullyLoaded",eventType:x}};return{messages:["accessstatstotalsloadsuccess","accessstatstotalsloadstart","accessstatstotalsloadfail","accessstatsfetchstarted","accessstatsfetchfail","accessstatsactivityfeedgetstart","accessstatsactivityfeedgetsuccess","accessstatsactivityfeedgetfail"],init:function(){f=e.getConfig("accessStatsUpdate"),d=e.getGlobal("performance"),
c=e.getService("logger"),u=e.getService("resin"),m=g,h=g,_={handleNewlyFinishedLoading:!1,handleNewlyStarted:!1,handleAccessStatsTotalsFullyLoaded:!1,handleActivityFeedFullyLoaded:!1}},onmessage:function(e,n){if(f){switch(e){case"accessstatsactivityfeedgetstart":m=v;break;case"accessstatsfetchstarted":h=v;break;case"accessstatsactivityfeedgetfail":m=b,i();break;case"accessstatsfetchfail":o(n.statType);break;case"accessstatstotalsloadfail":h=b,a();break;case"accessstatsactivityfeedgetsuccess":m=y,s("feed");break;case"accessstatstotalsloadsuccess":h=y,s("totals")}this.isFullyLoaded()?r():this.isStarted()&&t()}},isFullyLoaded:function(){var e=[y,b].indexOf(m)>-1,t=[y,b].indexOf(h)>-1;return e&&t},isStarted:function(){var e=m!==g,t=h!==g;return e||t},destroy:function(){f&&l(this.isFullyLoaded())}}}),Box.Application.addBehavior("access-stats-keyboard-shortcut",function(e){"use strict";function t(){var t=e.getService("item-actions"),n=o+r;t.showAccessStatsPopup(n)}var n,r,i,o="f_",a=!1;return{messages:["previewcloserequested","file-list-selection-updated"],init:function(){r=e.getConfig("fileId"),a=e.getConfig("canUserSeeAccessStatsModal"),i=e.getElement(),n=e.getService("keyboard-shortcuts"),a&&n.register({name:"access-stats-keyboard-shortcut",shortcuts:[{key:"shift+a",description:$t("Open Access Stats","kb_shortcuts_item_actions_open_access_stats_modal"),handler:t,type:"item-actions"}]},i)},onmessage:function(e,t){"previewcloserequested"===e?n.deregister("access-stats-keyboard-shortcut",i):"file-list-selection-updated"===e&&t&&1!==t.length&&n.deregister("access-stats-keyboard-shortcut",i)},destroy:function(){n.deregister("access-stats-keyboard-shortcut",i)}}}),Box.Application.addBehavior("ajax-nav",function(e){"use strict";var t,n,r="is-disabled";return{init:function(){t=e.getService("nav"),n=e.getService("dom"),t.init()},onclick:function(e){if(!(e.isPropagationStopped&&e.isPropagationStopped()||e.ctrlKey||e.metaKey||e.shiftKey)){var i=n.getNearest(e.target,"a[data-ajax]");i&&(e.preventDefault(),n.getNearest(i,"."+r)||(e.stopPropagation(),t.navigate(i.getAttribute("href"))))}}}}),Box.Application.addBehavior("change-classification",function(e){"use strict";var t,n="change_classification_popup",r=e.getService("popups-amsterdam");return{init:function(){t=e.getConfig("itemTypedID")},onclick:function(e,i,o){i&&"change-classification"===o&&(e.preventDefault(),r.open(n,{data:{itemTypedID:t},isPostRequest:!0}))}}}),Box.Application.addBehavior("refresh-banner-policy",function(e){"use strict";var t,n,r,i,o="classification_get_banner_policy";return{messages:["item-change-classification"],init:function(){r=e.getService("ajax"),i=e.getService("dom");var o=e.getElement();t=i.query(".banner-policy",o),t&&(n=t.getAttribute("data-policy-for"))},onmessage:function(e,a){t&&"item-change-classification"===e&&a.itemTypedID===n&&r.get(o,{itemTypedID:n}).then(function(e){i.setHTML(t,e.data.html)})}}}),Box.Application.addBehavior("collab-invite",function(e){"use strict";var t,n="collab_invite_popup";return{init:function(){t=e.getService("popups-amsterdam")},onclick:function(e,t,n){if("open-invite-collab-popup"===n){var r=t.getAttribute("data-item-typed-id");this.openInvitePopup(r),e.preventDefault(),e.stopPropagation()}},openInvitePopup:function(e){t.open(n,{resinName:"invitecollaborators",data:{itemTypedId:e}})}}}),Box.Application.addBehavior("collab-menu-remove",function(e){"use strict";function t(e,t,n){var i=$t("Remove From Parent Folder","remove_inherited_collab_confirmation_popup_title"),o=$t('%1 will be removed from the parent folder "%2" because collaboration is inherited from it. Are you sure you want to continue?',"remove_inherited_collab_popup_message",t,n);c.confirm(o,i).then(function(){r(e,t,{ignoreInheritanceCheck:!0,ignoreTaskWarning:!1})})}function n(e,t,n){var i=$t("Overwrite Pending Tasks","pending_tasks_confirm_popup_title"),o=$t("Are you sure you want to remove %1 as a collaborator? %1 will no longer be able to complete pending tasks for this item.","pending_tasks_confirm_popup_message",t);c.confirm(o,i).then(function(){r(e,t,{ignoreInheritanceCheck:!1,collabedFolderName:n,ignoreTaskWarning:!0})})}function r(r,o,a){a=a||{};var c,d=u.getGcmCompatibleRm(p),g={itemTypedId:f,collabId:r,ignoreInheritanceCheck:a.ignoreInheritanceCheck||!1,ignoreTaskWarning:a.ignoreTaskWarning||!1};e.broadcast("collabrequestsent"),i.post(d,g).then(function(t){e.broadcast("collabresponsereceived"),t.data.isCurrentUserGroupCollab?(c=$t("You have removed your group from the item.","remove_current_user_group_collab_success"),l.info(c),s.redirect("/files")):(c=$t("You have removed %1 as a collaborator on this item.","remove_collab_success",o),l.info(c),e.broadcast("collabchanged",{itemTypedID:f}))},function(i){var s=i.data||{};if(e.broadcast("collabresponsereceived"),s.code===m)t(r,o,a.collabedFolderName);else if(s.code===h)n(r,o,a.collabedFolderName);else if(s.message)l.error(s.message);else{var c=$t("Something went wrong with your request. Please try again.","remove_collab_request_generic_error_message");l.error(c)}})}var i,o,a,s,l,c,u,d,f,p="remove_collab_from_item",m="inheritedCollab",h="taskAffected";return{init:function(){i=e.getService("ajax"),o=e.getService("collab-actions"),a=e.getService("dom"),s=e.getService("nav"),l=e.getService("notifications-amsterdam"),c=e.getService("popups-amsterdam"),u=e.getService("url"),d=e.getElement(),f=d.getAttribute("data-item-typed-id")},onclick:function(e,t,n){if("remove-collab"===n){var r=a.getNearest(t,".menu-wrapper"),i=r.hasAttribute("data-is-current-user");if(i)o.removeCurrentUserFromItem(f);else{var s=r.getAttribute("data-collab-id"),l=r.getAttribute("data-display-name"),c=r.getAttribute("data-collabed-folder-name");this.removeCollab(s,l,c)}e.preventDefault(),e.stopPropagation()}},removeCollab:function(e,t,n){r(e,t,{ignoreInheritanceCheck:!1,collabedFolderName:n,ignoreTaskWarning:!1})}}}),Box.Application.addBehavior("collab-menu-resend-invite",function(e){"use strict";var t,n,r,i,o="collab_resend_invite_email";return{init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getService("notifications-amsterdam"),i=e.getService("url")},onclick:function(e,t,r){if("resend-invite"===r){var i=n.getNearest(t,".menu-wrapper"),o=i.getAttribute("data-collab-id"),a=i.getAttribute("data-display-name");this.resendInvite(o,a),e.preventDefault(),e.stopPropagation()}},resendInvite:function(n,a){var s,l=i.getGcmCompatibleRm(o),c={collabId:n};e.broadcast("collabrequestsent"),t.post(l,c).then(function(){e.broadcast("collabresponsereceived"),s=$t("You resent a collaboration invite to %1","collaborate_resend_invite_success",a),r.info(s)},function(){e.broadcast("collabresponsereceived"),s=$t("There was an error resending the collaboration invite.","collaborate_resend_invite_error"),r.error(s)})}}}),Box.Application.addBehavior("collab-role-menu",function(e){"use strict";function t(t){e.broadcast("collabrequestsent");var r=s.getGcmCompatibleRm(p),a={itemTypedId:c,newRoleId:t};n.post(r,a).then(function(){e.broadcast("collabresponsereceived"),i.reload()},function(n){var r,i=n.data||{};e.broadcast("collabresponsereceived"),r=i.message?i.message:$t("There was a problem changing your role to %1. Please try again or refresh the page.","change_current_user_collab_role_generic_error",v[t]),o.error(r)})}var n,r,i,o,a,s,l,c,u="owner",d="collab_get_owner_transfer_confirm_message",f="collab_transfer_item_ownership",p="collab_change_current_user_role",m="collab_change_role",h="collab_get_role_menu",g="inheritedCollab",v={15:$t("Co-owner","co_owner"),7:$t("Editor","editor"),17:$t("Viewer Uploader","viewer_uploader"),13:$t("Previewer Uploader","previewer_uploader"),3:$t("Viewer","viewer"),9:$t("Previewer","previewer"),11:$t("Uploader","uploader")};return v[u]=$t("Owner","owner"),{init:function(){n=e.getService("ajax"),r=e.getService("dom"),i=e.getService("nav"),o=e.getService("notifications-amsterdam"),a=e.getService("popups-amsterdam"),s=e.getService("url"),l=e.getElement(),c=l.getAttribute("data-item-typed-id")},onclick:function(e,t,n){if("collab-role-menu-option"===n&&!r.hasClass(t,"is-selected")){var i=t.getAttribute("data-role-id"),o=r.getNearest(t,".menu-wrapper"),a=o.getAttribute("data-display-name"),s=o.hasAttribute("data-is-current-user"),l=o.getAttribute("data-collab-id"),c=o.getAttribute("data-collabed-folder-name");switch(i){case u:this.getOwnerTransferWarning(a);break;default:s?this.changeCurrentUserRole(i):this.changeCollabRole(l,a,i,t,c)}e.preventDefault(),e.stopPropagation()}},getOwnerTransferWarning:function(t){var r=s.getGcmCompatibleRm(d),i={itemTypedId:c,newOwnerEmail:t},l=this;e.broadcast("collabrequestsent"),n.get(r,i).then(function(n){var r=n.data,i=$t("Change Item Owner","change_item_owner_popup_title");e.broadcast("collabresponsereceived"),a.confirm(r.message,i).then(function(){l.transferItemOwnership(t)})},function(){e.broadcast("collabresponsereceived"),o.error($t("There was a problem making %1 the owner of the item. Please try again or refresh the page.","transfer_item_ownership_generic_error",t))})},transferItemOwnership:function(t){var r=s.getGcmCompatibleRm(f),a={itemTypedId:c,newOwnerEmail:t};e.broadcast("collabrequestsent"),n.post(r,a).then(function(){e.broadcast("collabresponsereceived"),i.reload()},function(n){var r,i=n.data||{};e.broadcast("collabresponsereceived"),r=i.message?i.message:$t("There was a problem making %1 the owner of the item. Please try again or refresh the page.","transfer_item_ownership_generic_error",t),o.error(r)})},changeCurrentUserRole:function(e){a.confirm($t("Are you sure you want to change your role? If changing to uploader, you may no longer be able to complete pending tasks for this item.","uploader_task_affected_current_user_warning"),$t("Change Collaboration Role","change_collab_role_popup_title")).then(function(){t(e)})},changeCollabRole:function(e,t,n,r,i){this.sendChangeCollabRoleRequest(e,t,n,!1,r,i)},sendChangeCollabRoleRequest:function(t,r,a,l,u,d){var f=s.getGcmCompatibleRm(m),p={itemTypedId:c,collabId:t,newRoleId:a,ignoreInheritanceCheck:l},h=this;e.broadcast("collabrequestsent"),n.post(f,p).then(function(n){e.broadcast("collabresponsereceived"),n.data.isCurrentUserGroupCollab?i.reload():h.updateCollabRoleMenu(t,u,v[a])},function(n){var i,s=n.data||{};return e.broadcast("collabresponsereceived"),s.code===g?void h.showChangeInheritedCollabRolePopup(t,r,a,u,d):(i=s.message?s.message:$t("There was a problem changing %1 to %2 role. Please try again or refresh the page.","change_collab_role_generic_error",r,v[a]),void o.error(i))})},updateCollabRoleMenu:function(t,o,a){var l=s.getGcmCompatibleRm(h),u=e.getConfig("isSidebar"),d={collabId:t,itemTypedId:c,isSidebar:!!u};e.broadcast("collabrequestsent"),n.get(l,d).then(function(t){var n=r.getNearest(o,".collab-row"),i=r.query(".collab-role-container",n),s=r.query(".collab-role-level",n);e.broadcast("collabresponsereceived"),r.setHTML(i,t.data.html),s&&r.setHTML(s,a)},function(){i.refresh()})},showChangeInheritedCollabRolePopup:function(e,t,n,r,i){var o=$t("Change Role for Parent Folder","change_inherited_collab_role_popup_title"),s=$t('%1 will be changed to %2 role for the parent folder "%3" because collaboration is inherited from it. Are you sure you want to continue?',"change_inherited_collab_role_popup_message",t,v[n],i),l=this;a.confirm(s,o).then(function(){l.sendChangeCollabRoleRequest(e,t,n,!0,r)})}}}),Box.Application.addBehavior("confirm-end-trial",function(e){"use strict";var t,n,r,i=$t("Ready to buy Box?","ready_to_buy_box"),o=$t("End your trial early and start your subscription now","end_your_trial_and_buy_now"),a=$t("Not now","not_now_btn"),s=$t("Start my subscription","start_my_subscription"),l=$t("You have successfully started your subscription. Welcome to the family!","end_trial_success"),c="end_trial_and_buy_now";return{init:function(){t=e.getService("popups-amsterdam"),n=e.getService("ajax"),r=e.getService("nav")},onclick:function(e,u,d){switch(d){case"end-trial-btn":var f=u.getAttribute("data-has-payment-system");if(!f)return void r.redirect("/update");t.confirm(o,i,{confirmText:s,cancelText:a}).then(function(){return n.post(c)}).then(function(){return t.alert(l)}).then(function(){r.reload()}).catch(function(e){e&&e.data&&t.alert(e.data.error.message)})}}}}),Box.Application.addBehavior("contextual-messages-registration",function(e){"use strict";function t(){return!document.querySelector("body.lte_ie9")}function n(){return u.hasClass(document.body,S)}function r(){var t=e.getConfig(p);if(!t)return[];var n=t.messageContext;return f=t.messages,f.map(function(e){e.context=n}),f}function i(){var e=r();e.map(function(e){d.registerMessage(e)})}function o(){var e=r();e.map(function(e){d.unregisterMessage(e.identifier,e.context,e.type)})}function a(){return e.hasService("contextual-message")&&t()}function s(){u.hasClass(document.body,w)||u.addClass(document.body,w)}function l(){u.hasClass(document.body,w)&&u.removeClass(document.body,w)}function c(t,n){switch(t){case"getcontextualmessageinfo":var r=null,i=null;Array.isArray(f)&&f.forEach(function(e){e.name===n.name&&e.type===n.type&&(r=e.id,i=e.context)}),null!==r&&e.broadcast("contextualmessageinfo",{context:i,id:r})}}var u,d,f,p="eligibleMessages",m="previewopen",h="previewclose",g="previewaction",v="previewtogglesidebar",y=[g,h,m,v],b="show",_="close",w="help-icon-hidden",S="is-preview-visible",k='.preview.is-preview-sidebar-visible[data-module="preview"]';return{messages:["previewaction","previewopen","previewclose","previewtogglesidebar","getcontextualmessageinfo"],init:function(){a()&&(u=e.getService("dom"),d=e.getService("contextual-message"),n()||i())},destroy:function(){a()&&o()},onmessage:function(e,t){if(a())return y.indexOf(e)<0?void c(e,t):e===v?void(t.showSidebar?l():s()):void(e===g&&t.action===b||e===m?(document.querySelector(k)||s(),o()):(e===g&&t.action===_||e===h)&&(l(),i()))}}}),Box.Application.addBehavior("custom-action-integrations",function(e){"use strict";var t;return{init:function(){t=e.getService("notifications-amsterdam")},onmessage:{customactionunlockrequested:function(n){if(n&&n.fileID){var r=!!n.saveOnUnlock,i="f_"+n.fileID;r&&t.info($t("Saving file back to Box...","custom_actions_saving_file_back_to_box"));var o=e.getService("fileop-lock");o.unlock(i).then(function(){r&&t.info($t("File was saved back to Box.","custom_actions_file_saved_to_box"))}).catch(function(){r&&t.error($t("Unable to save the file back to Box. Please refresh and try again.","custom_actions_unable_to_save_file"))})}},customactionclosed:function(e){e&&e.message&&t.confirm(e.message)}}}}),Box.Application.addBehavior("custom-avatar",function(e){"use strict";function t(){r.removeClass(o,l),setTimeout(function(){o.removeChild(a),a=null},500)}function n(e){a||(a=document.createElement("img"),o.appendChild(a)),a.onload=function(){s.URL.revokeObjectURL(e),r.addClass(o,l)},a.src=e}var r,i,o,a,s,l="has-custom-avatar";return{messages:["customavatarupdated","customavatarremoved"],init:function(){r=e.getService("dom"),s=e.getGlobal("window"),i=e.getElement(),o=r.query(".profile-image",i),a=r.query("img",o)},onmessage:function(e,r){switch(e){case"customavatarupdated":n(r.fileURL);break;case"customavatarremoved":t()}}}}),Box.Application.addBehavior("datepicker",function(e){"use strict";var t,n,r;return{init:function(){t=e.getService("dom"),n=e.getService("datepicker"),r=e.element;for(var i=t.queryAll("input.datepicker",r),o=0,a=i.length;o<a;o++)n.create(i[o])}}}),Box.Application.addBehavior("drag-drop-download",function(e){"use strict";var t,n;return{init:function(){t=e.getService("drag-download"),n=e.getElement(),t.bindDrag(n)},destroy:function(){t.unbindDrag(n)}}}),Box.Application.addBehavior("embed-widget",function(e){"use strict";var t,n,r,i;return{init:function(){r=e.getService("embed-context"),i=e.getService("nav"),t=e.getGlobal("XMLHttpRequest"),r.isEmbedWidget()&&(r.requiresAdditionalContext()&&this.hijackXHR(),i.registerBeforeStateChange(this.handleBeforeStateChange))},destroy:function(){this.restoreXHR(),i.unregisterBeforeStateChange(this.handleBeforeStateChange)},handleBeforeStateChange:function(e){var t=e.toState.url,n=r.updateURLWithEmbedWidgetParams(t);e.updateState(n)},hijackXHR:function(){n||(n=t.prototype.open,t.prototype.open=function(){var e=Array.prototype.slice.call(arguments,0),t=e[1];t&&(e[1]=r.setAdditionalContext(t)),n.apply(this,e)})},restoreXHR:function(){n&&(t.prototype.open=n,n=null)}}}),Box.Application.addBehavior("file-list-bulk-actions",function(e){"use strict";function t(){var e=i.query("[data-folder-typed-id]");return e?e.getAttribute("data-folder-typed-id"):null}function n(){return a.map(function(e){return e.id})}var r,i,o,a,s,l,c="showing-bulk-action-",u="is-showing-bulk-actions",d="none-available";return{messages:["file-list-selection-updated"],init:function(){r=e.getService("array-utils"),i=e.getService("dom"),o=e.getService("item-actions"),a=[],s=i.query(".action-bar"),l=new RegExp("\\s*("+c+"\\w+|"+d+")","g")},onmessage:function(e,t){this.handleSelectionUpdate(t.map(function(e){return{id:e.id,tags:e.tags,name:e.name}}))},onclick:function(e,r,i){if(i&&0===i.indexOf("bulk-")){e.preventDefault(),e.stopPropagation();var s=t(),l=n();switch(i){case"bulk-download-btn":o.download(l,{currentFolderTypedID:s});break;case"bulk-movecopy-btn":o.movecopy(l,s);break;case"bulk-delete-btn":o.delete_(l,s);break;case"bulk-share-via-email-btn":o.shareViaEmail(l,s);break;case"bulk-add-tags-btn":o.showUpdateTagsPopup(a)}}},handleSelectionUpdate:function(e){a=e,this.updateBulkActionDisplay(n())},updateBulkActionDisplay:function(e){if(!e.length)return i.removeClass(s,u),void i.removeClass(s,d);var t=this.getBulkActionIntersection(e),n=t.length?c+t.join(" "+c):d;s.className=s.className.replace(l,""),i.addClass(s,u+" "+n)},getBulkActionIntersection:function(e){var t=r.map(e,function(e){var t=i.query('.tbl-list-item[data-id="'+e+'"]').getAttribute("data-available-actions")||"",n=t.split(/\s+/);return n=r.filter(n,function(e){return e})});return r.reduce(t,function(e,t){for(var n=[];e.length&&t.length;)e[0]<t[0]?e.shift():t[0]<e[0]?t.shift():(n.push(e.shift()),t.shift());return n})}}}),Box.Application.addBehavior("file-list-bulk-menu",function(e){"use strict";function t(e){var t=e.actions||"",n=t.split(" ");return n.filter(function(e){return e.length>0})}function n(){y&&y.isOpen()&&y.hide()}function r(e,t,n){var r=e+n-t;return r>0?e-r:e}function i(e,t,n){var r=e+n-t;return r>0?e-r:e}function o(e){for(var t,n,r={},i=e.attributes,o=0,a=i.length;o<a;o++)t=i[o].name,n=i[o].value,0===t.indexOf("data-menu-data")&&(r[t.substr(15)]=n);return r}function a(){var e={delete:!0,"delete-forever":!0,download:!0,movecopy:!0,restore:!0,senditems:!0,_empty:!1};v=[],g.forEach(function(n){v.push(n.id);var r=t(n);Object.keys(e).map(function(t){e[t]=r.indexOf(t)!==-1&&e[t]})});var n=!1;Object.keys(e).map(function(t){n=e[t]||n}),e._empty=!n,d.show(e)}function s(e){this.menuEl=e,this.menuWrapperEl=l.getNearest(this.menuEl,".menu-wrapper");var t=this.eventTarget=new Box.EventTarget;this.fire=function(){t.fire.apply(t,arguments)},this.on=function(){t.on.apply(t,arguments)},this.init()}var l,c,u,d,f={delete:"delete_","delete-forever":"deleteForever",download:"download",movecopy:"movecopy",restore:"restore",senditems:"shareViaEmail"},p="is-visible",m=0,h=0,g=[],v=[],y=null;return s.prototype={init:function(){l.on(this.menuEl,"click",function(e){var t=l.getNearest(e.target,"[data-menu-event]");if(t){var n=t.getAttribute("data-menu-event");n&&(e.preventDefault(),this.fire("selected",{action:n,data:o(t)}),this.hide())}}.bind(this))},destroy:function(){this.hide(),y===this&&(y=null)},show:function(e){y&&y.hide();for(var t in e)if(e.hasOwnProperty(t)){var n=l.query('[data-menu-event="'+t+'"]',this.menuEl),o=l.getNearest(n,"li");o&&(e[t]?o.style.removeProperty("display"):o.style.display="none")}var a=l.query(".main-body"),s=l.getBoundingClientRect(a),c=document.body.scrollTop,u=h-c;this.menuEl.style.left=1e4,l.addClass(this.menuWrapperEl,p);var d=l.getBoundingClientRect(this.menuEl);l.removeClass(this.menuWrapperEl,p);var f=r(u,s.height+s.top+c,d.height),g=i(m,s.right,d.width);this.menuEl.style.top=f+"px",this.menuEl.style.left=g+"px",setTimeout(function(){l.addClass(this.menuWrapperEl,p)}.bind(this),100),this.menuEl.focus(),y=this},hide:function(){y===this&&(y=null),l.removeClass(this.menuWrapperEl,p)},isOpen:function(){return l.hasClass(this.menuWrapperEl,p)}},{messages:["file-list-selection-updated"],init:function(){l=e.getService("dom"),c=e.getService("file-list-manager"),u=e.getService("item-actions"),l.on(window,"mousemove",function(e){m=e.pageX,h=e.pageY}),l.on(window,"keyup",function(e){27===e.keyCode&&n()}),l.on(document.body,"mousedown",function(e){var t=e.target;l.getNearest(t,"[aria-haspopup]")||l.getNearest(t,".menu")||n()});var t=e.getElement().getAttribute("data-bulk-action-menu-name"),r=l.query('.menu-wrapper.bulk-action-menu[data-bulk-action-menu-name="'+t+'"] .menu');d=new s(r),this.initializeMenus(),d.on("selected",function(e){var t=e.data.action,n=c.getCurrentFolder()||0,r=f[t];u[r].call(u,v,"d_"+n)})},initializeMenus:function(){var t=l.queryAll(".item-menu",e.getElement());t.forEach(this.setupMenu.bind(this))},destroy:function(){d.destroy()},onmessage:function(e,t){switch(e){case"file-list-selection-updated":g=t}},setupMenu:function(e){var t=l.getNearest(e,"[data-id]");l.on(t,"contextmenu",function(e){g.length<2||(e.preventDefault(),this._showBulkActionMenu())}.bind(this))},_getBulkActionMenu:function(){return d},_getExtractItemActions:t,_Menu:s,_showBulkActionMenu:a}}),Box.Application.addBehavior("file-list-clipboard",function(e){"use strict";function t(){var e=l.getSelection();return""!==e.toString().trim()}function n(){return c.getAttribute("data-folder-typed-id")}var r,i,o,a,s,l,c,u,d;return{messages:["file-list-selection-updated"],init:function(){l=e.getGlobal("window"),s=e.getGlobal("document"),i=e.getService("item-clipboard"),r=e.getService("file-list-manager"),o=e.getService("keyboard-shortcuts"),a=e.getService("notifications-amsterdam"),d=i.isEnabled(),d&&(c=e.getElement(),u=[],this.handlePasteEvent=this.handlePasteEvent.bind(this),this.copyHandler=this.copyHandler.bind(this),this.pasteHandler=this.pasteHandler.bind(this),this.cutHandler=this.cutHandler.bind(this),o.register({name:"file-list-clipboard",shortcuts:[{key:["meta+c","ctrl+c"],description:$t("Copy selected items","kb_shortcuts_file_list_clipboard_copy_selected_item"),handler:this.copyHandler,type:"item-actions"},{key:["meta+v","ctrl+v"],description:$t("Paste copied items in current folder","kb_shortcuts_file_list_clipboard_paste_copied_item"),handler:this.pasteHandler,type:"item-actions"},{key:["meta+x","ctrl+x"],description:$t("Cut selected items","kb_shortcuts_file_list_clipboard_cut_selected_item"),handler:this.cutHandler,type:"item-actions"}]},s.body),i.on("paste",this.handlePasteEvent))},destroy:function(){d&&(o.deregister("file-list-clipboard",s.body),i.off("paste",this.handlePasteEvent))},onmessage:function(e,t){d&&"file-list-selection-updated"===e&&this.setCurrentSelectedTypedIDs(t.map(function(e){return e.id}))},copyHandler:function(e){t()||(e.preventDefault(),this.copyToClipboard())},pasteHandler:function(e){t()||(e.preventDefault(),this.pasteToFolder())},cutHandler:function(e){t()||(e.preventDefault(),this.cutToClipboard())},setCurrentSelectedTypedIDs:function(e){u=e},copyToClipboard:function(){var e=n();i.copyToClipboard(e,u).then(function(){a.info($t("%1 item(s) copied to clipboard","item_clipboard_copied_to_clipboard",u.length),{duration:2e3})}).catch(function(){})},cutToClipboard:function(){var e=n();i.cutToClipboard(e,u).then(function(){a.info($t("%1 item(s) moved to clipboard","item_clipboard_moved_to_clipboard",u.length),{duration:2e3})}).catch(function(){})},pasteToFolder:function(){var e=n();i.pasteToFolder(e).catch(function(){})},handlePasteEvent:function(e){var t=e.data,i=n();"cut"===t.operation&&(t.destinationFolderTypedID===i?t.itemTypedIDs.forEach(function(e){r.addItem(i,e)}):t.sourceFolderTypedID===i&&t.itemTypedIDs.forEach(function(e){r.removeItem(e)}))}}}),Box.Application.addBehavior("file-list-external-drag",function(e){"use strict";var t,n,r,i,o=".file-list[data-folder-typed-id], .file-list-empty";return{init:function(){if(e.hasService("uploads-hierarchy")){t=e.getService("dom"),n=e.getService("drag-external"),r=e.getService("uploads-hierarchy"),i=e.getElement();var a=n.bindDrops(i);a.on("dragstart",function(e){var n=t.query(o);n&&n.hasAttribute("data-upload-allowed")||e.data.block()}),a.on("drop",function(e){r.uploadIncomingFiles(e.data,t.query(o).getAttribute("data-folder-typed-id"))})}}}}),Box.Application.addBehavior("file-list-internal-drag",function(e){"use strict";function t(t){for(;!t.hasAttribute("draggable");)t=t.parentNode;var r=t.getAttribute("data-id");n.hasClass(t,"file-list-selection")||e.broadcast("toggle-file-list-selection",{itemTypedID:r});var i=!1;a&&a.length>1&&a.indexOf(r)!==-1&&(i=!0);var o=i?a:[r],s=i?$t("%1 items","drag-num-items",o.length):t.getAttribute("data-name"),l=null,c=null;return 1===o.length&&(t.hasAttribute("data-drag-icon")?l=t.getAttribute("data-drag-icon"):c=n.query(".file-list-representation svg",t)),{icon:l,items:o,svg:c,title:s,type:"item"}}var n,r,i,o,a=null;return{messages:["file-list-selection-updated"],init:function(){n=e.getService("dom"),r=e.getService("drag-internal"),i=e.getService("fileop-movecopy"),o=e.getElement(),r.bindDrag(o,t);var a=r.bindDrops(o,function(e){return n.getNearest(e,'[data-item-type="folder"]')});a.on("item",function(e){var t=e.data.contents.items,n=e.data.target.getAttribute("data-id"),r=o.getAttribute("data-folder-typed-id");t.indexOf(n)===-1&&i.move(t,n,r)})},destroy:function(){r.unbind(o)},onmessage:function(e,t){switch(e){case"file-list-selection-updated":a=t.map(function(e){return e.id})}}}}),Box.Application.addBehavior("file-list-keys",function(e){"use strict";function t(e){return c.query('.tbl-list-item[data-id="'+e.id+'"]',l)}function n(e){return"d_"+t(e).getAttribute("data-parent-folder-id")}function r(){m.length&&u.download(m.map(function(e){return e.id}),{currentFolderTypedID:n(m[0])})}function i(){m.length&&u.movecopy(m.map(function(e){return e.id}),n(m[0]))}function o(){1===m.length&&u.share(m[0].id)}function a(){if(1===m.length){var t=m[0].id,n=e.getConfig("isSFCEnabled"),r=0===t.indexOf(f),i=0===t.indexOf(p);(r||n&&i)&&u.inviteCollab(m[0].id)}}function s(e){1===m.length&&(e.preventDefault(),u.rename(m[0].id,m[0].name))}var l,c,u,d,f="d_",p="f_",m=[];return{messages:["file-list-selection-updated"],init:function(){c=e.getService("dom"),u=e.getService("item-actions"),d=e.getService("keyboard-shortcuts"),l=c.query("tbody",e.getElement()),d.register({name:"file-list-keys",shortcuts:[{key:"shift+d",description:$t("Download selected items","kb_shortcuts_item_actions_download_selected_items"),handler:r,type:"item-actions"},{key:"shift+m",description:$t("Move selected items","kb_shortcuts_item_actions_move_copy_item"),handler:i,type:"item-actions"},{key:"shift+s",description:$t("Share selected item","kb_shortcuts_item_actions_open_shared_link_modal"),handler:o,type:"item-actions"},{key:"shift+c",description:$t("Invite collaborators to selected item","kb_shortcuts_item_actions_open_invite_collab_modal"),handler:a,type:"item-actions"},{key:"shift+r",description:$t("Rename selected item","kb_shortcuts_item_actions_open_rename_modal"),handler:s,type:"item-actions"}]},l)},onmessage:function(e,t){m=t},destroy:function(){d.deregister("file-list-keys",l)}}}),Box.Application.addBehavior("file-list-menus",function(e){"use strict";var t,n,r,i,o,a="hidden";return{messages:["item-menu-initialized","item-menu-selected"],init:function(){t=e.getService("box-edit-amsterdam"),n=e.getService("dom"),r=e.getService("item-actions"),i=e.getService("resin"),o=e.getService("uploads-main")},onmessage:function(e,t){switch(e){case"item-menu-initialized":this.handleMenuInit(t.menu,t.item);break;case"item-menu-selected":this.handleMenuSelect(t.action,t.item,t.menuData)}},onclick:function(e,t,n){"upload-menu-option"===n&&e.target instanceof HTMLInputElement&&i.recordActionFromElement(e.target,{target:"uploadnewversion",action:"click"})},onmouseover:function(e,t,n){switch(n){case"openwith":case"moreactions":i.recordActionFromElement(t,{target:n,action:"hover"})}},handleMenuInit:function(e,t){this.setupBoxEditMenuOption(e,t),this.setupUploadNewVersionOption(e,t)},handleMenuSelect:function(t,n,i){var o,a=n.typedID,s=n.parentTypedID,l=n.extension;switch(t){case"folder-embed-settings":r.folderEmbedSettings(a);break;case"share":r.share(a);break;case"invite-collab":r.inviteCollab(a);break;case"open-with":r.openWithBoxEdit(a,l);break;case"sync":r.sync(a);break;case"unsync":r.unsync(a);break;case"lock":r.lock(a);break;case"unlock":r.unlock(a);break;case"request-unlock":r.requestUnlockPopup(a);break;case"set-expiration":r.setExpiration(a);break;case"access-stats":r.showAccessStatsPopup(a);break;case"version-history":r.showVersionHistoryPopup(a);break;case"file-properties":r.fileProperties(a);break;case"rename":r.rename(a,n.name);break;case"favorite":r.addToFavorites(a);break;case"unfavorite":r.removeFromFavorites(a);break;case"removeitem":o=e.getService("collab-actions"),o.removeCurrentUserFromItem(a);break;case"editweblink":r.editWeblink(a);break;case"create-box3d-package":r.createBox3dPackage(a,n.fileVersionID,n.name,s);break;case"watermarking":r.showWatermarkingPopup(a);break;case"update-tags":r.showUpdateTagsPopup([{id:a,name:n.name,tags:n.tags}]);break;case"upload-widget":r.showUploadWidgetPopup(a,n.name);break;case"download":r.download([a]);break;case"delete":r.delete_([a],s);break;case"movecopy":r.movecopy([a],s);break;case"senditems":r.shareViaEmail([a],s);break;case"customaction":this.handleCustomAction(a,i)}},setupBoxEditMenuOption:function(e,r){"file"===r.type&&r.extension&&t.canOpenWithBoxEdit(r.extension).then(function(t){var r=n.query("[data-open-with-app=box-edit]",e.menuEl);if(r){var i=n.query(".open-with-app",r);n.setText(i,t),n.removeClass(r,a)}}).catch(function(){var t=n.query(".item-open-with-google-docs",e.menuEl);n.removeClass(t,a)})},setupUploadNewVersionOption:function(e,t){if("file"===t.type){var r=n.query(".upload-file-version-handler-target",e.menuEl),i=n.query(".upload-handler-wrapper",r);if(!i&&r){var a=o.bindFileUploadHandler(r,t.parentTypedID,t.typedID);n.addClass(a,"menu-option")}}},handleCustomAction:function(t,n){var r="true"===n.disabled;if(!r){var i=n["action-id"],o=n.url,a=e.getService("custom-actions");o?a.executeCustomAction(t,i,o,{officeOnlineAppName:n["office-online-app-name"],openTarget:n["open-target"]||"server-only",windowWidth:n.width,windowHeight:n.height}):a.launchCustomActionPopup(t,i)}}}}),Box.Application.addBehavior("file-list-realtime-events",function(e){"use strict";function t(e){return f===e.data.subscriberID}function n(e){return!!v[e.data.fileVersionID]}function r(e){v[e.data.fileVersionID]=!0}function i(e){if(!d)return null;var r=null;return e.forEach(function(e){e.data.folderID!==d||n(e)||t(e)||(r=e)}),r}function o(e){var t,n=parseInt(e.user.id,10),r=e.user.name,i=e.data.fileName,o=e.data.fileCreatedAt,a=e.data.fileModifiedAt,s=n===m,l=n===u,c=o===a;return t=c?s?$t('Someone uploaded "%1". Would you like to refresh the page?',"anonymous_uploaded_new_file_refresh",i):l?$t('"%1" was just uploaded. Would you like to refresh the page?',"you_uploaded_new_file_refresh",i):$t('%1 uploaded "%2". Would you like to refresh the page?',"box_user_uploaded_new_file_refresh",r,i):s?$t('Someone uploaded a new version of "%1". Would you like to refresh the page?',"anonymous_uploaded_new_file_version_refresh",i):l?$t('A new version of "%1" was just uploaded. Would you like to refresh the page?',"you_uploaded_new_file_version_refresh",i):$t('%1 uploaded a new version of "%2". Would you like to refresh the page?',"box_user_uploaded_new_file_version_refresh",r,i)}var a,s,l,c,u,d,f,p,m=2,h=1e4,g="is-preview-visible",v={};
return{messages:["realtimeupload"],init:function(){a=e.getService("dom"),s=e.getService("notifications-amsterdam"),l=e.getService("nav"),c=a.query("body"),u=this.getCurrentUserID(),d=this.getCurrentFolderID(),f=this.getCurrentRealtimeSubscriberID()},getCurrentUserID:function(){var t=e.getGlobalConfig();return t.userId},getCurrentFolderID:function(){var t=e.getService("file-list-manager");return t.getCurrentFolder()},getCurrentRealtimeSubscriberID:function(){var t=e.getGlobalConfig();return t.realtimeSubscriberID},isPreviewVisible:function(){return a.hasClass(c,g)},onmessage:function(e,t){this.isPreviewVisible()||"realtimeupload"===e&&this.handleRealtimeUpload(t)},handleRealtimeUpload:function(e){if(!p){var t=i(e);if(null!==t){var n=o(t);p=s.confirm(n,{buttonText:$t("Refresh","file_list_refresh_button_text"),duration:h}).then(function(){l.refresh(),p=null},function(){p=null}),r(t)}}}}}),Box.Application.addBehavior("file-list-respond-to-action-bar-resize",function(e){"use strict";function t(e){return e+"px"}function n(e){return parseInt(e,10)}function r(e){return e.getBoundingClientRect().height}var i,o,a,s,l,c,u,d,f,p,m;return{messages:["folderdescriptiondidtoggleexpanded"],init:function(){i=e.getGlobal("window").getComputedStyle,o=e.getService("dom"),a=e.getElement(),s=o.query(".action-bar-description"),l=o.query(".file-list-header",a),c=o.query(".file-list-body-wrapper",a),p=!1,m=!1,s&&l&&(u=r(s),d=l.getBoundingClientRect().top)},cacheFileListInitialMargin:function(){!m&&c&&(m=!0,f=n(i(c).getPropertyValue("margin-top")))},onmessage:function(e){"folderdescriptiondidtoggleexpanded"===e&&(p?(this.moveFileListElementsUp(),p=!1):(this.cacheFileListInitialMargin(),this.moveFileListElementsDown(),p=!0))},moveFileListElementsDown:function(){var e=r(s)-u;l.style.top=t(d+e),c.style.marginTop=t(f+e)},moveFileListElementsUp:function(){l.style.top=t(d),c.style.marginTop=t(f)}}}),Box.Application.addBehavior("file-list-selection",function(e){"use strict";function t(){return H.queryAll(".tbl-list-item",j).length}function n(e){var t=H.query('.tbl-list-item[data-id="'+e+'"]',j);if(t)return H.queryAll(".tbl-list-item",j).indexOf(t)}function r(){return le===-1}function i(){return 0===le}function o(){return le===t()-1}function a(e){for(var t=0;t<U.length;t++)U[t].checked=e}function s(){X=z.create(j,{itemSelector:Z,checkboxSelector:J,selectionClass:re}),X.on("updated",function(t){a(X.isAllSelected()),e.broadcast("file-list-selection-updated",t.data)})}function l(e,t,n){W.recordAction({feature:"itemselection",component:"filelist",target:e,action:t,data:n||{}})}function c(e){var t=ee[e.charAt(0)],n="select|"+t,r={};r[t+"_id"]=e.substr(2),l(n,"click",r)}function u(){l("unselect","click")}function d(e,t){e.getAttribute("data-item-type")===Y&&l("openfolder",t,{folder_id:e.getAttribute("data-id").substr(2)})}function f(e){H.getNearestUnbounded(e.target,".global-sidebar")||H.getNearestUnbounded(e.target,".menu")||H.getNearestUnbounded(e.target,".file-list-item-actions")||H.getNearestUnbounded(e.target,".popup-wrapper")||H.getNearest(e.target,".toggle-right-sidebar-btn")||X.isNoneSelected()||(u(),X.unselectAll())}function p(e){var t=e.target;return H.hasClass(t,Q)||(t=H.getNearest(e.target,Z)),t}function m(){var e=H.query("."+te);return e?e:null}function h(e){var t=H.query(".item-name a",e);t&&(d(e,"keypress"),t.click())}function g(){var e=H.queryAll(".tbl-list-item.file-list-selection");1===e.length&&h(e[0])}function v(){return r()?void g():void h(m())}function y(){$.scrollElementIntoView(m(),G)}function b(){var e=H.query("."+te,j);if(H.removeClass(e,te),!r()){var t=H.queryAll(".tbl-list-item",j)[le];H.addClass(t,te),t.focus(),H.queryAll("button",t).forEach(function(e){e.setAttribute("tabindex","0")}),y()}}function _(){le=-1,b()}function w(){X.unselectAll(),_()}function S(){le>0&&(le--,b())}function k(){var e=t();le<e-1&&(le++,b())}function E(){var e=m();if(e)return e.getAttribute("data-id")}function C(){X.toggle(E())}function x(){return de===ie}function T(){return de===oe}function A(e){fe&&de!==e&&(fe=!1),de=e}function I(){return!fe&&!X.isSelected(E())}function O(){var e=x()&&i(),t=T()&&o();return e||t}function D(e){fe?(e(),C()):(C(),e())}function M(){return A(oe),I()?(fe=!0,void C()):void(O()||D(k))}function P(){return A(ie),I()?(fe=!0,void C()):void(O()||D(S))}function N(e){e.preventDefault(),X.selectAll()}function R(){se=H.queryAll(".tbl-list-item .file-list-name a.item-name-link",j);for(var e=le,t=0;t<se.length;t++)if(0===se[t].textContent.trim().toLowerCase().indexOf(ce)){e=t;break}e!==le&&(le=e,b())}function F(){ce="",clearTimeout(ue)}function B(t){var n=t.target;(n===e.getGlobal("document")||!n.hasAttribute("contenteditable")&&"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName)&&0!==t.which&&(ue&&clearTimeout(ue),ce+=t.key,ue=setTimeout(function(){F()},ne),R())}function q(e){e.preventDefault();var t=H.query('[data-type="context-menu-btn"]',m());t.click()}function L(e){var t=e.target;H.hasClass(t,Q)&&!i()&&(e.preventDefault(),C(),S(),C())}var j,U,H,$,V,W,K,z,G,X,J=".file-list-select",Y="folder",Q="tbl-list-item",Z=".tbl-list-item",ee={d:Y,f:"file",l:"weblink"},te="file-list-pointer",ne=1e3,re="file-list-selection",ie="north",oe="south",ae=e.getGlobal("document"),se=[],le=-1,ce="",ue=null,de=oe,fe=!0;return{messages:["filelistcontextmenuclicked","filelistsharebtnclicked","filelistitemadded","filelistitemremoved","toggle-file-list-selection"],init:function(){H=e.getService("dom"),V=e.getService("keyboard-shortcuts"),W=e.getService("resin"),z=e.getService("item-list-selection"),$=e.getService("file-list-scroll"),K=e.getService("tooltips-amsterdam"),j=e.getElement(),U=H.queryAll(".file-list-select-all",j);var t=H.query(".file-list-header",j);if(G=0,t){var n=H.getBoundingClientRect(t);G=n.bottom}var r=H.queryAll("input[type=checkbox]",j);if(r)for(var i=0;i<r.length;i++)r[i].checked=!1;s(),V.register({name:"file-list-selection",shortcuts:[{key:"up",description:$t("Select previous item","kb_shortcuts_file_list_selection_move_focus_to_previous"),handler:function(e){e.preventDefault(),S()},type:"selection"},{key:"down",description:$t("Select next item","kb_shortcuts_file_list_selection_move_focus_to_next"),handler:function(e){e.preventDefault(),k()},type:"selection"},{key:"shift+x",description:$t("Select current item","kb_shortcuts_file_list_selection_select_item_in_focus"),handler:C,type:"selection"},{key:"shift+up",description:$t("Add previous item to current selection","kb_shortcuts_file_list_selection_select_the_item_above"),handler:P,type:"selection"},{key:"shift+down",description:$t("Add next item to current selection","kb_shortcuts_file_list_selection_select_the_item_below"),handler:M,type:"selection"},{key:["meta+a","ctrl+a"],description:$t("Select all items","kb_shortcuts_file_list_selection_select_all_items_in_current_view"),handler:N,type:"selection"},{key:"enter",description:$t("Open focused item","kb_shortcuts_item_actions_open_selected_item"),handler:v,type:"item-actions"},{key:"esc",description:$t("Deselect all items","kb_shortcuts_file_list_selection_remove_all_current_selections_and_focus"),handler:w,type:"selection"},{key:"shift+o",description:$t('Open "More Actions" menu',"kb_shortcuts_item_actions_open_more_actions_menu"),handler:q,type:"item-actions"},{key:"shift+tab",handler:L,type:"selection"}]},j),H.on(ae.body,"click",f),H.on(ae.body,"keypress",B)},destroy:function(){H.off(ae.body,"click",f),H.off(ae.body,"keypress",B),V.deregister("file-list-selection",j)},onmessage:function(e,t){switch(e){case"toggle-file-list-selection":c(t.itemTypedID),X.select(t.itemTypedID);break;case"filelistitemadded":case"filelistitemremoved":X.refresh(),K.hideAll();break;case"filelistcontextmenuclicked":case"filelistcustomactionclicked":case"filelistsharebtnclicked":c(t.itemTypedID),X.selectOnly(t.itemTypedID)}},onclick:function(e){if(e.target&&!(H.getNearest(e.target,"a")&&e.shiftKey&&X.isNoneSelected())&&(!H.getNearest(e.target,"a")||e.shiftKey)&&"BUTTON"!==e.target.nodeName&&"LABEL"!==e.target.nodeName&&"file"!==e.target.getAttribute("type")){var t=p(e);if(t){var r=t.getAttribute("data-id"),i=!1;e.ctrlKey||e.metaKey?(X.isSelected(r)?u():c(r),i=!0,X.toggle(r)):e.shiftKey?(l("select|multiple","click"),i=!0,X.selectRange(r)):(X.isSelected(r)||c(r),i=!0,X.selectOnly(r)),i&&(le=n(r),b()),e.preventDefault(),e.stopPropagation()}}},ondblclick:function(e){if(e.target&&"A"!==e.target.nodeName&&"BUTTON"!==e.target.nodeName){var t=p(e);if(t){var n=H.query(".item-name a",t);n&&(d(t,"doubleclick"),n.click())}}}}}),Box.Application.addBehavior("file-list-focus-redirect",function(e){"use strict";var t,n="tab-jump-button",r='.sidebar-tab-view [role="tablist"] button';return{init:function(){t=e.getService("dom")},onfocusin:function(e,i,o){if(o===n){var a=t.query(r);return void(a&&a.focus())}}}}),Box.Application.addBehavior("file-list-view-toggle",function(e){"use strict";function t(e){return e.replace(T,"")}function n(e){var n=t(e);return n+=n.indexOf("?")<0?"?":"&",A===k&&u&&(n+=S+"="+u),n}function r(){d||(d=m.debounce(function(){var e=n(y.pathname+y.search);h.replace(e),v.saveUserViewPreferences(A,u)},500)),d()}function i(){p.classList.contains(C.icon)&&(A=k,u=f?f.value:b)}function o(){A=A===E?k:E,i(),v.saveUserViewPreferences(A,u),e.broadcast("viewchange",A)}function a(e,t){var n;n=e<t?"increasegridviewsize":"decreasegridviewsize",g.recordAction({component:"filelist",target:n,action:"click"})}function s(e,t){if(!t||e!==t){var n=p.querySelector(".file-list-body");a(parseInt(e,10),parseInt(t,10)),n.className="file-list-body icon-resize-"+e,u=e,r()}}function l(e,t,n){if("icon-resize"===n){var r=e.target.value;s(r,u)}}function c(e){var t=parseInt(f.value,10),n=parseInt(f.getAttribute("min"),10),r=parseInt(f.getAttribute("max"),10),i=parseInt(f.getAttribute("step"),10),o=t;e===_?o=Math.max(n,t-i):e===w&&(o=Math.min(r,t+i)),f.value=o,s(o,t)}var u,d,f,p,m,h,g,v,y=e.getGlobal("location"),b=3,_="increase",w="decrease",S="viewSize",k="icon",E="list",C={icon:"is-icon-view",list:"is-list-view"},x=new RegExp("^"+y.pathname+"$"),T=new RegExp("(\\?|&*)"+S+"=(\\w*)","g"),A=E;return{init:function(){m=e.getService("function-utils"),h=e.getService("nav"),g=e.getService("resin"),v=e.getService("user-preferences"),p=e.getElement(),f=p.querySelector(".file-list-icon-size"),h.intercept(x,{enter:function(e,n){return e.url===n.url||t(e.url)!==t(n.url)},exit:function(){return!0}}),i()},destroy:function(){h.removeInterceptor(x)},onchange:l,oninput:l,onclick:function(e,t,n){switch(n){case"view-selector":o();break;case"icon-size-modifier":var r=t.getAttribute("data-resize-operation");c(r)}}}}),Box.Application.addBehavior("flyout-toggle",function(e){"use strict";function t(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===o)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===o)return t}}var n,r,i,o="flyout-toggle-button";return{init:function(){var t=e.getService("flyout-toggle");n=e.getService("dom"),r=e.getService("keyboard-shortcuts"),i=t.create(),i.init()},registerKeyboardShortcuts:function(){r.register({name:"flyout-toggle",shortcuts:[{key:"esc",handler:this.closeFlyout.bind(this)}]},i.flyoutEl)},deregisterKeyboardShortcuts:function(){r.deregister("flyout-toggle",i.flyoutEl)},destroy:function(){i.destroy(),this.deregisterKeyboardShortcuts()},onclick:function(e,t,r){r===o?(this.showFlyout(t),e.preventDefault(),e.stopPropagation()):!n.getNearest(e.target,".flyout-member")||null!==t&&t.disabled||this.closeFlyout()},onkeyup:function(e){if(32===e.keyCode){var n=t(e);return n?(this.showFlyout(n),void e.preventDefault()):void 0}},showFlyout:function(e){i.showFlyout(e),this.registerKeyboardShortcuts()},closeFlyout:function(){i.closeFlyout(),this.deregisterKeyboardShortcuts()}}}),Box.Application.addBehavior("folder-embed-settings-form",function(e){"use strict";function t(e,t,n,r,i){var o=l,a=[];e&&a.push("sortColumn="+e),n&&a.push("view="+n),t&&a.push("sortDirection="+t),r&&a.push("showItemFeedActions=false"),i&&a.push("showParentPath=false");var s=a.join("&");return s&&(o+="?"+s),o}function n(e,t,n,r){var i='<iframe src="'+e+'" width="'+n+'" height="'+r+'" frameborder="0" allowfullscreen webkitallowfullscreen msallowfullscreen></iframe>';return i}function r(){u.select(),document.execCommand("copy",!0)}function i(e){return Array.prototype.reduce.call(e.elements,function(e,t){var n=t.name;if(n){var r=t.type===h?t.checked:t.value;return e[n]=r,e}return e},{})}function o(e){Object.keys(e).forEach(function(t){var n=s.query("[name="+t+"]",f);n.value=e[t]})}function a(r){var a=r.target.form,l=i(a),c=l.size,f=p[c];c===m?s.addClass(d,"custom"):(s.removeClass(d,"custom"),l.width=f.width,l.height=f.height);var h=t(l.sortColumn,l.sortDirection,l.view,l.hideActivityFeed,l.hideFolderPath),g=n(h,l.size,l.width,l.height);u.value=g,o(l),e.broadcast("folder-embed-settings-form-change",{embedLink:h,formData:l,iframeMarkup:g})}var s,l,c,u,d,f,p={small:{width:"330",height:"400"},medium:{width:"500",height:"400"},large:{width:"800",height:"550"}},m="custom",h="checkbox";return{init:function(){s=e.getService("dom"),c=e.getElement(),l=c.getAttribute("data-embed-link").split("?")[0],f=s.query(".folder-embed-settings-form",c),u=s.query(".iframe-input",c),d=s.query(".iframe-size",c),s.on(u,"focus",r),s.on(f,"change",a)},destroy:function(){s.off(u,"focus",r),s.off(f,"change",a)}}}),Box.Application.addBehavior("form-dirty-confirm",function(e){"use strict";var t,n,r,i,o,a=$t("You have unsaved changes. Are you sure you wish to leave?","account_settings_confirm_navigation_message");return{messages:["formsubmissionsuccess","formwillnativesubmit","formreset"],init:function(){r=e.getService("dom"),i=e.getService("nav"),o=e.getService("popups-amsterdam"),t=!1,n=e.getGlobal("window"),i.registerBeforeStateChange(this.handleBeforeNavigation),r.on(n,"beforeunload",this.handleBeforeUnload)},destroy:function(){i.unregisterBeforeStateChange(this.handleBeforeNavigation),r.off(n,"beforeunload",this.handleBeforeUnload)},handleBeforeUnload:function(){if(t)return a},handleBeforeNavigation:function(e){if(t)return o.confirm(a).then(function(){t=!1},function(){e.stopNavigation()})},onchange:function(){t=!0},onmessage:function(e){"formsubmissionsuccess"!==e&&"formwillnativesubmit"!==e&&"formreset"!==e||(t=!1)}}}),Box.Application.addBehavior("form-submit-loading-state",function(e){"use strict";var t,n,r,i="is-disabled",o="is-loading";return{messages:["formsubmitdone","formsubmitstart","formvalidationfail"],init:function(){t=e.getService("dom");var i=e.getElement();n=t.query(".cancel-btn",i),r=t.query(".submit-btn",i)},onsubmit:function(){this.setLoadingState()},onmessage:function(e){switch(e){case"formsubmitstart":this.setLoadingState();break;case"formsubmitdone":case"formvalidationfail":this.removeLoadingState()}},setLoadingState:function(){t.addClass(n,i),n.disabled=!0,t.addClass(r,o),t.addClass(r,i),r.disabled=!0},removeLoadingState:function(){t.removeClass(n,i),n.disabled=!1,t.removeClass(r,o),t.removeClass(r,i),r.disabled=!1}}}),Box.Application.addBehavior("form-validation",function(e){"use strict";function t(e){if(l)l.updateContent(e),l.show();else{var t=o.query(".error-container",c);t||(t=c),l=s.error(t,e,u)}}function n(){l&&l.hide()}function r(e){return Array.prototype.reduce.call(e.elements,function(e,t){if(!t.name)return e;var n=t.name,r=t.value;return t.type!==d&&t.type!==f||t.checked?(e[n]=r,e):e},{})}function i(e){var t=Array.prototype.reduce.call(e.elements,function(e,t){return t.name&&t.validationMessage&&(e+="<li>"+t.validationMessage+"</li>"),e},"");return'<ul class="validation-messages" role="alert">'+t+"</ul>"}var o,a,s,l,c,u=$t("Oops. That didn't work.","amsterdam_form_inline_error_title"),d="checkbox",f="radio";return{messages:["formsubmissionerror"],init:function(){o=e.getService("dom"),a=e.getService("form-validator"),s=e.getService("inline-notice"),c=e.getElement(),"FORM"!==c.nodeName&&(c=o.query("form",c)),a.initForm(c)},destroy:function(){c=null,o=null,l&&l.destroy()},onchange:function(e){n();var t=e.target;a.checkValidity(t)},oninput:function(){n()},onmessage:function(e,n){var r=n.form;if("formsubmissionerror"===e&&r===c){var i=n.message;if(n.code){var s=o.query('input[name="'+n.code+'"]',c);s&&a.setCustomError(s,n.message)}setTimeout(function(){t(i)},0)}},onsubmit:function(n){if(n.preventDefault(),a.checkValidity(c)){var o=r(c);e.broadcast("formvalidationsuccess",{formData:o,form:c})}else{var s=i(c);t(s),e.broadcast("formvalidationfail",{form:c})}}}}),Box.Application.addBehavior("header-ibm-orion-app-launcher",function(e){"use strict";var t,n,r="d_0";return{init:function(){n=e.getService("logger"),t=e.getService("custom-actions")},onclick:function(e,t,n){switch(n){case"orion-app-launcher":this.launchIBMOrionApp(t)}},launchIBMOrionApp:function(e){var i=e.getAttribute("data-action-id"),o=e.getAttribute("data-custom-action-url"),a=t.extractCustomActionConfig(e);t.executeCustomAction(r,i,o,a),n.sendLog("header_ibm_orion_app_launcher","action_start",{event_name:"user_click_on_header_ibm_orion_app_launcher_icon"})}}}),Box.Application.addBehavior("header-left-nav-toggle",function(e){"use strict";var t,n,r="is-left-nav-open";return{init:function(){n=e.getService("aria"),t=e.getElement()},onclick:function(e,i,o){"toggle-left-nav"===o&&(t.classList.contains(r)?(t.classList.remove(r),n.clearState(i,"expanded")):(t.classList.add(r),n.setState(i,"expanded")))}}}),Box.Application.addBehavior("header-search",function(e){"use strict";function t(e){l.recordAction({component:"header",feature:"search",target:e,action:"click"})}function n(e){return function(t){t.preventDefault(),e.focusOnSearchEl()}}function r(e,t,n){if(!e||!t)return null;var r={};return Object.keys(e.dataset).forEach(function(t){r[t]=e.dataset[t]}),r.resinTarget=t.getAttribute("data-resin-target"),{eventType:n,searchData:r}}function i(t){var n=t.data,i=a.query(".item-name",n);i&&(e.broadcast(N,r(n,i,t.type)),d.redirect(i.href))}var o,a,s,l,c,u,d,f,p,m,h,g,v,y,b,_,w,S,k,E,C="header_quick_search",x="embed_header_quick_search",T="0",A="/folder/",I="/search",O="is-active",D="is-search-expanded",M="custom_search_time_range_popup",P="openparentfolder",N="headerquicksearchitemselected",R=!1,F=!1;return{messages:["customsearchtimerangeupdated","navigationend","navigationstart","popupclosed"],init:function(){this.initBehavior()},destroy:function(){this.destroyBehavior()},initBehavior:function(){o=e.getService("aria"),a=e.getService("dom"),l=e.getService("resin"),d=e.getService("nav"),s=e.getService("popups-amsterdam"),u=e.getService("url"),f=e.getElement(),p=a.query(".header-search",f),m=a.query(".input-wrapper input",f),h=a.query(".keywordless-wrapper",f),g=a.query('input[data-type="limit-to-folder"]'),b=a.query(".results-wrapper",f),k=a.query(".updated-time-selected",f),_=a.query('button[data-type="keywordless-toggle-btn"]'),w=a.query('input[name="updatedTimeFrom"]',f),S=a.query('input[name="updatedTimeTo"]',f),E=p.getAttribute("data-folder-id"),R="true"===p.getAttribute("data-embed-widget"),F="true"===p.getAttribute("data-async-search"),y=this.setupQuickSearch(p),c=e.getService("keyboard-shortcuts"),c.register({name:"header-search",shortcuts:[{key:"/",description:$t("Jump to search field","kb_shortcuts_header_search_focus_select_search"),handler:n(y),type:"navigation"}]},this.contextEl);var t=a.query(".owner-selector",f);v=this.setupOwnerSelector(t);var r=u.getCurrentQueryParams();r&&r.limitToFolder&&this.updateSearchScope(E)},setupQuickSearch:function(t){var n=e.getService("quick-search"),r=n.create(t,R?x:C);return r.setSearchFolderID(T),r.events.on("select",i),r.events.on("click",i),r},setupOwnerSelector:function(t){if(t){var n=e.getService("pill-selector"),r=e.getService("provider-contacts"),i=e.getService("search-filter-formatting-helper"),o=r.searchAllContacts({excludeWithoutAccount:!0,includeSelf:!0}),s=n.create(t,o,{showPlaceholderIfResultEmpty:!0}),l=a.query('input[name="owners"]',f),c=l.value,u=i.parseOwnerInputForPills(c);return s.init(u),s.on("updated",function(){var e=s.getPills();return e.length?void(l.value=i.serializeOwnerPills(e)):void(l.value="")}),s}},destroyBehavior:function(){c.deregister("quick-search",this.contextEl),y&&y.destroy(),v&&v.destroy()},toggleKeywordlessSearchOn:function(){a.addClass(_,O),a.addClass(h,O),a.removeClass(b,O),o.setState(_,"expanded"),o.show(h),y.removeSearchEventHandlers(),e.broadcast("keywordlesssearchopened")},toggleKeywordlessSearchOff:function(){a.removeClass(_,O),a.removeClass(h,O),a.addClass(b,O),o.clearState(_,"expanded"),o.hide(h),y.attachSearchEventHandlers(),y.triggerSearch()},onchange:function(e,t,n){"limit-to-folder"===n&&(t.checked?this.updateSearchScope(E):this.updateSearchScope(T))},onmessage:function(e,t){switch(e){case"navigationend":this.destroyBehavior(),this.initBehavior();break;case"popupclosed":y.attachInputEventHandlers();break;case"customsearchtimerangeupdated":w.value=t.updatedTimeFrom,S.value=t.updatedTimeTo;var n=$t("%1 - %2","keywordless_dropdown_custom_time_range_btn_text",t.updatedTimeFromText,t.updatedTimeToText);a.setText(k,n)}},onclick:function(n,i,o){switch(o){case"keywordless-toggle-btn":a.hasClass(i,O)?(this.toggleKeywordlessSearchOff(),t("hidekeywordless")):(this.toggleKeywordlessSearchOn(),t("showkeywordless")),m.focus(),n.stopPropagation(),n.preventDefault();break;case"toggle-search-btn":a.hasClass(f,D)?a.removeClass(f,D):a.addClass(f,D);break;case"custom-time-range-popup":var l=u.getCurrentQueryParams();y.removeInputEventHandlers(),s.open(M,{width:"260px",disableAutoFocus:!0,data:{updatedTimeFrom:l.updatedTimeFrom,updatedTimeTo:l.updatedTimeTo,skipNavigation:!0}});break;case"preset-time-range-option":w.value="",S.value="";break;case"header-search-form":var c=n.target,d=n.target.getAttribute("data-resin-target")===P,p=a.getNearest(n.target,".search-result-item");d||(c=a.query(".item-name",p)),e.broadcast(N,r(p,c,n.type))}},onsubmit:function(e,n,r){if("header-search-form"===r){y.reset(),m.value=m.value.trim(),t("fullsearch");var i=l.getSessionId();if(F){e.preventDefault();var o=p.action+"?"+$(p).serialize()+"&resinSessionID="+i;return void d.navigate(o)}var a=document.createElement("input");a.name="resinSessionID",a.type="hidden",a.value=i,p.appendChild(a)}},updateSearchScope:function(t){if(g){if(t===T)g.checked=!1;else{if(t!==E)return;g.checked=!0}var n=e.getService("embed-context");p.action=n.getBasePath()+A+t+I,y.setSearchFolderID(t)}}}}),Box.Application.addBehavior("header-search-instrumentation",function(e){"use strict";function t(e){return g[e]?p:v[e]?m:h}function n(e){if(!e)return null;var t=e.searchData.itemTypedId,n=1+parseInt(e.searchData.resinIndexclicked,10);if(!t||isNaN(n))return null;var r=c[t[0]],i=e.searchData.resinItemid,o=[r,i].join("_"),a=f;return"select"===e.eventType?a=u:"click"===e.eventType&&(a=d),{dataResinTarget:e.searchData.resinTarget,dataQuery:e.searchData.resinQuery,dataIndexClicked:n,dataItemTypedID:o,dataItemID:i,dataResinResultsCount:e.searchData.resinResultscount,itemType:r,userInputTrigger:a,clickTimestamp:(new Date).getTime()}}function r(e){e&&a.recordAction({component:"header",feature:"search",target:e.dataResinTarget,action:"programmatic",data:{query:e.dataQuery,indexClicked:e.dataIndexClicked,itemID:e.dataItemID,resultsCount:e.dataResinResultsCount}})}function i(n){if(n){var r=t(n.dataResinTarget);o=e.getService("logger"),o.sendLog(l,s,{interaction:r,result_num:n.dataIndexClicked,search_string:n.dataQuery,user_input_trigger:n.userInputTrigger,item_type:n.itemType,item_id:n.dataItemID,typed_id:n.dataItemTypedID,created_at:n.clickTimestamp,resin_session_id:a.getSessionId()})}}var o,a,s="SEARCH_QUICK_SEARCH_PICK_RESULT",l="search",c={f:"file",d:"folder",l:"web_link"},u="keyboard",d="click",f="unknown",p="open_link",m="parentfolder_click",h="unknown_interaction",g={openfolder:!0,openbookmark:!0,openfile:!0,openboxnote:!0},v={openparentfolder:!0};return{messages:["headerquicksearchitemselected"],init:function(){a=e.getService("resin")},onmessage:function(e,t){if("headerquicksearchitemselected"===e&&t&&t.searchData&&t.eventType){var o=n(t);i(o),r(o)}}}}),Box.Application.addBehavior("header-sidebar-toggle",function(e){"use strict";function t(){i.addClass(o,a),i.removeClass(o,s)}function n(){i.addClass(o,s),i.removeClass(o,a)}function r(e){e.matches?n():t()}var i,o,a="right-sidebar-open",s="right-sidebar-closed",l=".toggle-right-sidebar-btn";return{init:function(){var t=e.getGlobal("window"),n=t.matchMedia;if(i=e.getService("dom"),o=e.getElement(),n){var a=i.query(l,o);if(a){var s=n("(max-width: 1038px)");s.addListener(r),setTimeout(function(){r(s)},0)}}},onclick:function(e,r,s){switch(s){case"toggle-right-sidebar":i.hasClass(o,a)?n():t()}}}}),Box.Application.addBehavior("image-loader",function(e){"use strict";var t,n,r,i,o,a="data-image",s="data-image-loading",l="is-image-loaded",c="is-loading",u=e.getGlobal("Image");return{messages:["contentrefreshed","loaddeferredimage","navigationend","item-menu-initialized"],init:function(){var a=e.getGlobal("window");r=e.getElement(),t=e.getService("dom"),n=e.getService("embed-context"),o=e.getService("page-events"),i=a.requestAnimationFrame||a.webkitRequestAnimationFrame,o.getAfterPageLoadPromise().then(function(){this.loadImages()}.bind(this))},onmessage:function(e,t){switch(e){case"loaddeferredimage":var n=t.imageElement;n.hasAttribute("data-image")&&this.loadImage(n),this.loadImages(n);break;case"contentrefreshed":case"navigationend":case"item-menu-initialized":this.loadImages()}},loadImages:function(e){var n=t.queryAll("["+a+"]",e||r),o=this;n&&i(function(){var e=n.filter(function(e){return!e.offsetHeight||(o.loadImage(e),!1)});e.length&&i(function(){e.forEach(function(e){o.loadImage(e)})})})},loadImage:function(e){if(!e.getAttribute(s)){var r=e.getAttribute(a);n.isEmbedWidget()&&n.requiresAdditionalContext()&&(r=n.setAdditionalContext(r)),e.setAttribute(s,1);var i=new u(1,1);i.onload=function(){e&&("img"===e.nodeName.toLowerCase()?e.src=r:e.style.backgroundImage='url("'+r+'")',e.removeAttribute(a),e.removeAttribute(s),e.classList.add(l),t.removeClass(e,c))},i.src=r}}}}),Box.Application.addBehavior("inline-search",function(e){"use strict";function t(){return"oninput"in e.getGlobal("document").createElement("input")}var n,r,i,o,a,s,l,c="is-searching",u="inline-search-input",d=300;return{init:function(){n=e.getService("dom"),o=e.getElement(),r=n.query(".inline-search-container",o),i=n.query(".inline-search-input",r),l=t(),a=""},onclick:function(e,t,n){"inline-search-cancel-btn"===n&&this.clearSearch()},onkeyup:function(e,t,n){l||this.handleInputEvent(e,t,n)},oninput:function(e,t,n){this.handleInputEvent(e,t,n)},handleInputEvent:function(t,o,l){l===u&&(s&&clearTimeout(s),s=setTimeout(function(){var t=i.value||"";a!==t&&(a=t,t.length?e.broadcast("inlinesearchchanged",{searchString:t}):e.broadcast("inlinesearchcleared"))},d),i.value.length?n.addClass(r,c):n.removeClass(r,c))},clearSearch:function(){n.removeClass(r,c),i.value="",e.broadcast("inlinesearchcleared")}}}),Box.Application.addBehavior("item-collab-extend-access",function(e){"use strict";function t(){l.addClass(o,p)}function n(){l.removeClass(o,p)}function r(){var e=$t("There was a problem extending the expiration.","collab_extend_expiring_access_error");u.error(e)}function i(e,r){var i=!!l.query(".flyout-wrapper.is-left-positioned",o),u={collabId:e,itemTypedId:a,isLeftPositioned:i};t(),s.get(f,u).then(function(e){n(),l.setHTML(r,e.data.html)}).catch(function(){n(),c.refresh()})}var o,a,s,l,c,u,d="item_collab_extend_expiration",f="item_collabs_expiration_flyout",p="is-loading";return{init:function(){s=e.getService("ajax"),l=e.getService("dom"),c=e.getService("nav"),u=e.getService("notifications-amsterdam"),o=e.getElement(),a=o.getAttribute("data-item-typed-id")},onclick:function(e,t,n){switch(n){case"extend-access":var r=t.getAttribute("data-collab-id"),i=l.getNearest(t,".item-collab-extend-access-flyout");this.extendExpiringAccess(r,i);break;default:return}e.preventDefault(),e.stopPropagation()},extendExpiringAccess:function(e,o){var a={collabId:e};t(),s.post(d,a).then(function(t){n();var r=$t("You have extended the expiration to %1.","collab_extend_expiring_access_success",t.data.newCollabExpiration);u.info(r),i(e,o)}).catch(function(e){n(),e.data?u.error(e.data):r()})}}}),Box.Application.addBehavior("item-collab-search",function(e){"use strict";function t(e){i.setHTML(l,e)}function n(n){var i={itemTypedId:u,searchString:n};e.broadcast("itemcollabsearchstart"),r.get(f,i).then(function(n){var r=n.data;r&&(t(r.html),l.scrollTop=0),e.broadcast("itemcollabsearchend")},function(){a.error($t("An error occurred when searching for collaborators. Please try again.","unexpected_error_when_searching_collab")),e.broadcast("itemcollabsearchend")})}var r,i,o,a,s,l,c,u,d,f="item_collab_search";return{messages:["inlinesearchchanged","inlinesearchcleared","collabchanged"],init:function(){r=e.getService("ajax"),i=e.getService("dom"),o=e.getService("nav"),a=e.getService("notifications-amsterdam"),s=e.getService("tooltips-amsterdam"),c=e.getElement(),l=i.query(".tbl-body",c),u=c.getAttribute("data-item-typed-id"),d=""},onmessage:function(e,t){switch(e){case"inlinesearchchanged":this.requestSearchResultFromServer(t.searchString),d=t.searchString;break;case"inlinesearchcleared":s.hideAll(),o.refresh(),d="";break;case"collabchanged":d.length&&this.requestSearchResultFromServer(d)}},requestSearchResultFromServer:n}}),Box.Application.addBehavior("item-context-menus",function(e){"use strict";function t(e){var t={parentTypedID:l+e.getAttribute("data-parent-folder-id"),typedID:e.getAttribute("data-id"),fileVersionID:e.getAttribute("data-version-id"),type:e.getAttribute("data-item-type"),name:e.getAttribute("data-name"),tags:e.getAttribute("data-tags")};return"file"===t.type&&(t.extension=e.getAttribute("data-extension")),t}function n(e){var t={};t[e.type+"_id"]=e.typedID.substr(2),o.recordAction({component:"filelist",target:"moreoptions",action:"rightclick",data:t})}var r,i,o,a,s,l="d_",c={},u=!1;return{messages:["filelistitemadded","file-list-selection-updated"],init:function(){r=e.getService("dom"),i=e.getService("menus-raw"),o=e.getService("resin"),a=e.getElement(),s=e.getConfig("menus"),s||(s={});var t=r.queryAll("[data-id]",a);t.forEach(function(e){r.on(e,"mouseenter",this.insertMenu.bind(this,e))}.bind(this)),setTimeout(this.initializeMenus.bind(this),0)},destroy:function(){for(var e in c)c.hasOwnProperty(e)&&c[e].destroy()},initializeMenus:function(){var e=r.queryAll(".item-menu",a);e.forEach(this.setupMenu.bind(this))},onmessage:function(e,n){switch(e){case"filelistitemadded":var i=n.fileListItemEl,o=r.query(".item-menu",i),a=t(i),s=a.typedID;this.isContextMenuInitializedForItemTypedId(s)&&delete c[s],this.setupMenu(o);break;case"file-list-selection-updated":u=n.length>1}},onclick:function(e,t,n){"context-menu-btn"!==n||u||(e.preventDefault(),this.showMenuRelativeToElement(t))},insertMenu:function(e){var t=e.getAttribute("data-id");if(!c[t]){var n=s[t];if(n){n=$("<textarea>").html(n).text();var i=$(n)[0],o=r.query(".item-menu-placeholder",e);if(o){o.parentNode.replaceChild(i,o);var a=r.query(".item-menu",i);this.setupMenu(a)}}}},setupMenu:function(o){var a=r.getNearest(o,"[data-id]"),s=t(a),l=s.typedID;if(!this.isContextMenuInitializedForItemTypedId(l)){var d=c[l]=i.create(o);r.on(a,"contextmenu",function(e){u||(e.preventDefault(),e.stopImmediatePropagation(),n(s),d.show())}),d.on("selected",function(n){var r=n.data;e.broadcast("item-menu-selected",{action:r.action,item:t(a),menuData:r.data})}),d.init(),e.broadcast("item-menu-initialized",{menu:d,item:s})}},showMenuRelativeToElement:function(e){var t=r.getNearest(e,"[data-id]");this.insertMenu(t);var n=t.getAttribute("data-id"),i=r.getBoundingClientRect(e),o=c[n];o.show(i.right,i.bottom)},isContextMenuInitializedForItemTypedId:function(e){return!!c[e]}}}),Box.Application.addBehavior("left-nav-unread-notifications-badge",function(e){
"use strict";function t(e){return e>0?(r.setText(s,o.formatNumber(e)),void r.addClass(s,c)):(r.removeClass(s,c),void r.setText(s,0))}var n,r,i,o,a,s,l="notifications_page_get_unread_count",c="is-showing";return{messages:["notification-unread-count-decrement","notification-unread-count-increment","notification-unread-count-update"],init:function(){n=e.getService("ajax"),r=e.getService("dom"),i=e.getService("page-events"),o=e.getService("numbers"),a=e.getElement(),s=r.query(".nav-item.notifications .unread-badge",a),i.getAfterPageLoadPromise().then(function(){n.get(l).then(function(e){var n=e.data&&e.data.unreadCount;t(n)})})},onmessage:function(e,n){var r=parseInt(s.innerText,10)||0;switch(e){case"notification-unread-count-decrement":r--;break;case"notification-unread-count-increment":r++;break;case"notification-unread-count-update":var i=n&&n.markedAsReadCount?n.markedAsReadCount:null;i>0&&(r-=i)}t(r)}}}),Box.Application.addBehavior("list-sort",function(e){"use strict";function t(){return n.query('[data-type="list-sort-option"].is-sorting-asc, [data-type="list-sort-option"].is-sorting-desc',r)}var n,r,i="is-sorting-asc",o="is-sorting-desc";return{init:function(){n=e.getService("dom"),r=e.getElement()},onclick:function(e,r,a){if("list-sort-option"===a){var s=t();s===r?n.hasClass(r,o)?(n.removeClass(r,o),n.addClass(r,i)):(n.removeClass(r,i),n.addClass(r,o)):(n.removeClass(s,i+" "+o),n.addClass(r,o))}}}}),Box.Application.addBehavior("menu-toggle-eu",function(e){"use strict";function t(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===o)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===o)return t}}var n,r,i,o="menu-toggle-button",a="is-disabled",s={init:function(){var t=e.getService("menu-toggle-eu");n=e.getService("dom"),r=e.getService("select-menu"),i=t.create(),i.init(),n.on(document.body,"keyup",this.keyupHandler)},destroy:function(){n.off(document.body,"keyup",this.keyupHandler),i.destroy()},keyupHandler:function(e){27===e.keyCode&&s.closeMenu()},onclick:function(e,t,i){i!==o||n.hasClass(t,a)?!n.getNearest(e.target,".menu-option")||null!==t&&t.disabled||(r.isMultiSelectEvent(e.target)?r.toggleOption(n.getNearest(e.target,".menu-option")):r.isSingleSelectEvent(e.target)?(r.selectOption(n.getNearest(e.target,".menu-option")),this.closeMenu()):this.closeMenu()):(this.showMenu(t),e.preventDefault(),e.stopPropagation())},onkeyup:function(e){if(32===e.keyCode){var n=t(e);return n?(s.showMenu(n),void e.preventDefault()):void 0}},showMenu:function(e){i.showMenu(e)},closeMenu:function(){i.closeMenu()}};return s}),Box.Application.addBehavior("menu-toggle",function(e){"use strict";function t(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===i)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===i)return t}}var n,r,i="menu-toggle-button",o="is-visible",a={init:function(){var t=e.getService("menu-toggle");n=e.getService("dom"),r=t.create(),r.init(),n.on(document.body,"keyup",this.keyupHandler)},destroy:function(){n.off(document.body,"keyup",this.keyupHandler),r.destroy()},keyupHandler:function(e){27===e.keyCode&&a.closeMenu()},onclick:function(e,t,r){r===i?(this.showMenu(t),e.preventDefault(),e.stopPropagation()):!n.getNearest(e.target,".menu-option")||null!==t&&t.disabled||this.closeMenu()},onkeyup:function(e){if(32===e.keyCode){var r=t(e);if(r)return a.showMenu(r),void e.preventDefault();var i=(e.target||e.srcElement).parentNode;do{if("MENU"===i.nodeName){e.stopPropagation();var s=n.getNearest(i,".menu-wrapper");return n.removeClass(s,o),void setTimeout(a.closeMenu,100)}i=i.parentNode}while(i&&i!==document.body)}},showMenu:function(e){r.showMenu(e)},closeMenu:function(){r.closeMenu()}};return a}),Box.Application.addBehavior("metadata-editor-tabs",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f,p,m,h,g,v="custom_metadata_add_attribute_popup",y="custom_metadata_remove_attribute",b="metadata_add_template",_="metadata_remove_template",w="metadata_instance_limit_exceeded",S="hidden",k="is-disabled",E="is-selected",C=$t("Remove Metadata Template","metadata_remove_template_confirm_title"),x=$t("Are you sure you want to delete this metadata template and all of its values?","metadata_remove_template_confirm_message"),T=$t("Remove Metadata Attribute","custom_metadata_remove_attribute_confirm_title"),A=$t("Are you sure you want to delete this attribute and its value?","custom_metadata_remove_attribute_confirm_message");return{messages:["custommetadatafieldadded"],init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getService("notifications-amsterdam"),i=e.getService("popups-amsterdam"),o=e.getService("resin"),a=e.getService("tabview"),s=e.getService("tooltips-amsterdam");var v=e.getElement(),y=n.query(".tab-view",v);if(y){l=n.query(".form-buttons",v);var b=n.query(".metadata-add-template-menu-wrapper",v);c=n.query(".menu",b),u=n.query('[data-type="menu-toggle-button"]',b),d=n.query(".tabs",y),f=n.query(".tab-spacer",y),p=n.query(".tab-panels",y),m=n.query(".tabview-empty-state",y);var _=v.offsetHeight-80;c.style.maxHeight=_+"px",h=e.getConfig("itemTypedID"),g=a.create(y),g.init(),g.on("tabclose",this.tabcloseHandler.bind(this))}},destroy:function(){g&&g.destroy()},tabcloseHandler:function(e){i.confirm(x,C).then(this.removeTemplate.bind(this,e.data.tab))},onclick:function(e,t,n){switch(n){case"metadata-template":e.preventDefault();var r=t.getAttribute("data-key"),o=t.getAttribute("data-scope");this.addTemplate(r,o);break;case"add-attribute":e.preventDefault(),i.open(v,{data:{itemTypedID:h}});break;case"remove-attribute":e.preventDefault();var a=t.getAttribute("data-field-key");i.confirm(A,T).then(function(){this.removeCustomAttribute(a)}.bind(this))}},onmessage:function(e,t){if("custommetadatafieldadded"===e){var r=n.query('[data-tab-name="properties"]',p),i=t.fieldEl;r.insertBefore(i,r.lastChild);var o=n.query("input",i);o.focus()}},resetMenuEmptyState:function(){var e=n.queryAll(".menu-option:not(."+S+")",c);e.length?(n.removeClass(u,k),u.removeAttribute("data-tooltip")):(n.addClass(u,k),u.setAttribute("data-tooltip",""))},addTemplate:function(i,o){var a={itemTypedID:h,metadataTemplateTypeKey:i,metadataTemplateScope:o,shouldFetchHTML:!0};t.post(b,a).then(function(t){this.addTemplateTab(t.data.html),e.broadcast("metadatatemplateadded",{templateKey:i}),g.goToTab(i);var r=n.queryAll('[data-key="'+i+'"]',c);r.forEach(function(e){n.addClass(e,S)}),this.resetMenuEmptyState(),this.resetFormButtonsState()}.bind(this),function(e){e.data&&e.data.code===w?r.error(e.data.message):r.error($t("There was a problem adding the metadata template to this item. Please try again or refresh the page.","metadata_add_template_error_notification"))})},addTemplateTab:function(e){var t=n.createFragmentFromHtml(e),r=t.querySelector(".tab"),i=t.querySelector(".tab-panel");d.insertBefore(r,f),p.appendChild(i),g.reInit()},removeTemplate:function(i){var a={itemTypedID:h,metadataTemplateTypeKey:i};o.recordAction({component:"metadatapane",feature:"editmetadata",target:"confirmremoval",action:"click"}),t.post(_,a).then(function(){s.hideAll(),g.closeTab(i);var t=n.queryAll('[data-key="'+i+'"]',c);t.forEach(function(e){n.removeClass(e,S)}),this.resetMenuEmptyState(),this.resetFormButtonsState(),e.broadcast("metadatatemplateremoved",{templateKey:i})}.bind(this),function(){r.error($t("There was a problem removing the metadata template from this item. Please try again or refresh the page.","metadata_remove_template_error_notification"))})},removeCustomAttribute:function(e){var i={itemTypedID:h,key:e};t.post(y,i).then(function(){var t=n.query('input[data-field-key="'+e+'"]',p),i=n.getNearest(t,".metadata-field");n.remove(i),r.info($t("The attribute was removed successfully.","custom_metadata_remove_attribute_success_notification"))},function(){r.error($t("There was a problem removing the attribute from this item. Please try again or refresh the page.","custom_metadata_remove_attribute_error_notification"))})},resetFormButtonsState:function(){n.hasClass(m,E)?n.addClass(l,S):n.removeClass(l,S)}}}),Box.Application.addBehavior("metadata-field-editor",function(e){"use strict";function t(){s.addClass(v,C),s.addClass(v,E),v.disabled=!0,s.addClass(y,E)}function n(){s.removeClass(v,C),s.removeClass(v,E),v.disabled=!1,s.removeClass(y,E)}function r(e,t){if(!e)return"";switch(t){case"integer":return parseInt(e,10);case"float":return parseFloat(e);default:return e}}function i(e,t){p.recordAction({component:"metadatapane",feature:"editmetadata",target:e,action:t})}var o,a,s,l,c,u,d,f,p,m,h,g,v,y,b,_,w,S,k="metadata_edit_template",E="is-disabled",C="is-loading",x=$t("At least one value is invalid. Please check all changed templates and try again.","metadata_invalid_form_error"),T=[];return{messages:["metadatatemplateadded","metadatatemplateremoved"],init:function(){o=e.getService("ajax"),a=e.getService("datepicker"),s=e.getService("dom"),l=e.getService("form-validator"),c=e.getService("inline-notice"),u=e.getService("metadata-store"),d=e.getService("nav"),f=e.getService("notifications-amsterdam"),p=e.getService("resin"),m=e.getService("tooltips-amsterdam"),h=e.getElement(),g=s.query("form",h),v=s.query(".save-btn",g),y=s.query(".cancel-btn",g),_=e.getConfig("itemTypedID"),b=_.substr(2),S=u.create(),this.initDatepickers(h),l.initForm(g)},initDatepickers:function(e){var t=s.queryAll(".datepicker",e);t.forEach(function(e){var t=a.create(e);T.push(t),t.on("change",function(t){var n=t.data.formattedValue;if(n){var r=new Date(parseInt(n,10));n=r.toISOString()}this.handleChangeEvent(n,e),i("editdatevalue","click")}.bind(this))},this)},destroy:function(){T.forEach(function(e){e.destroy()})},oninput:function(){this.hideFormError()},onchange:function(e,t,n){if("metadata-field"===n){var r=t.value.trim();t instanceof HTMLSelectElement&&t.options[t.selectedIndex].hasAttribute("data-null-value")&&(r=""),this.handleChangeEvent(r,t)}},handleChangeEvent:function(e,t){if(!l.checkValidity(t))return void this.showFormError(x);var n=s.getNearest(t,".tab-panel"),i=n.getAttribute("data-tab-name"),o=t.getAttribute("data-field-key"),a=t.getAttribute("data-field-type"),c=r(e,a),u=t.getAttribute("data-initial-value"),d=r(u,a);this.hideFormError(),S.storeField(i,o,c,d)},handleTemplateRemoved:function(t){S.removeTemplate(t),S.isEmpty()&&e.broadcast("formreset"),l.checkValidity(g)&&this.hideFormError()},onmessage:function(e,t){switch(e){case"metadatatemplateadded":var n=s.query('.tab-panel[data-tab-name="'+t.templateKey+'"]',g);this.initDatepickers(n);break;case"metadatatemplateremoved":this.handleTemplateRemoved(t.templateKey)}},onsubmit:function(e){e.preventDefault(),l.checkValidity(g)?(this.hideFormError(),this.sendEditRequest()):(this.showFormError(x),i("validationsaveerror","click"))},sendEditRequest:function(){var r={itemTypedID:_,templatePatches:S.getTemplatePatches()};t(),o.post(k,r).then(function(){f.info($t("All changes were saved successfully.","metadata_edit_template_success_notification")),e.broadcast("formsubmissionsuccess");var t="/file/"+b;d.navigate(t)},function(){this.showFormError($t("There was a problem editing one or more metadata templates for this item. Please refresh the page.","metadata_edit_template_error_notification")),n()}.bind(this))},showFormError:function(e){w?(w.updateContent(e),w.show()):w=c.error(g,e)},hideFormError:function(){w&&(m.hideAll(),w.hide())}}}),Box.Application.addBehavior("metadata-readonly-tabs",function(e){"use strict";var t,n,r,i,o,a="properties",s=".metadata-tabs",l="metadata_add_template";return{messages:["sidebartabchange"],init:function(){t=e.getService("ajax");var a=e.getService("dom");n=e.getService("nav"),r=e.getService("notifications-amsterdam");var l=e.getService("tabview"),c=e.getElement(),u=a.query(s,c);i=e.getConfig("itemTypedID"),u&&(o=l.create(u),a.isVisible(u)&&o.init())},onmessage:function(e,t){"sidebartabchange"===e&&"sidebar-details"===t.tabName&&o&&!o.isInit&&o.init()},destroy:function(){o&&o.destroy()},onclick:function(e,t,n){if("metadata-template"===n){var r=t.getAttribute("data-key"),i=t.getAttribute("data-scope");this.addTemplate(r,i),e.preventDefault()}},addTemplate:function(e,o){var s={itemTypedID:i,metadataTemplateTypeKey:e,metadataTemplateScope:o};t.post(l,s).then(function(){var t="/file/"+encodeURIComponent(i.substr(2))+"?sidebar=metadata";e===a&&(t+="&tab=properties"),n.navigate(t)},function(){r.error($t("There was a problem adding the metadata template to this item. Please try again or refresh the page.","metadata_add_template_error_notification"))})}}}),Box.Application.addBehavior("notifications-page-invite",function(e){"use strict";var t,n,r,i,o,a="is-loading",s="notifications_page_collaboration_invite_accept";return{init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getService("nav"),i=e.getService("notifications-amsterdam"),o=e.getService("popups-amsterdam")},onclick:function(e,t,r){if(t&&r){var i=n.getNearest(t,".notifications-item");switch(r){case"accept-btn":this.sendCollabInviteResponse(i,!0);break;case"reject-btn":o.confirm($t("Are you sure you want to reject this collaboration invite? The item will no longer be available.","reject_collab_invite_popup"),$t("Reject Invite","reject_collab_invite_popup_header")).then(function(){this.sendCollabInviteResponse(i,!1)}.bind(this));break;default:return}e.preventDefault()}},sendCollabInviteResponse:function(l,c){var u=n.query(".notification-body-controls",l);n.addClass(u,a);var d=n.query(".notification-body-details",l),f=d.getAttribute("data-collab-id"),p=d.getAttribute("data-tos-id"),m=d.getAttribute("data-ent-id");t.post(s,{accept:c,collabId:f,tosId:p,entId:m}).then(function(){return n.removeClass(u,a),c?void o.confirm($t('You are now collaborating on "%1". Would you like to go there now?',"collaboration_accepted_popup_message",d.getAttribute("data-folder-name")),$t("Collaboration Accepted","collaboration_accepted_popup_header"),{confirmText:$t("Yes","collaboration_accepted_popup_confirm"),cancelText:$t("No","collaboration_accepted_popup_cancel")}).then(function(){r.redirect(d.getAttribute("data-folder-url"))}).catch(function(){e.broadcast("notificationlistupdate",{notificationEl:l})}):(i.info($t("Collaboration Declined.","collaboration_declined_popup_header")),void e.broadcast("notificationlistupdate",{notificationEl:l}))}).catch(function(e){n.removeClass(u,a);var t=e&&e.data&&e.data.message;if(!t)return t=$t("There was a problem updating the collaboration invite. Please try again or refresh the page.","notification_invite_error"),void i.error(t);switch(e.data.code){case"strongPasswordRequired":i.error(t,{buttonText:$t("Change Password","update_password_notification_button_text")}).then(function(){r.redirect("/settings/change_password?collab_id="+f.substring(2))}).catch(function(){});break;default:return void i.error(t)}})}}}),Box.Application.addBehavior("notifications-page-sent-task",function(e){"use strict";var t,n,r,i,o="is-loading",a="notifications_page_remind_task_assignee",s="notifications_page_delete_task_assignment";return{init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getService("notifications-amsterdam"),i=e.getService("popups-amsterdam")},onclick:function(e,t,r){if(t&&r){var o=n.getNearest(t,".notifications-item");switch(r){case"remind-btn":this.sendTaskAssignmentReminder(o);break;case"cancel-btn":var a=this;i.confirm($t("Are you sure you want to cancel this task assignment? The assignee will be removed from the task.","cancel_task_assignment_popup"),$t("Cancel Assignment","cancel_task_assignment_popup_header")).then(function(){a.cancelTaskAssignment(o)});break;default:return}e.preventDefault()}},sendTaskAssignmentReminder:function(e){var i=n.query(".notification-body-controls",e);n.addClass(i,o);var s=n.query(".notification-body-details",e);t.post(a,{taskAssignmentID:s.getAttribute("data-task-assignment-id"),origin:"notifications"}).then(function(){n.removeClass(i,o);var e=s.getAttribute("data-reminder-email");r.info($t('A reminder email has been sent to "%1".',"notification_send_task_reminder_success",e))},function(e){n.removeClass(i,o);var t=e.data.message||$t("There was a problem sending an email reminder about the task. Please try again or refresh the page.","notification_send_task_reminder_error");r.error(t)})},cancelTaskAssignment:function(i){var a=n.query(".notification-body-controls",i);n.addClass(a,o);var l=n.query(".notification-body-details",i);t.post(s,{taskAssignmentId:l.getAttribute("data-task-assignment-id")}).then(function(){r.info($t("Task assignment cancelled.","notification_cancel_task_assignment_success")),n.removeClass(a,o),e.broadcast("notificationlistupdate",{notificationEl:i})},function(){n.removeClass(a,o),r.error($t("There was a problem cancelling the task assignment. Please try again or refresh the page.","notification_cancel_task_assignment_error"))})}}}),Box.Application.addBehavior("notifications-page-task",function(e){"use strict";var t,n,r,i,o="is-loading",a="box_tasks_complete_task_assignment",s="activity_feed_task_assignment_post";return{init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getService("notifications-amsterdam"),i=e.getService("popups-amsterdam")},onclick:function(e,t,r){if(t&&r){var o=n.getNearest(t,".notifications-item");switch(r){case"complete-btn":this.completeTask(o);break;case"decline-btn":var a=this;i.confirm($t("Are you sure you want to decline this task? You will no longer be assigned to the task.","decline_task_assignment_popup"),$t("Decline Task","decline_task_assignment_popup_header")).then(function(){a.declineTask(o)});break;default:return}e.preventDefault()}},completeTask:function(i){var s=n.query(".notification-body-controls",i);n.addClass(s,o);var l=n.query(".notification-body-details",i);t.post(a,{task_assignment_id:l.getAttribute("data-task-assignment-id"),complete:"complete",origin:"notifications"}).then(function(){r.info($t("Task assignment completed.","notification_complete_task_success")),n.removeClass(s,o),e.broadcast("notificationlistupdate",{notificationEl:i})},function(){n.removeClass(s,o),r.error($t("There was a problem completing the task. Please try again or refresh the page.","notification_complete_task_error"))})},declineTask:function(i){var a=n.query(".notification-body-controls",i);n.addClass(a,o);var l=n.query(".notification-body-details",i);t.post(s,{taskAssignmentId:l.getAttribute("data-task-assignment-id"),status:"decline"}).then(function(){r.info($t("Task assignment declined.","notification_decline_task_success")),n.removeClass(a,o),e.broadcast("notificationlistupdate",{notificationEl:i})},function(){n.removeClass(a,o),r.error($t("There was a problem declining the task. Please try again or refresh the page.","notification_decline_task_error"))})}}}),Box.Application.addBehavior("overflow-scroll-detection",function(e){"use strict";var t,n,r,i,o="is-scrolling";return{messages:["navigationend"],init:function(){t=e.getService("dom"),n=e.getService("page-scroll"),r=e.getGlobal("window"),i=e.getElement(),this.updateIsScrollingStatus=this.updateIsScrollingStatus.bind(this),this.updateIsScrollingStatus(),r.addEventListener("resize",this.updateIsScrollingStatus),r.addEventListener("scroll",this.updateIsScrollingStatus)},onmessage:function(e){switch(e){case"navigationend":this.updateIsScrollingStatus()}},destroy:function(){r.removeEventListener("scroll",this.updateIsScrollingStatus),r.removeEventListener("resize",this.updateIsScrollingStatus)},updateIsScrollingStatus:function(){n.isScrolling()?t.addClass(i,o):t.removeClass(i,o)}}}),Box.Application.addBehavior("permissions-matrix-flyout",function(e){"use strict";var t,n,r="is-active",i=".permissions-matrix-flyout";return{init:function(){t=e.getService("dom");var r=e.getElement();n=t.query(i,r)},onclick:function(e,t,n){switch(n){case"permissions-matrix-toggle-btn":e.preventDefault(),this.togglePermissionsMatrixFlyout();break;case"permissions-dropdown":break;default:this.hidePermissionsMatrixFlyout()}},onchange:function(e,t,n){"permissions-dropdown"===n&&this.hidePermissionsMatrixFlyout()},togglePermissionsMatrixFlyout:function(){n.classList.toggle(r)},hidePermissionsMatrixFlyout:function(){t.removeClass(n,r)}}}),Box.Application.addBehavior("extend-retention",function(e){"use strict";var t,n,r="extend_retention_expiration_popup";return{init:function(){t=e.getConfig("itemTypedID"),n=e.getService("popups-amsterdam")},onclick:function(e,i,o){if(i&&o)switch(e.preventDefault(),o){case"extend-retention":case"extend-retention-file-properties":n.close({unsafeSkipRefresh:!0}),n.open(r,{data:{resinName:"extendretention",itemTypedID:t,fromFilePropertiesPopup:"extend-retention-file-properties"===o}})}}}}),Box.Application.addBehavior("preview-watermarked-download",function(e){"use strict";function t(){return e.getGlobalConfig("sharedName")}var n,r;return{messages:["requestedwatermarkeddownload"],init:function(){n=e.getService("fileop-download"),r=e.getGlobalConfig("isSharedFolderPage")},onmessage:function(e,n){if("requestedwatermarkeddownload"===e&&n.typedID)return r?void this.downloadFileFromSharedLink(n.typedID.slice(2),t()):void this.downloadFile(n.typedID.slice(2))},downloadFile:function(e){n.downloadViaGet("/index.php?rm=preview_download_watermarked_rep&fileId="+e)},downloadFileFromSharedLink:function(e,t){n.downloadViaGet("/index.php?rm=preview_download_watermarked_rep_shared&sharedName="+t+"&fileId="+e)}}}),Box.Application.addBehavior("preview-adv-header-item-menu",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u="hidden";return{messages:["favoritesuccess","unfavoritesuccess","filelockedsuccess","fileunlockedsuccess","filealreadylocked","filealreadyunlocked","item-name-change","sharedlinkremoved"],init:function(){t=e.getService("dom"),n=e.getService("item-actions"),r=e.getService("resin"),i=e.getService("uploads-main"),c=e.getConfig("fileName"),o=e.getElement(),a=t.query('[data-type="favorite"]',o),s=t.query('[data-type="unfavorite"]',o),l=t.query(".upload-file-version-handler-target",o),this.setMenuHeight(),l&&this.initializeUploadButton()},setMenuHeight:function(){var n=t.query(".item-menu",o),r=e.getGlobal("window");n.style.maxHeight=r.innerHeight-o.offsetHeight+"px"},initializeUploadButton:function(){var n=e.getConfig("typedID"),r=e.getConfig("parentTypedID"),o=i.bindFileUploadHandler(l,r,n);t.addClass(o,"menu-option")},requestPreviewHeaderUpdate:function(t){var n=t.substr(2);e.broadcast("previewheaderupdate",{fileID:n})},onclick:function(t,i,o){if(i&&o&&!i.disabled){var a=e.getConfig("typedID"),s=e.getConfig("parentTypedID");switch(o){case"movecopy":t.preventDefault(),n.movecopy([a],s);break;case"rename":t.preventDefault(),n.rename(a,c);break;case"lock":t.preventDefault(),n.lock(a);break;case"unlock":t.preventDefault(),n.unlock(a);break;case"favorite":t.preventDefault(),n.addToFavorites(a);break;case"unfavorite":t.preventDefault(),n.removeFromFavorites(a);break;case"version-history":t.preventDefault(),n.showVersionHistoryPopup(a);break;case"print-btn":t.preventDefault(),e.broadcast("previewprintrequested");break;case"upload-new-version-btn":if(!(t.target instanceof HTMLInputElement))return;r.recordActionFromElement(i,{target:"uploadnewversion",action:"click"});break;case"file-properties":n.fileProperties(a)}}},setOriginalFileName:function(e){c=e},onmessage:function(n,r){var i=e.getConfig("typedID");switch(n){case"item-name-change":this.setOriginalFileName(r.name);break;case"favoritesuccess":i===r.itemTypedId&&(t.removeClass(s,u),t.addClass(a,u));break;case"unfavoritesuccess":i===r.itemTypedId&&(t.addClass(s,u),t.removeClass(a,u));break;case"filelockedsuccess":case"fileunlockedsuccess":case"filealreadylocked":case"filealreadyunlocked":case"sharedlinkremoved":i===r.itemTypedId&&this.requestPreviewHeaderUpdate(i)}}}}),Box.Application.addBehavior("preview-realtime-events",function(e){"use strict";var t,n,r,i,o,a,s,l="is-preview-visible",c=-1;return{messages:["previewchanged","previewcloserequested","previewsdkfileloaded","realtimeupload"],init:function(){t=e.getService("dom"),n=e.getService("notifications-amsterdam"),r=e.getService("nav"),i=t.query("body"),o=null,a=null},isPreviewVisible:function(){return i.classList.contains(l)},onmessage:function(e,t){if(this.isPreviewVisible())switch(e){case"previewchanged":this.setPreviewContext(t);break;case"previewcloserequested":this.clearNotification(t);break;case"previewsdkfileloaded":this.setFileData(t);break;case"realtimeupload":this.handleRealtimeUpload(t)}},setPreviewContext:function(e){a=null,o=e},setFileData:function(e){o&&o.fileID===e.fileID&&(a=e)},handleRealtimeUpload:function(e){if(a&&o){var t=null;e.forEach(function(e){e.data.fileID===o.fileID&&(t=e)}),t&&t.data&&t.data.fileVersionID&&t.data.fileVersionID!==a.fileVersionID&&(s||(s=n.confirm($t("A new version of this file is available. Would you like to refresh the page?","preview_new_version_available_message"),{buttonText:$t("Refresh","preview_refresh_button_text"),duration:c}).then(function(){r.reload(),s=null},function(){s=null})))}},clearNotification:function(){n.hideAll()}}}),Box.Application.addBehavior("readonly-select",function(){"use strict";return{onclick:function(e){"INPUT"===e.target.tagName&&e.target.hasAttribute("readonly")&&(e.target.focus(),e.target.select())}}}),Box.Application.addBehavior("resin-target-toggle",function(e){"use strict";var t,n="INPUT",r="checkbox";return{init:function(){t=e.getService("dom")},onclick:function(e){if(e.target){var i=t.getNearest(e.target,"[data-toggle-resin-target]");if(i)return e.target.nodeName===n&&e.target.type===r?void setTimeout(function(){this.toggleResinTarget(i)}.bind(this),0):void this.toggleResinTarget(i)}},toggleResinTarget:function(e){var t=e.getAttribute("data-resin-target"),n=e.getAttribute("data-toggle-resin-target");e.setAttribute("data-resin-target",n),e.setAttribute("data-toggle-resin-target",t)}}}),Box.Application.addBehavior("resizable-columns",function(e){"use strict";function t(e,t){e.style.width=t+"%",e.style.WebkitFlexBasis=t+"%",e.style.flexBasis=t+"%"}function n(e,t){return e<t+m&&e>t-m}var r,i,o,a,s,l,c="is-resize-active",u="data-col-id",d="data-resizable-column-name",f="item-resize-handle",p="resize-handle",m=.001;return{init:function(){r=e.getService("dom"),i=e.getService("resin"),o=e.getService("user-preferences"),a=e.getElement(),s=r.query("body");var t=e.getGlobal("window");l=t.requestAnimationFrame||t.webkitRequestAnimationFrame},onmousedown:function(e,t,n){n===p&&(this.resinRecordAction(t.getAttribute("data-col-id")),this.resizeColumns(e.clientX,t))},resinRecordAction:function(e){var t={};"file-list-name"===e?t.name_updated="":"file-list-updated"===e&&(t.updated_size=""),i.recordAction({component:"filelist",target:"resizecolumn",action:"click",data:t})},resizeColumns:function(e,i){function o(){C&&l(o);var r=(_+x-e)/S*100,i=k-r;if(!(r<0||i<0)){t(m,r),t(h,i);var a=m.getBoundingClientRect().width/S*100,s=h.getBoundingClientRect().width/S*100;n(r,a)&&n(i,s)?(b.forEach(function(e){t(e.previousElementSibling,r),t(e.nextElementSibling,i)}),T=r,A=i):(t(m,T),t(h,A))}}function d(e){x=e.clientX}function p(){s.style.cursor=E,r.removeClass(b,c),C=!1,I.saveColumnWidths(),r.off(s,"mousemove",d),r.off(s,"mouseup",p)}var m=i.previousElementSibling,h=i.nextElementSibling,g=i.parentNode,v=i.getAttribute(u),y="."+f+"["+u+'="'+v+'"]',b=r.queryAll(y,a),_=m.getBoundingClientRect().width,w=h.getBoundingClientRect().width,S=g.getBoundingClientRect().width,k=(_+w)/S*100,E=s.style.cursor,C=!0,x=e,T=_/S*100,A=k-T,I=this;s.style.cursor="col-resize",r.addClass(b,c),l(o),r.on(s,"mousemove",d),r.on(s,"mouseup",p)},saveColumnWidths:function(){var e="["+d+"]",t=r.queryAll(e,a),n=!1,i={};t.forEach(function(e){var t=e.getAttribute(d),r=e.style.width;if(r){var o=parseFloat(r);i[t]=o,n=!0}}),n&&o.saveUserColumnWidths(i)}}}),Box.Application.addBehavior("search-metadata",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u="get_search_metadata_templates",d="get_search_metadata_filters";return{messages:["keywordlesssearchopened"],init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getService("react-components"),i=e.getService("react-component-renderer"),o=e.getElement(),a=e.getConfig("templates"),s=e.getConfig("filterState"),o.classList.contains("file-list-filters")&&this.initSearchMetadata("SearchMetadataFilterUI")},destroy:function(){this.destroySearchMetadata()},onmessage:function(e){"keywordlesssearchopened"===e&&this.initSearchMetadata("SearchMetadataUI")},initSearchMetadata:function(e){var t=n.query(".search-metadata-mount-node",o);if(l!==t){l&&this.destroySearchMetadata(),l=t;var u=r.getComponent(e);c=i.create(u,l),a&&s?c.setProps({templates:a,filterState:s,handleTemplateChange:this.handleTemplateChange,numFiltersSet:s.initialFilterMap?Object.keys(s.initialFilterMap).length:0}):(c.setProps({handleTemplateChange:this.handleTemplateChange}),this.getMetadataTemplates())}},destroySearchMetadata:function(){c&&c.unmount()},getMetadataTemplates:function(){t.get(u).then(function(e){e.data&&(a=e.data.templates,c.setProps({templates:e.data.templates}))})},handleTemplateChange:function(e){var n=null;return a&&e&&(n=a.find(function(t){return t.typeKey===e})),n?void t.get(d,{typeKey:e,scope:n.scope}).then(function(e){var t=e.data.filters;t.fields&&t.fields.forEach(function(e){e.id=e.key,delete e.key}),c.setProps({filterState:t})}):void c.setProps({filterState:{}})}}}),Box.Application.addBehavior("search-page-excerpts",function(e){"use strict";var t;return{init:function(){t=e.getService("search-excerpts");var n=e.getConfig("excerpts");t.setForCurrentPage(n)},destroy:function(){t.clear()}}}),Box.Application.addBehavior("search-instrumentation",function(e){"use strict";var t,n,r,i,o=e.getElement(),a="SEARCH_RESULT_CLICK",s="search",l="search",c="item-name-link",u="crumb-holder";return{messages:["filelistitemclicked","filelistsharebtnclicked","filelistcontextmenuclicked"],init:function(){n=e.getService("dom"),r=e.getService("logger"),t=0,i=o.getAttribute("data-page")===l},getInteractionTypeForElement:function(e){return n.hasClass(n.getNearest(e,"a"),c)?"open_link":n.hasClass(n.getNearest(e,"span"),u)?"breadcrumb_click":void 0},onmessage:function(e,t){if(i){var r=function(){return"filelistcontextmenuclicked"===e?"context_menu_click":"filelistsharebtnclicked"===e?"share_button_click":this.getInteractionTypeForElement(t.targetEl)}.call(this);if(r){var o=n.getNearest(t.targetEl,"li"),a=o.getAttribute("data-id"),s=+new Date,l=o.parentNode.children,c=1+Array.prototype.indexOf.call(l,o);this.sendLogEvent(r,a,s,c)}}},sendLogEvent:function(n,i,o,l){var c=e.getConfig("searchParams"),u=parseInt(i.substr(2),10),d={f:"file",d:"folder",l:"web_link"}[i[0]],f=[d,u].join("_"),p={interaction:n,click_num:++t,result_num:l,typed_id:f,item_type:d,item_id:u,created_at:o,resin_session_id:c.resinSessionID,total_results:e.getConfig("resultCount"),page_num:c.pageNumber,page_size:c.pageSize,search_string:c.query,sort_type:c.sortColumn,sort_direction:c.sortDirection};r.sendLog(s,a,p)}}}),Box.Application.addBehavior("share-access-menu-amsterdam",function(e){"use strict";function t(t){var n=a.getGcmCompatibleRm(c),i={itemTypedId:s,accessLevel:t};e.broadcast("sharedlinkchangeinitiated",{itemTypedId:s,context:l}),r.post(n,i).then(function(){e.broadcast("sharedlinkchanged",{newAccessLevel:t,itemTypedId:s,context:l})},function(){e.broadcast("sharedlinkchangeerror",{itemTypedId:s,context:l})})}function n(){var t=a.getGcmCompatibleRm(u),n={itemTypedId:s};e.broadcast("sharedlinkchangeinitiated",{itemTypedId:s,context:l}),r.post(t,n).then(function(){e.broadcast("sharedlinkremoved",{itemTypedId:s,context:l})},function(){e.broadcast("sharedlinkchangeerror",{itemTypedId:s,context:l})})}var r,i,o,a,s,l,c="share_change_access_level",u="share_remove_link",d="0",f="1",p="2",m="remove";return{init:function(){r=e.getService("ajax"),i=e.getService("dom"),o=e.getService("popups-amsterdam"),
a=e.getService("url");var t=e.getElement();s=t.getAttribute("data-item-typed-id"),e.getConfig()&&(l=e.getConfig().context)},onclick:function(e,t,n){var r;switch(n){case"share-access-menu-option":if(!i.hasClass(t,"is-selected"))switch(r=t.getAttribute("data-access-id")){case d:case f:case p:this.changeAccessLevel(r);break;case m:this.showRemoveSharedLinkPopup()}break;default:return}e.preventDefault(),e.stopPropagation()},changeAccessLevel:t,showRemoveSharedLinkPopup:function(){o.confirm($t("This will permanently remove the shared link. If this item is embedded on other sites it will also become inaccessible. Any custom properties, settings and expirations will be removed as well. Do you want to continue?","share_access_menu_remove_link_message"),$t("Remove Share Link","share_access_menu_remove_popup_title")).then(n)}}}),Box.Application.addBehavior("sidebar-description-change",function(e){"use strict";var t,n,r,i,o,a,s;return{messages:["folderdescriptionsetsuccess","filedescriptionsetsuccess","linkdescriptionsetsuccess"],init:function(){t=e.getService("dom"),n=e.getService("item-actions"),r=e.getElement(),o=e.getConfig("itemTypedID"),a=r.getAttribute("data-folder-typed-id"),i=t.query(".description-textarea",r),i&&(s=i.value,t.on(i,"blur",this.setDescription))},destroy:function(){t.off(i,"blur",this.setDescription)},setDescription:function(){var e=i.value;s!==e&&n.changeDescription(o,e)},onmessage:function(t,n){if(n.typedID!==a)switch(t){case"folderdescriptionsetsuccess":case"filedescriptionsetsuccess":case"linkdescriptionsetsuccess":e.broadcast("item-change-description",{itemTypedId:n.typedID})}}}}),Box.Application.addBehavior("sidebar-focus-redirect",function(e){"use strict";function t(e){var t=n.query(r,e);if(t)return t;var s=n.query(i,e);if(s)return s;var l=n.queryAll(o,e);if(l&&l.length>0)return l[l.length-1];var c=n.query(a,e);return c?c:void 0}var n,r='.file-list-item-actions [data-resin-target="share"]',i=".file-list-item-context-menu",o=".file-list-badges button",a=".item-name-link-wrapper a",s="tab-jump-to-share-button",l="tab-jump-to-next-file-item";return{init:function(){n=e.getService("dom")},onfocusin:function(r,i,o){if(i){var a=e.getConfig("itemTypedID"),c=n.query('li.tbl-list-item[data-id="'+a+'"]');if(c){if(o===s){var u=t(c);return void(u&&u.focus())}return o===l?void(c.nextElementSibling&&c.nextElementSibling.click()):void 0}}}}}),Box.Application.addBehavior("sidebar-name-change",function(e){"use strict";var t,n,r,i;return{messages:["item-name-change"],init:function(){t=e.getService("dom"),n=e.getElement(),i=e.getConfig("itemTypedID"),r=t.query(".sidebar-headline strong",n)},onmessage:function(e,t){"item-name-change"===e&&t.itemTypedId===i&&r&&this.updateName(t.name)},updateName:function(e){t.setText(r,e),r.title=e}}}),Box.Application.addBehavior("sidebar-search-excerpts",function(e){"use strict";function t(e,t){var r=document.createElement("div"),i=document.createElement("h2");if(e===s)n.setText(i,c);else{if(!(l.indexOf(e)>-1))return null;n.setText(i,u)}var a=document.createElement("a");return a.className="excerpt",a.href="/file/"+o.substr(2),n.setHTML(a,t),r.appendChild(i),r.appendChild(a),r}var n,r,i,o,a="hidden",s="file_content_excerpt",l=["comments_excerpt","discussion_comments_excerpt"],c=$t("File Contents","sidebar_excerpt_header_file_contents"),u=$t("Activity","sidebar_excerpt_header_activity");return{init:function(){n=e.getService("dom"),r=e.getService("search-excerpts"),i=e.getElement(),o=e.getConfig("itemTypedID");var s=r.getForItem(o);if(s){var l=n.query(".sidebar-search-excerpts-container",i);for(var c in s)if(s.hasOwnProperty(c)){var u=t(c,s[c]);u&&l.appendChild(u)}n.removeClass(l,a)}}}}),Box.Application.addBehavior("sidebar-sync",function(e){"use strict";var t,n,r,i,o,a,s,l,c=$t("Folder unsynced.","folder_successfully_unsynced"),u=$t("Folder failed to unsync.","folder_failed_to_unsync"),d=$t("Folder synced.","folder_successfully_synced"),f=$t("Folder failed to sync.","folder_failed_to_sync");return{init:function(){t=e.getService("dom"),n=e.getService("fileop-sync"),r=e.getService("notifications-amsterdam"),i=e.getService("resin"),l=e.getConfig("itemTypedID"),o=e.getElement(),a=t.query('[data-type="toggle-sync-btn"]',o),s=t.query("#sidebar-sync-toggle",a)},onclick:function(e,t,n){if(t&&"toggle-sync-btn"===n){e.preventDefault();var r=s.checked;r?this.unsync():this.sync()}},sync:function(){i.recordActionFromElement(s,{target:"sync",action:"click"}),n.syncItem(l).then(function(){r.info(d),e.broadcast("syncsuccess",{itemTypedId:l})},function(){r.error(f),s.checked=!1}),s.checked=!0},unsync:function(){i.recordActionFromElement(s,{target:"unsync",action:"click"}),n.unsyncItem(l).then(function(){r.info(c),e.broadcast("unsyncsuccess",{itemTypedId:l})},function(){r.error(u),s.checked=!0}),s.checked=!1}}}),Box.Application.addBehavior("sidebar-tabs",function(e){"use strict";var t;return{init:function(){var n=e.getService("dom"),r=e.getService("user-preferences"),i=e.getService("tabview"),o=e.getElement(),a=e.getConfig(),s=n.query(".sidebar-tab-view",o);s&&(t=i.create(s),t.init(),t.on("tabchange",function(t){var n=t.data&&t.data.tab;a&&a.sidebarCategory&&n&&(n=0===n.indexOf("sidebar-")?n.substr(8):n,"itemList"===a.sidebarCategory&&r.saveUserItemListSidebarTabPreference(n)),e.broadcast("sidebartabchange",{tabName:n})}))},destroy:function(){t&&t.destroy()}}}),Box.Application.addBehavior("sidebar-weblink-url-change",function(e){"use strict";function t(){r.removeClass(a,"has-error"),a.removeAttribute("data-tooltip"),a.removeAttribute("data-tooltip-theme"),a.removeAttribute("aria-label")}function n(e){var t=e.valueMissing?c:u;r.addClass(a,"has-error"),a.setAttribute("data-tooltip",""),a.setAttribute("data-tooltip-theme","error"),a.setAttribute("aria-label",t)}var r,i,o,a,s,l=".weblink-url-input",c=$t("This is a required field","required_field_validation_error"),u=$t("Please enter a valid URL","invalid_url_validation_error");return{init:function(){r=e.getService("dom"),i=e.getService("item-actions"),o=e.getElement(),s=e.getConfig("itemTypedID"),a=r.query(l,o),r.on(a,"blur",this.submitChange),r.on(a,"focus",this.resetErrors)},destroy:function(){r.off(a,"blur",this.submitChange),r.off(a,"focus",this.resetErrors)},submitChange:function(){var e=a.validity;return e.valid?void i.changeWeblinkUrl(s,a.value):void n(e)},resetErrors:function(){t(),e.getService("tooltips-amsterdam").hide(a)}}}),Box.Application.addBehavior("sticky-sidebar-scroll",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f,p,m,h,g,v,y,b,_,w,S,k,E=".global-sidebar > .global-sidebar-content",C=".file-list-body",x=".action-bar",T=".main-header",A=".is-list-view .file-list-header",I=".is-icon-view .file-list-header",O="is-fixed";return{messages:["navigationend","navigationstart","sidebarcontentloaded","sidebarselectionupdated","sidebartabchange","sidebarcontentupdated"],init:function(){t=e.getService("dom"),n=e.getService("page-scroll"),f=e.getElement(),u=e.getGlobal("document"),d=e.getGlobal("window"),r=d.requestAnimationFrame||d.webkitRequestAnimationFrame,d.addEventListener("resize",this.initSidebarStickiness.bind(this)),l=this.handleScroll.bind(this),c=!1,this.initSidebarStickiness(),f&&t.on(d,"scroll",l)},onmessage:function(e){switch(e){case"sidebarcontentloaded":case"sidebarselectionupdated":case"sidebartabchange":case"sidebarcontentupdated":this.initSidebarStickiness();break;case"navigationend":this.initSidebarStickiness(),f&&t.on(d,"scroll",l);break;case"navigationstart":f&&t.off(d,"scroll",l)}},initSidebarStickiness:function(){if(i=!1,o=!1,a=0,s=!1,m=t.query(E,f),m&&(p=t.query(C,f))){var n=this;r(function(){p.style.paddingBottom=0,g=p.getBoundingClientRect().height,h=t.query(x,f).getBoundingClientRect().height,v=t.query(T).getBoundingClientRect().height;var r=t.query(A,f);r||(r=t.query(I,f)),y=r.getBoundingClientRect().height,b=e.getGlobal("window").innerHeight,w=m.getBoundingClientRect(),_=w.height,S=h+v+y,k=_+S-b,s=k>0,n.setInitialState()})}},setInitialState:function(){s?(m.style.top=n.getScrollTop()+h+y+"px",m.style.position="absolute",this.padTheFileListBottomIfNeeded()):this.stickToTop()},handleScroll:function(){if(s){var e=this;r(function(){if(c)return void d.setTimeout(function(){c=!1},200);var t=n.getScrollTop(),r=t>a,s=t<a;if(a=t,w=m.getBoundingClientRect(),r){if(i)return;if(w.bottom<=b)return i=!0,void e.stickToBottom();if(o)return o=!1,e.unStick(),void e.padTheFileListBottomIfNeeded()}else if(s){if(o)return;var l=6;if(w.top>=S-l)return o=!0,void e.stickToTop();if(i)return i=!1,void e.unStick()}})}},stickToTop:function(){m.style.top="auto",m.style.position="fixed",m.classList.add(O)},stickToBottom:function(){m.style.top=b-_+"px",m.style.position="fixed",m.classList.add(O),c=!0},unStick:function(){var e=h+y;m.style.top=n.getScrollTop()+e-(S-w.top)+"px",m.style.position="absolute",m.classList.remove(O)},padTheFileListBottomIfNeeded:function(){p.style.paddingBottom=0,g=p.getBoundingClientRect().height;var e=g-n.getScrollTop();e<_&&(p.style.paddingBottom=_-e-v+"px",g=p.getBoundingClientRect().height)}}}),Box.Application.addBehavior("tabs",function(e){"use strict";var t,n,r,i;return{messages:["navigationstart","navigationend"],init:function(){this.initBehavior()},destroy:function(){this.destroyBehavior()},onmessage:function(e){switch(e){case"navigationstart":this.destroyBehavior();break;case"navigationend":this.initBehavior()}},initBehavior:function(){t=e.getService("dom"),n=e.getService("tabview"),r=e.getElement();var o=t.query(".tab-view",r);o&&(i=n.create(o),i.init())},destroyBehavior:function(){i&&i.destroy()}}}),Box.Application.addBehavior("textarea-autogrow",function(e){"use strict";var t,n,r;return{init:function(){var i=e.getGlobal("window"),o=i.requestAnimationFrame||i.webkitRequestAnimationFrame;t=e.getService("dom"),n=e.getService("textarea-resizer"),r=t.queryAll("textarea[data-autogrow]",e.getElement()),Array.prototype.forEach.call(r,function(e){o(function(){var r=n.create(e),i=r.resize.bind(r);i(),t.on(e,"input",i),t.on(e,"change",i)})})},destroy:function(){Array.prototype.forEach.call(r,function(e){t.off(e,"input",!1),t.off(e,"change",!1)})}}}),Box.Application.addBehavior("text-clipboard",function(e){"use strict";var t,n,r,i=[];return{init:function(){t=e.getService("dom"),n=e.getService("text-clipboard"),r=e.element;var o=t.queryAll(".copy-text-input-group",r);o.forEach(function(e){i.push(n.create(e))})},destroy:function(){i.forEach(function(e){e.destroy()})}}}),Box.Application.addBehavior("tooltips-amsterdam",function(e){"use strict";function t(){return null}var n;return{messages:["contentrefreshed","formvalidatorerrorcleared","navigationstart"],onmessage:function(e,r){switch(e){case"formvalidatorerrorcleared":n.hide(r);break;case"contentrefreshed":case"navigationstart":n.hideAll();break;default:t()}},init:function(){n=e.getService("tooltips-amsterdam")},onfocusin:function(e,t,r){n&&n.handleEvent(e,t,r)},onfocusout:function(e,t,r){n&&n.handleEvent(e,t,r)},onmouseover:function(e,t,r){n&&n.handleEvent(e,t,r)},onmouseout:function(e,t,r){n&&n.handleEvent(e,t,r)},onclick:function(e,t,r){n&&n.handleEvent(e,t,r)}}}),Box.Application.addModule("access-stats-count",function(e){"use strict";function t(t,n){return e.broadcast("accessstatsfetchsuccess",{statType:t}),n.data&&n.data.accessEventsCount&&this.updateStat(t,n.data.accessEventsCount),i.createResolved({status:"success",statType:t})}var n,r,i,o,a="access_event_stats",s="failed";return{init:function(){o=e.getElement(),n=e.getService("dom"),r=e.getService("ajax"),i=e.getService("promises"),this.requestAllStats(o.getAttribute("data-file-id"))},updateStat:function(e,t){var r=n.query('[data-access-stats-type="'+e+'"]');n.setText(r,t)},requestStat:function(n,o){if(n&&o)return e.broadcast("accessstatsfetchstarted",{statType:o}),r.get(a,{fileId:n,eventType:o}).then(t.bind(this,o)).catch(function(){return i.createResolved({status:s,statType:o})})},requestAllStats:function(t){if(t){e.broadcast("accessstatstotalsloadstart");var r=n.queryAll("[data-access-stats-type]"),a=r.map(function(e){var n=e.getAttribute("data-access-stats-type");return this.requestStat(t,n)}.bind(this));i.all(a).then(function(t){var r=!1;t.forEach(function(t){t.status===s&&(r=!0,e.broadcast("accessstatsfetchfail",t.statType))}),r?e.broadcast("accessstatstotalsloadfail"):e.broadcast("accessstatstotalsloadsuccess"),n.addClass(o,"ready")})}}}}),Box.Application.addModule("access-stats-summary",function(e){"use strict";function t(){r=e.getService("xhr"),r.send("GET",a+i).then(function(t){n.removeClass(o,s),n.setHTML(o,t.responseText),e.broadcast("sidebarcontentupdated")})}var n,r,i,o,a="/index.php?rm=access_stats_summary&fileId=",s="is-loading",l="hidden";return{behaviors:["access-stats-keyboard-shortcut"],messages:["previewcloserequested"],init:function(){n=e.getService("dom"),i=e.getConfig("fileId"),o=e.getElement(),n.removeClass(o,l),n.addClass(o,s),t()},onmessage:function(){}}}),Box.Application.addModule("access-stats-popup",function(e){"use strict";function t(e){n.close({unsafeSkipRefresh:!0}),n.open(r,{data:{fileID:e},resinName:"accessstatsexport"})}var n,r="access_stats_export_popup";return{behaviors:["access-stats-instrumentation"],init:function(){n=e.getService("popups-amsterdam")},onclick:function(n,r,i){if(r&&i&&"export"===i){var o=e.getConfig("fileID");t(o)}}}}),Box.Application.addModule("access-stats-export-popup",function(e){"use strict";function t(){if(C){var e=_.query(".user-selector-input",E),t=b.searchAllContacts({includeSelf:!0,includeGroups:!0});T=y.create(e,t),T.init()}}function n(){var e,t=x.value;return!t||(e=T.createDataArrayFromString(t),e.length?(T.removeAllErrors(),T.insertArrayOfPills(e),!0):(T.displayError(V),!1))}function r(e){_.addClass(e,R),_.addClass(D,F),M=!1}function i(){_.removeClass(A,R),_.removeClass(I,R),_.removeClass(D,F),M=!0}function o(e){return S.isEmail(e.id)||e.data&&"group"===e.data.type}function a(){_.addClass(D,B),_.addClass(D,q),M=!1}function s(){_.removeClass(D,q),_.removeClass(D,B),M=!0}function l(){var e,t;return!!n()&&(e=T.getPills(),!(e.length>0&&!T.validatePills(o))||(t=$t("One or more of the email addresses is invalid.","access_stats_export_atleast_one_invalid_email_error"),T.displayError(t),!1))}function c(e){var t=new Date(e),n=t.getUTCFullYear(),r=t.getUTCMonth()+1,i=t.getUTCDate();return n+"-"+r+"-"+i}function u(t){s();var n=t.data||{};if(n.success){var r=$t("Your report is generating and will be uploaded to your reports folder.","access_stats_export_popup_success_message"),i=n.reportsFolderUrl||"";k.info(r,{buttonText:$t("GO TO FOLDER","access_stats_export_go_to_report_button"),duration:N,clickHandler:function(){e.getService("url").goToUrl(i)}}),v.close({unsafeSkipRefresh:!0})}else k.error(W)}function d(){s(),k.error(W)}function f(){var e,t,n,r,i,o,s={};if(s.fileID=C,e=_.query('input[name="activity-types"]',E).value||"",s.activityTypes=e.split(","),l()){if(t=T.getPillIDsByType(),n=t.defaultIDs,r=t.groupIDs,n.length>0&&(s.userEmails=n),r.length>0&&(s.groupIDs=r),O&&O.isVisible()){if(!O.validate())return;o=O.getDateRange(),s.fromDate=c(o.fromDate),s.toDate=c(o.toDate)}else i=_.query('input[name="filter-range"]',E).value,i&&(s.dateRangeCode=i);a(),w.post(L,s).then(u).catch(d)}}function p(){var t=_.query(".calendar-group",E),n=e.getService("custom-date-range");A=_.query(".inline-alert-error.invalid-date-range",E),I=_.query(".inline-alert-error.empty-date-range",E),O=n.create(t)}function m(){O||p(),O.show()}function h(){O&&(O.hide(),i())}var g,v,y,b,_,w,S,k,E,C,x,T,A,I,O,D,M,P=13,N=6e3,R="inline-alert-visible",F="is-disabled",B="is-loading",q="is-disabled",L="access_stats_export_create",j="cancel-btn",U="create",H="custom-date-range",$="preset-time-range-option",V=$t("Please enter a valid email address.","access_stats_export_invalid_email_error_notification"),W=$t("Sorry, the report could not be generated. Please try again.","access_stats_export_popup_report_creation_fail");return{behaviors:["menu-toggle-eu"],messages:["invaliddaterangeerror","emptydateerror","clearerrormessage"],init:function(){w=e.getService("ajax"),_=e.getService("dom"),g=e.getService("item-actions"),v=e.getService("popups-amsterdam"),b=e.getService("provider-contacts"),y=e.getService("pill-selector"),S=e.getService("strings"),k=e.getService("notifications-amsterdam"),C=e.getConfig("fileID"),E=e.getElement(),D=_.query('.btn[data-type="create"]',E),M=!0,t(),x=_.query(".pill-selector-input",E),_.on(x,"paste",this.pasteEventHandler)},onclick:function(e,t,n){if(t&&n){var r="f_"+C;switch(n){case j:v.close({unsafeSkipRefresh:!0}),g.showAccessStatsPopup(r);break;case U:M&&f();break;case H:m();break;case $:h()}}},onmessage:function(e){switch(e){case"emptydateerror":i(),r(I);break;case"invaliddaterangeerror":i(),r(A);break;case"clearerrormessage":i()}},onkeydown:function(e,t,r){if("user-email-input"===r){var i=e.which||e.keyCode;i===P&&n()}},pasteEventHandler:function(){setTimeout(n,0)}}}),Box.Application.addModule("accessibility-skip-content-header",function(e){"use strict";return{onclick:function(){e.broadcast("focusfirstfilename"),event.stopPropagation(),event.preventDefault()}}}),Box.Application.addModule("action-bar",function(e){"use strict";function t(){var e=c.query("[data-folder-typed-id]");return e?e.getAttribute("data-folder-typed-id"):null}function n(e,n){var r=e===t()?x:T,i=c.query(".action-bar-toggle-favorite-btn",r);if(i){if(!n.canFavorite)return void c.addClass(i,j);c.removeClass(i,j),n.isFavorited?(c.addClass(i,L),i.setAttribute("data-tooltip-text",$),i.setAttribute("aria-label",$),i.setAttribute("data-resin-target","unfavorite")):(c.removeClass(i,L),i.setAttribute("data-tooltip-text",V),i.setAttribute("aria-label",V),i.setAttribute("data-resin-target","favorite")),i.removeAttribute("data-resin-folder_id"),i.removeAttribute("data-resin-file_id"),i.removeAttribute("data-resin-weblink_id"),i.setAttribute("data-resin-"+G[e.charAt(0)]+"_id",e.substr(2))}}function r(){var e=t();v.open(P,{data:{parentFolderID:e.substr(2)}})}function i(){var e=t();v.open(M,{data:{folderTypedID:e}})}function o(e){var t={};try{t=JSON.parse(e)}catch(t){E.sendLog(Y,"invalid_json_response",{response:e})}return t}function a(t,n,r,i){S.hide();var a=o(t),s=a.itemTypedId;if(i){var l=a.fullFileName;if(l){var c=$t("%1 was created successfully","successfully_created_new_document_no_conflict_message",l);w.confirm(c)}a.editURL&&k.executeCustomAction(s,r,a.editURL,{openTarget:"tab"})}e.broadcast("newitemadded",{folderTypedId:n,itemTypedId:s})}function s(e){S.hide();var t=o(e),n=t.message||z;w.error(n)}var l,c,u,d,f,p,m,h,g,v,y,b,_,w,S,k,E,C,x,T,A,I,O,D="get_new_document_popup",M="get_create_bookmark_popup",P="new_folder_popup",N="create_new_document",R="/folder/0",F="d_0",B="",q="is-active",L="is-favorited",j="hidden",U="is-multi-selected",H="are-showing",$=$t("Unfavorite this item","action_bar_unfavorite_tooltip"),V=$t("Favorite this item","action_bar_favorite_tooltip"),W=$t("Create new bookmark","action_bar_kb_shortcut_new_bookmark"),K=$t("Create new folder","action_bar_kb_shortcut_new_folder"),z=$t("Unable to create file. Please try again","action_bar_create_file_generic_error"),G={d:"folder",f:"file",l:"weblink"},X=428,J=452,Y="action_bar";return{behaviors:["ajax-nav","refresh-banner-policy","resin-target-toggle","tooltips-amsterdam","file-list-bulk-actions"],init:function(){l=e.getService("browser"),c=e.getService("dom"),u=e.getService("file-list-manager"),d=e.getService("fileop-delete"),f=e.getService("fileop-download"),p=e.getService("fileop-rename"),m=e.getService("item-actions"),g=e.getService("nav"),v=e.getService("popups-amsterdam"),y=e.getService("uploads-hierarchy"),b=e.getService("uploads-main"),_=e.getService("xhr"),w=e.getService("notifications-amsterdam"),S=e.getService("loading"),k=e.getService("custom-actions"),E=e.getService("logger"),C=e.getElement(),x=c.query(".action-bar-left",C)||c.query(".page-title",C),T=c.query(".selected-items-placeholder",C),I=c.query(".selected-item-name",T),A=c.query(".selected-items-number",T),O=e.getGlobal("window"),this.bindUploadFileButtonHandler(),this.setupUploadFolderButton(),this.filterNewDocumentTypes(),h=e.getService("keyboard-shortcuts"),h.register({name:"action-bar",shortcuts:[{key:"shift+b",description:W,handler:i,type:"other"},{key:"shift+n",description:K,handler:r,type:"other"}]},C),setTimeout(function(){this.setBreadcrumbMenuAlignment()}.bind(this),0)},messages:["favoritesuccess","file-list-selection-updated","item-name-change","unfavoritesuccess"],onmessage:function(e,r){switch(e){case"item-name-change":if(r.itemTypedId!==t())return;var i=c.query(".action-bar-breadcrumb-item-name",C);c.setText(i,r.name),i.title=r.name;break;case"file-list-selection-updated":if(!r.length){B="",c.setText(A,""),c.addClass(T,j),c.removeClass(T,U),c.removeClass(x,j);break}if(c.addClass(x,j),c.removeClass(T,j),r.length>1){B="",c.setText(A,r.length),c.addClass(T,U);break}var o=r[0];if(B=o.id,n(B,{canFavorite:o.canFavorite,isFavorited:o.isFavorited}),I){var a=o.name;c.setText(I,a),c.removeClass(T,U)}break;case"favoritesuccess":n(r.itemTypedId,{canFavorite:!0,isFavorited:!0});break;case"unfavoritesuccess":n(r.itemTypedId,{canFavorite:!0,isFavorited:!1});var s=u.getCurrentPageType();"favorites"===s&&u.removeItem(r.itemTypedId)}},onclick:function(e,n,o){var a,s=t(),l=c.query(".action-bar-breadcrumb-parent:last",C),u=l?l.getAttribute("data-parent-typed-id")||F:F;switch(o){case"new-folder":r();break;case"new-bookmark":i();break;case"create-file":a=e.target.getAttribute("data-doc-type")||"",v.open(D,{data:{docType:a,folderId:s}});break;case"create-file-auto-filename":var h=e.target.getAttribute("data-file-name")||"";a=e.target.getAttribute("data-doc-type")||"";var y=e.target.getAttribute("data-action-id")||"",b=e.target.getAttribute("data-extension")||"",_=e.target.getAttribute("data-asct")||"";if(!(h&&a&&y&&b&&_))return;this.createFileWithAutomaticNameConflictResolution(h,s,a,y,b,_);break;case"rename-folder":var w=c.query(".action-bar-breadcrumb-item-name",C),S=w.textContent||w.innerText;p.rename(s,S);break;case"toggle-filters-btn":var k=c.query(".file-list-filters");c.hasClass(n,q)?(c.removeClass(n,q),c.removeClass(k,H)):(c.addClass(n,q),c.addClass(k,H));break;case"download-folder":f.download([s]);break;case"movecopy-folder":m.movecopy([s],u);break;case"delete-folder":d.delete_([s],u).then(function(){},function(){return l?void g.navigate(l.href):void g.navigate(R)});break;case"toggle-favorite-btn":var E=!c.hasClass(n,L),x=B||t();E?m.addToFavorites(x):m.removeFromFavorites(x),e.stopPropagation();break;default:return}e.preventDefault()},bindUploadFileButtonHandler:function(){var e=c.query(".upload-file-handler-target",C);e&&b.bindFileUploadHandler(e,t())},setupUploadFolderButton:function(){var e=c.query(".upload-folder-handler-target",C),n=c.query(".upload-folder-java");if(!l.canFolderUpload()||!e){var r=c.query("a",n);return void c.on(r,"click",function(e){e.preventDefault();var t=r.getAttribute("href"),n=["resizable","scrollbars","status","width="+X,"height="+J].join(",");O.open(t,"UploadWindow",n)})}c.removeClass(e,"hidden"),c.addClass(n,"hidden"),y.bindFolderUploadHandler(e,t())},filterNewDocumentTypes:function(){var t=c.queryAll(".box_edit_types",C);if(t.length){var n=e.getService("box-edit-amsterdam");n.checkBoxEditAvailability().then(function(){var e=c.queryAll(".office_online_types",C);c.addClass(e,"hidden")}).catch(function(){c.addClass(t,"hidden")})}},setBreadcrumbMenuAlignment:function(){var e="is-right-aligned",t=c.query(".action-bar-breadcrumb-item-name",C),n=c.query(".action-bar-breadcrumb-current-wrapper menu");if(t&&n){var r=t.getBoundingClientRect().width;n.style.display="block";var i=n.getBoundingClientRect().width;n.style.display="none";var o=i<r;o?c.addClass(n,e):c.removeClass(n,e)}},createFileWithAutomaticNameConflictResolution:function(e,t,n,r,i,o){S.show();var l=!1,c=!0,u={fileName:e,folderId:t,docType:n,actionId:r,extension:i,asct:o,overwrite:l,resolveNameConflict:c},d=[];for(var f in u)u.hasOwnProperty(f)&&d.push(encodeURIComponent(f)+"="+encodeURIComponent(u[f]));var p={success:function(e){a(e.response,t,r,c)},error:function(e){s(e.response)}};_.sendSync("post","/index.php?rm="+N,d.join("&"),p)},onFileCreateSuccessHandler:a,onFileCreateErrorHandler:s,destroy:function(){h.deregister("action-bar",C)}}}),Box.Application.addModule("change-classification-popup",function(e){"use strict";function t(){i.addClass(d,h),i.addClass(f,g),i.addClass(f,h),f.disabled=!0}function n(){i.removeClass(d,h),i.removeClass(f,g),i.removeClass(f,h),f.disabled=!1}var r,i,o,a,s,l,c,u,d,f,p="Box__Security__Classification__Key",m="metadata_edit_template",h="is-disabled",g="is-loading";return{init:function(){r=e.getService("ajax"),i=e.getService("dom"),o=e.getService("notifications-amsterdam"),a=e.getService("popups-amsterdam"),s=e.getConfig("classificationTemplateKey"),l=e.getConfig("itemTypedID");var t=e.getService("metadata-store");c=t.create();var n=e.getElement();u=i.query('[data-field-key="'+p+'"]',n),d=i.query(".popup-cancel-btn",n),f=i.query(".btn-primary",n)},getTemplatePatches:function(){var e=u.getAttribute("data-initial-value"),t=u.options[u.selectedIndex].value;return c.storeField(s,p,t,e),c.getTemplatePatches()},onsubmit:function(i){i.preventDefault();var s={itemTypedID:l,templatePatches:this.getTemplatePatches()};t(),r.post(m,s).then(function(){o.info($t("Your changes were saved successfully.","change_classification_success")),a.close({unsafeSkipRefresh:!0}),e.broadcast("item-change-classification",{initiallyShowDetailsTab:!0,itemTypedID:l})}).catch(function(){o.error($t("There was a problem changing the classification for this item. Please try again.","change_classification_error")),n()})}}}),Box.Application.addModule("collaborators-page",function(e){"use strict";function t(){var e=$t("This user cannot be removed.","collaborators_notification_remove_collab_error");i.error(e)}function n(e){var t=$t("%1 was successfully removed as a collaborator.","collaborators_notification_remove_collab_success",e);i.info(t)}var r,i,o,a;return{behaviors:["ajax-nav","list-sort","overflow-scroll-detection"],init:function(){a=e.getService("ajax"),r=e.getService("nav"),i=e.getService("notifications-amsterdam"),o=e.getService("popups-amsterdam")},onclick:function(e,t,n){if("remove-collab-btn"===n){var r=this,i=t.getAttribute("data-name");o.confirm($t("Would you like to remove %1 as a collaborator from all the folders you own? (Note: this collaborator will not be removed from folders where (s)he was added as part of a group. To remove a collaborator from a specific folder, go directly to that folder.)","remove_collab_popup_confirmation",i),$t("Remove Collaborator","remove_collab_popup_header")).then(function(){r.removeCollab(t.getAttribute("data-email"),i)}),e.preventDefault(),e.stopPropagation()}},removeCollab:function(e,i){a.post("collaborators_ajax_remove",{email:e,origin:"collaborators"}).then(function(e){e.data.result?(n(i),r.refresh()):t()},t)}}}),Box.Application.addModule("page-contextual-messages",function(e){"use strict";function t(){var t=n.createMessageRepresentation("first_login_amsterdam","modal");t.setIsTriggeredByUserAction(!1).registerOnShowCallback(function(){var t=e.getService("ajax");t.post(r)}).registerOnCloseCallback(function(){var e=1e3;setTimeout(function(){n.createMessageRepresentation("ftux_box_features_intro","popout").setIsTriggeredByUserAction(!1).show()},e)}).show()}var n,r="onboarding_unset_show_first_login_modal";return{behaviors:["contextual-messages-registration"],init:function(){e.hasService("contextual-message")&&(n=e.getService("contextual-message"),t())}}}),Box.Application.addModule("amsterdam-survey",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f,p,m,h,g,v,y,b="submit-survey",_="submit-bug-report",w="feedback-action",S="is-visible",k="hidden",E="is-selected",C="show-bug-report-pane",x="show-feedback-pane",T="bug-category-select",A="feature-select",I="amsterdam_opt_in",O="amsterdam_bug_report",D="SURVEY_COMPLETED",M="BUG_SUBMITTED",P=$t("Thank you for your feedback!","experience_survey_success_message");return{init:function(){t=e.getService("dom"),r=e.getService("nav"),n=e.getService("logger"),i=e.getElement(),o=t.query(".survey-warning-text",i),c=t.query(".survey-pane-bug-report",i),l=t.query(".survey-pane-feedback-form",i),u=t.query(".other-option-category",i),d=t.query(".other-option-feature",i),a=t.query(".bug-report-warning-text",i),s=t.query(".bug-report-message-text",i),f=t.query(".feedback-pane-selector-btn",i),p=t.query(".bug-report-pane-selector-btn",i),m=t.query(".feedback-text",i),h=t.query(".leave-amsterdam",i),g=t.query(".bug-category-select",i),v=t.query(".feature-select",i),y=t.query(".bug-description",i)},goToURL:function(e){r.redirect(e)},close:function(){t.removeClass(i,S)},onclick:function(e,t,n){var r;switch(n){case b:return e.stopPropagation(),r=this.collectSurveyData(),void(this.validateSurveyData(r)?this.sendFeedbackData(r):this.showFeedbackWarningMessage());case _:return e.stopPropagation(),r=this.collectBugReportData(),void(this.validateBugReportData(r)?(this.sendBugReportData(r),setTimeout(function(){this.resetBugReportForm(),this.close()}.bind(this),1e3)):(this.hideBugReportSuccessMessage(),this.showBugReportWarningMessage()));case C:return e.stopPropagation(),this.hideFeedbackPane(),void this.showBugReportPane();case x:return e.stopPropagation(),this.hideBugReportPane(),void this.showFeedbackPane()}},onchange:function(e,n,r){switch(r){case w:this.hideFeedbackSuccessMessage(),this.hideFeedbackWarningMessage();break;case T:case A:var i=r===T?u:d;"other"===n.options[n.selectedIndex].value?t.addClass(i,S):t.removeClass(i,S)}},hideFeedbackSuccessMessage:function(){},hideFeedbackWarningMessage:function(){t.removeClass(o,S)},hideFeedbackPane:function(){t.removeClass(f,E),t.addClass(l,k)},showBugReportPane:function(){t.addClass(p,E),t.removeClass(c,k),h&&h.setAttribute("data-resin-target","revert|bug")},showFeedbackPane:function(){t.addClass(f,E),t.removeClass(l,k),h&&h.setAttribute("data-resin-target","revert|feedback")},hideBugReportPane:function(){t.removeClass(p,E),t.addClass(c,k)},showFeedbackSuccessMessage:function(){this.hideFeedbackWarningMessage()},showFeedbackWarningMessage:function(){this.hideBugReportPane(),this.showFeedbackPane(),this.hideFeedbackSuccessMessage(),t.addClass(o,S)},showBugReportWarningMessage:function(){t.addClass(a,S)},showBugReportSuccessMessage:function(){t.addClass(s,S)},hideBugReportWarningMessage:function(){t.removeClass(a,S)},hideBugReportSuccessMessage:function(){t.removeClass(s,S)},validateBugReportData:function(e){return Object.keys(e).every(function(t){return""!==e[t].trim()})},validateSurveyData:function(e){return!!e.feedback},collectBugReportData:function(){var e=g.options[g.selectedIndex].value;"other"===e&&(e=u.value);var t=v.options[v.selectedIndex].value;return"other"===t&&(t=d.value),{"bug-description":y.value,categoryValue:e,feature:t}},collectSurveyData:function(){return{feedback:m.value}},sendFeedbackDataCallback:function(){var t=e.getService("notifications-amsterdam");t.confirm(P),this.resetFeedbackForm(),this.close()},sendFeedbackData:function(e){n.sendLog(I,D,e,this.sendFeedbackDataCallback.bind(this))},sendBugReportDataCallback:function(){this.hideBugReportWarningMessage(),this.showBugReportSuccessMessage()},sendBugReportData:function(e){n.sendLog(O,M,e,this.sendBugReportDataCallback.bind(this))},resetFeedbackForm:function(){t.query(".survey-form").reset(),this.hideFeedbackSuccessMessage()},resetBugReportForm:function(){t.query(".bug-report-form").reset(),this.hideBugReportSuccessMessage()}}}),Box.Application.addModule("excel-online-previewer",function(e){"use strict";var t,n,r="use-excel-online-previewer",i="box_add_service";return{init:function(){t=e.getService("ajax"),n=e.getConfig("excelOnlinePreviewerServiceID")},onclick:function(e,o,a){switch(a){case r:return void t.post(i,{q:{service_id:n}})}}}}),Box.Application.addModule("favorites-homepage",function(e){
"use strict";var t,n,r=!1;return{init:function(){t=e.getService("notifications-amsterdam"),n=e.getService("user-preferences")},onclick:function(e,t,n){"set-favorites-as-homepage"===n&&this.setFavoritesAsHomepage()},setFavoritesAsHomepage:function(){r||(r=!0,n.setUserHomepage("favorites").then(function(){r=!1,t.confirm($t("Your homepage was successfully changed to Favorites.","popout_favorites_homepage_set_success"))}).catch(function(){r=!1,t.error($t("There was a problem setting your homepage to Favorites.","popout_favorites_homepage_set_error"))}))}}}),Box.Application.addModule("file-activity-feed",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f=50,p=0,m=0,h={today:$t("Today","access_stats_feed_group_name_today"),yesterday:$t("Yesterday","access_stats_feed_group_name_yesterday"),"this-week":$t("Earlier this Week","access_stats_feed_group_name_thisweek"),"last-week":$t("Last Week","access_stats_feed_group_name_lastweek"),"this-month":$t("Earlier this Month","access_stats_feed_group_name_thismonth"),"last-month":$t("Last Month","access_stats_feed_group_name_lastmonth"),"this-year":$t("Earlier this Year","access_stats_feed_group_name_thisyear"),"last-year":$t("Last Year","access_stats_feed_group_name_lastyear")},g=Object.keys(h);return{behaviors:["tooltips-amsterdam"],init:function(){o=e.getElement(),t=e.getService("ajax"),a=e.getService("dom"),n=o.getAttribute("data-file-id"),r=e.getService("templates"),s=a.query(".access-stats-feed-pagination",o),i=e.getService("date-boundaries"),d=parseInt(o.getAttribute("data-request-size"),10)||f,u=this.generateDateBoundaries(),this.getNextSetOfItems()},destroy:function(){o=null,s=null},onclick:function(e,t,n){"load-more"===n&&(a.addClass(t,"hidden"),this.getNextSetOfItems())},generateDateBoundaries:function(){var e=new Date,t=i;return[t.getStartofToday(e).getTime(),t.getStartofYesterday(e).getTime(),t.getStartofThisWeek(e).getTime(),t.getStartofLastWeek(e).getTime(),t.getStartofThisMonth(e).getTime(),t.getStartofLastMonth(e).getTime(),t.getStartofThisYear(e).getTime(),t.getStartofLastYear(e).getTime()]},updateLoadMoreBtn:function(e){var t=a.query(".access-stats-load-more-btn",o);t&&(a.removeClass(t,"hidden"),t.setAttribute("data-resin-request_count",e))},displayEmptyFeed:function(){a.addClass(o,"is-empty-state")},getAccessEventsAjaxSuccessHandler:function(t){var n=t.data,r=this.groupAccessStatsFeedEvents(n.events);return e.broadcast("accessstatsactivityfeedgetsuccess"),c||n.events.length?(c=n.streamPosition,p++,this.generateFeedSections(r,l),n.events.length<d?s.parentNode.removeChild(s):this.updateLoadMoreBtn(p),void a.addClass(o,"ready")):void this.displayEmptyFeed()},getNextSetOfItems:function(){return e.broadcast("accessstatsactivityfeedgetstart"),t.get("access_stats_get_activity_feed",{fileId:n,streamPosition:c,limit:d}).then(this.getAccessEventsAjaxSuccessHandler.bind(this)).catch(function(){e.broadcast("accessstatsactivityfeedgetfail")})},generateFeedItems:function(e,t){var n=a.query('[data-feed-section-name="'+e+'"] .access-stats-feed-items');t.forEach(function(e){var t=e.userId?e.userId+"":null,i=e.type.toLowerCase(),o=r.getTemplateFragment("access-stats-feed-icon-type-"+i),a=null!==t?"access-stats-feed-item-with-profile":"access-stats-feed-item-without-profile",s={feedItemUserName:e.name,feedItemUserId:t,feedItemDescription:e.description,feedItemType:e.type,feedItemUserTooltipInfo:e.email||e.tooltipText},l=r.getTemplateFragment(a,s);l.querySelector(".access-stats-feed-icon").appendChild(o),n.appendChild(l)})},createNewSectionFragment:function(e,t){var n=r.getTemplateFragment("access-stats-feed-section",{feedSectionName:t,feedSectionHeader:h[t]});e.appendChild(n)},generateFeedSections:function(e,t){var n=Object.keys(e),r=a.query(".access-stats-feed-sections",o);n.forEach(function(n,i){0===i&&void 0!==t&&g.indexOf(n)===t||this.createNewSectionFragment(r,n),this.generateFeedItems(n,e[n])}.bind(this)),l=m},groupAccessStatsFeedEvents:function(e){if(e){var t={};return e.forEach(function(e){for(var n=new Date(e.createdAt).getTime();m<u.length;){if(n>=u[m]){var r=g[m];return t[r]||(t[r]=[]),void t[r].push(e)}m++}}),t}}}}),Box.Application.addModule("file-list-minimal",function(e){"use strict";function t(){var t=e.getGlobalConfig("currentRm")||"";return t===f}function n(){if(s&&s.navigationStart)return Date.now()-s.navigationStart}function r(e){return e<=p?100:e<=4*p?50:0}var i,o,a,s,l="file-list-loading",c="/folder/",u="runmode_performance_timers",d="files_page_performance",f="folder_get",p=2e3,m=e.getGlobal("window");return{init:function(){var t=e.getElement(),n=t.getAttribute("data-page");o=e.getGlobal("performance"),a=e.getService("logger"),s=o&&o.timing,this.logFilesPageTimeToMeaningfulContent(),Box.filesListMinimalFirstTimeLoaded=!0;var r=t.getAttribute("data-folder-typed-id").split("_")[1];if(this.updateFileList(r),"files"===n){var i=e.getService("resin");i.recordAction({application:"files",page:"",component:"",feature:"",target:"loaded",action:"programmatic"})}},destroy:function(){m.removeEventListener("beforeunload",this.abortFileListReq)},abortFileListReq:function(){i&&i.abort()},logFilesPageTimeToMeaningfulContent:function(){if(s&&s.navigationStart&&t()&&!Box.filesListMinimalFirstTimeLoaded){var e=n();if(e){var i=r(e);a.sendBatchLog(u,d,{timer_to_meaningful_content_ms:e,appdex_points:i})}}},onmessage:function(e){"navigationstart"===e&&this.abortFileListReq()},updateFileList:function(t){var n=e.getService("embed-context"),r=e.getElement(),o=e.getService("dom"),a=e.getService("xhr"),s=m.location.search,u=n.getBasePath()+c+t+"/items";s&&(u+="?"+s.substr(1)),i=a.send("GET",u),i.then(function(t){i=null,e.application.stop(r),r.setAttribute("data-module","file-list"),r.innerHTML=t.responseText,setTimeout(function(){o.removeClass(r,l)},0),e.application.start(r),e.broadcast("contentrefreshed")}),m.addEventListener("beforeunload",this.abortFileListReq)}}}),Box.Application.addModule("file-list",function(e){"use strict";function t(){return i.getAttribute("data-folder-typed-id")}function n(){var e=r.querySelector(".upload-link");e&&h.bindFileUploadHandler(e,t())}var r,i,o,a,s,l,c,u,d,f,p,m,h,g,v,y="is-favorited",b=250,_="hidden";return{behaviors:["drag-drop-download","file-list-clipboard","file-list-internal-drag","file-list-keys","file-list-bulk-menu","file-list-menus","file-list-selection","file-list-focus-redirect","file-list-view-toggle","file-list-respond-to-action-bar-resize","file-list-realtime-events","collab-invite","contextual-messages-registration","custom-action-integrations","item-context-menus","list-sort","menu-toggle-eu","overflow-scroll-detection","resizable-columns","search-page-excerpts","search-instrumentation","ajax-nav"],init:function(){i=e.getElement(),l=e.getService("custom-actions"),c=e.getService("dom"),u=e.getService("file-list-manager"),d=e.getService("item-actions"),v=e.getService("browser"),p=e.getService("nav"),m=e.getService("resin"),h=e.getService("uploads-main"),f=e.getService("keyboard-shortcuts"),g=e.getService("contextual-message"),r=i.querySelector(".file-list-empty"),o=i.getAttribute("data-page"),s=[];var t,a=c.query(".view-selector-option.active");v.isFolderDragAndDropUploadSupported()&&(t=i.querySelector(".folder-upload-supported"),t&&c.removeClass(t,_)),f.register({name:"file-list",shortcuts:[{key:"shift+v",description:$t("Switch between grid view and list view","kb_shortcuts_file_list_switch_view"),handler:function(){var e=c.query(".view-selector-option.active");c.hasClass(e,"is-icon-view")?c.query(".view-selector-option.is-list-view").click():c.query(".view-selector-option.is-icon-view").click()},type:"other"},{key:"]",description:$t("Go to next page","kb_shortcuts_file_list_goto_next_page"),handler:function(){var e=c.query(".action-bar-pagination .page-forward:not(.is-disabled)");e&&e.click()},type:"navigation"},{key:"[",description:$t("Go to previous page","kb_shortcuts_file_list_goto_previous_page"),handler:function(){var e=c.query(".action-bar-pagination .page-back:not(.is-disabled)");e&&e.click()},type:"navigation"}]},a),r&&n(),e.broadcast("contentrefreshed"),"files"===o?m.recordAction({application:"files",page:"",component:"",feature:"",target:"postloaded",action:"programmatic"}):m.recordAction({target:"loaded",action:"programmatic"})},destroy:function(){var e=c.query(".view-selector-option.active");f.deregister("file-list",e)},messages:["collabchanged","copysuccess","favoritesuccess","file-list-selection-updated","filelockedsuccess","filealreadylocked","filealreadyunlocked","fileunlockedsuccess","focusfirstfilename","item-change-description","item-change-tags","item-name-change","movesuccess","newitemadded","unfavoritesuccess","unsyncsuccess","sharedlinkremoved","syncsuccess"],refreshItemRow:function(e){var n=u.getCurrentPageType();if("recents"!==n){var r=i.querySelector("li[data-id="+e+"]");r&&u.addItem(t(),e)}},handleExcelOnlinePreviewerContextualMessage:function(e){var t=g.createMessageRepresentation("excel_online_previewer","modal");"non-displayable"===t.type?p.navigate(e):t.setIsTriggeredByUserAction(!0).registerOnCloseCallback(function(){p.redirect(e)}).show()},onmessage:function(e,t){if(t&&t.itemTypedId)var n=i.querySelector("li[data-id="+t.itemTypedId+"]");switch(e){case"copysuccess":t.currentFolderTypedId===t.destinationFolderTypedId&&t.items.forEach(function(e){u.addItem(t.currentFolderTypedId,e.createdTypedId)});break;case"file-list-selection-updated":t.length>1?c.addClass(i,"is-multiple-selected"):c.removeClass(i,"is-multiple-selected");break;case"item-change-description":case"item-change-tags":case"syncsuccess":case"filelockedsuccess":case"fileunlockedsuccess":case"filealreadylocked":case"filealreadyunlocked":case"sharedlinkremoved":this.refreshItemRow(t.itemTypedId);break;case"item-name-change":if(!n)return;var r=n.querySelector(".item-name a");c.setText(r,t.name),n.setAttribute("data-name",t.name),n.title=t.name;break;case"movesuccess":var a=t.items;if(a[0].typedId===i.getAttribute("data-folder-typed-id"))return void p.refresh();a.forEach(function(e){u.removeItem(e.typedId)});break;case"newitemadded":u.addItem(t.folderTypedId,t.itemTypedId);break;case"favoritesuccess":if(!n)return;c.addClass(n,y),n.setAttribute("data-is-favorited",!0);break;case"unfavoritesuccess":"favorites"===o?u.removeItem(t.itemTypedId):n&&(c.removeClass(n,y),n.removeAttribute("data-is-favorited"));break;case"unsyncsuccess":"sync"===o?u.removeItem(t.itemTypedId):this.refreshItemRow(t.itemTypedId);break;case"collabchanged":this.refreshItemRow(t.itemTypedID);break;case"focusfirstfilename":i.querySelector(".item-name-link")&&i.querySelector(".item-name-link").focus()}},onclick:function(t,n,r){var i=c.getNearest(n,".tbl-list-item");if(i){var o=i.getAttribute("data-id");switch(r){case"custom-action-link":t.preventDefault();var a=n.getAttribute("data-action-id"),s=n.getAttribute("data-custom-action-url");if(s){var u=l.extractCustomActionConfig(n);l.executeCustomAction(o,a,s,u)}else l.launchCustomActionPopup(o,a);e.broadcast("filelistcustomactionclicked",{itemTypedID:o});break;case"context-menu-btn":e.broadcast("filelistcontextmenuclicked",{itemTypedID:o,targetEl:t.target});break;case"menu-toggle-button":e.broadcast("filelistsharebtnclicked",{itemTypedID:o});break;case"share-btn":d.share(o),e.broadcast("filelistsharebtnclicked",{itemTypedID:o,targetEl:t.target});break;case"rename-btn":var f=i.getAttribute("data-name");d.rename(o,f);break;case"version-history-btn":d.showVersionHistoryPopup(o);break;case"lock-btn":d.showUnlockPopup(o);break;case"request-unlock-btn":d.requestUnlockPopup(o);break;case"excel-online-previewer-link":t.stopPropagation(),t.preventDefault();var p=n.getAttribute("href");this.handleExcelOnlinePreviewerContextualMessage(p);break;default:e.broadcast("filelistitemclicked",{targetEl:t.target})}}},onmouseover:function(t,n){clearTimeout(a);var r=c.getNearest(n,".tbl-list-item"),i=r?r.getAttribute("data-item-type"):"";if("file"===i){var o=r.getAttribute("data-id")||"",l=o.substr(2);l&&s.indexOf(l)===-1&&(a=setTimeout(function(){e.broadcast("previewprefetchpreload",{fileID:l}),s.push(l)},b))}}}}),Box.Application.addModule("folder-description",function(e){"use strict";var t,n,r,i,o,a="show-folder-description";return{messages:["folderdescriptionsetsuccess"],init:function(){var a=e.getConfig("folderID");t=e.getService("dom"),n=e.getService("templates"),r=e.getElement(),o="d_"+a,i=t.query(".folder-description-content",r)},hideFolderDescription:function(){t.removeClass(r,a)},onmessage:function(e,s){if("folderdescriptionsetsuccess"===e&&o===s.typedID){var l=s.description;if(!l)return void this.hideFolderDescription();var c=n.escapeHTML(l);c=c.replace(new RegExp("\n","g"),"<br>"),t.setHTML(i,c),t.addClass(r,a)}}}}),Box.Application.addModule("folder-notifications",function(e){"use strict";var t,n,r,i,o="mark_collab_invites_seen",a="mark_collab_expiration_seen",s="accepted",l="rejected",c="update_enterprise_invite";return{init:function(){t=e.getService("ajax"),n=e.getService("nav"),r=e.getService("notifications-amsterdam"),i=e.getService("popups-amsterdam"),this.showPendingCollabNotification(),this.showAutoAcceptedCollabNotification(),this.showExpiringCollabNotification(),this.showCollabLinkErrorNotification(),this.showEnterpriseInvitePopup()},showPendingCollabNotification:function(){e.getConfig("showPendingCollabNotification")&&r.default($t("You have pending invitations to collaborate.","files_page_pending_collab_notification"),{buttonText:$t("See Invitations","files_page_pending_collab_notification_button_text"),duration:-1}).then(function(){n.navigate("/notifications/pending-invites")},function(){t.post(o)})},showAutoAcceptedCollabNotification:function(){e.getConfig("showAutoAcceptedCollabNotification")&&r.default($t("You have accepted collaboration invites on folders.","files_page_auto_accepted_collab_notification"),{buttonText:$t("View Messages","files_page_auto_accepted_collab_notification_button_text"),duration:1e4}).then(function(){t.post(o).then(function(){n.navigate("/notifications/accepted-invites")})}).catch(function(){t.post(o)})},showExpiringCollabNotification:function(){var n=e.getConfig("expiringCollabNotificationInfo");n&&r.default($t("You have been granted temporary access to this folder. You will be automatically removed from this folder on %1","initial_text_access",n.expiration)).catch(function(){t.post(a,{collabID:n.collabID})})},showCollabLinkErrorNotification:function(){e.getConfig("showCollabLinkErrorNotification")&&r.error($t("Folder invitation links are no longer supported. Please contact the folder owner to get access to this folder.","collab_by_link_no_longer_supported_amsterdam"))},showEnterpriseInvitePopup:function(){var t=e.getConfig("enterpriseInviteData");if(t){var n=t.enterpriseInviteID;i.confirm($t("You've been invited to join %1 on Box. By accepting, you will be giving this enterprise access to your account. We recommend creating a personal Box account for any personal files you have stored on Box.","enterprise_invite_popup_message",t.enterpriseName),$t("Join Enterprise","join_enterprise_popup_title"),{confirmText:$t("Accept","accept_enterprise_invite"),cancelText:$t("Reject","reject_enterprise_invite")}).then(function(){this.updateEnterpriseInvite(n,s)}.bind(this)).catch(function(){this.updateEnterpriseInvite(n,l)}.bind(this))}},updateEnterpriseInvite:function(e,i){t.post(c,{enterpriseInviteID:e,status:i}).then(function(){i===s?n.reload(!0):n.refresh()}).catch(function(){r.error($t("There was a problem updating the enterprise invite. Please refresh the page and try again or contact the administrator.","enterprise_invite_error_message"))})}}}),Box.Application.addModule("folder-settings-page",function(e){"use strict";function t(e,t,n){null!==t&&(e.checked=t),null!==n&&(e.disabled=n)}function n(e,t){t?p.removeClass(e,F):p.addClass(e,F)}function r(e,t){t?e.setAttribute("data-tooltip",""):e.removeAttribute("data-tooltip")}function i(){var e=v.getAttribute("data-error");if(e){var t=g.pathname;switch(m.replace(t),e){case L:h.error(W);break;case U:h.error(G);break;case j:h.error(K);break;case q:h.error(V);break;default:h.error(z)}}}function o(e){var n,r,i,o;C&&t(C,!1,e);for(var a=0;a<T;a++)n="1"===x[a].getAttribute("data-default"),r="1"===x[a].getAttribute("data-disabled"),i=!r&&n,o=e||r,t(x[a],i,o)}function a(e){for(var n,r,i=0;i<T;i++)n="1"===x[i].getAttribute("data-disabled"),r=e||n,t(x[i],!1,r)}function s(e){var n="1"===A.getAttribute("data-default"),r="1"===A.getAttribute("data-disabled"),i=e||n,o=e||r;t(A,i,o)}function l(e,t,n){return function(){p.removeClass(e,B),p.query("input",e).checked=t,h.error(n)}}function c(e){var t=p.query('input[name="item-typed-id"]').value,r=p.query(".allow-folder-email-upload"),i=p.query(".email-upload-subsection"),o=p.query("input",i),a=l(r,!e,$);d.post("folder_settings_email_upload_post",{"item-typed-id":t,"allow-email-upload":e}).then(function(e){o.value=e.data.folder_info.folder_email_address,p.removeClass(r,B),n(i,e.data.folder_info.folder_email_active),h.info(H)},a).caught(a),p.addClass(r,B)}function u(){return w.checked&&!E.value?(N.setError(J),h.error(J),!1):O.checked&&!P.value?(R.setError(X),h.error(X),!1):!(O.checked&&w.checked&&P.value>E.value)||(N.setError(G),R.setError(G),h.error(G),!1)}var d,f,p,m,h,g,v,y,b,_,w,S,k,E,C,x,T,A,I,O,D,M,P,N,R,F="hidden",B="is-loading",q="expirations",L="permissions",j="parent_before_child",U="unshare_after_delete",H=$t("Your folder's email upload setting was successfully updated.","folder_settings_email_upload_update_success"),$=$t("Sorry, error changing your email upload settings. Please try again later.","folder_settings_email_upload_error"),V=$t("Sorry, there was a problem saving the expirations for this folder.","folder_settings_error_expirations_default"),W=$t("Sorry, you don't have the permissions necessary to set expirations on this folder.","folder_settings_error_expirations_permissions"),K=$t("Auto deletion date must occur on or before that of this folder's parent.","folder_settings_error_parent"),z=$t("Sorry, there was problem saving the settings for this folder.","folder_settings_error_properties"),G=$t("Unshare expiration must happen on or before the delete expiration date.","folder_settings_error_unshare_after_delete"),X=($t("Your folder's collaboration invite link setting was successfully updated.","folder_settings_collab_invite_link_update_success"),$t("Sorry, there was a problem saving your collab invitation preferences. Please try again later.","folder_settings_collab_invite_enable_error"),$t("Please set an un-share date.","folder_settings_unshare_empty_error")),J=$t("Please set an auto-delete date.","folder_settings_delete_empty_error");return{behaviors:["form-dirty-confirm","readonly-select","resin-target-toggle","text-clipboard","tooltips-amsterdam"],init:function(){d=e.getService("ajax"),f=e.getService("datepicker"),p=e.getService("dom"),m=e.getService("nav"),h=e.getService("notifications-amsterdam"),g=e.getGlobal("location"),v=e.getElement(),y=p.query('input[name="allow-collab-from-shared-link"]'),b=p.getNearest(y,".checkbox-tooltip-wrapper"),_=p.query('select[name="allow-collab-from-shared-link-role"]'),w=p.query('input[name="delete-expiration-enable"]'),S=p.query(".delete-expiration-wrapper"),k=p.query(".datepicker",S),E=p.query('input[name="delete-expiration-val"]'),N=f.create(k),C=p.query('input[name="email-notifications-disable"]'),x=p.queryAll(".email-notifications-setting"),T=x.length,A=p.query('input[name="restrict-collab-invites-to-owners-coowners"]'),I=p.query('select[name="restrict-shared-links-collabs-only-item-type"]'),O=p.query('input[name="unshare-expiration-enable"]'),D=p.query(".unshare-expiration-wrapper"),M=p.query(".datepicker",D),P=p.query('input[name="unshare-expiration-val"]'),R=f.create(M),i()},onchange:function(e,i,l){if(i&&l){var u=i.checked;switch(l){case"hide-collaborators":s(u);break;case"allow-collab-from-shared-link":t(_,null,!u);break;case"restrict-shared-links-collabs-only":t(I,null,!u),t(y,!1,u),t(_,null,!0),r(b,u);break;case"email-notifications-disable":a(u);break;case"allow-folder-email-upload":c(u);break;case"delete-expiration-enable":n(S,u);break;case"unshare-expiration-enable":n(D,u);break;case"use-custom-notifications":var d="true"!==i.value;o(d);break;default:return}}},onsubmit:function(t){u()||t.preventDefault(),e.broadcast("formwillnativesubmit")}}}),Box.Application.addModule("folder-tree-flyout",function(e){"use strict";var t,n,r,i,o="d_0",a="/folder/";return{behaviors:["flyout-toggle","tooltips-amsterdam"],init:function(){t=e.getService("folder-tree"),n=e.getService("nav"),r=e.getService("page-events");var s=e.getElement();r.getAfterPageLoadPromise().then(function(){i=t.create(s,o),i.events.on("click",function(e){n.navigate(a+e.data.substr(2),!0)})})},destroy:function(){i&&i.destroy()}}}),Box.Application.addModule("collab-share-sidebar",function(e){"use strict";function t(){o.addClass(u,"is-loading")}function n(){o.removeClass(u,"is-loading")}function r(){t();var e=c.getGcmCompatibleRm(f),r={itemTypedID:d};i.get(e,r).then(function(e){n(),o.setHTML(u,e.data.html)},function(e){var t=e.data||{},r=$t("There was a problem loading the sidebar. Try refreshing the page.","collab_sharing_sidebar_refresh_error");n(),"itemNotFound"===t.code&&(r=t.message),s.error(r)})}var i,o,a,s,l,c,u,d,f="get_collab_share_sidebar";return{behaviors:["collab-invite","contextual-messages-registration","flyout-toggle","menu-toggle-eu","collab-menu-remove","collab-menu-resend-invite","collab-role-menu","item-collab-extend-access","readonly-select","share-access-menu-amsterdam","text-clipboard","tooltips-amsterdam"],messages:["collabchanged","collabchangeinitiated","collabchangecanceled","collabremoveerror","collabrequestsent","collabresponsereceived","sharedlinkchanged","sharedlinkremoved"],init:function(){i=e.getService("ajax"),o=e.getService("dom"),a=e.getService("item-actions"),s=e.getService("notifications-amsterdam"),l=e.getService("resin"),c=e.getService("url"),u=e.getElement(),d=u.getAttribute("data-item-typed-id"),this.addCopyLinkEventListener()},addCopyLinkEventListener:function(){var e=o.query(".share-sidebar-link-input",u);o.on(e,"copy",function(){l.recordActionFromElement(e,{target:"copysharedlink",action:"keypress"})})},onmessage:function(e){switch(e){case"collabchanged":case"sharedlinkchanged":case"sharedlinkremoved":this.refresh();break;case"collabrequestsent":case"collabchangeinitiated":case"sharedlinkchangeinitiated":t();break;case"collabresponsereceived":case"collabchangecanceled":case"collabremoveerror":case"sharedlinkchangeerror":n()}},onclick:function(e,t,n){if(t&&n)switch(n){case"share-btn":a.share(d);break;case"share-settings-btn":a.openSharedLinkSettingsPopup(d)}},refresh:r}}),Box.Application.addModule("header-amsterdam",function(e){"use strict";var t,n,r,i,o,a;return{behaviors:["menu-toggle-eu","custom-avatar","header-search","header-left-nav-toggle","header-sidebar-toggle","image-loader","search-metadata","tabs","tooltips-amsterdam","ajax-nav","confirm-end-trial","header-search-instrumentation"],messages:["copyfailure","copystart","copysuccess","fileopdeletefailure","fileopdeletestart","fileopdeletesuccess","movefailure","movestart","movestop","movesuccess","navigationstart","navigationend"],init:function(){t=e.getService("dom"),n=e.getService("progress-bar"),r=e.getElement(),i=t.query(".progress-bar-mount-node",r),o=n.create(i)},destroy:function(){o.unmount()},onmessage:function(e){switch(e){case"copystart":case"fileopdeletestart":case"movestart":case"navigationstart":i.style.opacity=1;var t=20*Math.random()+10;o.updateProgress(t),a=setInterval(function(){return t>=90?void clearInterval(a):(t+=5*Math.random(),void o.updateProgress(t))},100);break;case"copysuccess":case"fileopdeletesuccess":case"movesuccess":case"navigationend":i.style.opacity=0,clearInterval(a),o.finish();break;case"copyfailure":case"fileopdeletefailure":case"movefailure":case"movestop":i.style.opacity=0,clearInterval(a),o.updateProgress(0)}}}}),Box.Application.addModule("item-collab-action-bar",function(e){"use strict";var t,n="collab_mail_all_popup";return{behaviors:["collab-invite","inline-search"],init:function(){t=e.getService("popups-amsterdam")},onclick:function(e,t,n){var r;"mail-all-btn"===n&&(r=t.getAttribute("data-item-typed-id"),this.showMailAllPopup(r),e.preventDefault(),e.stopPropagation())},showMailAllPopup:function(e){t.open(n,{data:{itemTypedId:e}})}}}),Box.Application.addModule("item-collab-list",function(e){"use strict";function t(){r.addClass(o,s)}function n(){r.removeClass(o,s)}var r,i,o,a,s="is-loading",l="is-tbl-search-visible";return{behaviors:["menu-toggle","flyout-toggle","collab-menu-remove","collab-menu-resend-invite","collab-role-menu","item-collab-extend-access","item-collab-search","overflow-scroll-detection"],messages:["collabrequestsent","collabresponsereceived","itemcollabsearchstart","itemcollabsearchend","collabchanged"],init:function(){r=e.getService("dom"),i=e.getService("nav"),o=e.getElement(),a=r.query(".item-collaborators-page")},onmessage:function(e){switch(e){case"collabrequestsent":case"itemcollabsearchstart":t();break;case"collabresponsereceived":case"itemcollabsearchend":n();break;case"collabchanged":r.hasClass(a,l)||i.refresh()}}}}),Box.Application.addModule("iwork-enable-online-preview",function(e){"use strict";function t(){s.addClass(u,p),s.addClass(u,m),u.disabled=!0}function n(){u.disabled=!1,s.removeClass(u,m),s.removeClass(u,p)}var r,i,o,a,s,l,c,u,d="enable_iwork_online_preview_runmode",f="iwork",p="is-loading",m="is-disabled";return{init:function(){r=e.getService("popups-amsterdam"),i=e.getService("ajax"),o=e.getService("nav"),a=e.getService("logger"),s=e.getService("dom"),l=e.getService("notifications-amsterdam"),c=e.getElement(),u=s.query(".enable-online-preview-btn",c)},onclick:function(e,s,c){if(s&&c&&!s.disabled)switch(c){case"iwork-enable-online-preview-decline":a.sendLog(f,"iwork_enable_online_preview_declined");break;case"iwork-enable-online-preview-accept":t(),i.post(d).then(function(){n(),r.close(),a.sendLog(f,"iwork_enable_online_preview_accepted_success"),o.reload(!0)}).catch(function(){n(),r.close(),a.sendLog(f,"iwork_enable_online_preview_accepted_failure");var e=$t("Error while enabling iWork online preview","iwork_failure_to_enable_online_previews");l.error(e)})}}}}),Box.Application.addModule("left-nav",function(e){"use strict";function t(e,t){return 0===e.indexOf(t)}function n(e){return function(){l.location.href=e}}var r,i,o,a={"/files/favorites":".favorites","/folders/sync":".sync","/recommendations":".recommendations","/recents":".recents","/trash":".trash","/updates":".activity","/notifications":".notifications","/contacts":".collabs","/master":".enterprise-admin","/file":".files","/folder":".files"},s="is-selected",l=e.getGlobal("window");return{messages:["navigationend"],behaviors:["left-nav-unread-notifications-badge","tooltips-amsterdam","header-ibm-orion-app-launcher"],init:function(){r=e.getElement(),i=e.getService("dom"),o=e.getService("keyboard-shortcuts");var t=[{key:"shift+g shift+a",description:$t("Go to All Files page","kb_shortcuts_left_nav_all_files_page"),handler:n("/folder/0"),type:"navigation"},{key:"shift+g shift+f",description:$t("Go to Favorites page","kb_shortcuts_left_nav_favorites_page"),handler:n("/files/favorites"),type:"navigation"},{key:"shift+g shift+m",description:$t("Go to Messages page","kb_shortcuts_left_nav_messages_page"),handler:n("/notifications/unread"),type:"navigation"},{key:"shift+g shift+c",description:$t("Go to Collaborators page","kb_shortcuts_left_nav_collaborators_page"),handler:n("/contacts"),type:"navigation"}],a=e.getConfig("isSyncEnabled");a&&t.push({key:"shift+g shift+s",description:$t("Go to Synced page","kb_shortcuts_left_nav_sync_page"),handler:n("/folders/sync/0"),type:"navigation"});var s=e.getConfig("isTrashEnabled");s&&t.push({key:"shift+g shift+t",description:$t("Go to Trash page","kb_shortcuts_left_nav_trash_page"),handler:n("/trash"),type:"navigation"}),o.register({name:"left-nav",shortcuts:t},r),this.updateSelectedNavLink()},destroy:function(){o.deregister("left-nav",r)},onmessage:function(e){"navigationend"===e&&this.updateSelectedNavLink()},updateSelectedNavLink:function(){for(var e,n=i.query("."+s,r),o=l.location.pathname,c=null,u=Object.keys(a),d=0,f=u.length;d<f;d++)if(e=u[d],t(o,e)){c=i.query(a[e],r);break}c!==n&&(n&&i.removeClass(n,s),c&&i.addClass(c,s))}}}),Box.Application.addModule("custom-metadata-add-attribute-popup",function(e){"use strict";function t(t){var n=i.createFragmentFromHtml(t),r=n.querySelector(".metadata-field");e.broadcast("custommetadatafieldadded",{fieldEl:r})}function n(){var e={name:"metadata-unique-key",shouldValidate:function(e,t,n){return e.hasValidatorAttribute(n,"metadata-unique-key")},validate:function(e,t,n){var r=n.getAttribute("data-existing-attributes");return r=JSON.parse(r),r.indexOf(n.value.trim())===-1||(e.setCustomValidity(n,$t("An attribute with that key already exists.","custom_metadata_unique_key_error")),!1)}};o.addValidationRule(e)}var r,i,o,a,s,l="custom_metadata_add_attribute",c="metadata_instance_limit_exceeded";return{behaviors:["form-submit-loading-state","form-validation","tooltips-amsterdam"],messages:["formvalidationsuccess"],init:function(){r=e.getService("ajax"),i=e.getService("dom"),o=e.getService("form-validator"),a=e.getService("notifications-amsterdam"),s=e.getService("popups-amsterdam"),this.addUniqueKeyValidationRule()},addUniqueKeyValidationRule:n,onmessage:function(e,t){"formvalidationsuccess"===e&&this.addAttribute(t.formData)},addAttribute:function(n){r.post(l,n).then(function(e){t(e.data.html),a.info($t("Attribute added successfully.","custom_metadata_attribute_added_successfully")),s.close()}).catch(function(t){t.data&&t.data.code===c?a.error(t.data.message):a.error($t("There was an error adding an attribute to this item.","custom_metadata_error_adding_attribute")),e.broadcast("formsubmitdone")})}}}),Box.Application.addModule("preview-metadata-sidebar",function(){"use strict";return{behaviors:["form-dirty-confirm","menu-toggle-eu","metadata-editor-tabs","metadata-field-editor"]}}),Box.Application.addModule("notifications-page-action-bar",function(e){"use strict";function t(){if(a.getAttribute("data-filter-type")===l)return void i.refresh();var e=r.queryAll(".notification-list .notifications-item");e.forEach(function(e){r.addClass(e,s)})}var n,r,i,o,a,s="is-read",l="unread",c=!1;return{init:function(){n=e.getService("ajax"),r=e.getService("dom"),i=e.getService("nav"),o=e.getService("notifications-amsterdam"),a=e.getElement()},onclick:function(e,t,n){"mark-all-as-read"===n&&this.markAllAsRead()},markAllAsRead:function(){var r=a.getAttribute("data-filter-type");c||(c=!0,n.post("notifications_page_mark_all_notifications_as_read",{filterType:r}).then(function(n){c=!1,e.broadcast("notification-unread-count-update",n.data),o.info($t("All notifications have been marked as read.","notification_mark_all_as_read_success"),{duration:1e3}).then(t,t)},function(){o.error($t("There was a problem marking all notifications as read. Please try again or refresh the page.","notification_mark_all_as_read_error")),c=!1}))}}}),Box.Application.addModule("notifications-page",function(e){"use strict";function t(e){return e.parentNode.children.length>1?void e.parentNode.removeChild(e):void i.refresh()}var n,r,i,o,a,s="is-read",l="A",c="BUTTON",u={incoming_task_assignment:"incomplete-tasks",outgoing_task_assignment:"sent-tasks",at_mention:"at-mentions",incoming_collab:"pending-invites",expiration:"expirations"},d="unread",f=0;return{behaviors:["notifications-page-invite","notifications-page-sent-task","notifications-page-task"],messages:["notificationlistupdate"],init:function(){n=e.getService("ajax"),r=e.getService("dom"),i=e.getService("nav"),o=e.getService("notifications-amsterdam"),a=e.getElement()},onclick:function(e,t,n){if(t=t||e.target){var i=r.getNearest(t,".notifications-item");return"mark-unread-btn"===n?void this.markAsUnread(i):void(r.hasClass(i,s)||"notification-filter-badge"===n||t.nodeName!==l&&t.nodeName!==c||this.markAsRead(i,n));
}},onmessage:function(e,n){if("notificationlistupdate"===e&&n.notificationEl instanceof HTMLElement){var r=n.notificationEl,i=r.getAttribute("data-notification-type"),o=u[i];o===a.getAttribute("data-filter")&&t(r)}},markAsRead:function(i,l){var c=i.getAttribute("data-notification-type"),u=i.getAttribute("data-notification-id");n.post("notifications_page_mark_notification_as_read",{notificationType:c,notificationId:u}).then(function(){return e.broadcast("notification-unread-count-decrement"),"mark-read-btn"===l&&a.getAttribute("data-filter")===d?void t(i):void r.addClass(i,s)}).catch(function(e){e&&e.status===f||o.error($t("There was a problem marking the notification as read. Please try again or refresh the page.","notification_mark_as_read_error"))})},markAsUnread:function(t){var i=t.getAttribute("data-notification-type"),a=t.getAttribute("data-notification-id");n.post("notifications_page_mark_notification_as_unread",{notification_type:i,notification_id:a}).then(function(){r.removeClass(t,s),e.broadcast("notification-unread-count-increment")}).catch(function(){o.error($t("There was a problem marking the notification as unread. Please try again or refresh the page.","notification_mark_as_unread_error"))})}}}),Box.Application.addModule("popup-upgrade",function(e){"use strict";var t,n;return{init:function(){t=e.getService("popups-amsterdam"),n=e.getService("url");var r=e.getElement(),i=r.getAttribute("data-resin-page"),o=e.getService("logger");o.sendLog("user_event","DISPLAY_UPGRADE_POPUP_"+i)},onclick:function(e,r,i){"paywall-upgrade-btn"===i&&(t.close({unsafeSkipRefresh:!0}),n.openWindow("/upgrade/up"))}}}),Box.Application.addModule("page-amsterdam",function(e){"use strict";var t,n,r,i=4e3;return{messages:["navigationend"],behaviors:["ajax-nav","file-list-external-drag","image-loader","menu-toggle-eu","overflow-scroll-detection","sticky-sidebar-scroll","tooltips-amsterdam","embed-widget"],init:function(){r=e.getElement(),e.getService("resin"),e.hasService("page-events")&&e.hasService("realtime-events")&&(t=e.getService("page-events"),n=e.getService("realtime-events"),t.getAfterPageLoadPromise().then(function(){setTimeout(function(){n.subscribe()},i)}))},destroy:function(){n&&n.unsubscribe()},onmessage:function(e){"navigationend"===e&&(r.scrollTop=0)}}}),Box.Application.addModule("popup-invite-collaborators",function(e){"use strict";function t(){c.addClass(b,C),c.addClass(b,x),b.disabled=!0}function n(){b.disabled=!1,c.removeClass(b,x),c.removeClass(b,C)}function r(){if(y=h.getAttribute("data-typed-id")){var e=c.query(".invite-selector-input",h),t=l.searchAllContactsExcludingItemCollaborators(y,{includeSelf:!1,includeGroups:!0});v=d.create(e,t),v.init()}}function i(){var e=w.value;if(e){var t=v.createDataArrayFromString(e);t.length?(v.removeAllErrors(),v.insertArrayOfPills(t)):v.displayError(O)}}function o(e){var t={tooltipRelative:".popup-wrapper"};v.displayError(e,t),c.hasClass(_,E)||(c.addClass(_,E),f.resize())}function a(){var e=c.queryAll(".pill",g);Array.prototype.forEach.call(e,function(e){e.setAttribute("aria-invalid",!0),c.addClass(e,T)})}var s,l,c,u,d,f,p,m,h,g,v,y,b,_,w,S=13,k=2500,E="inline-alert-visible",C="is-loading",x="is-disabled",T="is-invalid",A="box_collaborate_invite_amsterdam",I="Editor",O=$t("Please enter a valid email address.","popup_invite_collaborators_error_notification");return{behaviors:["menu-toggle","permissions-matrix-flyout","tooltips-amsterdam"],init:function(){h=e.getElement(),s=e.getService("ajax"),l=e.getService("provider-contacts"),c=e.getService("dom"),u=e.getService("notifications-amsterdam"),d=e.getService("pill-selector"),f=e.getService("popups-amsterdam"),p=e.getService("strings"),m=e.getService("url"),b=c.query('.btn[data-type="collab-popup-submit"]',h),g=c.query(".pill-selector",h),_=c.query(".inline-alert",h),r(),w=c.query(".pill-selector-input",h),c.on(w,"paste",this.pasteEventHandler)},sendEmailInvites:function(){var r=c.query(".personal-message-wrapper textarea"),i=r?r.value:"",o=c.query(".invite-permission-type .select"),l=o?o.value:I,d=v.getPillIDsByType(),p=this,g=m.getGcmCompatibleRm(A),b={email:d.defaultIDs.join(","),groupIds:d.groupIDs.join(","),emailMessage:i,nodeId:y,notify:1,permissions:l};t(),s.post(g,b).then(function(t){if(n(),t.code)return void p.showInviteError(t.message,{duration:k});var r=t.data.message;if("warning"===r.type){var i=r.title.error,o=r.title.success+r.description,s=t.data.invited_users;return v.deletePills(s),a(),p.showInviteError(i),void u.confirm(o)}if("error"===r.type&&""!==r.title.error)return p.showInviteError(r.title.error),void a();if("success"===r.type&&""!==r.title.success){var l=r.title.success+r.description;u.confirm(l)}e.broadcast("collabchanged",{itemTypedID:y}),f.close({unsafeSkipRefresh:!0})},function(e){var t,r=e.data||{};n(),t=r.message?r.message:$t("Something went wrong with your request. Please try again.","invite_popup_send_invites_error_message"),u.error(t,{duration:k});var i;r.invalidEmails&&r.invalidEmails.forEach(function(e){i=c.query('[data-id="'+e+'"]',h),c.addClass(i,T),i.setAttribute("aria-invalid",!0)})})},onkeydown:function(e,t,n){if("email-invite-input"===n){var r=e.which||e.keyCode;r===S&&(i(),e.stopPropagation(),e.preventDefault())}},onclick:function(e,t,n){"collab-popup-submit"!==n||t.disabled||(this.validateAndSubmit(),e.preventDefault(),e.stopPropagation())},pasteEventHandler:function(){setTimeout(function(){i()},0)},validateAndSubmit:function(){var e,t;i(),e=v.getPills(),e.length>0?v.validatePills(this.isPillValid)?this.sendEmailInvites():(t=$t("One or more of the email addresses is invalid.","atleast_one_invalid_email_invite_collab_popup"),this.showInviteError(t)):(t=$t("Please enter at least one email address.","collab_popup_atleast_one_email_error"),this.showInviteError(t))},isPillValid:function(e){return p.isEmail(e.id)||!!e.data&&"group"===e.data.type},onsubmit:function(e,t,n){"popup-collab-form"===n&&(e.stopPropagation(),e.preventDefault())},showInviteError:o}}),Box.Application.addModule("popup-mail-all-collaborators",function(e){"use strict";function t(){var e=i.query(".send-btn",c);i.addClass(e,d),i.addClass(e,f),e.disabled=!0}function n(e){var n={itemTypedId:c.getAttribute("data-item-typed-id"),message:e};t(),r.post(u,n).then(function(e){s.close({unsafeSkipRefresh:!0}),a.info(e.data.message)},function(e){var t,n=e.data||{};switch(s.close(),n.code){case"invalidEmails":a.warn(n.message);break;case"itemNotFound":case"noCollabs":a.error(n.message);break;case"collaboratorsMailAllLimitExceeded":a.error(n.message);break;default:t=$t("There was a problem sending your message to collaborators. Please refresh the page and try again.","collab_mail_all_failure_try_again"),a.error(t)}})}var r,i,o,a,s,l,c,u="mail_all_collabs",d="is-loading",f="is-disabled";return{behaviors:["tooltips-amsterdam"],init:function(){r=e.getService("ajax"),i=e.getService("dom"),o=e.getService("form-validator"),a=e.getService("notifications-amsterdam"),s=e.getService("popups-amsterdam"),l=e.getService("strings"),c=e.getElement(),o.initForm(c)},onclick:function(e,t,n){"send-btn"!==n||t.disabled||(this.validateAndSubmitMessageForm(),e.preventDefault(),e.stopPropagation())},validateAndSubmitMessageForm:function(){var e=i.query(".mail-all-message",c),t=l.trim(e.value);if(!t){var r=$t("Please enter a message.","mail_all_collab_error_enter_message");return void o.setCustomError(e,r)}n(t)}}}),Box.Application.addModule("popup-share-link",function(e){"use strict";function t(){return O||(O=e.getConfig(D)?"top":""),O}function n(){v.addClass(C,$),v.addClass(C,H)}function r(){v.removeClass(C,H),v.removeClass(C,$)}function i(){v.addClass(T,H),v.addClass(T,$),T.disabled=!0}function o(){T.disabled=!1,v.removeClass(T,$),v.removeClass(T,H)}function a(){setTimeout(function(){C.select()},0)}function s(){var e=v.query(".contact-selector-input",x),t=g.searchAllContacts({includeSelf:!0,includeGroups:!1});A=b.create(e,t),A.init()}function l(e){var t,n,r=e.length,i=[],o=[];for(t=0;t<r;t++)n=e[t].id,S.isEmail(n)?i.push(n):o.push(n);return{validEmails:i,invalidEmails:o}}function c(e){if(!e||!e.length)return"";var t,n=e.length,r=[],i=e[0].item_name;for(t=0;t<n;t++)r.push(e[t].email);return $t("The link to %1 was sent to %2.","share_link_popup_success_message",i,r.join(", "))}function u(e,t){if(!e||!e.length)return t.length?$t("The link was not sent to the following invalid email(s): %1.","share_link_popup_invalid_emails",t.join(", ")):"";var n,r,i,o=e.length,a=[],s=0,l="",c=e[0].item_name,u=!1;for(n=0;n<o;n++)r=e[n],a.push(r.email),s=Math.max(s,r.access),r.hasOwnProperty("reason")&&r.reason===q&&(u=!0);switch(u&&0===s&&(s=L),i=a.join(", "),s){case F:l=t.length?$t("The link to %1 was not sent to %2 because at least one user is not a user in the folder owner's enterprise. The link was also not sent to the following invalid email(s): %3.","share_link_popup_send_link_not_in_enterprise_failure_with_invalid_emails",c,i,t.join(", ")):$t("The link to %1 was not sent to %2 because at least one user is not a user in the folder owner's enterprise.","share_link_popup_send_link_not_in_enterprise_failure",c,i);break;case B:l=t.length?$t("The link to %1 was not sent to %2 because at least one user is not a collaborator in this folder. The link was also not sent to the following invalid email(s): %3.","share_link_popup_send_link_not_in_folder_failure_with_invalid_emails",c,i,t.join(", ")):$t("The link to %1 was not sent to %2 because at least one user is not a collaborator in this folder.","share_link_popup_send_link_not_in_folder_failure",c,i);break;case L:l=$t("Sorry, the link to %1 could not be sent at this time. Please try again later.","share_link_popup_send_link_rate_limiter_failure",c);break;default:l=t.length?$t("Sorry, there was an error and the link to %1 was not sent to %2. Please try again. The link was also not sent to the following invalid email(s): %3.","share_link_popup_send_link_generic_failure_with_invalid_emails",c,i,t.join(", ")):$t("Sorry, there was an error and the link to %1 was not sent to %2. Please try again.","share_link_popup_send_link_generic_failure",c,i)}return l}function d(e,t){var n=c(e.successful_emails_items),r=u(e.failed_emails_items,t);n&&r?y.warn(n+" "+r):r?y.error(r):n&&y.info(n)}function f(t,n,r){var a=k.getGcmCompatibleRm(P),s={itemTypedId:t,emails:n.validEmails,message:r};i(),h.post(a,s).then(function(t){e.broadcast("sharedlinkemailsent"),_.close({unsafeSkipRefresh:!0}),d(t.data,n.invalidEmails)}).catch(function(){o();var e=$t("There was a problem emailing the link. Please try again or refresh the page.","email_share_link_error_message");_.alert(e)})}function p(){v.on(C,"copy",function(){w.recordActionFromElement(C,{target:"copysharedlink",action:"click",data:{item_id:I,custom_url:C.value}})})}function m(){var t=e.getService("contextual-tooltips");t.repositionCurrentTip()}var h,g,v,y,b,_,w,S,k,E,C,x,T,A,I,O,D="isEmbedWidget",M="isNewSharedLink",P="email_share_link",N="item_share_link_popup_access_details",R="item_share_settings",F=1,B=2,q="rate_limiter",L=11,j=$t("Please enter a valid email address.","popup_share_link_error_notification"),U=13,H="is-loading",$="is-disabled",V=".popup-wrapper";return{behaviors:["menu-toggle","share-access-menu-amsterdam","text-clipboard","tooltips-amsterdam"],messages:["sharedlinkchanged","sharedlinkremoved"],init:function(){h=e.getService("ajax"),g=e.getService("provider-contacts"),v=e.getService("dom"),y=e.getService("notifications-amsterdam"),b=e.getService("pill-selector"),_=e.getService("popups-amsterdam"),w=e.getService("resin"),S=e.getService("strings"),k=e.getService("url"),x=e.getElement(),C=v.query(".share-link-input",x),I=x.getAttribute("data-item-typed-id"),p(),a(),s(),E=v.query(".pill-selector-input",x),T=v.query('.btn[data-type="send-btn"]',x),e.getConfig(M)&&setTimeout(function(){e.broadcast("sharedlinkchanged")},0)},destroy:function(){v.off(C,"copy")},onclick:function(e,t,n){if(t&&!t.disabled){switch(n){case"share-link-input":this.focusAndSelectText(t);break;case"send-btn":var r=t.getAttribute("data-item-typed-id");this.emailShareLink(r);break;case"share-settings-btn":this.openSharedLinkSettingsPopup();break;default:return}e.preventDefault(),e.stopPropagation()}},onfocusin:function(e,t,n){var r=v.query(".email-fieldset",x);"contact-selector-input"!==n||v.hasClass(r,"is-email-expanded")||v.addClass(r,"is-email-expanded",m)},onmessage:function(e,t){switch(e){case"sharedlinkchanged":if(!t)return;this.updateShareLinkAccessDetailsHTML(t.itemTypedId);break;case"sharedlinkremoved":_.close({unsafeSkipRefresh:!0})}},onkeydown:function(n,r,i){var o=n.which||n.keyCode;if(o===U&&"contact-selector-input"===i){var a=v.query(".pill-selector-input",x).value,s=A.createDataArrayFromString(a);s.length?(A.removeAllErrors(),A.insertArrayOfPills(s),e.broadcast("sharelinkvalidemailentered")):A.displayError(j,{tooltipPosition:t()}),n.preventDefault(),n.stopPropagation()}},focusAndSelectText:function(e){e.focus(),e.select()},openSharedLinkSettingsPopup:function(){_.close({unsafeSkipRefresh:!0});var e=x.getAttribute("data-item-typed-id"),t=k.getGcmCompatibleRm(R);_.open(t,{data:{itemTypedId:e,openBasicSettingsOnClose:!0}})},emailShareLink:function(e){var n,r,i,o,a=A.createDataArrayFromString(E.value);A.insertArrayOfPills(a),o=A.getPills(),n=l(o),n.validEmails.length?(A.removeAllErrors(),i=v.query(".message-textarea",x).value,f(e,n,i)):(r=$t("Enter at least one valid email","share_properties_popup_no_emails"),A.displayError(r,{tooltipPosition:t(),tooltipRelative:V}))},updateShareLinkAccessDetailsHTML:function(t){var i=k.getGcmCompatibleRm(N),o={itemTypedId:t};n(),h.get(i,o).then(function(e){r();var t=v.query(".share-link-access-details",x);v.setHTML(t,e.data.html);var n=v.query('[data-type="menu-toggle-button"]',t);n&&n.focus()}).catch(function(){_.close({unsafeSkipRefresh:!0});var n=e.getService("item-actions");n.share(t)})}}}),Box.Application.addModule("popup-share-settings",function(e){"use strict";function t(e){e?(k.removeClass(_,M),_.removeAttribute("disabled")):(k.addClass(_,M),_.setAttribute("disabled","disabled"))}function n(e,t){T.hideAll(),e.checked&&k.hasClass(t,D)?k.removeClass(t,D):e.checked||k.hasClass(t,D)||k.addClass(t,D)}function r(e,t){k.hasClass(e,"tooltip-active")&&k.hasClass(e,"is-invalid")||(k.hasClass(e,"datepicker")?S.setError(t):E.setCustomError(e,t),O&&e.setAttribute("data-tooltip-position",O),e.setAttribute("data-tooltip-relative",N),T.show(e,{}))}function i(t){var n;C.close({unsafeSkipRefresh:!0}),t||e.broadcast("sharedlinkchanged",{itemTypedId:A,context:"popup"}),e.getConfig("openBasicSettingsOnClose")&&(n=e.getService("item-actions"),n.share(A))}function o(){var e={name:"SharedCustomURLRule",shouldValidate:function(e,t,n){return e.hasValidatorAttribute(n,"popup-share-settings-customurl")&&""!==n.value&&!n.disabled},validate:function(e,t,n){var i=n.value,o=i.length>=F&&i.length<=B&&q.test(i);return o||r(n,$t("There's a problem with the Custom URL you specified. It should be between 3 and 30 characters. You can use letters, numbers, and hyphens. And it can't contain special reserved words.","vanity_name_invalid_rec")),o}},t={name:"CustomPasswordValidationRule",shouldValidate:function(e,t,n){return e.hasValidatorAttribute(n,"popup-share-settings-password")&&!n.disabled},validate:function(e,t,n){var i="",o=!0,a=n.value;return 0===a.length&&(i=$t("You must enter a password.","password_must_be_entered_when_required"),o=!1),o||r(n,i),o}};E.addValidationRule(e),E.addValidationRule(t)}function a(){T.hideAll();var e=E.checkValidity(d);return v.checked&&!g.value?(S.setError($t("Please select a date.","date_required_error")),e=!1):S.removeError(),t(e),e}function s(e){n(e,b),C.resize(),e.checked?b.setAttribute("data-validator","popup-share-settings-password"):(b.value="",b.removeAttribute("data-validator"),a())}function l(e){n(e,g),C.resize(),e.checked||(a(),g.value="")}function c(e){n(e,h),C.resize()}var u,d,f,p,m,h,g,v,y,b,_,w,S,k,E,C,x,T,A,I,O,D="hidden",M="is-disabled",P="is-loading",N=".popup-wrapper",R="isEmbedWidget",F=3,B=30,q=/^[a-z0-9-]+$/i,L="update_share_settings",j=300;return{behaviors:["text-clipboard","tooltips-amsterdam"],init:function(){d=e.getElement(),A=d.getAttribute("data-typed-id"),w=e.getService("datepicker"),k=e.getService("dom"),E=e.getService("form-validator"),C=e.getService("popups-amsterdam"),T=e.getService("tooltips-amsterdam"),x=e.getService("resin"),u=k.query(".restrict-download input",d),f=k.query(".custom-url-input",d),p=k.query(".custom-url-slug",d),m=k.query(".custom-url p",d),h=k.query(".direct-link",d),g=k.query(".datepicker",d),v=k.query(".link-expiry-enable input",d),b=k.query(".custom-url-password input",d),y=k.query(".custom-url-password-enable input",d),_=k.query(".save-settings-btn",d),this.attachURLCopyHandler(),O=e.getConfig(R)?"top":"",E.initForm(d),o(),this.registerExternalEvents(),S=w.create(g)},destroy:function(){k.off(m,"copy")},onchange:function(e,t,n){switch(n){case"password-checkbox":s(t);break;case"expiration-checkbox":l(t);break;case"allow-download-checkbox":c(t);break;default:return}e.stopPropagation()},onclick:function(e,t,n){switch(n){case"close-popup":i(!0);break;case"direct-link":t.select();break;default:return}e.stopPropagation()},onfocusout:function(e,t,n){switch(n){case"custom-url-input":case"password-input":case"expiration-input":this.validateForm();break;default:return}e.stopPropagation()},onkeyup:function(e,t,n){switch(n){case"custom-url-input":this.updateCustomURLPreview(),clearTimeout(I),I=setTimeout(function(){E.checkValidity(t)},j);break;case"password-input":""!==t.value?b.setAttribute("data-validator","popup-share-settings-password"):b.removeAttribute("data-validator");break;default:return}e.stopPropagation()},onsubmit:function(e){e.preventDefault(),e.stopPropagation(),this.validateForm()&&(t(!1),k.addClass(d.parentElement,P),this.updateSettings())},updateSettings:function(){var t,n=e.getService("ajax"),o=e.getService("url"),a=o.getGcmCompatibleRm(L),s={itemTypedId:A};f&&!f.disabled&&(s.vanityName=f.value),y&&b&&!y.disabled&&(y.checked&&b.value||!y.checked)&&(s.password=y.checked?b.value:""),v&&!v.disabled&&(t=k.query('input[name="shared-expiration-val"]',d),s.expiration=v.checked?t.value:0),u&&!u.disabled&&(s.allowDownload=u.checked),n.post(a,s).then(function(){i(!1)},function(t){var n,i=t.data||{};switch(i.code){case"vanityName":r(f,i.message);break;case"password":r(b,i.message);break;case"expiration":r(g,i.message);break;case"download":r(u,i.message);break;default:n=e.getService("notifications-amsterdam"),n.error($t("Something went wrong. Please try again","unknown_server_error"))}})},updateCustomURLPreview:function(){"string"==typeof p.innerText?p.innerText=f.value:p.textContent=f.value},validateForm:a,onclose:function(e){"keyup"===e.type&&27!==e.keyCode||(i(!0),e.stopPropagation())},registerExternalEvents:function(){var e=k.query(".popup-x-btn"),t=k.query(".popup");k.on(e,"click",this.onclose),k.on(t,"keyup",this.onclose)},attachURLCopyHandler:function(){k.on(m,"copy",function(){x.recordActionFromElement(m,{target:"copydirectlink",action:"click",data:{item_id:A}})})}}}),Box.Application.addModule("box-edit-install-popup",function(e){"use strict";function t(){i.removeClass(c,p),i.addClass(l,f),i.addClass(l,d)}function n(){i.addClass(c,p),i.removeClass(l,d),i.removeClass(l,f)}var r,i,o,a,s,l,c,u="hidden",d="is-loading",f="is-disabled",p="inline-alert-visible";return{init:function(){r=e.getService("box-edit-amsterdam"),i=e.getService("dom"),o=e.getService("popups-amsterdam"),a=e.getElement(),s=i.queryAll(".install-popup-pane",a),l=i.query(".install-popup-pane-2 .btn-primary",a),c=i.query(".inline-alert-error",a)},displayPaneAtIndex:function(e){var t="install-popup-pane-"+e;s.forEach(function(e){i.hasClass(e,t)?i.removeClass(e,u):i.addClass(e,u)}),o.resize()},onclick:function(i,o,a){switch(a){case"download-btn":i.preventDefault();var s=e.getService("url"),l=e.getConfig("downloadURL");s.goToUrl(l),this.displayPaneAtIndex(2);break;case"continue-btn":i.preventDefault();var c=e.getConfig("typedID"),u=e.getConfig("extension");t(),r.openFile(c,u).then(function(){}).catch(function(){n()})}}}}),Box.Application.addModule("box-edit-install-popup-v3",function(e){"use strict";function t(){i.removeClass(u,p),i.addClass(l,f),i.removeClass(c,d)}function n(){i.addClass(u,p),i.addClass(c,d),i.removeClass(l,f)}var r,i,o,a,s,l,c,u,d="hidden",f="is-disabled",p="inline-alert-visible";return{init:function(){r=e.getService("box-edit-amsterdam"),i=e.getService("dom"),o=e.getService("popups-amsterdam"),a=e.getElement(),s=i.queryAll(".install-popup-pane",a),l=i.query(".install-popup-pane-2 .btn-primary",a),c=i.query(".spinner-box",a),u=i.query(".inline-alert-error",a)},displayPaneAtIndex:function(e){var t="install-popup-pane-"+e;s.forEach(function(e){i.hasClass(e,t)?i.removeClass(e,d):i.addClass(e,d)}),o.resize()},onclick:function(i,o,a){switch(a){case"download-btn":i.preventDefault();var s=e.getService("url"),l=e.getConfig("downloadURL");s.goToUrl(l),this.displayPaneAtIndex(2);break;case"continue-btn":i.preventDefault();var c=e.getConfig("typedID"),u=e.getConfig("extension");t(),r.openFile(c,u).then(function(){}).catch(function(){n()})}}}}),Box.Application.addModule("box-edit-lock-prompt-popup",function(e){"use strict";var t,n;return{init:function(){n=e.getService("item-actions"),t=e.getConfig("itemTypedID")},onclick:function(e,r,i){"lock-file"===i&&n.lock(t)}}}),Box.Application.addModule("box3d-create-package-popup",function(e){"use strict";function t(e){!p||e instanceof h.CancellationError||(p.error(e.message||M),m.close({unsafeSkipRefresh:!0}))}function n(){p.info($t("%1 package was successfully created.","box3d_package_creation_success",w)),m.close()}function r(e){return g.createTemplateFragment(T,{entryText:e.displayName,entryFileId:e.fileID,entryDisplayPath:e.displayPath,entryPath:e.path})}function i(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];r.fileID&&t.push(r)}),t}function o(e,t){var n=f.query(".box3d-fetch-spinner",b);f.remove(n);var i=f.query(".box3d-package-contents",b),o=r({displayName:e.name,fileID:e.fileID}),a=f.query("ul",i),s=!1;a.appendChild(o),Object.keys(t).forEach(function(e){var n=t[e],i=r(n);a.appendChild(i),n.fileID||(s=!0)}),t[e.name]=e,s&&f.addClass(b,D);var l=f.query(".popup-btn-confirm",b);f.removeClass(l,"is-disabled"),v=t}function a(){return(C.value||w).trim()}function s(){return C.checkValidity()&&a().length>0}function l(){C&&(s()?(x.classList.remove(I),x.classList.remove(O),E.classList.remove(A)):(E.classList.add(A),x.classList.add(I),x.classList.add(O)))}function c(e){return e().then(function(t){return t.ready?t.data:(clearTimeout(k),h.create(function(t,n){k=setTimeout(function(){c(e).then(t).catch(n)},P)}))})}function u(){if(v&&!y&&s()){y=!0;var e=f.query(".popup-btn-confirm",b);f.addClass(e,"spinner-is-enabled"),f.addClass(e,"is-disabled");var r=_.replace("d_",""),o=a(),l=i(v);w=o,S=d.createPackageFromEntities(l,r,o).then(c).then(n).catch(t)}}var d,f,p,m,h,g,v,y,b,_,w,S,k,E,C,x,T='<li data-path="<%=entryDisplayPath%>" data-file-id="<%=entryFileId%>"  title="<%=entryPath%>"><span><%=entryText%></span><span class="accessibility-hidden"><%=entryDisplayPath%></span><span class="box3d-missing-file">'+$t("File not found","box3d_package_popup_file_missing")+"</span></li>",A="show-error",I="shown",O="error",D="missing-assets",M=$t("Error trying to create Box3D Package.","box3d_package_error"),P=750;return{init:function(){d=e.getService("fileop-create-box3d-package"),f=e.getService("dom"),p=e.getService("notifications-amsterdam"),m=e.getService("popups-amsterdam"),h=e.getService("promises"),g=e.getService("templates");var n=e.getConfig("fileName"),r=e.getConfig("typedIDs"),i=e.getConfig("fileVersionID");b=e.getElement(),_=e.getConfig("parentTypedID"),w=e.getConfig("packageName"),E=f.query(".box-ui-text-input-container",b),C=f.query("input",E),x=f.query(".box-ui-tooltip",E),C.onblur=l;var a={fileID:r[0],fileVersionID:i,name:n,displayName:n,resolved:!1};S=d.getDependencies(a,a.fileID).then(o.bind(this,a)).catch(t)},destroy:function(){d=null,v=null,f=null,y=null,b=null,p=null,w=null,x=null,C=null,E=null,_=null,m=null,h=null,g=null,clearTimeout(k),k=null,S&&(S.cancel(),S=null)},onclick:function(e,t,n){if(t&&n&&!t.disabled)switch(n){case"confirm-btn":u();break;case"close":m.close({unsafeSkipRefresh:!0})}}}}),Box.Application.addModule("create-bookmark-popup",function(e){"use strict";function t(){f.addClass(c,h),f.addClass(c,g),c.disabled=!0}function n(){c.disabled=!1,f.removeClass(c,g),f.removeClass(c,h)}function r(){var e=f.query(".inline-alert",o);f.addClass(e,"inline-alert-visible"),d.resize()}var i,o,a,s,l,c,u,d,f,p,m,h="is-loading",g="is-disabled";return{behaviors:["tooltips-amsterdam"],init:function(){f=e.getService("dom"),u=e.getService("notifications-amsterdam"),d=e.getService("popups-amsterdam"),p=e.getService("form-validator"),m=e.getService("fileop-create-weblink"),o=e.getElement(),a=f.query(".url-input",o),s=f.query(".name-input",o),l=f.query(".description-input",o),c=f.query(".create-bookmark-btn",o),i=e.getConfig("folderTypedID"),p.initForm(o),d.resize()},onclick:function(e,t,n){"create-btn"===n&&(e.preventDefault(),this.createBookmark(a.value,s.value,l.value))},createBookmark:function(o,l,c){t();var f=i.substr(2);m.createWeblink(o,f,l,c).then(function(t){var n=$t("Bookmark was created successfully.","popup_create_bookmark_success_message_2");d.close({unsafeSkipRefresh:!0}),u.info(n),e.broadcast("newitemadded",{folderTypedId:i,itemTypedId:t.data.itemTypedID})},function(e){var t=e.data||{};n(),r(),"nameConflict"===t.code?p.setCustomError(s,t.message):"invalidUrl"===t.code&&p.setCustomError(a,t.message)})}}}),Box.Application.addModule("custom-action-popup",function(e){"use strict";var t;return{init:function(){t=e.getService("popups-amsterdam"),t.resize()},onsubmit:function(n){n.preventDefault();var r=e.getService("custom-actions"),i=e.getService("url"),o=n.target,a=o.getAttribute("action"),s=this.getFormData(o),l=i.createUrl(a,s),c=e.getConfig(),u={openTarget:c.openTarget||"tab"};"window"===c.openTarget&&(u.windowWidth=c.windowWidth||500,u.windowHeight=c.windowHeight||400),r.executeCustomAction(c.itemTypedId,c.actionId,l,u),"server-only"!==c.openTarget&&t.close()},getFormData:function(e){for(var t,n={},r=0,i=e.elements.length;r<i;r++)t=e.elements[r],"TEXTAREA"===t.tagName?n[t.name]=t.value:"INPUT"===t.tagName?"text"===t.type||"hidden"===t.type||"password"===t.type?n[t.name]=t.value:"radio"===t.type&&t.checked?n[t.name]=t.value:"checkbox"===t.type&&"skipPopup"===t.name&&t.checked&&(n[t.name]=t.value):"SELECT"===t.tagName&&(n[t.name]=t.value);return n}}}),Box.Application.addModule("custom-search-time-range",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f,p,m,h,g,v="inline-alert-visible",y="is-disabled",b=60,_=60,w=24,S=!1;return{init:function(){t=e.getService("datepicker"),n=e.getService("dom"),r=e.getService("nav"),i=e.getService("popups-amsterdam"),o=e.getService("url"),S=e.getConfig("skipNavigation"),l=e.getElement(),c=n.query(".datepicker.from-date",l),u=n.query(".datepicker.to-date",l),p=n.query('input[name="updatedTimeFrom"]',l),m=n.query('input[name="updatedTimeTo"]',l),d=n.query(".inline-alert-error",l),f=n.query(".btn-primary",l),h=p.value,g=m.value,this.initDatePickers()},initDatePickers:function(){this.initFromDatePicker(),this.initToDatePicker()},initFromDatePicker:function(){a=t.create(c),a.on("change",function(e){e&&e.data&&e.data.formattedValue&&(h=e.data.formattedValue),this.validateDatepickerInputsOnChange()}.bind(this))},initToDatePicker:function(){s=t.create(u),s.on("change",function(e){e&&e.data&&e.data.formattedValue&&(g=parseInt(e.data.formattedValue,10)+1e3*(w*b*_-1)),this.validateDatepickerInputsOnChange()}.bind(this))},validateDatepickerInputsOnChange:function(){return!(!h||!g)&&(h>g?(this.setErrorState(),!1):(this.clearErrorState(),!0))},validateDatepickerInputsOnSubmit:function(){return h&&g?this.validateDatepickerInputsOnChange():(this.setErrorState(),!1)},onsubmit:function(e){e.preventDefault(),this.validateDatepickerInputsOnSubmit()&&(S?this.broadcastTimeRange():this.submitQueryWithTimeRange(),i.close({unsafeSkipRefresh:!0}))},broadcastTimeRange:function(){e.broadcast("customsearchtimerangeupdated",{updatedTimeFrom:h,updatedTimeTo:g,updatedTimeFromText:c.value,updatedTimeToText:u.value})},submitQueryWithTimeRange:function(){var e=o.getCurrentWindowUrl(),t={updatedTime:"",updatedTimeFrom:h,updatedTimeTo:g},n=o.updateQueryStringParameters(e,t);r.navigate(n,!0)},setErrorState:function(){n.addClass(d,v),n.addClass(f,y)},clearErrorState:function(){n.removeClass(d,v),n.removeClass(f,y)}}}),Box.Application.addModule("download-mobile-app-popup",function(e){"use strict";function t(e){var t=new FormData(e);return{phonenumber:t.get("phonenumber"),countrycode:t.get("countrycode")}}function n(){u.sendLog(v,"mobile_sms_successful");var e=c.query(p);c.addClass(l,g),c.removeClass(e,g)}function r(){u.sendLog(v,"mobile_sms_error");var e=c.query(m);c.addClass(l,g),c.removeClass(e,g)}function i(){var e=c.query(m);c.addClass(e,g),c.removeClass(l,g)}function o(t,n){u.sendLog(v,"mobile_sms_requested");var r=e.getService("ajax");return r.post("send_mobile_app_download_link_to_phone_number",{phoneNumber:t,countryCode:n}).then(function(e){var t=e.data;return t.status===h?Promise.rejected():Promise.resolve()})}function a(){if(d.checkValidity(l)){var e=this._getFormData(l),t=e.phonenumber,i=e.countrycode;o(t,i).then(n).catch(r)}}var s,l,c,u,d,f=".download-mobile-app-form",p=".mobile-link-send-success-message",m=".mobile-link-send-error-message",h="error",g="hidden",v="sidebar_buttons",y={name:"numbers-only",shouldValidate:function(e,t,n){return e.hasValidatorAttribute(n,"numbers-only")},validate:function(e,t,n){var r=/^[0-9]*$/i;return!(!r.test(n.value)||n.value.length>15)||(e.setCustomValidity(n,$t("Input should be a valid phone number","form_error_phone_number")),!1)}};return{behaviors:["tooltips-amsterdam"],init:function(){s=e.getElement(),c=e.getService("dom"),u=e.getService("logger"),d=e.getService("form-validator"),l=c.query(f,s),d.initForm(l),d.addValidationRule(y)},onclick:function(e,t,n){switch(e.preventDefault(),n){case"submit-form":a.call(this);break;case"try-again-link":i()}},_getFormData:t}}),Box.Application.addModule("default-app-prompt-popup",function(e){"use strict";var t,n,r,i="set_default_app_for_file_type";return{init:function(){n=e.getService("popups-amsterdam"),r=e.getService("ajax"),t=e.getService("logger")},onclick:function(o,a,s){if(a&&!a.disabled)switch(s){case"set-app-as-default":o.preventDefault(),n.close({unsafeSkipRefresh:!0,enableClose:!0});var l=e.getConfig("userId"),c=e.getConfig("fileType"),u=e.getConfig("serviceActionId"),d={userId:l,fileType:c,serviceActionId:u};r.post(i,d).catch(function(){t.sendLog("open_with_settings","unexpected_error",{event_name:"set_default_app_for_file_type_failure"})})}}}}),Box.Application.addModule("edit-weblink-popup",function(e){"use strict";function t(){r.addClass(o,s),r.addClass(o,a),o.disabled=!0}function n(){o.disabled=!1,r.removeClass(o,a),r.removeClass(o,s)}var r,i,o,a="is-disabled",s="is-loading",l="edit_weblink";return{behaviors:["form-validation","tooltips-amsterdam"],messages:["formvalidationsuccess"],init:function(){r=e.getService("dom"),i=e.getElement(),o=r.query(".submit-btn",i)},onmessage:function(e,t){"formvalidationsuccess"===e&&t.form===i&&this.editWeblink(t.formData)},editWeblink:function(r){var o=e.getService("ajax");t(),o.post(l,r).then(function(){var t=e.getService("notifications-amsterdam"),n=e.getService("popups-amsterdam");n.close(),t.info($t('The bookmark properties for "%1" were successfully updated.',"edit_weblink_popup_success_message",r.name))},function(t){var r=t.data||{},o=r.message||$t("There was a problem updating the bookmark properties. Please try again.","edit_weblink_popup_error_message");n(),e.broadcast("formsubmissionerror",{form:i,code:r.code,message:o});
})}}}),Box.Application.addModule("extend-retention-popup",function(e){"use strict";function t(e){w=_+e}function n(e){e&&e.data&&e.data.formattedValue&&(w=parseInt(e.data.formattedValue,10))}function r(){f=e.getService("datepicker"),p=f.create(y),p.on("change",function(e){n(e)})}function i(){p||r(),w=p.getDate().getTime(),d.addClass(v,A)}function o(){p&&d.removeClass(v,A)}function a(){h.error(D,{duration:O})}function s(){h.error(M,{duration:O})}function l(){h.info(P),m.close({unsafeSkipRefresh:!0}),e.broadcast("item-extend-retention",{initiallyShowDetailsTab:!0,itemTypedID:S})}function c(){if(!w)return void a();var e={};e.itemTypedID=S,e.updatedExpirationTimestampSeconds=w/1e3,u.post(T,e).then(l).catch(s)}var u,d,f,p,m,h,g,v,y,b,_,w,S,k="extend-retention-save",E="custom-date",C="preset-time-option",x="close",T="extend_retention_expiration",A="is-visible",I=864e5,O=3e3,D=$t("Please enter a valid extension period.","extend_retention_error_invalid_date_message"),M=$t("There was a problem extending the retention for this item. Please try again.","extend_retention_error_message"),P=$t("Your changes were saved successfully.","extend_retention_success_message");return{behaviors:["menu-toggle-eu","tooltips-amsterdam"],init:function(){u=e.getService("ajax"),d=e.getService("dom"),m=e.getService("popups-amsterdam"),h=e.getService("notifications-amsterdam"),S=e.getConfig("itemTypedID"),g=e.getElement(),v=d.query(".calendar-group",g),y=d.query(".datepicker.expiration-date",g),b=d.query('input[name="updatedExtensionTimestamp"]',g),_=parseInt(b.value,10)},onclick:function(n,r,a){if(r&&a)switch(a){case x:var s=e.getService("item-actions"),l=e.getConfig("fromFilePropertiesPopup");m.close({unsafeSkipRefresh:!0}),l&&s.fileProperties(S);break;case k:c();break;case E:i();break;case C:var u=r.getAttribute("data-value"),d=parseInt(u,10)*I;t(d),o()}}}}),Box.Application.addModule("file-properties-popup",function(){"use strict";return{behaviors:["extend-retention"]}}),Box.Application.addModule("fileop-lock-popup",function(e){"use strict";var t,n,r,i,o,a,s="alreadyLocked";return{init:function(){t=e.getElement(),n=e.getService("dom"),r=e.getService("fileop-lock"),i=e.getService("notifications-amsterdam"),o=e.getService("popups-amsterdam"),a=e.getService("resin")},onclick:function(l,c,u){if(c&&u)switch(u){case"lock-item":var d=t.getAttribute("data-typed-id"),f=n.query("select",t).value-0||0,p=n.query("input",t).checked||!1;o.close({unsafeSkipRefresh:!0}),a.recordActionFromElement(c,{target:"lock",action:"click",data:{duration:f}}),r.lock(d,f,p).then(function(){var t=$t("File successfully locked.","file_lock_success_msg");i.info(t),e.broadcast("filelockedsuccess",{itemTypedId:d})}).catch(function(t){var n=t.data||{};i.error(n.message),n.code===s&&e.broadcast("filealreadylocked",{itemTypedId:d})});break;case"close-popup":o.close({unsafeSkipRefresh:!0})}},onchange:function(e,t,n){if("select-duration"===n){var r=t.value;a.recordActionFromElement(t,{target:"lockduration",action:"click",data:{duration:r}})}}}}),Box.Application.addModule("fileop-unlock-popup",function(e){"use strict";var t,n,r;return{init:function(){t=e.getElement(),r=e.getService("item-actions"),n=e.getService("popups-amsterdam")},onclick:function(e,i,o){if(i&&o)switch(o){case"unlock-item":var a=t.getAttribute("data-typed-id");n.close({unsafeSkipRefresh:!0}),r.unlock(a);break;case"close-popup":n.close({unsafeSkipRefresh:!0})}}}}),Box.Application.addModule("fileop-request-unlock-popup",function(e){"use strict";var t,n,r,i;return{init:function(){t=e.getElement(),i=e.getService("dom"),r=e.getService("fileop-lock"),n=e.getService("popups-amsterdam")},onclick:function(e,o,a){if(o&&a)switch(a){case"request-unlock-item":var s=t.getAttribute("data-typed-id"),l=i.query(".message-textarea",t).value,c=i.query(".email-notify",t).checked;n.close({unsafeSkipRefresh:!0}),r.requestUnlock(s,l,c);break;case"close-popup":n.close({unsafeSkipRefresh:!0})}}}}),Box.Application.addModule("folder-embed-settings",function(e){"use strict";function t(t,n){var r=e.getConfig("isFolder")?"&isFolder=true":"",o="&embedSettings="+encodeURIComponent(JSON.stringify(t));return i+encodeURIComponent(n)+r+o}var n,r,i="/embed/preview?embedLink=";return{behaviors:["folder-embed-settings-form","text-clipboard"],messages:["folder-embed-settings-form-change"],init:function(){n=e.getService("dom");var t=e.getElement();r=n.query(".folder-embed-preview-btn",t)},onmessage:function(e,n){"folder-embed-settings-form-change"===e&&(r.href=t(n.formData,n.embedLink))}}}),Box.Application.addModule("item-expiration-popup",function(e){"use strict";function t(){var e,t=m.length;for(e=0;e<t;e++)m[e].disabled=!0,a.addClass(m,v);a.addClass(h,b)}function n(){var e,t=m.length;for(e=0;e<t;e++)m[e].disabled=!1,a.removeClass(m,v);a.removeClass(h,b)}function r(){var e=a.query(".inline-alert",u);a.addClass(e,"inline-alert-visible"),l.resize()}var i,o,a,s,l,c,u,d,f,p,m,h,g,v="is-disabled",y="hidden",b="is-loading",_="change_item_expiration";return{_showLoadingSubmit:t,_hideLoadingSubmit:n,behaviors:["tooltips-amsterdam"],init:function(){i=e.getService("ajax"),o=e.getService("datepicker"),a=e.getService("dom"),s=e.getService("notifications-amsterdam"),l=e.getService("popups-amsterdam"),c=e.getService("resin"),u=e.getElement(),d=a.query('input[name="set-expiration"]',u),f=a.query(".datepicker",u),p=a.query(".datepicker-section",u),m=a.queryAll(".btn",u),h=a.query(".save-btn",u),g=o.create(f)},onchange:function(e,t,n){if("expiration-checkbox"===n)this.toggleDatepickerVisibility(),t.checked||(g.removeError(),f.value=""),e.stopPropagation();else if(e.originalEvent&&e.originalEvent.firedBy&&e.originalEvent.firedBy.getDate instanceof Function){var r=e.originalEvent.srcElement;c.recordActionFromElement(r,{target:"selectdate",action:"click",data:{expiration_date:e.originalEvent.firedBy.getDate().toDateString()}})}},onsubmit:function(e){return e.preventDefault(),e.stopPropagation(),d.checked&&!f.value?void g.setError($t("Please select a date.","date_required_error")):void this.submitExpirationChange()},toggleDatepickerVisibility:function(){d.checked?a.removeClass(p,y):a.addClass(p,y),l.resize()},submitExpirationChange:function(){var e=a.query('input[name="raw-expiration-date"]',u),t={itemTypedId:u.getAttribute("data-item-typed-id"),setExpiration:d.checked,expirationDate:e.value},n=this;this._showLoadingSubmit(),i.post(_,t).then(function(){var e=$t("The expiration has been successfully changed.","item_expiration_popup_success");l.close(),s.info(e)},function(e){var t=e.data||{};n._hideLoadingSubmit(),r(),"expireAfterParent"===t.code&&g.setError(t.message)})}}}),Box.Application.addModule("keyboard-shortcuts-popup",function(e){"use strict";function t(e,t){var n=i.query(d,a),r=i.query(f,a);n.setAttribute(c,e),i.setText(r,t||e)}function n(e){i.addClass(e,s),i.removeClass(e,l)}function r(e){i.removeClass(e,s),i.addClass(e,l)}var i,o,a,s="hidden",l="is-visible",c="data-category-type",u="data-category-label",d=".section-name-toggle-button",f=".section-name-toggle-button-text",p=".section-item.is-visible",m="switch-section";return{behaviors:["menu-toggle"],init:function(){i=e.getService("dom"),o=e.getService("keyboard-shortcuts"),a=e.getElement(),o.register({name:"keyboard-shortcuts-popup",shortcuts:[{key:"shift+?",handler:function(){}}]},a)},destroy:function(){o.deregister("keyboard-shortcuts-popup",a)},onclick:function(e,o,s){if(s===m){var l=o.getAttribute(c),d=o.getAttribute(u),f=i.query(p,a),h=i.query(".section-item["+c+'="'+l+'"]',a);t(l,d),n(f),r(h)}}}}),Box.Application.addModule("move-copy-popup",function(e){"use strict";function t(){var e=r.query(".folder-tree-container",n);c=s||u;var t=o.create(e,c,{allowSelect:!0,setFocus:!0});t.events.on("select",function(e){var t=e.data.id;("string"==typeof t||t instanceof String)&&(c=t)})}var n,r,i,o,a,s,l,c,u="d_0";return{behaviors:["tooltips-amsterdam"],init:function(){n=e.getElement(),s=e.getConfig("currentFolderTypedId"),l=e.getConfig("itemTypedIds"),r=e.getService("dom"),o=e.getService("folder-tree"),i=e.getService("fileop-movecopy"),a=e.getService("popups-amsterdam"),t()},onclick:function(e,t,n){if(t&&n)switch(n){case"move-btn":a.close({unsafeSkipRefresh:!0}),i.move(l,c,s);break;case"copy-btn":a.close({unsafeSkipRefresh:!0}),i.copy(l,c,s);break;case"close-popup":a.close({unsafeSkipRefresh:!0})}}}}),Box.Application.addModule("multi-share-items-popup",function(e){"use strict";function t(){p.addClass(b,x),b.disabled=!0}function n(){b.disabled=!1,p.removeClass(b,x)}function r(){p.addClass(b,O),t()}function i(){n(),p.removeClass(b,O)}function o(){var t=p.query(E,y),n=e.getService("provider-contacts").searchAllContactsExcludingItemCollaborators(null,{includeSelf:!1,includeGroups:!1});v=e.getService("pill-selector").create(t,n),v.init(),v.on("resize",h.resize)}function a(){var e,t,n,r=p.query(".pill-selector",y),i=p.queryAll(".pill",r),o=i.length,a=!0;for(n=0;n<o;n++)e=i[n],t=e.getAttribute("data-id"),g.isEmail(t)?p.removeClass(e,T):(p.addClass(e,T),a=!1);return a}function s(){var e=p.query(".pill-selector-input",y),t=e.value;if(t){var n=v.createDataArrayFromString(t);v.insertArrayOfPills(n)}}function l(e,t){"failedToSendSomeEmails"===t?m.warn(e):m.error(e)}function c(e){var t=p.query(".message-wrapper .share-message",y).value,n=f.map(e,function(e){return e.id}),o=f.map(p.queryAll(".items-list-wrapper .shared-item",y),function(e){return e.getAttribute("data-item-typed-id")}),a={emailContacts:n.join(","),emailMessage:t,itemTypedIDs:o.join(",")};r(),d.post(k,a).then(function(e){var t=e.data||{};i(),m.confirm(t.message),h.close({unsafeSkipRefresh:!0})},function(e){var t=e.data||{};i(),l(t.message,t.code),h.close({unsafeSkipRefresh:!0})})}function u(e){h.resize(),v.displayError(e,{tooltipPosition:"right",tooltipRelative:".popup-wrapper"})}var d,f,p,m,h,g,v,y,b,_=188,w=13,S=32,k="multi_item_share_send_invite",E=".email-address-input",C=".sharelinks-wrapper",x="is-disabled",T="is-invalid",A="is-open",I="is-closed",O="is-loading";return{behaviors:["tooltips-amsterdam"],init:function(){d=e.getService("ajax"),f=e.getService("array-utils"),p=e.getService("dom"),m=e.getService("notifications-amsterdam"),h=e.getService("popups-amsterdam"),g=e.getService("strings"),y=e.getElement(),b=p.query('.btn[data-type="multi-share-items-popup-send"]',y),o()},onkeydown:function(e,t,n){if("email-invite-input"===n){var r=e.which||e.keyCode;r!==w&&r!==_&&r!==S||(s(),a()||u($t("At least one of the email addresses is not correct.","multi-share-items-popup-incorrect-email-address")),e.stopPropagation(),e.preventDefault())}},validateAndSubmit:function(){var e,t;s(),e=v.getPills(),e.length>0?a()?c(e):(t=$t("One or more of the email addresses is invalid.","multi-share-items-popup-invalid-email-address"),u(t)):(t=$t("Please enter at least one email address.","multi-share-items-popup-missing-email-address"),u(t))},onclick:function(e,t,n){switch(n){case"items-list-toggle":var r=p.query(C,y),i=p.hasClass(r,A);i?(p.removeClass(r,A),p.addClass(r,I)):(p.removeClass(r,I),p.addClass(r,A)),h.resize();break;case"multi-share-items-popup-send":e.preventDefault(),this.validateAndSubmit()}}}}),Box.Application.addModule("new-document-popup",function(e){"use strict";function t(){b.addClass(g,C),b.addClass(g,x),g.disabled=!0}function n(){g.disabled=!1,b.removeClass(g,x),b.removeClass(g,C)}function r(){var e=$t("Duplicate File","file_conflict_popup_title"),t=$t("Overwrite","file_conflict_popup_overwrite_btn"),n=$t("A file with this name already exists. Would you like to overwrite the existing file?","file_conflict_popup_message");y.confirm(n,e,{confirmText:t}).then(function(){c=!0,a()})}function i(t){y.close({unsafeSkipRefresh:!0});var n=t.itemTypedId;if(e.getConfig("isBoxEditAction")){var r=s+"."+p,i=$t("%1 was created successfully","successfully_created_new_document_message",r);v.confirm(i,{duration:E});var o=e.getService("box-edit-amsterdam");o.openFile(n,p)}else if(t.editURL){var a=e.getService("custom-actions");a.executeCustomAction(n,f,t.editURL,{openTarget:"tab"})}e.broadcast("newitemadded",{folderTypedId:u,itemTypedId:n})}function o(e){return n(),"fileNameConflict"===e.code?void r():void v.error(e.message,{duration:E})}function a(){function n(e){var t={};try{t=JSON.parse(e)}catch(e){}return t}var r={folderId:u,fileName:s,docType:l,overwrite:c,asct:d,actionId:f,extension:p};t();var a=e.getGlobal("XMLHttpRequest"),m=new a,h=!1,g=e.getGlobalConfig("requestToken");m.open("post","/index.php?rm="+w,h),m.setRequestHeader("X-Requested-With","XMLHttpRequest"),m.setRequestHeader("X-Request-Token",g),m.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),m.onreadystatechange=function(){if(4===m.readyState){var e=n(m.response);m.status>=200&&m.status<300?i(e):o(e)}},m.onerror=function(){var e=n(m.response);o(e)};var v=[];for(var y in r)r.hasOwnProperty(y)&&v.push(encodeURIComponent(y)+"="+encodeURIComponent(r[y]));m.send(v.join("&"))}var s,l,c,u,d,f,p,m,h,g,v,y,b,_,w="create_new_document",S="inline-alert-visible",k=".inline-alert",E=2500,C="is-loading",x="is-disabled";return{behaviors:["tooltips-amsterdam"],init:function(){v=e.getService("notifications-amsterdam"),y=e.getService("popups-amsterdam"),b=e.getService("dom"),_=e.getService("form-validator"),h=e.getElement(),m=b.query(k,h),g=b.query(".create-document-btn",h),_.initForm(h),u=h.getAttribute("data-folder-id"),l=h.getAttribute("data-doc-type"),d=b.query('[name="asct"]').value||"",f=b.query('[name="actionId"]').value||"",p=b.query('[name="extension"]').value||"",c=!1},showNewDocumentError:function(){b.addClass(m,S),y.resize()},create:function(){a()},onclick:function(e,t,n){if("new-document-popup-submit"===n){e.preventDefault();var r=b.query('input[data-type="new-document-name"]',h);if(r.value=r.value.trim(),!_.checkValidity(h))return void this.showNewDocumentError();s=r.value||"",this.create()}}}}),Box.Application.addModule("new-folder-popup",function(e){"use strict";function t(){r.addClass(l,p),r.addClass(l,m),l.disabled=!0}function n(){l.disabled=!1,r.removeClass(l,m),r.removeClass(l,p)}var r,i,o,a,s,l,c,u,d=13,f=188,p="is-loading",m="is-disabled",h=$t("One or more of the email addresses is invalid.","atleast_one_invalid_email_invite_collab_popup"),g="create_new_folder",v="folderNameError",y="createFolderError";return{behaviors:["form-validation","permissions-matrix-flyout","tooltips-amsterdam"],messages:["formvalidationsuccess"],init:function(){r=e.getService("dom"),i=e.getService("popups-amsterdam"),o=e.getService("strings"),a=e.getElement(),l=r.query(".submit-btn",a),u="d_"+r.query('input[name="parentFolderID"]',a).value,this.initContactSelector()},initContactSelector:function(){var t=r.query(".invite-selector-input",a);if(t){var n=e.getService("provider-contacts"),i=e.getService("pill-selector"),o=n.searchAllContactsExcludingItemCollaborators(u,{includeSelf:!1,includeGroups:!0});c=i.create(t,o),c.init(),s=r.query(".pill-selector-input",a)}},onkeydown:function(e,t,n){if("email-invite-input"===n){var r=e.which;r!==d&&r!==f||(e.preventDefault(),this.createContactPills(s.value))}},createContactPills:function(e){if(e){var t=c.createDataArrayFromString(e);c.insertArrayOfPills(t)}},isPillValid:function(e){return o.isEmail(e.id)||!!e.data&&"group"===e.data.type},onmessage:function(t,n){if("formvalidationsuccess"===t&&n.form===a){var r=n.formData;if(c){if(this.createContactPills(s.value),!c.validatePills(this.isPillValid,h))return void e.broadcast("formsubmissionerror",{form:a,message:h});var i=c.getPillIDsByType();r.emails=i.defaultIDs.join(","),r.groupIDs=i.groupIDs.join(",")}this.createNewFolder(r)}},createNewFolder:function(r){var o=e.getService("ajax"),s=e.getService("notifications-amsterdam");return t(),r.folderName=r.folderName&&r.folderName.replace(/\s+$/,""),0===r.folderName.length?(n(),void e.broadcast("formsubmissionerror",{form:a,message:$t("Folder name cannot be empty.","new_folder_error_empty_name"),code:"folderName"})):void o.post(g,r).then(function(t){var n="d_"+t.data.folderId;i.close({unsafeSkipRefresh:!0}),s.info($t("Folder was created successfully.","new_folder_created_2")),e.broadcast("newitemadded",{folderTypedId:u,itemTypedId:n})},function(t){var r=t.data||{},o={};r.code===v?(n(),e.broadcast("formsubmissionerror",{form:a,message:r.message,code:"folderName"})):(r.code===y&&(o.unsafeSkipRefresh=!0),i.close(o),s.error(r.message||$t("There was a problem creating the folder.","new_folder_error_2")))})}}}),Box.Application.addModule("update-tags-popup",function(e){"use strict";function t(t){l.info($t("Your updates were saved successfully.","update_tags_success"),{duration:g}),c.close({unsafeSkipRefresh:!0}),t.forEach(function(t){e.broadcast("item-change-tags",{itemTypedId:t})})}function n(){l.error($t("There was a problem updating tags for this item. Please try again.","update_tags_error"),{duration:v}),c.close({unsafeSkipRefresh:!0})}function r(e,r){var i=r.split(","),o=f.split(","),s=[],l=[];i.forEach(function(e){e=e.trim(),o.indexOf(e)===-1&&s.push(e)}),o.forEach(function(e){e=e.trim(),i.indexOf(e)===-1&&l.push(e)});var c={items:e,addedTags:s,removedTags:l},u=e.map(function(e){return e.id});a.post(h,c).then(function(){t(u)}).catch(n)}function i(e,r){var i={tags:r,itemTypedID:e};a.post(m,i).then(function(){t([e])}).catch(n)}function o(){var t=d.getValue();if(f===t)return void c.close({unsafeSkipRefresh:!0});var n=e.getConfig("items");if(n&&n.length>1)r(n,t);else{var o=s.query("input.item-typed-id-input",p),a=o.value;i(a,t)}}var a,s,l,c,u,d,f,p,m="edit_item_tags",h="edit_item_tags_multiple",g=5e3,v=8e3;return{init:function(){a=e.getService("ajax"),s=e.getService("dom"),l=e.getService("notifications-amsterdam"),c=e.getService("popups-amsterdam"),u=e.getService("tags-autocomplete"),p=e.getElement(),d=u.create(s.query(".tags-autocomplete",p),this.getInitialTags()),f=d.getValue()},getInitialTags:function(){var t=e.getConfig("currentTags");return t?t.split(","):[]},onsubmit:function(e){e.preventDefault(),setTimeout(o,0)}}}),Box.Application.addModule("upload-widget-popup",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f,p,m,h="upload_widget_get_token",g="/upload-widget/preview",v="/upload-widget/embed.js",y=5e3,b="upload-widget-enabled",_="upload-widget-disabled",w=420,S=385,k=e.getGlobal("window");return{behaviors:["text-clipboard"],init:function(){r=e.getService("ajax"),i=e.getService("dom"),o=e.getService("url"),n=e.getService("popups-amsterdam"),t=e.getService("notifications-amsterdam"),a=e.getElement(),s=i.query(".copy-text-target",a),f=i.query(".item-typed-id-input",a),l=i.query(".upload-widget-popup-title-input",a),c=i.query(".upload-widget-popup-instructions-input",a),u=i.query(".upload-widget-popup-allow-descriptions",a),d=i.query(".upload-widget-popup-require-email",a),p=i.query(".upload-widget-preview-btn",a);var h=f.value;m=h.slice(2),this.onFormChange=this.onFormChange.bind(this),i.on(a,"change",this.onFormChange),this.setup()},setup:function(){this.updateSettings(),this.getToken()},updateSettings:function(){this.settings={folderID:m,title:l.value,instructions:c.value,isDescriptionFieldShown:u.checked?1:0,isEmailRequired:d.checked?1:0,width:S,height:w}},updatePreviewUrlAndCode:function(){var e=this.getPreviewUrl(),t=this.getCode();p.setAttribute("href",e),s.value=t},getPreviewUrl:function(){return this.settings.token=this.token,o.createUrl(g,this.settings)},getCode:function(){var e=k.location.hostname,t="https://"+e+v;this.settings.token=this.token,t=o.createUrl(t,this.settings);var n='<script src="'+t+'" type="text/javascript"></script>';return n},getToken:function(e){e=e||{},e.folderID=m,r.post(h,e).then(function(e){this.isActive=e.data.active,this.token=e.data.token,this.updatePreviewUrlAndCode(),this.updateVisibility()}.bind(this)).catch(function(){var e=$t("There was a problem creating the upload embed widget. Please try again.","upload_widget_popup_get_token_error");t.error(e,{duration:y}),n.close({unsafeSkipRefresh:!0})})},deactivateUploadWidget:function(){this.getToken({deactivate:!0})},reactivateUploadWidget:function(){this.getToken({reactivate:!0})},updateVisibility:function(){this.isActive?(i.removeClass(a,_),i.addClass(a,b)):(i.addClass(a,_),i.removeClass(a,b))},onFormChange:function(){this.updateSettings(),this.updatePreviewUrlAndCode()},onclick:function(e,t,n){switch(n){case"deactivate-upload-widget":this.deactivateUploadWidget();break;case"reactivate-upload-widget":this.reactivateUploadWidget();break;default:return}},destroy:function(){i.off(a,"change",this.onFormChange)}}}),Box.Application.addModule("version-history-popup",function(e){"use strict";function t(e){e.disabled=!1,u.removeClass(e,v)}function n(e){e.disabled=!0,u.addClass(e,v)}function r(e,t,n){return c.get("version_history_item",{fileID:e,fileVersionID:t}).then(function(e){var t=$(e.data.html);u.setHTML(n,t.html())})}function i(e,t){var n=u.queryAll(".title span, .info span",e),r=u.queryAll(".action",e),i=u.queryAll('[data-type="version-history-restore"]',e);t?(u.removeClass(n,v),u.removeClass(r,g),u.addClass(i,g)):(u.addClass(n,v),u.addClass(r,g),u.removeClass(i,g))}function o(e,t){var n="f_"+e;""!==t&&(n+="_"+t),d.downloadFile(n).then(function(){},function(e){e=e||$t("Something went wrong with the download request. Please try again.","version_history_download_generic_error"),f.error(e)})}function a(t){m.makeCurrentVersion(t).then(function(){p.close(),e.broadcast("makecurrentversionsuccess"),f.info($t("Current version is updated successfully","version_history_make_current_version_success"))},function(e){var t=e.message||$t("Something went wrong with the make current request. Please try again.","version_history_make_current_generic_error");f.error(t)})}function s(e,t,n){m.restoreVersion(e,t).then(function(){r(e,t,n).then(function(){i(n,!0)})},function(e){var t=e.message||$t("Something went wrong with the restore request. Please try again.","version_history_restore_generic_error");f.error(t)})}function l(e,o,a){var s=u.query('[data-type="version-history-remove"]',a);n(s),m.removeVersion(e,o).then(function(){r(e,o,a).then(function(){i(a,!1)})}).catch(function(e){var n=e.message||$t("Something went wrong with the remove request. Please try again.","version_history_remove_generic_error");f.error(n),t(s)})}var c,u,d,f,p,m,h,g="hidden",v="is-disabled";return{init:function(){c=e.getService("ajax"),u=e.getService("dom"),d=e.getService("fileop-download"),f=e.getService("notifications-amsterdam"),p=e.getService("popups-amsterdam"),m=e.getService("fileop-versions"),this.setupRequestAnimationFrame();var t=e.getElement(),n=e.getConfig("scrollToVersion");n&&h(function(){var e=u.query('[data-file-version-number="'+n+'"]'),r=u.query(".version-list",t);r.scrollTop=e.offsetTop-e.offsetHeight})},setupRequestAnimationFrame:function(){var t=e.getGlobal("window");h=t.requestAnimationFrame||t.webkitRequestAnimationFrame},onclick:function(e,t,n){var r,i,c;if(t&&!t.disabled&&(c=u.getNearest(t,".version-item"))){switch(r=c.getAttribute("data-file-id"),i=c.getAttribute("data-file-version-id"),r.indexOf("_")!==-1&&(r=r.substring(0,r.indexOf("_"))),n){case"version-history-restore":s(r,i,c);break;case"version-history-download":o(r,i);break;case"version-history-make-current":a(i);break;case"version-history-remove":l(r,i,c);break;default:return}e.preventDefault(),e.stopPropagation()}}}}),Box.Application.addModule("preview-adv-header",function(e){"use strict";function t(){var t=e.getConfig("typedID");m.download([t])}function n(){e.broadcast("previewpointannotationmodetoggled")}function r(){var e=f.query(".upload-handler-picker",_);e&&e.click()}function i(){var t=e.getConfig("typedID");m.share(t)}function o(){var t=e.getConfig("isSFCEnabled"),n=e.getConfig("typedID");t&&m.inviteCollab(n)}function a(){e.broadcast("previewprintrequested")}function s(){function e(){}h.register({name:"preview-adv-header",shortcuts:[{key:"shift+d",description:$t("Download file","kb_shortcuts_preview_download_file"),handler:t,type:"preview"},{key:"shift+u",description:$t("Upload new file version","kb_shortcuts_preview_upload_new_version"),handler:r,type:"preview"},{key:"shift+o",description:$t("Open file using the default app","kb_shortcuts_preview_open_file"),handler:function(){this.boxEditHandler()}.bind(this),type:"preview"},{key:"shift+s",description:$t("Share file","kb_shortcuts_preview_share_file"),handler:i,type:"preview"},{key:"shift+c",description:$t("Invite collaborators","kb_shortcuts_preview_open_invite_collab_modal"),handler:o,type:"preview"},{key:"shift+p",description:$t("Print file","kb_shortcuts_preview_print_file"),handler:a,type:"preview"},{key:"left",description:$t("Go to previous file","kb_shortcuts_preview_previous_file"),handler:e,type:"preview"},{key:"right",description:$t("Go to next file","kb_shortcuts_preview_next_file"),handler:e,type:"preview"},{key:"[",description:$t("Previous page in file","kb_shortcuts_preview_previous_page"),handler:e,type:"preview"},{key:"]",description:$t("Next page in file","kb_shortcuts_preview_next_page"),handler:e,type:"preview"}]},_)}function l(){h.deregister("preview-adv-header",_)}function c(e){var t=b.constants;if(e&&e.error)switch(e.error){case t.BOX_EDIT_NOT_SUPPORTED_ERROR:this.setBoxEditInstallationStatus(I);break;case t.BOX_EDIT_UPGRADE_BROWSER_ERROR:this.setBoxEditInstallationStatus(O);break;case t.BOX_EDIT_SAFARI_ERROR:this.setBoxEditInstallationStatus(D);break;case t.BOX_EDIT_UNINSTALLED_ERROR:default:this.setBoxEditInstallationStatus(x)}else this.setBoxEditInstallationStatus(x)}function u(){var t=$t("Your current browser is not supported for this feature.","box_edit_unsupported_browser");g.error(t,{buttonText:$t("Details","box_edit_browser_unsupported_button")}).then(function(){e.getService("nav").redirect(F)})}var d,f,p,m,h,g,v,y,b,_,w,S,k,E="hidden",C="is-disabled",x=0,T=1,A=2,I=3,O=4,D=5,M=$t("Unsupported filetype","box_edit_unsupported_filetype_title"),P="is_default_app_prompt_displayed",N="get_default_app_prompt",R="box_edit_upgrade_browser_popup",F="https://community.box.com/t5/How-to-Guides-for-Managing/System-Requirements-for-Box-Tools-4-0-Box-Edit-and-Box-Device/ta-p/47815";return{behaviors:["collab-invite","menu-toggle","preview-adv-header-item-menu","preview-watermarked-download","refresh-banner-policy","resin-target-toggle"],messages:["item-name-change","previewclose","previewopen"],init:function(){w=$t('Box Edit did not detect a program to open files of type "%1" on this computer.',"box_edit_unsupported_filetype",e.getConfig("extension")),f=e.getService("dom"),d=e.getService("box-edit-amsterdam"),p=e.getService("custom-actions"),m=e.getService("item-actions"),h=e.getService("keyboard-shortcuts"),g=e.getService("notifications-amsterdam"),v=e.getService("popups-amsterdam"),y=e.getService("resin"),b=e.getService("com-server-client"),_=e.getElement();var t=e.getConfig("pageTitle");k=e.getConfig("isOpenWithProgramEnabled"),t&&(document.title=t),this.registerKeyboardShortcuts(),this.configureBoxEditOptions()},onclick:function(r,o,a){if(o&&a&&!o.disabled){var s=e.getConfig("typedID");switch(a){case"download-watermarked-btn":r.preventDefault(),e.broadcast("requestedwatermarkeddownload",{typedID:s});break;case"download-btn":r.preventDefault(),t();break;case"preview-point-annotation":r.preventDefault(),n();break;case"share-btn":r.preventDefault(),i();break;case"custom-action-edit-btn":r.preventDefault(),this.handleEditWithCustomAction(o);break;case"box-edit-btn":case"box-edit-menu-option":r.preventDefault(),this.boxEditHandler();break;case"box-edit-not-installed-menu-option":r.preventDefault(),this.boxEditHandler();break;case"default-open-menu-option":case"office-online-menu-option":case"google-dss-menu-option":case"iwork-menu-option":case"adobe-sign-menu-option":r.preventDefault(),k&&"default-open-menu-option"!==a?this.showDefaultAppPromptPopup(o):this.handleEditWithCustomAction(o);break;case"toggle-sidebar-btn":r.preventDefault(),this.requestSidebarToggle();break;case"lock-btn":r.preventDefault(),m.showUnlockPopup(s);break;case"change-theme-btn":r.preventDefault(),this.requestThemeChange();break;case"close-btn":y.recordActionFromElement(f.query(".preview-close-btn"),{target:"close",action:"click"}),r.preventDefault(),this.requestClose()}}},boxEditHandler:function(){switch(S){case A:this.handleEditWithBoxEdit();break;case T:v.alert(w,M);break;case x:this.installBoxEdit();break;case I:u();break;case O:v.open(R,{resinName:"boxeditupgradebrowserpopup"});break;case D:v.alert("Please enable the Safari App extension AND/OR install Box Edit")}},registerKeyboardShortcuts:s,onmessage:function(e,t){switch(e){case"item-name-change":this.updateHeader(t.name);break;case"previewclose":l();break;case"previewopen":this.registerKeyboardShortcuts()}},updateHeader:function(e){var t=f.query(".preview-dropdown-btn .item-name",_);f.setText(t,e)},configureBoxEditOptions:function(){var t=e.getConfig("extension"),n=this;d.checkBoxEditAvailability().then(function(){d.canOpenWithBoxEdit(t).then(function(){n.setBoxEditInstallationStatus(A)}).catch(function(){n.setBoxEditInstallationStatus(T)})}).catch(c.bind(n))},handleEditWithBoxEdit:function(){var t=e.getConfig("typedID"),n=e.getConfig("extension");d.openFile(t,n)},handleEditWithCustomAction:function(t){var n=e.getConfig("typedID"),r=t.getAttribute("data-action-id"),i=t.getAttribute("data-custom-action-url");if(i){var o=p.extractCustomActionConfig(t);p.executeCustomAction(n,r,i,o)}else p.launchCustomActionPopup(n,r)},requestSidebarToggle:function(){e.broadcast("previewsidebartogglerequested")},requestThemeChange:function(){e.broadcast("previewthemechangerequested")},requestClose:function(){e.broadcast("previewcloserequested")},installBoxEdit:function(){var t=e.getService("popups-amsterdam");t.open("box_edit_install_popup",{data:{typedID:e.getConfig("typedID"),extension:e.getConfig("extension")},resinName:"boxeditinstallpopup"})},setBoxEditInstallationStatus:function(e){var t=f.queryAll(".box-edit-installed",_),n=f.queryAll(".box-edit-not-installed",_),r=f.query(".edit-btn-no-dropdown");switch(S=e,e){case A:f.removeClass(t,E);break;case T:f.removeClass(t,E);var i=r.getAttribute("data-custom-action-url");r&&!i&&(f.addClass(r,C),r.setAttribute("aria-label",w));break;case x:case I:case O:case D:f.removeClass(n,E)}},showDefaultAppPromptPopup:function(t){var n,r=e.getGlobalConfig("userId"),i=e.getConfig("extension"),o=t.getAttribute("data-action-id"),a={userId:r,fileType:i,serviceActionId:o},s=e.getService("ajax"),l=e.getService("popups-amsterdam"),c=e.getService("logger");s.get(P,a).then(function(e){e.data.result===!1?(n=l.open(N,{data:a}),n.on("close",function(){this.handleEditWithCustomAction(t)}.bind(this))):this.handleEditWithCustomAction(t)}.bind(this)).catch(function(){c.sendLog("open_with_settings","unexpected_error",{event_name:"get_is_default_app_prompt_displayed_failure"})})}}}),Box.Application.addModule("preview-content",function(e){"use strict";function t(e,t){b=y[e];var n=Date.now();switch(t.clientTimeStamp=n,(t.fileID||p)&&(t.fileID=t.fileID||p),e){case v.REQUESTED:_=n;break;case v.LOADED:0!==_&&(t.timeToPreviewDisplay=n-_,_=0);break;case v.ERROR:0!==_&&(t.timeToPreviewError=n-_,_=0);break;case v.NAVIGATED:_=0;break;case v.INTERRUPTED:0!==_&&(t.timeToPreviewInterrupt=n-_,_=0)}return e}function n(e){var t={};return e?(Object.keys(e).map(function(n){t[n]=e[n]}),t):t}function r(e,r){r=n(r),e=t(e,r);var i={application:"files",page:"preview",component:"sdk",feature:"lifecycle",target:e,action:"programmatic",data:r};l.recordAction(i)}var i,o,a,s,l,c,u,d,f,p,m,h,g=["Document","Presentation","Image","Dash","MP4"],v={INITIATED:"initiated",REQUESTED:"requested",LOADED:"loaded",ERROR:"error",NAVIGATED:"navigated",INTERRUPTED:"interrupted",CLOSED:"closed"},y={initiated:0,requested:1,loaded:2,error:3,navigated:4,interrupted:5,closed:6},b=-1,_=0;return{messages:["previewpopupopened","previewpopupclosed","previewopen","previewclose","previewchanged","previewprintrequested","previewresizerequested","previewcollectionupdated","previewfilesmetadatafetched","previewprefetchpreload","previewpointannotationmodetoggled"],
init:function(){i=e.getService("assets-dynamic"),o=e.getService("preview-auth"),a=e.getService("preview-metrics"),s=e.getService("preview-instance"),l=e.getService("resin"),c=e.getService("shared-context"),r(v.INITIATED),u=!1,d=null,f=null,h=e.getElement(),this.handleNotificationsEvent=this.handleNotificationsEvent.bind(this),this.handlePreviewNavigate=this.handlePreviewNavigate.bind(this),this.handlePreviewLoad=this.handlePreviewLoad.bind(this),this.handleViewerEvent=this.handleViewerEvent.bind(this),this.setTokenTimeout(),this.loadPreviewSDK()},destroy:function(){u&&(this.unbindNotificationsEventHandler(),this.unbindNavigationHandler(),this.unbindLoadHandler(),this.unbindViewerEventHandler(),this.clearDwellTimers())},onmessage:function(t,n){switch(t){case"previewpopupopened":this.disablePreviewHotkeys();break;case"previewpopupclosed":this.enablePreviewHotkeys();break;case"previewopen":this.setPreviewContext(n),this.showPreview();break;case"previewclose":this.hidePreview(),this.clearPreviewContext();break;case"previewchanged":this.setPreviewContext(n);break;case"previewcollectionupdated":this.setPreviewContext(n),this.updateCollection();break;case"previewprintrequested":this.print();break;case"previewresizerequested":u&&d&&d.fileID&&f.resize();break;case"previewfilesmetadatafetched":u&&f.updateFileCache&&Array.isArray(n)&&n.length>0&&f.updateFileCache(n);break;case"previewprefetchpreload":if(u&&e.getConfig("preload")){var r=n.fileID;if(!r)return;o.getTokens([r],!1).then(function(e){var t=e[r],n=c.getSharedLink();f.prefetch({fileId:r,token:t,sharedLink:n,preload:!0})})}break;case"previewpointannotationmodetoggled":if("function"==typeof f.viewer.getAnnotationModeClickHandler){var i=f.viewer.getAnnotationModeClickHandler("point");i()}else f.viewer.emit("toggleannotationmode","point")}},loadPreviewSDK:function(){var t=i.loadJS([e.getConfig("js")]);i.loadCSS([e.getConfig("css")]),t.then(function(){this.createPreviewSingleton(),this.setPreviewSDKLoadedFlag(),this.bindNotificationsEventHandler(),this.bindNavigationHandler(),this.bindLoadHandler(),this.bindViewerEventHandler(),d?this.showPreview():this.prefetch()}.bind(this))},setTokenTimeout:function(){o.setTokenTimeoutMS(1e3*e.getConfig("tokenTimeout"))},getSurroundingCollectionFileIDs:function(e,t){var n=d.collectionFileIDs.indexOf(e),r=parseInt(t/2,10);if(n===-1)return[e];var i=d.collectionFileIDs.length,o=[];if(i<=t)o=d.collectionFileIDs.slice(0);else if(n-r<0)o=d.collectionFileIDs.slice(0,t);else if(n+r+1>i)o=d.collectionFileIDs.slice(i-t);else{var a=n-r;o=d.collectionFileIDs.slice(a,a+t)}return o},getAuthTokens:function(e){var t=Array.isArray(e)?e:[e];if(1===t.length){var n=t[0];if(!o.hasTokenBeenRequested(n)){var r=o.getTokenRequestLimit();t=this.getSurroundingCollectionFileIDs(n,r)}}return o.getTokens(t)},createPreviewSingleton:function(){return f=s.create()},setPreviewSDKLoadedFlag:function(){u=!0},disablePreviewHotkeys:function(){u&&f.disableHotkeys&&f.disableHotkeys()},enablePreviewHotkeys:function(){u&&f.enableHotkeys&&f.enableHotkeys()},bindNotificationsEventHandler:function(){f.addListener("notification",this.handleNotificationsEvent)},unbindNotificationsEventHandler:function(){f.removeListener("notification",this.handleNotificationsEvent)},bindNavigationHandler:function(){f.addListener("navigate",this.handlePreviewNavigate)},unbindNavigationHandler:function(){f.removeListener("navigate",this.handlePreviewNavigate)},bindLoadHandler:function(){f.addListener("load",this.handlePreviewLoad)},unbindLoadHandler:function(){f.removeListener("load",this.handlePreviewLoad)},bindViewerEventHandler:function(){f.addListener("viewerevent",this.handleViewerEvent)},unbindViewerEventHandler:function(){f.removeListener("viewerevent",this.handleViewerEvent)},setPreviewContext:function(e){d=e},clearPreviewContext:function(){d=null},updateCollection:function(){u&&d&&f.updateCollection(d.collectionFileIDs)},handleNotificationsEvent:function(t){e.broadcast("previewsdknotification",{notification:t})},handlePreviewNavigate:function(t){t!==p&&b<y[v.LOADED]&&b>=y[v.REQUESTED]&&r(v.INTERRUPTED),p=t,r(v.NAVIGATED),r(v.REQUESTED),e.broadcast("previewsdknavigate",{fileID:t}),this.clearDwellTimers()},handlePreviewLoadError:function(t){if(Object.prototype.hasOwnProperty.call(t,"error")){var n=t.file,i=n.file_version||{},o={error:t.error,fileID:n.id,fileVersionID:i.id,extension:n.extension,name:n.name};return r(v.ERROR,o),e.broadcast("previewsdkloaderror",o),!0}return!1},handlePreviewLoad:function(t){if(a.log(t),!this.handlePreviewLoadError(t)){var n=t.file||{},i=n.file_version||{},o={fileID:n.id,fileVersionID:i.id,extension:n.extension,name:n.name};this.logPreviewContentLoaded(),this.setDwellTimers(),r(v.LOADED,o),e.broadcast("previewsdkfileloaded",o)}},handleViewerEvent:function(t){var n=t.event;switch(n){case"printerror":e.broadcast("previewsdkprinterror")}},print:function(){u&&d&&d.fileID&&f.print()},prefetch:function(){u&&f.prefetchViewers(g)},showPreview:function(){if(u&&d){var t=d.fileID,n=d.collectionFileIDs,i=this.getAuthTokens.bind(this),o={api:e.getConfig("apiHost"),apiHost:e.getConfig("apiHost"),appHost:e.getConfig("appHost"),header:"none",collection:n,container:h,sharedLink:c.getSharedLink(),showAnnotations:e.getConfig("annotations"),showDownload:!0,viewers:{Office:{disabled:!e.getConfig("isExcelOnlinePreviewerEnabled"),shouldUsePlatformSetup:!1},Document:{preload:e.getConfig("preload")},Presentation:{preload:e.getConfig("preload")}}};this.clearDwellTimers(),p=t,r(v.REQUESTED),f.show(t,i,o)}},hidePreview:function(){u&&(this.clearDwellTimers(),r(v.CLOSED),f.hide())},logPreviewContentLoaded:function(){l.recordAction({application:"files",page:"preview",component:"",feature:"",target:"contentloaded",action:"programmatic"})},setDwellTimers:function(){this.clearDwellTimers(),m=setTimeout(function(){this.logPreviewDwellTime(5),m=setTimeout(function(){this.logPreviewDwellTime(10)}.bind(this),5e3)}.bind(this),5e3)},clearDwellTimers:function(){clearTimeout(m)},logPreviewDwellTime:function(e){l.recordAction({application:"files",page:"preview",component:"",feature:"",target:"dwell"+e,action:"programmatic"})}}}),Box.Application.addModule("preview-header-manager",function(e){"use strict";var t,n,r,i;return{messages:["previewchanged","previewheaderupdate"],init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getElement()},onmessage:function(e,t){("previewheaderupdate"===e||"previewchanged"===e&&!t.skipHeaderLoad)&&this.loadHeader(t.fileID)},loadHeader:function(o){var a={fileID:o},s=e.getService("shared-context");i&&i.isPending()&&i.cancel(),this.disableButtons(),s.addSharedParams(a),i=t.get("preview_get_header",a),i.then(function(e){n.setHTML(r,e.data.html)}).catch(function(){})},disableButtons:function(){var e=n.queryAll("button",r);e.forEach(function(e){e.disabled=!0,n.addClass(e,"is-disabled")})}}}),Box.Application.addModule("preview-overlay",function(e){"use strict";function t(e){var t,n,r=q.length;for(t=0;t<r;t++)if(n=e.match(q[t]))return n[1];return""}function n(e){return q.some(function(t){return t.test(e)})}var r,i,o,a,s,l,c,u,d,f,p,m,h,g,v,y,b,_,w,S,k,E,C,x="properties",T="metadata",A="preview_get_folder_collection_file_ids",I="preview_get_files_metadata",O=["doc","docx","gdoc","gsheet","ods","odt","pdf","rtf","wpd","xls","xlsm","xlsx","odp","ppt","pptx"],D="[pdf][jpg?dimensions=1024x1024&paged=false]",M=50,P="is-preview-visible",N=new RegExp("^/file/(\\d+)$"),R=new RegExp("^/embed/.*file/(\\d+)$"),F=new RegExp("^/(?:s|shared)/(?:[0-9a-zA-Z]{10}|[0-9a-zA-Z]{20}|[0-9a-zA-Z]{32})/file/(\\d+)$"),B=new RegExp("^/v/[^/]+/file/(\\d+)$"),q=[N,R,F,B],L="is-preview-sidebar-visible",j="theme-darkroom",U="get_enable_iwork_online_preview_popup_runmode",H=!1;return{behaviors:["ajax-nav","menu-toggle-eu","preview-realtime-events","tooltips-amsterdam"],messages:["fileuploadsuccess","makecurrentversionsuccess","movesuccess","navigationend","popupclosed","popupopened","previewcloserequested","previewsidebartogglerequested","previewthemechangerequested","previewsdknavigate","previewsdkprinterror"],init:function(){o=e.getService("dom"),r=e.getService("ajax"),i=e.getService("aria"),u=e.getService("nav"),d=e.getService("notifications-amsterdam"),a=e.getService("dom-fragment"),s=e.hasService("file-list-manager")?e.getService("file-list-manager"):null,f=e.getService("resin"),p=e.getService("shared-context"),m=e.getService("keyboard-shortcuts"),g=e.getService("xhr"),l=e.getService("preview-auth"),c=e.getService("preview-context"),h=e.getService("url"),v=e.getService("popups-amsterdam"),b=o.query("body"),_=e.getElement(),w=o.query(".preview-sidebar-wrapper"),y=c.create(),C=e.getGlobal("document"),this.bindInterceptors();var t=e.getConfig()||{};t.showEnableIWorkOnlinePreviewPopup===!0&&this.showEnableIWorkOnlinePreviewPopup(t.extension),t.initialFileID&&this.handleInitialPreview(t.initialFileID,t.backURL,t.sidebar),this.handleEscapeKey=this.handleEscapeKey.bind(this),this.setupMediaQuery(),w&&w.addEventListener("transitionend",this.onSidebarResize),this.prefetchFilesMetadata()},destroy:function(){E.removeListener(this.onWidthChange)},onmessage:function(t,n){switch(t){case"makecurrentversionsuccess":b.classList.contains(P)&&u.reload();break;case"navigationend":this.handleNavigationPrefetch(n);break;case"previewsidebartogglerequested":this.toggleSidebar();break;case"previewthemechangerequested":this.changeTheme();break;case"previewcloserequested":this.navigateToReturnURL();break;case"fileuploadsuccess":b.classList.contains(P)&&u.reload();break;case"movesuccess":b.classList.contains(P)&&this.handleMoveEvent(n);break;case"previewsdknavigate":this.handlePreviewNavigate(n.fileID);break;case"previewsdkprinterror":this.handlePrintError();break;case"popupopened":e.broadcast("previewpopupopened");break;case"popupclosed":e.broadcast("previewpopupclosed")}},loadParentFolderHTML:function(e){g.send("get",e).done(function(e){var t=C.title;a.update(e.response),this.setReturnTitle(C.title),C.title=t,y.setSortDataFromFilesList(),y.isFullCollectionSupported()&&this.loadFolderCollectionFileIDs()}.bind(this))},setReturnURL:function(e){S=e},setReturnTitle:function(e){k=e},navigateToReturnURL:function(){u.navigate(S)},navigateToFile:function(t){var n=e.getService("embed-context"),r=n.getBasePath()+p.getBasePath(),i=y.getContext(),o=r+"/file/"+t;i.sidebar!==y.getDefaultSidebar()&&(o+="?sidebar="+i.sidebar),u.navigate(o)},loadFolderCollectionFileIDs:function(){var t=y.getContext();if(t.fileID&&t.sortColumn&&t.sortDirection){var n={fileID:t.fileID,sortColumn:t.sortColumn,sortDirection:t.sortDirection};p.addSharedParams(n),r.get(A,n).then(function(t){var n=t.data.collectionFileIDs;y.setCollectionFileIDs(n),e.broadcast("previewcollectionupdated",y.getContext())})}},handleNavigationPrefetch:function(e){if(e&&e.from&&e.to){var t=e.from.url.split("?")[0],r=e.to.url.split("?")[0],i=n(t),o=n(r);o||i||this.prefetchFilesMetadata()}},prefetchFilesMetadata:function(){var t=s?s.getCurrentFileIDs({includeExtensions:O}):[];if(t.length=Math.min(M,t.length),0!==t.length){var n={fileIDs:t};p.addSharedParams(n);var i={headers:{"X-Rep-Hints":D}};r.get(I,n,i).then(function(t){var n=t.data.filesMetadata;e.broadcast("previewfilesmetadatafetched",n)}),l.getTokens(t)}},show:function(t,n){b.classList.add(P),i.show(w),m.register({name:"preview-overlay",shortcuts:[{key:"esc",description:$t("Close Preview","kb_shortcuts_preview_overlay_close_preview"),handler:this.handleEscapeKey,type:"preview"}]},_),y.clearContext(),y.setFileID(t),y.isCollectionSupported()&&(y.setCollectionDataFromFilesList(),y.setSortDataFromFilesList()),n&&n.sidebar&&(y.setSidebar(n.sidebar),"metadata"===n.sidebar&&o.addClass(_,L));var r=y.getContext();e.broadcast("previewopen",r),n&&n.headerPreloaded&&(r.skipHeaderLoad=!0),e.broadcast("previewchanged",r),y.isFullCollectionSupported()&&this.loadFolderCollectionFileIDs(),this.logPreviewOpened()},hide:function(){o.removeClass(b,P),i.hide(w),m.deregister("preview-overlay",_),y.clearContext(),e.broadcast("previewclose")},bindInterceptors:function(){q.forEach(function(e){u.intercept(e,{enter:this.handleEnterState.bind(this),exit:this.handleExitState.bind(this)})},this)},handleFileNavigation:function(t){var n;return H?void(H=!1):(y.setFileID(t),n=y.getContext(),e.broadcast("previewopen",n),void e.broadcast("previewchanged",n))},handleEnterState:function(r,i){var o=i.url.split("?")[0],a=n(o),s=h.getQueryParams(r.url),l=t(r.url.split("?")[0]),c={},u=s.sidebar;if(s.sidebar===T&&s.tab===x&&(u="metadataEmptyProperties"),a)if(l!==t(o))this.handleFileNavigation(l);else{var d=h.getQueryParams(i.url);if(s.sidebar!==d.sidebar){y.setSidebar(u||"");var f=y.getContext();"metadata"===d.sidebar&&(f.initiallyShowDetailsTab=!0),e.broadcast("previewsidebarchanged",f)}}else this.setReturnURL(i.url),this.setReturnTitle(i.title),u&&(c.sidebar=u),this.show(l,c);return!1},handleExitState:function(e){var t=e.url.split("?")[0],r=n(t);return r||(this.hide(),k&&(C.title=k)),S!==e.url},handleEscapeKey:function(){f.recordActionFromElement(o.query(".preview-close-btn",_),{target:"close",action:"keypress"}),this.navigateToReturnURL()},handleInitialPreview:function(e,t,n){this.setReturnURL(t),this.loadParentFolderHTML(t),setTimeout(function(){this.show(e,{headerPreloaded:!0,sidebar:n})}.bind(this),0)},handlePreviewNavigate:function(t){H=!0,y.setFileID(t),this.navigateToFile(t),e.broadcast("previewchanged",y.getContext())},handleMoveEvent:function(e){var t=e.items||[];if(t&&t[0]&&t[0].typedId){var n=t[0].typedId.substr(2),r=y.getContext();n===r.fileID&&this.navigateToReturnURL()}},handlePrintError:function(){d.error($t("Unable to print file. Disable popup blockers and try again.","print_error_popup_blocker_warning"))},toggleSidebar:function(){_.classList.toggle(L)},changeTheme:function(){_.classList.toggle(j)},onWidthChange:function(e){e.matches?o.removeClass(_,L):o.addClass(_,L)},onSidebarResize:function(t){t.target===w&&e.broadcast("previewresizerequested")},setupMediaQuery:function(){var t=e.getGlobal("window");E=t.matchMedia("(max-width: 1000px)"),E.addListener(this.onWidthChange),this.onWidthChange(E)},logPreviewOpened:function(){f.recordAction({application:"files",page:"preview",component:"",feature:"",target:"loaded",action:"programmatic"})},showEnableIWorkOnlinePreviewPopup:function(e){v.open(U,{data:{extension:e}})}}}),Box.Application.addModule("promo-sidebar",function(e){"use strict";function t(){return L+k}function n(){return j+k}function r(){var e=E.queryAll("[data-promo]",T);return e.map(function(e){return e.getAttribute("data-promo-id")})}function i(){E.addClass(E.query(q),O)}function o(){return C.getItem(t())||{}}function a(e){C.setItem(t(),e)}function s(e,t){e.forEach(function(e){t.hasOwnProperty(e)||(t[e]=I)})}function l(e){var t=E.query(B,T),n=E.query('[data-slide-name="'+e+'"]',t);t.removeChild(n)}function c(e,t){t[e]===A&&l(e)}function u(e){var t=o();s(e,t);var n=e.filter(function(e){return c(e,t),t[e]===I});return a(t),1===n.length&&i(),n}function d(e){var t=o();return t&&t.hasOwnProperty(e)}function f(e){var t=o();t[e]=A,a(t)}function p(e){var t=E.query(".promo-sidebar-inner",T);e.length&&(E.addClass(t,"slides"),e.forEach(function(e){var n=E.query('[data-slide-name="'+e+'"]',t);E.addClass(n,"slide"),E.removeClass(n,O)}),E.addClass(E.query(".slide",t),"is-active"),E.removeClass(T,O))}function m(){S=e.getService("slide-carousel"),x=S.create(T)}function h(t,n){var r=e.getService("logger");r.sendLog(N,t,n)}function g(){var e=E.queryAll(".slide",T);1===e.length&&i()}function v(e){if(d(e)){f(e),h(e+"_close_btn_clicked");var t=E.queryAll(".slide",T);if(1===t.length)return void E.addClass(T,O);x.goToNextSlide(!0),l(e),g(),m()}}function y(){C.setItem(n(),!1)}function b(){var t=C.getItem(n()),r=e.getConfig("showLearnByDoingTour");return null===t&&(y(),r===!0)}function _(){h("sync_download_cta_button_clicked");var t=e.getService("browser"),n=t.getOSName(),r=e.getConfig("downloadSyncURL"),i=e.getService("url");i.goToUrlInBackground(r);var o=e.getService("popups-amsterdam");o.open(F,{width:"710px"}),h("show_sync_popup"),h("download_sync",{os_name:n})}function w(){h("mobile_download_cta_button_clicked");var t=e.getService("popups-amsterdam");t.open(R,{width:"555px"}),h("show_mobile_popup")}var S,k,E,C,x,T,A=!1,I=!0,O="hidden",D="close-active-promo-card",M="mobile-button",P="sync-button",N="sidebar_buttons",R="download_mobile_app_popup",F="install_sync_info_popup",B=".promo-sidebar-inner",q=".slides-pagination",L="sidebar-promo-",j="first-login-";return{init:function(){E=e.getService("dom"),C=e.getService("local-store"),T=e.getElement(),k=e.getGlobalConfig("userId");var t=r(),n=u(t),i=b();n.length>0&&!i&&(p(n),m())},destroy:function(){x&&x.destroy&&"function"==typeof x.destroy&&x.destroy()},onclick:function(e,t,n){var r=x.getCurrentSlideName();switch(n){case D:v(r);break;case M:w(),f(r);break;case P:_(),f(r)}}}}),Box.Application.addModule("search-folder-filter",function(e){"use strict";var t,n,r,i,o,a,s,l="d_0",c="0",u="/folder/",d="/search";return{behaviors:["flyout-toggle","tooltips-amsterdam"],init:function(){n=e.getService("folder-tree"),r=e.getService("nav"),i=e.getService("page-events"),o=e.getService("url"),t=e.getService("dom"),a=e.getConfig("searchParams"),a.limitToFolder="on";var f=e.getConfig("folderID"),p=e.getElement(),m=t.query(".input-wrapper",p),h=l;if(f&&f!==c){t.addClass(m,"quick-search-folder-selected");t.query(".folder-tree-clear-search",p);h="d_"+f}i.getAfterPageLoadPromise().then(function(){s=n.create(p,h,{allowSelect:!1,quickSearchResultOnClickHandler:function(e){var t=e.data.getAttribute("data-item-typed-id"),n=o.createUrl(u+t.substr(2)+d,a);r.navigate(n,!0)},setFocus:!0}),s.events.on("click",function(e){var t=o.createUrl(u+e.data.substr(2)+d,a);r.navigate(t,!0)})})},onclick:function(e,t,n){if("clear-search"===n){var i=o.createUrl(u+c+d,a);r.navigate(i,!0)}},destroy:function(){s&&s.destroy()}}}),Box.Application.addModule("search-page-filters",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f="custom_search_time_range_popup";return{behaviors:["menu-toggle-eu","search-metadata","flyout-toggle"],init:function(){n=e.getService("url"),r=e.getService("dom"),a=e.getService("pill-selector"),s=e.getService("provider-contacts"),l=e.getService("search-filter-formatting-helper"),i=e.getService("tags-autocomplete"),t=e.getService("popups-amsterdam"),c=e.getElement();var o=r.query('.filter-owner input[name="owners"]',c);d=r.query(".tags-toggle-btn",c);var u=r.query(".owner-pill-selector",c),f=a.create(u,s.searchAllContacts({excludeWithoutAccount:!0,includeSelf:!0})),p=o.value,m=l.parseOwnerInputForPills(p);f.init(m),f.on("updated",function(){var e=f.getPills();return e.length?void(o.value=l.serializeOwnerPills(e)):void(o.value="")}),this.initTagsFilter()},initTagsFilter:function(){if(d){u=r.query('.filter-tags input[name="tags"]',c);var e=r.query(".tags-autocomplete",c),t=u.value,n=t?t.split(","):[];o=i.create(e,n)}},onclick:function(e,r,i){switch(i){case"apply-tags":u.value=o.getValue();break;case"custom-time-range-popup":var a=n.getCurrentQueryParams();t.open(f,{width:"260px",disableAutoFocus:!0,data:{updatedTimeFrom:a.updatedTimeFrom,updatedTimeTo:a.updatedTimeTo}})}}}}),Box.Application.addModule("shared-file-header",function(e){"use strict";return{behaviors:["menu-toggle-eu"],onclick:function(t,n,r){if("download-btn"===r){t.preventDefault();var i=e.getService("item-actions"),o=n.getAttribute("data-typed-id");i.download([o])}}}}),Box.Application.addModule("shared-file-page",function(e){"use strict";var t;return{behaviors:["tooltips-amsterdam"],init:function(){var n=e.getService("preview-context"),r=e.getElement(),i=r.getAttribute("data-file-id");t=n.create(),setTimeout(function(){this.loadPreviewContent(i)}.bind(this),0)},loadPreviewContent:function(n){t.clearContext(),t.setFileID(n),e.broadcast("previewopen",t.getContext())}}}),Box.Application.addModule("global-sidebar",function(e){"use strict";var t,n,r,i,o,a,s,l,c,u,d,f,p="d_0",m="hidden",h="is-loading";return{messages:["file-list-selection-updated","item-change-classification","item-extend-retention"],init:function(){t=e.getService("dom"),n=e.getService("nav"),r=e.getService("xhr"),i=e.getElement(),o=t.query(".global-sidebar-default",i),a=t.query(".sidebar-multiselect-placeholder",i),s=t.query(".sidebar-multiselect-placeholder-text",i),l=t.query(".sidebar-itemselect-placeholder",i),l&&(c=l.innerHTML),f=e.getConfig()||{},u=i.getAttribute("data-folder-typed-id"),u&&u!==p&&this.loadItemSidebar(u,o)},onmessage:function(e,t){switch(e){case"file-list-selection-updated":a&&this.updateSelection(t.map(function(e){return e.id}));break;case"item-change-classification":case"item-extend-retention":this.updateSelection([t.itemTypedID])}},abortOngoingRequest:function(){d&&(d.abort(),d=null)},resetOriginalPlaceholder:function(){t.setHTML(l,c)},updateSelection:function(n){t.addClass(o,m),t.addClass(a,m),t.addClass(l,m),this.abortOngoingRequest(),n&&0!==n.length?1===n.length?this.loadItemSidebar(n[0],l):(t.removeClass(a,m),t.setText(s,$t("%1 Selected","sidebar_selected_items_placeholder",n.length))):(this.resetOriginalPlaceholder(),t.removeClass(o,m)),e.broadcast("sidebarselectionupdated")},loadItemSidebar:function(i,o){this.resetOriginalPlaceholder(),t.removeClass(o,m),t.addClass(o,h);var a=this.getSidebarURL(i);d=r.send("GET",a),d.then(function(n){t.removeClass(o,h),t.setHTML(o,n.responseText),d=null,e.broadcast("sidebarcontentloaded")}).catch(function(e){401===e.status&&n.reload(!0)})},getSidebarURL:function(t){var n,r=e.getService("embed-context"),i=e.getService("shared-context"),o=r.getBasePath()+i.getBasePath(!0);switch(t[0]){case"d":n="folder";break;case"f":n="file";break;case"l":n="web_link"}var a=o+"/"+n+"/"+encodeURIComponent(t.substr(2))+"/sidebar";return f.isItemDeleted?a+="?isDeleted=true":f.isSearchResult?a+="?isSearchResult=true":f.isSyncItem&&(a+="?isSyncItem=true"),a}}}),Box.Application.addModule("preview-adv-sidebar",function(e){"use strict";var t,n,r,i,o,a,s,l="metadata",c="metadataEmptyProperties";return{messages:["item-change-classification","item-extend-retention","previewchanged","previewclose","previewsidebarchanged"],init:function(){t=e.getService("dom"),n=e.getService("xhr"),r=e.getElement(),i=t.query(".sidebar-itemselect-placeholder",r),t.removeClass(i,"hidden"),i&&(o=i.innerHTML),s=e.getConfig()||{}},onkeydown:function(e){var n=e.target,r=e.originalEvent;if(n.hasAttribute("contenteditable")||"INPUT"===n.nodeName||"TEXTAREA"===n.nodeName){var i=r.key||r.keyIdentifier,o=e.shiftKey;if(0===i.indexOf("U+")&&(i=String.fromCharCode(parseInt(i.replace("U+","0x"),16))),0===i.indexOf("Arrow")&&(i=i.replace("Arrow","")),o||"_"!==i&&"+"!==i)switch(i){case"+":case"_":case"Left":case"Right":var a=t.query(".pika-single");a&&t.isVisible(a)||e.stopPropagation()}}},onmessage:function(e,t){switch(e){case"item-change-classification":case"item-extend-retention":t.fileID=t.itemTypedID.substr(2),this.loadFileSidebar(t);break;case"previewchanged":case"previewsidebarchanged":this.loadFileSidebar(t)}},abortOngoingRequest:function(){a&&(a.abort(),a=null)},resetOriginalPlaceholder:function(){t.setHTML(i,o)},loadFileSidebar:function(r){var o=r.fileID,u=r.sidebar,d=r.initiallyShowDetailsTab,f=e.getService("embed-context"),p=e.getService("shared-context"),m=f.getBasePath()+p.getBasePath(!0);this.abortOngoingRequest(),this.resetOriginalPlaceholder(),t.addClass(i,"is-loading");var h=m+"/file/"+encodeURIComponent(o)+"/sidebar";u===l?h+="?showMetadataSidebar=true":u===c?h+="?showMetadataSidebar=true&showEmptyCustomMetadataEditor=true":(h+="?fromPreview=true",s.isSearchResult&&(h+="&isSearchResult=true"),d&&(h+="&initiallyShowDetailsTab=true"),f.isEmbedWidget()&&!f.showItemFeedActions()&&(h+="&showItemFeedActions=false")),a=n.send("GET",h),a.then(function(e){t.removeClass(i,"is-loading"),t.setHTML(i,e.responseText),a=null})}}}),Box.Application.addModule("sidebar-activity-feed",function(e){"use strict";function t(e){S.send("GET","/file/"+encodeURIComponent(e)+"/activityfeed").then(S.parseJSONResponse).then(function(e){g.setProps({isLoading:!1,feedState:e})})}function n(e){return{name:e.name,id:""+e.id,avatarUrl:e.has_custom_avatar?e.pic_urls.large:null}}function r(e){var t=g.props.feedState.slice(0);t.unshift({type:"comment",taggedMessage:e,id:"pending",createdBy:T,createdAt:Date.now(),isPending:!0}),g.setProps({feedState:t})}function i(e,t){var n=g.props.feedState.slice(0),r=n.shift();r.error={title:e,message:t},n.unshift(r),g.setProps({feedState:n})}function o(e,t,n){var r=g.props.feedState.slice(0),i=t.map(function(e,t){return{user:{name:"",id:t},status:"incomplete"}});r.unshift({type:"task",taggedMessage:e,assignees:i,dueDate:0!==n?new Date(n):null,id:"pending",createdBy:T,createdAt:Date.now(),isPending:!0}),g.setProps({feedState:r})}function a(e){var t=g.props.feedState.slice(1);t.unshift(e),g.setProps({feedState:t})}function s(e,t){var n=g.props.feedState.slice(0);n=n.filter(function(n){return!(n.type===e&&n.id===t)}),g.setProps({feedState:n})}function l(e){var t,n=g.props.feedState.slice(0);return n=n.map(function(n){return"task"===n.type&&n.id===e.id&&(t=JSON.parse(JSON.stringify(n)),n.taggedMessage=e.taggedMessage),n}),g.setProps({feedState:n}),t}function c(e,t,n){var r,i=g.props.feedState.slice(0);return i=i.map(function(i){return"task"===i.type&&i.id===e&&(r=JSON.parse(JSON.stringify(i)),i.assignees=i.assignees.map(function(e){return e.id===t&&(e.status=n),e})),i}),g.setProps({feedState:i}),r}function u(e,t){var n=g.props.feedState.slice(0);n=n.map(function(n){return"task"===n.type&&n.id===e.id&&(n=e,n.error={title:$t("Assignment update error","task_assignment_update_error"),message:t}),n}),g.setProps({feedState:n})}function d(e,t){var n=g.props.feedState.slice(0);n=n.map(function(n){return"task"===n.type&&n.id===e.id&&(n=e,n.error={title:$t("Task update error","task_update_error"),message:t}),n}),g.setProps({feedState:n})}function f(e){return e?e.reduce(function(e,t){return t.isNotSelectable?e:e.concat([{id:t.id,name:t.text,item:{name:t.text,email:t.email}}])},[]):[]}function p(e,t){var n=g.props.inputState;n[t]=e,g.setProps({inputState:n})}function m(e,t){var n=g.props.feedState.slice(0);n=n.map(function(n){return n.id===e&&(n.translatedTaggedMessage=t),n}),g.setProps({feedState:n})}function h(e,t){var n=g.props.feedState.slice(0);n=n.map(function(n){return n.id===e&&(n.error={title:$t("An error occured","comment_error_occured"),message:t}),n}),g.setProps({feedState:n})}var g,v,y,b,_,w,S,k,E,C="comment",x={},T=null,A=null,I=null;return{init:function(){v=e.getService("provider-contacts"),y=e.getService("dom"),b=e.getService("fileop-comment"),_=e.getService("fileop-task"),w=e.getService("popups-amsterdam"),S=e.getService("xhr"),k=e.getService("google-translations"),E=e.getService("resin"),I=e.getElement();var r=e.getService("react-components"),i=e.getService("react-component-renderer"),o=y.query(".mount-node",I),a=r.getComponent("ActivityFeedUI"),s=e.getConfig(),l=s.currentUser,c=s.permissions,u=s.isGoogleTranslationEnabled;T=n(l),A=I.getAttribute("data-file-id"),x.isLoading=!0,x.inputState={currentUser:T,approverSelectorContacts:[],mentionSelectorContacts:[]},x.handlers={comments:{create:c.comments?this.createComment:null,delete:c.comments?this.deleteComment:null},tasks:{create:c.tasks?this.createTask:null,delete:c.tasks?this.deleteTask:null,edit:c.tasks?this.updateTask:null,onTaskAssignmentUpdate:this.updateTaskAssignment},contacts:{getApproverWithQuery:this.getApproverSelectorContacts,getMentionWithQuery:this.getMentionSelectorContacts},versions:{info:this.openVersionHistoryPopup}},x.translations={translationEnabled:u,onTranslate:this.translate},g=i.create(a,o),g.setProps(x),t(A)},destroy:function(){g.unmount()},createComment:function(e){r(e.text),b.create(A,e.text).then(S.parseJSONResponse).then(function(e){a(e)},function(e){var t=JSON.parse(e.responseText);i($t("An error occured","comment_error_occured"),t.message)}),E.recordActionFromElement(I,{component:"activityfeed",target:"commentcreate",action:"click"})},deleteComment:function(e){s("comment",e.id),b.remove(A,e.id),E.recordActionFromElement(I,{component:"activityfeed",target:"commentdelete",action:"click"})},createTask:function(e){var t=+e.dueDate;o(e.text,e.approvers,t),_.create(A,e.text,e.approvers,t/1e3).then(S.parseJSONResponse).then(function(e){var t=e.task;t.assignees=e.assignments.successfulAssignments,a(t)})},updateTask:function(e){var t=c(e.id,null,status);_.updateTask(A,e.id,e.text).then(S.parseJSONResponse).then(function(e){var t=e.task;l(t)},function(e){var n=JSON.parse(e.responseText);d(t,n.message)})},deleteTask:function(e){s("task",e.id),_.remove(A,e.id)},updateTaskAssignment:function(e,t,n){var r=null;"approved"===n?r="complete":"rejected"===n&&(r="decline");var i=c(e,t,n);_.updateAssignment(A,t,r).then(function(){},function(e){var t=JSON.parse(e.responseText);u(i,t.message)})},getApproverSelectorContacts:function(e){v.searchWithItem("f_"+A)(e).then(function(e){p(f(e),"approverSelectorContacts")})},getMentionSelectorContacts:function(e){v.searchWithItem("f_"+A)(e).then(function(e){p(f(e),"mentionSelectorContacts")})},openVersionHistoryPopup:function(e){var t;e.versionNumber?t=e.versionNumber:e.versions&&(t=e.versions[e.versions.length-1].versionNumber),w.open("version_history",{data:{fileId:A,scrollToVersion:t}})},translate:function(e){k.getTranslation(e.taggedMessage,A,C).then(function(t){var n=t.data||{};n.translatedText?m(e.id,n.translatedText):h(e.id,t.message)})}}}),Box.Application.addModule("sidebar-file",function(e){"use strict";var t,n;return{behaviors:["change-classification","extend-retention","sidebar-description-change","sidebar-focus-redirect","sidebar-name-change","sidebar-search-excerpts","sidebar-tabs","textarea-autogrow","metadata-readonly-tabs"],init:function(){t=e.getService("item-actions"),n=e.getConfig("itemTypedID")},onclick:function(e,r,i){if(r&&i){switch(i){case"access-stats-more-info":t.showAccessStatsPopup(n);break;case"sidebar-version-link":t.showVersionHistoryPopup(n)}e.preventDefault()}}}}),Box.Application.addModule("sidebar-folder",function(){"use strict";return{behaviors:["change-classification","sidebar-description-change","sidebar-focus-redirect","sidebar-name-change","sidebar-sync","sidebar-tabs","textarea-autogrow"]}}),Box.Application.addModule("sidebar-skills",function(e){"use strict";var t,n,r,i,o,a,s,l;return{init:function(){l=!1,t=e.getService("assets-dynamic"),i=e.getService("preview-instance"),n=e.getService("preview-auth"),r=e.getService("shared-context"),o=!1,a=e.getElement(),this.loadSidebarSDK()},destroy:function(){l=!0},getPreviewer:function(){if(s=i.instance(),!s)return null;var e=s.getCurrentViewer();return e?e:null},loadSidebarSDK:function(){var n=t.loadJS([e.getConfig("sidebarjs")]);t.loadCSS([e.getConfig("sidebarcss")]),n.then(function(){this.setSidebarSDKLoadedFlag(),this.showSidebar()}.bind(this))},setSidebarSDKLoadedFlag:function(){o=!0},setPreview:function(e){s=e},getAuthTokens:function(e){var t=Array.isArray(e)?e:[e];return n.getTokens(t)},showSidebar:function(){if(!l){var t=e.getConfig("fileID");if(o&&t){var n=new Box.ContentSidebar,i=this.getAuthTokens.bind(this),s={apiHost:e.getConfig("apiHost"),hasSkills:!0,container:a,getPreviewer:this.getPreviewer.bind(this),sharedLink:r.getSharedLink()};n.show(t,i,s)}}}}}),Box.Application.addModule("sidebar-weblink",function(){"use strict";return{behaviors:["sidebar-description-change","sidebar-focus-redirect","sidebar-weblink-url-change","sidebar-name-change","sidebar-tabs","textarea-autogrow"]}}),Box.Application.addModule("trash-page-button-group",function(e){"use strict";function t(e){var t,n=!0,r=0;for(r=0;r<m.length;r++)if(t=m[r],!d[t][e]){n=!1;break}return n}function n(){var e;t(g)?(o.removeClass(f,"is-disabled"),f.disabled=!1,f.removeAttribute("title")):(e=$t("You do not have the permission to restore all of the selected items from trash.","restore_selected_from_trash_no_permission"),f.setAttribute("title",e),
o.addClass(f,"is-disabled"),f.disabled=!0),t(v)?(e=$t("Delete the selected items from trash.","delete_selected_from_trash"),o.removeClass(u,"is-disabled"),u.disabled=!1,f.removeAttribute("title")):(e=$t("You do not have the permission to delete all of the selected items from trash.","delete_selected_from_trash_no_permission"),u.setAttribute("title",e),o.addClass(u,"is-disabled"),u.disabled=!0)}function r(){o.hasClass(p,"hidden")&&(o.addClass(c,"hidden"),o.removeClass(p,"hidden"))}function i(){o.hasClass(c,"hidden")&&(o.addClass(p,"hidden"),o.removeClass(c,"hidden"))}var o,a,s,l,c,u,d,f,p,m,h="invalidParentFolder",g="restoreFromTrash",v="deleteFromTrash",y="/trash";return{messages:["file-list-selection-updated"],init:function(){o=e.getService("dom"),a=e.getService("fileop-deletefromtrash"),s=e.getService("fileop-restore"),d=e.getConfig("permissions"),l=e.getService("nav");var t=e.getElement();c=o.query(".trash-all-button-group",t),p=o.query(".trash-select-button-group",t),m=[],f=o.query(".restore-btn",p),u=o.query(".delete-btn",p)},onclick:function(e,t,n){function r(){l.navigateOrRefresh(y)}function i(){l.refresh()}function o(e){e&&e.message!==h&&l.refresh()}if(t&&t.disabled)return e.preventDefault(),void e.stopPropagation();switch(n){case"restore-all-btn":s.restoreAllItemsFromTrash().then(r).caught(function(){});break;case"delete-all-btn":a.deleteAllItems().then(r).caught(function(){});break;case"restore-btn":s.restoreItemsFromTrash(m).then(i).caught(o);break;case"delete-btn":a.deleteItems(m).then(i).caught(o);break;default:return}e.preventDefault(),e.stopPropagation()},onmessage:function(e,t){"file-list-selection-updated"===e&&(m=t.map(function(e){return e.id})||[],m.length?(n(),r()):i())}}}),Box.Application.addModule("trash-page-item-list",function(e){"use strict";var t,n,r,i,o,a="invalidParentFolder",s="is-multiple-selected";return{behaviors:["file-list-bulk-menu","file-list-selection","item-context-menus"],messages:["file-list-selection-updated"],init:function(){t=e.getService("dom"),n=e.getService("fileop-restore"),r=e.getService("fileop-deletefromtrash"),i=e.getService("nav"),o=e.getElement()},onclick:function(e,t,o){function s(){i.refresh()}function l(e){e&&e.message!==a&&i.refresh()}var c;switch(o){case"restore-menu-option":c=t.getAttribute("data-item-typed-id"),n.restoreItemsFromTrash([c]).then(s).caught(l);break;case"delete-menu-option":c=t.getAttribute("data-item-typed-id"),r.deleteItems([c]).then(s).caught(l);break;default:return}e.preventDefault()},onmessage:function(e,n){"file-list-selection-updated"===e&&(n.length>1?t.addClass(o,s):t.removeClass(o,s))}}}),Box.Application.addModule("trash-restore-folder-popup",function(e){"use strict";function t(){var e=i.query(p,c);s=a.create(e,g,{allowSelect:!0,setFocus:!0}),s.events.on("select",function(e){var t=e.data||{},n=t.id;("string"==typeof n||n instanceof String)&&(u=n.substring(2))})}function n(){var e,t=i.query(".btn-primary",c),n=i.queryAll(d,c);for(i.addClass(t,h),i.addClass(n,f),e=0;e<n.length;e++)n[e].disabled=!0}function r(e){e&&e.message!==m&&l.refresh()}var i,o,a,s,l,c,u,d=".btn",f="is-disabled",p=".folder-tree-container",m="invalidParentFolder",h="is-loading",g="d_0",v="/trash";return{behaviors:["tooltips-amsterdam"],init:function(){i=e.getService("dom"),o=e.getService("fileop-restore"),a=e.getService("folder-tree"),l=e.getService("nav"),c=e.getElement(),u=g.substring(2),t()},onclick:function(e,t,n){switch(n){case"restore-btn":this.restoreItems();break;case"restore-all-btn":this.restoreAllItems();break;default:return}e.preventDefault(),e.stopPropagation()},restoreItems:function(){var t=e.getConfig("itemTypedIds");n(),o.restoreItemsFromTrash(t,u).then(function(){l.refresh()}).catch(r)},restoreAllItems:function(){n(),o.restoreAllItemsFromTrash(u).then(function(){l.navigateOrRefresh(v)}).catch(r)}}}),Box.Application.addModule("first-login-tutorial",function(e){"use strict";var t,n=["selectstep","switchpath","markasperformed"];return{messages:["collabchanged","contentrefreshed","fileuploadsuccess","newitemadded","popupopened","previewclose","previewopen","selectstep","sharedlinkemailsent","sharelinkvalidemailentered","switchpath","markasperformed","filelistitemadded","setstepcompleteflag","popupclosed","bfdinstalled","mobilelinksentinwebtrialmodal"],init:function(){t=e.getService("first-login-tutorial")},onmessage:function(e,r){return n.indexOf(e)>-1?void t.onInternalMessageReceived(e,r):void t.onMessageReceived(e,r)},onclick:function(e,n,r){"close-tip"===r&&t.onInternalMessageReceived("stopstep")}}}),Box.Application.addModule("first-login-tutorial-progress-tracker",function(e){"use strict";function t(){return null===K&&(K=v.canUseTutorialService()),K}function n(){var t=e.getService("contextual-message");t.createMessageRepresentationWithContext("lbd_finish_modal",L,null).registerOnCloseCallback(function(){w||(h.addClass(S,q),v.destroy())}).setIsTriggeredByUserAction(!1).show()}function r(){var e=v.getProgressForCurrentUser();Object.keys(e).forEach(function(t){var n=e[t],r=h.query("[data-step="+t+"]",S),i=h.query("button",r);if(r.className=B,Array.isArray(G)){var o=G.indexOf(t);o>=0&&h.addClass(r,q)}h.addClass(r,W[n]),n!==$&&i.removeAttribute("data-tooltip")})}function i(){var e=v.getProgressForCurrentUser();Object.keys(e).forEach(function(t){var n=e[t],r=h.query("[data-progress-step="+t+"]",S);r.className=F,n===I&&h.addClass(r,O)})}function o(){h.removeClass(S,M),k&&(h.setText(k,U),k.setAttribute("aria-label","Hide the tour")),b=!1;var e=h.query("."+R,S);e&&e.click(),g.recordAction({target:"maximizeProgressTracker",action:"click"})}function a(){h.addClass(S,M),k&&(h.setText(k,H),k.setAttribute("aria-label","Show the tour")),b=!0,g.recordAction({target:"minimizeProgressTracker",action:"click"})}function s(){b?o():(i(),a())}function l(){S=e.getElement(),h.removeClass(S,q),k=h.query(".btn-minimize-maximize",S),r(),h.addClass(S,N),b=!1}function c(){v.setConfig(C,x,X,G,T,A),v.init(),l()}function u(){z.sendBatchLog(V,"after_showing_contextual_message_show_modal",{})}function d(){if(!t())return void z.sendBatchLog(V,"no_local_storage_show_modal",{});if(!_)return void z.sendBatchLog(V,"not_users_first_login_show_modal",{});z.sendBatchLog(V,"before_showing_contextual_message_show_modal",{});var n=e.getService("contextual-message");n.createMessageRepresentationWithContext("lbdstartingmodal","modal","page_all_files").registerOnCloseCallback(c).registerOnShowCallback(u).setIsTriggeredByUserAction(!1).show()}function f(){var t="modal",n="web_trial_add_user_congrats",r=e.getService("contextual-message");r.createMessageRepresentationWithContext(n,t,"page_all_files").registerOnCloseCallback(c).setIsTriggeredByUserAction(!0).show()}function p(){var t="modal",n="web_trial_goals_finished",r=e.getService("contextual-message");r.createMessageRepresentationWithContext(n,t,"page_all_files").setIsTriggeredByUserAction(!0).show()}function m(){var t=e.getConfig("showLearnByDoingTour"),n=v.getProgressForCurrentUser(),r=0!==Object.keys(n).length;return t&&r}var h,g,v,y,b,_,w,S,k,E,C,x,T,A,I="done",O="is-completed",D="is-locked",M="is-minimized",P="is-not-started",N="is-ready",R="is-started",F="step",B="tutorial-step",q="hidden",L="modal",j="lbdstartingmodal",U="▬",H="▭",$="locked",V="experiment_data",W={done:O,locked:D,notstarted:P,started:R},K=null,z=e.getService("logger"),G=[],X=[];return{behaviors:["tooltips-amsterdam"],messages:["tutorialcompleted","tutorialprogresschanged","tutorialvisiblestepscompleted","message-registered","message-shown","message-closed","contentrefreshed","useraddedinwebtrialmodal","addusermodalclosed"],init:function(){return h=e.getService("dom"),g=e.getService("resin"),y=e.getService("url"),v=e.getService("first-login-tutorial"),E=e.getService("contextual-tooltips"),t()?(_=e.getConfig("isFirstLogin"),w=e.getConfig("showGamificationGoals"),C=e.getConfig("tutorialSteps"),x=e.getConfig("alternativeSteps"),G=e.getConfig("hiddenSteps"),X=e.getConfig("completedSteps"),T=e.getConfig("shouldAutoLaunchNextStep"),A=e.getConfig("shouldMarkCompletionOnServer"),void(!_&&m()&&(z.sendBatchLog(V,"not_first_login_init_tracker",{}),v.setConfig(C,x,X,G,T,A),v.show(),l()))):void z.sendBatchLog(V,"no_local_storage_init_tracker",{})},onmessage:function(e,t){switch(e){case"contentrefreshed":!_&&w&&c();break;case"tutorialprogresschanged":r();break;case"tutorialvisiblestepscompleted":G=[],r(),setTimeout(p,1e3);break;case"tutorialcompleted":w||setTimeout(n,0);break;case"message-registered":t.name===j&&d();break;case"message-shown":E.onContextualMessageShown();break;case"message-closed":E.onContextualMessageClosed();break;case"useraddedinwebtrialmodal":X.push("share");var i=h.query(".gamification-goals .tutorial-steps"),o=h.query('li[data-step="share"]');i.insertBefore(o,i.firstChild),f();break;case"addusermodalclosed":c()}},onclick:function(t,n,r){switch(t.preventDefault(),t.stopPropagation(),r){case"minimize-maximize":s();break;case"maximize-progress-tracker":b&&o();break;case"select-step":var i=h.getNearest(n,"[data-step]");(h.hasClass(i,P)||h.hasClass(i,R))&&e.broadcast("selectstep",{stepName:i.getAttribute("data-step")});break;case"more-advanced-tips":y.openWindow(t.target.href)}}}}),Box.Application.addModule("web-trial-add-user",function(e){"use strict";function t(){if(!m){m=!0;var t={stepName:h};s.post(g,t).then(function(){l.fire("closemodal"),e.broadcast("useraddedinwebtrialmodal")},function(){var t=$t("Sorry, we couldn't mark the task as completed for now. Please try again.","error_mark_task_completion_failure");d.error(t),l.fire("closemodal"),e.broadcast("addusermodalclosed")})}}function n(e){var t=$t("Sorry, we couldn't invite %1. That user may already have a registered Box account.","web_trial_add_user_error",e.email);d.error(t)}function r(e,r){return e&&e.data.success!==!0?void n(r):void t()}function i(){var e=[],t=c.queryAll(".web-trial-invite");return t.forEach(function(t){var n={};n.name=c.query('input[name="userName"]',t).value,n.email=c.query('input[name="userEmail"]',t).value,n.name&&n.email&&e.push(n)}),e}function o(e){e.preventDefault();var t=i();t.forEach(function(e){var t={public_name:e.name,email:e.email,space:10,space_amount:10,language_id:p.value,has_see_other_slaves:"yes",see_other_slaves:"on",has_is_sync_user:"yes",is_sync_user:"on",has_is_exempt_from_device_limits:"yes",has_is_external_collab_restricted:"yes"};s.post("box_master_users_add_user_via_form",t).then(function(t){r(t,e)},function(){n(e)})}),u.recordAction({application:"webapp",page:"webtrial",component:"gamification",feature:"adduserrequestsent-"+t.length,target:"inviteteammatemodal",action:"programmatic"})}function a(){var e=c.query(".web-trial-invites"),t=c.query(".web-trial-invite-template"),n=t.cloneNode(!0);c.removeClass(n,"web-trial-invite-template"),c.addClass(n,"web-trial-invite"),e.appendChild(n)}var s,l,c,u,d,f,p,m,h="share",g="amsterdam_onboarding_gamifiaction_submit_mark_goal_completed";return{init:function(){s=e.getService("ajax"),c=e.getService("dom"),u=e.getService("resin"),l=e.getService("custom-event-bus"),d=e.getService("notifications-amsterdam"),f=e.getElement(),p=c.query('input[name="userLanguageId"]',f),m=!1},onsubmit:function(e,t,n){switch(n){case"web-trial-invite-teammates":o(e)}},onclick:function(t,n,r){switch(r){case"close-modal":e.broadcast("addusermodalclosed");break;case"invite-more":a()}}}}),Box.Application.addModule("web-trial-bfd",function(e){"use strict";function t(e,t){}function n(){e.broadcast("getcontextualmessageinfo",{name:y,type:"popout"}),t("web_trial_get_ghost_message_info")}function r(){a.post(v,{id:_,context:b}),t("web_trial_mark_ghost_message_seen")}function i(){var e=s.getOSName(),n="";n=e===m?h:g,f.goToUrlInBackground(n),t("bfd_download_cta_button_clicked")}function o(){var e="popout",n="",r=u.query(".slides .is-active",p);switch(r.getAttribute("data-slide-name")){case"downloadbfd":case"clickinstaller":n="web_trial_bfd_popout1";break;default:n="web_trial_bfd_popout2"}l.createMessageRepresentation(n,e).setIsTriggeredByUserAction(!0).show(),t("bfd_show_web_trial_popout")}var a,s,l,c,u,d,f,p,m="Mac",h="https://e3.boxcdn.net/box-installers/desktop/releases/mac/Box.pkg",g="https://e3.boxcdn.net/box-installers/desktop/releases/win/Box-x64.msi",v="contextual_message_mark_as_seen",y="web_trial_bfd_ghost_message",b=null,_=null,w=!1;return{messages:["realtimeupload","contextualmessageinfo"],init:function(){a=e.getService("ajax"),s=e.getService("browser"),c=e.getService("custom-event-bus"),l=e.getService("contextual-message"),u=e.getService("dom"),d=e.getService("logger"),f=e.getService("url"),p=e.getElement(),w=e.getConfig("triggerWebTrialPopup"),n()},onmessage:function(e,n){switch(e){case"realtimeupload":c.fire("modalgotoslide",3),t("upload_to_bfd_done");break;case"contextualmessageinfo":b=n.context,_=n.id,t("set_ghost_messsage_info")}},onclick:function(t,n,a){switch(a){case"web-trial-download-bfd":i();break;case"close-modal":w&&o();break;case"bfd-installed":r();break;case"gamification-bfd-installed":e.broadcast("bfdinstalled")}},_getGhostMessageInfo:function(){return{context:b,id:_}}}}),Box.Application.addModule("web-trial-goals-finished",function(e){"use strict";function t(){a.fire("closemodal"),l.recordAction({application:"webapp",page:"webtrial",component:"gamification",feature:"smsmobilelinkfail",target:"sendmobilelinkform",action:"programmatic"})}function n(n){return n.data.status!==d?void t():(a.fire("closemodal"),e.broadcast("mobilelinksentinwebtrialmodal"),void l.recordAction({application:"webapp",page:"webtrial",component:"gamification",feature:"smsmobilelinksuccess",target:"sendmobilelinkform",action:"programmatic"}))}function r(e,r){var i={phoneNumber:e,countryCode:r};o.post(u,i).then(n,t),l.recordAction({application:"webapp",page:"webtrial",component:"gamification",feature:"mobilelinkrequested",target:"sendmobilelinkform",action:"programmatic"})}function i(e){var t=s.query('input[name="phoneNumber"]',c),n=s.query('select[name="countryCode"]',c),i=t.value,o=n.value;r(i,o),e.preventDefault()}var o,a,s,l,c,u="send_mobile_app_download_link_to_phone_number",d="success";return{init:function(){o=e.getService("ajax"),s=e.getService("dom"),a=e.getService("custom-event-bus"),l=e.getService("resin"),c=e.getElement()},onsubmit:function(e,t,n){switch(n){case"web-trial-send-mobile-link":i(e)}}}}),Box.Application.addModule("web-trial-popout",function(e){"use strict";function t(e,t){}function n(){var e=r.getOSName(),n="";n=e===s?l:c,a.goToUrlInBackground(n),t("bfd_download_cta_button_clicked")}var r,i,o,a,s="Mac",l="https://e3.boxcdn.net/box-installers/desktop/releases/mac/Box.pkg",c="https://e3.boxcdn.net/box-installers/desktop/releases/win/Box-x64.msi";return{init:function(){a=e.getService("url"),r=e.getService("browser"),o=e.getService("logger"),i=e.getService("dom");var t=i.query(".contextual-popout-container");i.addClass(t,"web-trial-popout")},onclick:function(e,t,r){switch(r){case"web-trial-download-bfd":n()}}}}),Box.Application.addModule("updates-feed",function(e){"use strict";function t(){return n.getAttribute("data-update-type")}var n,r,i,o,a,s,l,c="is-loading",u="updates_page_get_updates",d=300,f=1;return{behaviors:["overflow-scroll-detection"],init:function(){n=e.getElement(),a=e.getService("ajax"),s=e.getService("dom"),l=e.getService("infinite-scroll"),i=e.getConfig().paging_id,r=s.query(".updates-feed",n);var t=this;o=l.listen(r,d),o.on("scrolled",function(e){t.loadMore(e.data)})},destroy:function(){o.stop()},loadMore:function(e){s.addClass(r,c),a.get(u,{pagingId:i,type:encodeURIComponent(t())}).then(function(t){var n=t.data;f++,i=n.paging_info.paging_id;var a=s.createFragmentFromHtml(n.html);r.appendChild(a),s.removeClass(r,c),n.updates.length?e():o.stop()},function(){s.removeClass(r,c),o.stop()})}}}),Box.Application.addModule("uploads-manager",function(e){"use strict";var t,n,r,i,o,a,s="is-cancelled",l="is-failed",c="is-inactive",u="is-uploading",d="is-completed",f="is-expanded",p=8e3,m=3500,h=5,g=null;return{behaviors:["tooltips-amsterdam"],init:function(){t=e.getService("dom"),n=e.getService("file-list-manager"),r=e.getService("notifications-amsterdam"),i=e.getElement(),o=i.querySelector("[role=progressbar]"),a=i.querySelector(".uploads-manager-body"),this.ongoingUploads=[],this.beforeUnloadListener=this.beforeUnloadListener.bind(this),t.on(window,"beforeunload",this.beforeUnloadListener)},destroy:function(){t.off(window,"beforeunload",this.beforeUnloadListener)},messages:["new-upload","upload-fail","upload-folder-created"],onmessage:function(e,t){switch(e){case"new-upload":this.registerUpload(t);break;case"upload-fail":r.info($t('There was an error preparing "%1" for upload.',"upload_manager_prepare_error",t));break;case"upload-folder-created":n.addItem(t.parent,t.id)}},onclick:function(e,n,r){"toggle-uploads-manager"===r&&(this.isUploadsManagerExpanded()?(t.removeClass(i,f),t.hasClass(i,d)&&this.setHideTimeout()):this.expandUploadManager())},updateUploadManager:function(){var n=0,r=0,o=0,a=0,s=0,p=this.ongoingUploads.length;if(p){this.ongoingUploads.forEach(function(e){e.cancelled?s++:e.failed?o++:e.completed&&a++,n+=e.size,r+=e.progress/100*e.size});var h=r/n*100,g=o+a+s;if(o>0&&(t.removeClass(i,u),t.addClass(i,l),t.addClass(i,f)),g===p){if(t.removeClass(i,u),t.addClass(i,d),h=0,this.ongoingUploads=[],this.setMasterProgressBar(100),0===o&&this.isUploadsManagerExpanded()&&t.removeClass(i,f),setTimeout(this.displayPopupNotifications.bind(this,o,a),m),arguments[0]&&"error"===arguments[0].type&&arguments[0].data){var v=e.getGlobalConfig("isFreeUser");if(v){var y=e.getService("popups-amsterdam");switch(arguments[0].data.error){case"request_entity_too_large":y.open("amsterdam_large_file_paywall_popup");break;case"insufficient_storage":y.open("amsterdam_storage_paywall_popup")}}}this.setHideTimeout()}else t.removeClass(i,c),t.removeClass(i,d),t.addClass(i,u),this.clearHideTimeout(),this.setMasterProgressBar(h)}},displayPopupNotifications:function(e,t){var n=$t("Show","show_files_uploaded_in_upload_manager"),i={duration:p};if(t>=1){var o=$t("%1 items were uploaded successfully.","current_user_uploaded_multiple_files_success_notification",t);1===t&&(o=$t("1 item was uploaded successfully.","current_user_uploaded_one_file_success_notification")),r.info(o,i).then(this.expandUploadManager.bind(this))}if(e>=1){var a=$t("%1 items failed to upload.","current_user_uploaded_multiple_files_fail_notification",e);1===e&&(a=$t("1 item failed to upload.","current_user_uploaded_one_file_fail_notification")),i.buttonText=[n],r.error(a,i).then(this.expandUploadManager.bind(this))}},expandUploadManager:function(){t.addClass(i,f),this.clearHideTimeout()},setHideTimeout:function(){this.clearHideTimeout(),this.isUploadsManagerExpanded()||(g=setTimeout(function(){for(t.addClass(i,c),t.removeClass(i,d),this.setMasterProgressBar(0);a.firstChild;)a.removeChild(a.firstChild)}.bind(this),p))},isUploadsManagerExpanded:function(){return t.hasClass(i,f)},registerUpload:function(t){this.ongoingUploads.push(t),this.ongoingUploads.length===h&&this.expandUploadManager(),t.on("progress",this.updateUploadManager.bind(this)),t.on("error",this.updateUploadManager.bind(this)),t.on("cancelled",this.updateUploadManager.bind(this)),t.on("completed",function(r){n.addItem(t.destinationFolder,r.data),e.broadcast("fileuploadsuccess",{fileID:r.data.slice(2)}),this.updateUploadManager.bind(this)()}.bind(this)),this.createAndBindUploadRow(t),this.clearHideTimeout(),this.updateUploadManager()},createAndBindUploadRow:function(e){var n=document.createElement("li"),r=document.createElement("span");r.className="upload-name",t.setText(r,e.name),n.appendChild(r);var i=document.createElement("span");i.className="upload-progress",e.on("progress",function(e){t.setText(i,Math.floor(e.data)+"%")}),n.appendChild(i);var o=$t("Cancel this upload","uploads_manager_cancel_button_text"),c=document.createElement("span");c.className="cancel-upload-btn",c.setAttribute("data-tooltip",""),c.setAttribute("data-tooltip-position","top"),c.setAttribute("data-tooltip-text",o),c.setAttribute("aria-label",o),t.on(c,"click",function(){e.cancel()}),n.appendChild(c),e.on("completed",function(){t.addClass(n,d),t.addClass(i,d),t.setHTML(i,"")}),e.on("error",function(e){t.addClass(n,l),t.addClass(i,l),t.setText(i,e.data.reason||e.data)}),e.on("cancelled",function(){t.addClass(n,s),t.setText(i,$t("Cancelled.","upload_cancelled_message"))}),a.appendChild(n)},beforeUnloadListener:function(e){if(this.ongoingUploads.length)return e.returnValue=$t("Are you sure you wish to leave? This will cancel your ongoing uploads.","amsterdam_uploads_manager_beforeunload"),e.originalEvent&&(e.originalEvent.returnValue=e.returnValue),e.returnValue},clearHideTimeout:function(){g&&(clearTimeout(g),g=null)},setMasterProgressBar:function(e){o.firstChild.style.width=e+"%",o.setAttribute("aria-valuenow",e)}}});Box.Application.addModule("watermarking-popup",function(e){"use strict";var t,n,r,i,o;return{behaviors:["tooltips-amsterdam"],init:function(){t=e.getService("ajax"),n=e.getService("dom"),r=e.getService("notifications-amsterdam"),i=e.getService("popups-amsterdam"),o=e.getElement()},onsubmit:function(e){e.preventDefault(),this.handleSubmit(),i.close({unsafeSkipRefresh:!0})},handleSubmit:function(){var e=n.query(".watermark-enable-checkbox",o);if(!e.disabled){var t=e.checked;t?this.enableWatermarking():this.disableWatermarking()}},enableWatermarking:function(){var e=o.getAttribute("data-name"),n=o.getAttribute("data-typed-id");t.post("enable_watermarking",{itemTypedID:n}).then(function(){r.info($t("Watermark enabled for %1","popup_action_enable_watermark_notification",e))}).catch(function(){r.error($t("There was a problem enabling the watermark for %1. Please try again or refresh the page.","popup_action_error_while_enabling_watermark",e))})},disableWatermarking:function(){var e=o.getAttribute("data-name"),n=o.getAttribute("data-typed-id");t.post("disable_watermarking",{itemTypedID:n}).then(function(){r.info($t("Watermark disabled for %1","popup_action_disable_watermark_notification",e))}).catch(function(){r.error($t("There was a problem disabling the watermark for %1. Please try again or refresh the page.","popup_action_error_while_disabling_watermark",e))})}}});Box.Application.addService("ajax",function(e){"use strict";function t(e){4!==e.readystate&&e.abort()}function n(e,t){return{status:t.status,data:e}}function r(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return{status:e.status,data:t}}function i(e){return"parsererror"===e?"JSON Parse Error":"Server Error"}function o(t,n){if($.isEmptyObject(t)&&$.isEmptyObject(n))return l.createResolved();var r=e.getService("assets"),i=l.create(function(e){r.loadJSByHash(t,function(){e()})}),o=l.create(function(e){r.loadCSSByHash(n,function(){e()})});return l.all([i,o])}function a(e){return!("$ver"in e||"data"in e)}function s(s,c,u,d,f){function p(t,s){function l(r,i,l){function c(){"function"==typeof d&&(f.context?d.call(f.context,u):d(u))}var u,d=f.success,p=null===r||"undefined"==typeof r;if(p)r=null;else{if(!$.isPlainObject(r))return void s(new Error("Invalid Response Data. Response data must be a plain object."));if("unidb"===r.type&&"params"in r){var m=e.hasService("unidb")?e.getService("unidb"):null;m&&(r=m.decode(r))}}p||a(r)?(u=n(r,l),c(),t(u)):(u=n(r.data,l),o(r.js||{},r.css||{}).then(function(){c(),t(u)},function(){s(new Error("Assets could not be loaded correctly"))}))}function c(e,t,n){if(0!==e.status||"abort"!==t||"abort"!==n){var o=r(e),a=f.error;"function"==typeof a&&(f.context?a.call(f.context,o):a(o));var l=new Error(i(t));l.status=o.status,l.data=o.data,s(l)}}h=$.ajax(g).done(l).fail(c)}var m,h,g={type:s,dataType:c,url:"/index.php?rm="+u,data:d,dataFilter:function(e){return""===e?null:e},beforeSend:function(e){e.setRequestHeader("X-Requesting-Application","EndUser"),e.setRequestHeader("X-Box-Client-Name","amsterdam"),e.setRequestHeader("X-Box-Client-Version","1.0.0")},headers:f.headers||{}};return m=l.createCancellable(p).caught(l.CancellationError,function(e){throw t(h),e}),"function"!=typeof f.success&&"function"!=typeof f.error||m.then(function(){},function(){}),m}var l=e.getService("promises");return{get:function(e,t,n){return n=n||{},s("GET","json",e,t,{success:n.success,error:n.error,context:n.context,headers:n.headers})},post:function(t,n,r){return r=r||{},n=n||{},n.request_token&&e.reportError(new Error("Request token will be appended automatically and should not passed in manually")),n.request_token=e.getGlobalConfig("requestToken")||e.getGlobal("request_token"),s("POST","json",t,n,{success:r.success,error:r.error,context:r.context,headers:r.headers})}}}),Box.Application.addService("assets-dynamic",function(e){"use strict";function t(e){return e in s}function n(e){if(t(e))return s[e];var n;return s[e]=i.create(function(e){n=e}),o.getAfterPageLoadPromise().then(function(){var t=a.createElement("script");t.src=e,t.onload=function(){n()},a.body.appendChild(t)}),s[e]}function r(e){if(t(e))return s[e];var n;return s[e]=i.create(function(e){n=e}),o.getAfterPageLoadPromise().then(function(){var t=a.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,t.onload=function(){n()},a.head.appendChild(t)}),s[e]}var i=e.getService("promises"),o=e.getService("page-events"),a=e.getGlobal("document"),s={};return{loadJS:function(e){return i.all(e.map(function(e){return n(e)}))},loadCSS:function(e){return i.all(e.map(function(e){return r(e)}))}}}),Box.Application.addService("box-edit-amsterdam",function(e){"use strict";function t(e){var t=e.toUpperCase();return"."===t.charAt(0)&&(t=t.substr(1)),p[t]?Promise.reject("extensionnotsupported"):Promise.resolve()}function n(e,t,n,r,i,o){var a=JSON.stringify({command_type:"launch_application",file_id:""+e,auth_token:t,auth_code:n,key_id:o,efile_id:r,eauth_code:i,browser_type:w.getName()});return a}function r(){var e=k.get(y);return!(!e||""!==k.get(e).replace(/\s|=/g,""))}function i(){var e=k.get(y),t=e.split("-"),n=t[2],r=t[3];return{key:n,secret:r}}function o(e){var t=S.generateKeyId(),n=S.convertToBase64(e),r="box-lcskey-"+t+"-"+n,i=(new Date).getTime()+m;return k.set(r,"",i),k.set(y,r,i),t}function a(e,t,a){var s,l;if(r()){var c=i(),u=c.secret;s=c.key,l=S.convertFromBase64(u)}else l=S.generateSecretAsArrayBuffer(),s=o(l);var d=S.encryptValue(e,l),f=S.encryptValue(a,l);return n(e,t,a,d,f,s)}function s(e){return JSON.stringify({request_type:"get_default_application",extension:e})}function l(){var e=C;C={},x=null;var t=Object.keys(e),n=s(t);return E.sendRequest(n).then(function(t){if(t&&t.default_application_name){var n=t.default_application_name;"[object Object]"===Object.prototype.toString.call(n)&&(n=[n]),n.forEach(function(t){var n=Object.keys(t)[0],r=t[n];r&&(e[n].resolve(r),delete e[n])})}Object.keys(e).forEach(function(t){e[t].reject()})})}function c(e){if(C[e])return C[e].promise;var t={},n=new Promise(function(e,n){t.resolve=e,t.reject=n});return t.promise=n,C[e]=t,n}function u(){var t=e.getGlobalConfig("isBoxEditV4Enabled"),n=e.getGlobalConfig("isBoxEditFallbackEnabled");return!e.getGlobalConfig("isBoxEditAllowed")||!t&&n?Promise.reject("boxeditnotallowed"):(t?(E=e.getService("com-server-client"),E.isInitialized()||E.initialize(b)):E||(E=e.getService("com-server").create(b)),E.getComServerStatus())}function d(){if(!r()){var e=S.generateSecretAsArrayBuffer();o(e)}}var f="create_open_on_desktop_token",p={A6P:1,AC:1,AS:1,ACR:1,ACTION:1,AIR:1,APP:1,AWK:1,BAT:1,BOXNOTE:1,CGI:1,CHM:1,CMD:1,COM:1,CSH:1,DEK:1,DLD:1,DS:1,EBM:1,ESH:1,EXE:1,EZS:1,FKY:1,FRS:1,FXP:1,GADGET:1,HMS:1,HTA:1,ICD:1,INX:1,IPF:1,ISU:1,JAR:1,JS:1,JSE:1,JSX:1,KIX:1,LUA:1,MCR:1,MEM:1,MPX:1,MS:1,MSI:1,MST:1,OBS:1,PAF:1,PEX:1,PIF:1,PL:1,PRC:1,PRG:1,PVD:1,PWC:1,PY:1,PYC:1,PYO:1,QPX:1,RBX:1,REG:1,RGS:1,ROX:1,RPJ:1,SCAR:1,SCR:1,SCRIPT:1,SCPT:1,SCT:1,SH:1,SHB:1,SHS:1,SPR:1,TLB:1,TMS:1,U3P:1,UDF:1,VB:1,VBE:1,VBS:1,VBSCRIPT:1,WCM:1,WPK:1,WS:1,WSF:1,XQT:1},m=31536e6,h=100,g="get_file_lock_status",v="box_edit_lock_prompt_popup",y="box-edit-secret-cookie-name",b="BoxEdit",_=e.getService("ajax"),w=e.getService("browser"),S=e.getService("box-edit-crypto"),k=e.getService("cookies"),E=null,C={},x=null,T=e.getService("notifications-amsterdam"),A=e.getService("popups-amsterdam");return d(),{checkBoxEditAvailability:function(){return u()},canOpenWithBoxEdit:function(e){return u().then(function(){return t(e)}).then(function(){var t=c(e);return x||(x=setTimeout(l,h)),t})},isFileEditable:function(t){var n=t.substr(2);return _.get(g,{fileID:n}).then(function(n){var r=n.data.isBoxEditable;if(r)return Promise.resolve(n.data.isLocked);var i=n.data.isConcurrentlyLocked;return i?T.error($t("This file is being concurrently edited in another application, so it cannot be opened in Box Edit.","boxedit_concurrently_locked_error")):T.error($t("This file has been locked by someone else. You must unlock it before opening it.","boxedit_locked_error")),e.broadcast("filealreadylocked",{itemTypedId:t}),Promise.reject()}).catch(function(){return Promise.reject()})},openFile:function(e,t){var n,r=!1;return this.isFileEditable(e).then(function(e){return r=e,this.canOpenWithBoxEdit(t)}.bind(this)).then(function(t){return n=t,_.get(f,{item_typed_id:e})}).then(function(t){var n=a(e.slice(2),t.data.token,t.data.auth_code);return E.sendCommand(n)}).then(function(t){var i=t;t.responseText&&"string"==typeof t.responseText&&(i=JSON.parse(t.responseText));var o="200"===i.status||"true"===i.success;o&&this.openLockPromptPopup(e,n,r)}.bind(this))},openLockPromptPopup:function(e,t,n){A.close(),A.open(v,{data:{itemTypedID:e,applicationName:t,isFileLocked:n}})}}}),Box.Application.addService("box-edit-crypto",function(e){"use strict";function t(e){for(var t=c.byteArrayToBase64(new Uint8Array(e)).replace(/-/g,"+").replace(/_/g,"/");t.length%4;)t+="=";return t}function n(e){return e=e.replace(/\s|=/g,""),c.base64ToByteArray(e)}function r(){return u.getRandomValues(new Uint8Array(a))}function i(){return Array.prototype.map.call(u.getRandomValues(new Uint8Array(16)),function(e){return e.toString(36)}).join("").slice(0,s)}function o(e,t){return u.encryptSJCL(e,t,l)}var a=16,s=8,l="75392C57F66CE7E7EF47110410280DD7",c=e.getService("base64-conversion"),u=e.getService("webcrypto");return{encryptValue:o,generateSecretAsArrayBuffer:r,generateKeyId:i,convertToBase64:t,convertFromBase64:n}}),Box.Application.addService("com-server-client",function(e){"use strict";function t(e){return b.create(e,h)}function n(e){return b.create(e,m)}function r(e){return _.create(e)}function i(e){return w.create(e)}function o(){return y.isMinBrowser(y.constants.CHROME,53)||y.isMinBrowser(y.constants.FIREFOX,g)}function a(){return y.isMinBrowser(y.constants.SAFARI,10)}function s(){return y.isSafari()&&!a()}function l(){return y.isFirefox()&&!y.isMinBrowser(y.constants.FIREFOX,g)}function c(){return e.getGlobalConfig("isBoxEditFallbackEnabled")}function u(){return y.isMinBrowser("explorer",11)&&y.isBrowserPluginsSupported()}function d(){return y.isMinBrowser("explorer",11)&&c()}function f(e){return e(o()||u()||d()?{error:v.BOX_EDIT_UNINSTALLED_ERROR}:y.isFirefox()||y.isChrome()||s()?{error:v.BOX_EDIT_UPGRADE_BROWSER_ERROR}:a()?{error:v.BOX_EDIT_SAFARI_ERROR}:{error:v.BOX_EDIT_NOT_SUPPORTED_ERROR})}var p,m="https://edit.boxlocalhost.com:",h="http://127.0.0.1:",g=55,v={BOX_EDIT_NOT_SUPPORTED_ERROR:"box_edit_not_supported_error",BOX_EDIT_UNINSTALLED_ERROR:"box_edit_uninstalled_error",BOX_EDIT_UPGRADE_BROWSER_ERROR:"box_edit_upgrade_browser_error",BOX_EDIT_SAFARI_ERROR:"box_edit_safari_error"},y=e.getService("browser"),b=e.getService("http-channel"),_=e.getService("safari-channel"),w=e.getService("activex-channel"),S=e.getService("promises"),k=[],E=!1;return{constants:v,initialize:function(e){E||(E=!0,o()?k.push(t(e)):a()?k.push(r(e)):u()?k.push(i(e)):l(),c()||k.push(n(e)))},isInitialized:function(){return E},getComServerStatus:function(){return new Promise(function(e,t){return y.isEdge()?t({error:v.BOX_EDIT_NOT_SUPPORTED_ERROR
}):k.length?S.one(k.map(function(t){return t.getComServerStatus().then(function(n){return p=t,e(n)})})).catch(f.bind(null,t)):f.call(null,t)})},sendRequest:function(e){return p?p.sendRequest(e):this.getComServerStatus().then(function(){return p.sendRequest(e)})},sendCommand:function(e){return p?p.sendCommand(e):this.getComServerStatus().then(function(){return p.sendCommand(e)})}}}),Box.Application.addService("http-channel",function(e){"use strict";function t(){return!!C.getItem("comUseFallback")}function n(){C.setItem("comUseFallback",1)}function r(){C.removeItem("comUseFallback")}function i(){return t()?{primary:S,fallback:w}:{primary:w,fallback:S}}function o(t,n){var r;try{return r=new XMLHttpRequest,r.open(t,n,!0),r}catch(r){this.retryCounter<3&&setTimeout(function(){return this.retryCounter++,o(t,n)},500*this.retryCounter),e.reportError(r)}return null}function a(e,t,n,r){return new Promise(function(i,a){var s=o(e,t);s?(s.setRequestHeader(v,y),s.onload=function(){i(s)},s.onerror=function(){a(s)},r>0&&(s.timeout=r,s.ontimeout=function(){a(s)}),setTimeout(function(){s.send(n)},0)):a()})}function s(e){return a(g,this.url+e+"/status",null,_).then(function(e){var t=JSON.parse(e.responseText);return t.running?t:Promise.reject(b)})}function l(){function e(e,i){p=e;var o;e===w?(r(),o="primary"):(n(),o="fallback"),E.recordAction({application:"files",page:"",component:"",feature:"boxedit",target:"available"+o,action:"programmatic"}),t(i)}var t,o;this.comServerInstallationPromise=new Promise(function(e,n){t=e,o=n});var a=i(),l=a.primary,c=a.fallback;return s.call(this,l).then(e.bind(this,l)).catch(function(t){return t===b?void o():void s.call(this,c).then(e.bind(this,c)).catch(function(){o()})}.bind(this)),this.comServerInstallationPromise}function c(){var e=(new Date).getTime();return"xxxxxxxx".replace(/x/g,function(){var t=Math.floor((e+16*Math.random())%16);return t.toString(16)})}function u(e){return k.get(e+"-bgp-id")}function d(e){var t=u(e)||c(),n="bgp-"+t,r=(new Date).getTime()+m;return k.set(e+"-bgp-id",t,r),k.set("bgp-"+t,"generic",r),n}function f(e,t){this.appName=e,this.comChannelName=d(e),this.comServerInstallationPromise=null,this.retryCounter=0,this.url=t}var p,m=31536e6,h="POST",g="GET",v="Content-Type",y="text/plain; charset=UTF-8",b="notrunning",_=5e3,w=17223,S=17224,k=e.getService("cookies"),E=e.getService("resin"),C=e.getService("local-store");return f.prototype={getComServerStatus:function(){return!this.comServerInstallationPromise||this.comServerInstallationPromise.isRejected()?(this.comServerInstallationPromise=null,l.call(this)):this.comServerInstallationPromise},sendRequest:function(e){var t=this.url+p+"/application_request?application="+this.appName+"&com="+this.comChannelName;return a(h,t,e).then(function(e){var t=JSON.parse(e.responseText);return t.response_type&&"error"===t.response_type?Promise.reject({name:"CommunicationError",message:t.message}):t})},sendCommand:function(e){var t=this.url+p+"/application_command?application="+this.appName+"&com="+this.comChannelName;return a(h,t,e).then(function(e){return JSON.parse(e.responseText)})}},{create:function(e,t){return new f(e,t)}}}),Box.Application.addService("safari-channel",function(e){"use strict";function t(){return c+g.now()}function n(e){var t=new CustomEvent(s,e);h.dispatchEvent(t)}function r(e){var t="string"==typeof e.detail?JSON.parse(e.detail):e.detail;if(v.has(t.req_id)){var n=v.get(t.req_id);clearTimeout(n.rejectTimeout),v.delete(t.req_id);var r="string"==typeof t.com_server_response.data?JSON.parse(t.com_server_response.data):t.com_server_response.data;n.resolve(r)}}function i(e,n,r){var i={operation:n,properties:{application:e},req_id:t()};if(n!==m){if(!r)throw new TypeError("Data cannot be undefined for "+n,"safari-channel.js");i.data=r}return i}function o(e,t,r){return new Promise(function(o,a){var s=i(e,t,r),l=setTimeout(function(){a({status_code:d})},u);v.set(s.req_id,{resolve:o,rejectTimeout:l}),n({detail:s})})}function a(e){this.getComServerStatus=o.bind(this,e,m),this.sendRequest=o.bind(this,e,p),this.sendCommand=o.bind(this,e,f)}var s="box_extension_input",l="box_extension_output",c="BOX-EXT-REQ-ID-",u=5e3,d=408,f="application_command",p="application_request",m="status",h=e.getGlobal("document"),g=e.getGlobal("performance"),v=new Map,y=!1;return{create:function(e){return y||(h.addEventListener(l,r),y=!0),new a(e)},destroy:function(){y&&(h.removeEventListener(l,r),y=!1)}}}),Box.Application.addService("activex-channel",function(e){"use strict";function t(){var e=y.query(u);if(!e){var t=y.createFragmentFromHtml(c);_.body.appendChild(t)}}function n(){var e=y.query(u);e&&y.remove(e)}function r(){return f+b.now()}function i(e){var t=y.query(u);t.Execute(JSON.stringify(e))}function o(e){var t="string"==typeof e.detail?JSON.parse(e.detail):e.detail;if(w.has(t.req_id)){var n=w.get(t.req_id);clearTimeout(n.rejectTimeout),w.delete(t.req_id);var r="string"==typeof t.com_server_response.data?JSON.parse(t.com_server_response.data):t.com_server_response.data;n.resolve(r)}}function a(e,t,n){var i={operation:t,properties:{application:e},req_id:r()};if(t!==v){if(!n)throw new TypeError("Data cannot be undefined for "+t,"activex-channel.js");i.data=n}return i}function s(e,t,n){return new Promise(function(r,o){var s=a(e,t,n),l=setTimeout(function(){o({status_code:m})},p);w.set(s.req_id,{resolve:r,rejectTimeout:l}),i({detail:s})})}function l(e){this.getComServerStatus=s.bind(this,e,v),this.sendRequest=s.bind(this,e,g),this.sendCommand=s.bind(this,e,h)}var c='<object ID="ATLActiveX2" CLASSID="CLSID:BA58190A-A733-4982-8AE2-E2021F0DD503"></object>',u="#ATLActiveX2",d="box_extension_output",f="BOX-EXT-REQ-ID-",p=5e3,m=408,h="application_command",g="application_request",v="status",y=e.getService("dom"),b=e.getGlobal("performance"),_=e.getGlobal("document"),w=new Map,S=!1;return{create:function(e){return S||(_.addEventListener(d,o),S=!0),t(),new l(e)},destroy:function(){S&&(_.removeEventListener(d,o),S=!1),n()}}}),Box.Application.addService("collab-actions",function(e){"use strict";function t(t){var a=s.getGcmCompatibleRm(n),l={itemTypedId:t};e.broadcast("collabrequestsent"),r.post(a,l).then(function(){e.broadcast("collabresponsereceived"),i.redirect("/files")},function(t){var n=t.data||{};e.broadcast("collabresponsereceived"),o.error(n.message||$t("You could not be removed as a collaborator. You may not have permission to perform this action.","remove_current_user_collab_error_notification"))})}var n="remove_current_user_collab",r=e.getService("ajax"),i=e.getService("nav"),o=e.getService("notifications-amsterdam"),a=e.getService("popups-amsterdam"),s=e.getService("url");return{removeCurrentUserFromItem:function(e){var n=$t("End Collaboration","end_collaboration_confirmation_popup_title"),r=$t("Are you sure you want to remove yourself as a collaborator? You will no longer have access to this item and will not be able to complete pending tasks.","remove_current_user_collab_confirmation");a.confirm(r,n).then(function(){t(e)})}}}),Box.Application.addService("com-server",function(e){"use strict";function t(){return!!I.getItem("comUseFallback")}function n(){I.setItem("comUseFallback",1)}function r(){I.removeItem("comUseFallback")}function i(){e.getGlobalConfig("useUnSecureUrlForComServer")&&(O=y)}function o(){return t()?{primary:x,fallback:C}:{primary:C,fallback:x}}function a(t,n,r){var i;try{if(window.XMLHttpRequest&&(i=new XMLHttpRequest,"withCredentials"in i))return i.open(t,n,r),i;if("undefined"!=typeof XDomainRequest)return i=new XDomainRequest,i.open(t,n),i.onprogress=function(){},i.ontimeout=function(){},i}catch(i){D<3&&setTimeout(function(){return D++,a(t,n,r)},500*D),e.reportError(i)}return null}function s(e,t,n,r){return new Promise(function(i,o){var s=a(e,t,!0);s?(e===b&&"function"==typeof s.setRequestHeader&&s.setRequestHeader(w,S),s.onload=function(){i(s)},s.onerror=function(){o(s)},r>0&&(s.timeout=r,s.ontimeout=function(){o(s)}),setTimeout(function(){s.send(n)},0)):o()})}function l(e){return s(_,O+e+"/status",null,E).then(function(e){var t=JSON.parse(e.responseText);return t.running?t:Promise.reject(k)})}function c(){function e(e,i){m=e;var o;e===C?(r(),o="primary"):(n(),o="fallback"),A.recordAction({application:"files",page:"",component:"",feature:"boxedit",target:"available"+o,action:"programmatic"}),t(i)}var t,i;h=new Promise(function(e,n){t=e,i=n});var a=o(),s=a.primary,c=a.fallback;return l(s).then(e.bind(this,s)).catch(function(t){return t===k?void i():void l(c).then(e.bind(this,c)).catch(function(){i()})}),h}function u(){var e=(new Date).getTime();return"xxxxxxxx".replace(/x/g,function(){var t=Math.floor((e+16*Math.random())%16);return t.toString(16)})}function d(e){return T.get(e+"-bgp-id")}function f(e){var t=d(e)||u(),n="bgp-"+t,r=(new Date).getTime()+g;return T.set(e+"-bgp-id",t,r),T.set("bgp-"+t,"generic",r),n}function p(e){this.appName=e,this.comChannelName=f(e)}var m,h,g=31536e6,v="https://edit.boxlocalhost.com:",y="http://127.0.0.1:",b="POST",_="GET",w="Content-Type",S="text/plain; charset=UTF-8",k="notrunning",E=5e3,C=17223,x=17224,T=e.getService("cookies"),A=e.getService("resin"),I=e.getService("local-store"),O=v,D=0;return p.prototype={getComServerStatus:function(){return!h||h.isRejected()?(h=null,c()):h},sendRequest:function(e,t,n){var r=O+m+"/application_request?application="+this.appName+"&com="+this.comChannelName;if(!t)return s(b,r,e,n).then(function(e){var t=JSON.parse(e.responseText);return t.response_type&&"error"===t.response_type?Promise.reject({name:"CommunicationError",message:t.message}):t});var i=a(b,r,!1);return i&&("function"==typeof i.setRequestHeader&&i.setRequestHeader(w,S),i.send(e),4===i.readyState&&2===Math.floor(i.status/100))?JSON.parse(i.responseText):void 0},sendCommand:function(e){var t=O+m+"/application_command?application="+this.appName+"&com="+this.comChannelName;return s(b,t,e)}},{create:function(t){var n=e.getService("logger"),r={marker_date:"2017-10-09",marker_location:"js/enduser/services/com-server.js:create",message:t};return n.sendLog("tombstone","zombie",r),i(),new p(t)}}}),Box.Application.addService("contact-selector-dropdown",function(e){"use strict";function t(e,t){if(e&&t){var n=t.offsetHeight,r=t.scrollTop,i=Math.floor(n/5),o=e.offsetTop,a=0;if(a=o+i-(r+n),a>0)return void(t.scrollTop=r+a);a=r-o,a>0&&(t.scrollTop=r-a)}}function n(e,n){e.activeMenuItemEl&&d.removeClass(e.activeMenuItemEl,"hover"),e.activeMenuItemEl=n,e.activeMenuItemEl&&d.addClass(e.activeMenuItemEl,"hover"),t(e.activeMenuItemEl,e.selectorDropdownMenu)}function r(e){return function(t){var r,i,o=t.which||t.keyCode,a=e.activeMenuItemEl,c=e.selectorDropdownMenu;if(!d.hasClass(c,l))return!0;switch(o){case s.DOWN:a?n(e,a.nextSibling):n(e,c.children[0]);break;case s.UP:a?n(e,a.previousSibling):n(e,c.children[e.selectorDropdownMenu.children.length-1]);break;case s.RETURN:case s.TAB:if(!a||d.hasClass(a,"disabled"))break;r=a.getAttribute("data-id"),i=m[r]||{},p.recordActionFromElement(a,{target:"selectname",action:"keypress"}),e.fire("dropdownitemselect",{id:i.id,href:i.href,email:i.email,text:i.text,data:i.data}),d.removeClass(c,l);break;default:return!0}return!1}}function i(e){return function(t){var r=t.target||t.srcElement;r.getAttribute("data-id")?n(e,r):r.parentNode.getAttribute("data-id")&&n(e,r.parentNode)}}function o(e){return function(t){var n=t.target||t.srcElement,r="SPAN"===n.nodeName?n.parentNode:n,i=r.getAttribute("data-id"),o=m[i]||{};return!(!i||d.hasClass(r,"disabled"))&&(p.recordActionFromElement(r,{target:"selectname",action:"click"}),e.fire("dropdownitemselect",{id:o.id,href:o.href,email:o.email,text:o.text,data:o.data}),void d.removeClass(e.selectorDropdownMenu,l))}}function a(e){var t=document.createElement("div");t.className="contact-selector-dropdown",d.insertAfter(t,e),this.keydownHandlerRef=r(this),this.mousedownHandlerRef=o(this),this.mouseoverHandlerRef=i(this),d.on(e,"keydown",this.keydownHandlerRef),d.on(t,"mouseover",this.mouseoverHandlerRef),d.on(t,"mousedown",this.mousedownHandlerRef),this.inputEl=e,this.selectorDropdownMenu=t,$.extend(this,new Box.EventTarget)}var s={UP:38,DOWN:40,RETURN:13,TAB:9},l="is-visible",c='<a class="<%= className %>" data-id="<%= id %>"><span class="contact-selector-dropdown-text" title="<%= text %>"><%= text %></span><span class="contact-selector-dropdown-email" title="<%= secondaryText %>"><%= secondaryText %></span></a>',u='<a class="<%= className %>" data-id="<%= id %>"><span class="contact-selector-dropdown-text" title="<%= text %>"><%= text %></span><span class="contact-selector-dropdown-email" title="<%= secondaryText %>"><%= secondaryText %></span><span data-hover="tooltip" aria-label="<%= badgeTooltip %>" class="badge role"><%= badgeTitle %></span></a>',d=e.getService("dom"),f=e.getService("templates"),p=e.getService("resin"),m={};return a.prototype={setItems:function(e){var t,r,i,o=e.length;if(d.setHTML(this.selectorDropdownMenu,""),m={},o>0){for(t=0;t<o;t++)r=e[t].id,i=e[t].badge?f.createTemplateFragment(u,{id:""+r,text:e[t].text,secondaryText:e[t].email||"",className:e[t].isNotSelectable?"disabled":"",badgeTitle:e[t].badge.title,badgeTooltip:e[t].badge.tooltip}):f.createTemplateFragment(c,{id:""+r,text:e[t].text,secondaryText:e[t].email||"",className:e[t].isNotSelectable?"disabled":""}),this.selectorDropdownMenu.appendChild(i),m[r]=e[t];n(this,this.selectorDropdownMenu.children[0]),d.addClass(this.selectorDropdownMenu,l)}else d.removeClass(this.selectorDropdownMenu,l)},destroy:function(){d.off(this.inputEl,"keydown",this.keydownHandlerRef),d.off(this.selectorDropdownMenu,"mouseover",this.mouseoverHandlerRef),d.off(this.selectorDropdownMenu,"mousedown",this.mousedownHandlerRef)}},{create:function(e){return new a(e)}}}),Box.Application.addService("contextual-message",function(e){"use strict";function t(e,t){return e!==t&&(k.indexOf(e)>-1||k.indexOf(t)>-1)}function n(e,n){for(var r=Object.keys(e),i=r.length,o=0;o<i;o++)if(!t(r[o],n.type))return!1;return!0}function r(t){w.indexOf(t)>-1&&e.broadcast(h)}function i(e,t){S.indexOf(e)>-1&&(E=t)}function o(t){if(t){var n=e.getService("dom").query("[data-module]",t);n&&!e.isStarted(n)&&e.start(n)}}function a(t,n){e.getService("ajax").post(p,{id:t,context:n})}function s(t,n,r){e.getService("ajax").post(m,{id:t,context:n,wasTriggeredByUserAction:r})}function l(){e.broadcast("message-loaded")}function c(t){var n=t.message;r(n.type),i(n.type,!0),o(n.el),a(n.id,n.context),e.broadcast("message-shown",n)}function u(t){var n=t.message;s(n.id,n.context,t.wasTriggeredByUserAction),r(n.type),i(n.type,!1),e.broadcast("message-closed",n)}function d(t){e.hasService(t)&&_.addMessageRepresentationFactory(t,e.getService(t))}function f(){if(!e.hasService("pigeon"))throw new Error("contextual-message.js#init : contextual-message service should be available for this service to work");_=e.getService("pigeon"),_.registerGlobalOnLoadCallback(l).registerGlobalOnShowCallback(c).registerGlobalOnCloseCallback(u).setCanMessagesCoexistEvaluator(n),d(g),d(v),d(y),d(b)}var p="contextual_message_mark_as_seen",m="contextual_message_mark_as_closed",h="previewrefreshrequested",g="banner",v="fullscreentour",y="modal",b="popout",_={},w=[v],S=[y,v,b],k=[g],E=!1;return f(),{registerMessage:function(t){_.registerMessage(t),e.broadcast("message-registered",t)},unregisterMessage:function(t,n,r){_.unregisterMessage(t,n,r),e.broadcast("message-unregistered",{identifier:t,context:n,type:r})},createMessageRepresentation:function(e,t){return _.createMessageRepresentation(e,t)},createMessageRepresentationWithContext:function(e,t,n){return _.createMessageRepresentationWithContext(e,t,n)},shouldDisableHotkeys:function(){return E}}}),Box.Application.addService("banner",function(e){"use strict";function t(){}function n(){return null!==B?B.bannerData.name:null}function r(){return R.sanitize(S.page)}function i(e,t){R.recordAction({application:R.sanitize(S.application),page:B.bannerEl.getAttribute("data-resin-page"),component:"contextualmessage",feature:"banner",target:R.sanitize(e),action:R.sanitize(t)})}function o(){var e=k||D;i("close|"+e.target,e.action),k=null}function a(){var e=r()+"|"+n();B.bannerEl.setAttribute("data-resin-page",R.sanitize(e))}function s(){B.bannerEl.removeAttribute("data-resin-page");var e=B.bannerEl.firstChild;S=R.getActionAttributes(e),a()}function l(){P.addClass(B.bannerEl,T),P.removeClass(q,A)}function c(){P.removeClass(B.bannerEl,T),P.addClass(q,A)}function u(){B&&(h(),l(),o(),B.onCloseCallback()),B=null}function d(t,n){if(t&&n){k=O,u();var r=e.getService("contextual-message");r.createMessageRepresentation(t,n).setIsTriggeredByUserAction(!0).show()}}function f(e){e&&(k=O,u(),_.open(e,"_blank"))}function p(e){var t=P.getNearest(e.target||e.srcElement,"[data-action]");if(t){var n=t.getAttribute("data-action");switch(n){case I:k=D,u();break;case E:var r=t.getAttribute("data-actiondata-messagename"),i=t.getAttribute("data-actiondata-messagetype");d(r,i);break;case C:var o=t.getAttribute("data-actiondata-url");f(o)}}}function m(){P.on(B.bannerEl,"mouseup",p)}function h(){P.off(B.bannerEl,"mouseup",p)}function g(){m(),c(),s(),i("loaded","programmatic");var e=$.extend({},B.bannerData,{el:B.bannerEl});B.onShowCallback(e)}function v(){return w||(w=document.getElementById(x)),w?w:null}function y(e){var t=P.query('[data-banner-name="'+e.bannerData.name+'"]'),n=e.bannerData.templateFetchEndpoint,r={id:e.bannerData.id,identifier:e.bannerData.identifier,isHighDensityDisplay:F.isHighDensity()};if(t)return e.onLoadCallback(e.bannerData),N.createResolved();var i=v();return null===i?N.createRejected("No anchor element found on the page"):M.get(n,r).then(function(e){var t=P.createFragmentFromHtml(e.data.html);i.appendChild(t)}).then(function(){e.onLoadCallback(e.bannerData)})}function b(e){this.bannerData=e,this.bannerEl=null,this.onLoadCallback=t,this.onShowCallback=t,this.onCloseCallback=t}var _,w,S,k,E="launch-message",C="go-to-url",x="contextual-message-banner-anchor",T="hidden",A="banner-visible",I="close-message",O={target:"cta1",action:"click"},D={target:"x",action:"click"},M=e.getService("ajax"),P=e.getService("dom"),N=e.getService("promises"),R=e.getService("resin"),F=e.getService("screen"),B=null,q=e.getGlobal("document").body;return b.prototype={load:function(){return y(this)},show:function(){var e=this.bannerData.name;B=this,this.load().then(function(){B.bannerEl=P.query('[data-banner-name="'+e+'"]'),g()})},unload:function(){},setOnLoadCallback:function(e){"function"==typeof e&&(this.onLoadCallback=e)},setOnShowCallback:function(e){"function"==typeof e&&(this.onShowCallback=e)},setOnCloseCallback:function(e){"function"==typeof e&&(this.onCloseCallback=e)},_close:u},{create:function(t){return _=e.getGlobal("window"),new b(t)}}}),Box.Application.addService("fullscreentour",function(e){"use strict";function t(){}function n(){return null!==ue?ue.tourData.name:null}function r(){return le.sanitize(H.page)}function i(e,t){le.recordAction({application:le.sanitize(H.application),page:ue.tourEl.getAttribute("data-resin-page"),component:"contextualmessage",feature:"fullscreentour",target:le.sanitize(e),action:le.sanitize(t)})}function o(){var e=r()+"|"+n()+"|"+j.getCurrentSlideName();ue.tourEl.setAttribute("data-resin-page",le.sanitize(e))}function a(){ue.tourEl.removeAttribute("data-resin-page");var e=ue.tourEl.firstChild;H=le.getActionAttributes(e),o()}function s(e){return e?ae.query('[data-slide-name="'+e+'"] video',ue.tourEl):null}function l(e){var t=s(e);t&&t.pause&&(t.pause(),t.currentTime=0)}function c(e){var t=s(e);t&&t.play&&t.play()}function u(e,t){t.appendChild(e)}function d(){ae.removeClass(ue.tourEl,Z)}function f(){u(ue.tourEl,document.body)}function p(){ae.removeClass(ae.query(".slide.is-active",ue.tourEl),te),ae.addClass(ue.tourEl,Z)}function m(e,t){for(;e.childNodes.length>0;)u(e.childNodes[0],t)}function h(){j.goToSlide(0)}function g(e,t){var n=ae.query(".slide .transparent",ue.tourEl);if(n){var r=ae.getBoundingClientRect(n);t||ae.addClass(U,ne),U.style.left=r.left+"px",U.style.top=r.top+"px",U.style.width=r.width+"px",U.style.height=r.height+"px",t||fe(function(){ae.removeClass(U,ne)})}}function v(){var e=document.createElement("div");e.className=re,u(e,document.body)}function y(){var e=ae.query("."+re);e.parentNode.removeChild(e)}function b(e){if(!e)return void v();var t;t=document.createElement("div"),t.className="tour-fullscreen-fake-body-container tour-flex-container tour-full-abs-pos",U=document.createElement("div"),U.className="tour-fullscreen-fake-body tour-full-abs-pos "+te,u(U,t),m(document.body,U),u(t,document.body)}function _(e){return e?(m(U,document.body),document.body.removeChild(U.parentNode),void(U=null)):void y()}function w(e,t){function n(){ae.off(e,"transitionend",n),t()}ae.on(e,"transitionend",n)}function S(){return ue&&ue.tourEl&&"false"!==ue.tourEl.getAttribute("data-should-animate")}function k(e){S()&&(e?ae.addClass(U,te):ae.removeClass(U,te))}function E(e){e||ae.addClass(document.body,ee),ae.addClass(document.body,Q),ae.addClass(document.body,Y)}function C(e){e||ae.removeClass(document.body,ee),ae.removeClass(document.body,Q),ae.removeClass(document.body,Y)}function x(){g(null,!0)}function T(){setTimeout(function(){d(),c(j.getCurrentSlideName())},J),ae.addClass(ae.query("."+re),te)}function A(){var e=S();b(e),f(),e?(ae.on(de,"resize",g),w(U,h),E(e),d(),x()):(h(),E(e),fe(T))}function I(){var e=S();e&&ae.off(de,"resize",g),_(e),p(),f(),C()}function O(){F(),ue&&(l(j.getCurrentSlideName()),I(),ue.tourEl=null,j.destroy(),ue.onCloseCallback()),ue=null}function D(){ue&&(l(j.getCurrentSlideName()),j.goToNextSlide(),j.currentSlideNum>0&&S()&&k(!1),c(j.getCurrentSlideName()),i("next","click"),o(),i("loaded","programmatic"))}function M(){ue&&(l(j.getCurrentSlideName()),j.goToPrevSlide(),j.currentSlideNum<=0&&S()&&k(!0),c(j.getCurrentSlideName()),i("previous","click"),o(),i("loaded","programmatic"))}function P(e){var t=e.target||e.srcElement,n=t.getAttribute("data-action");n===W?M():n===V?D():n===K&&O()}function N(e){var t=e.keyCode;t===G?M():t===X?D():t===z&&(i("close|esc","keypress"),O())}function R(){ae.on(document.body,"mouseup",P),ae.on(document.body,"keyup",N)}function F(){ae.off(document.body,"mouseup",P),ae.off(document.body,"keyup",N)}function B(){R(),j=oe.create(ue.tourEl),A(),document.body.focus(),a(),i("loaded","programmatic");var e=$.extend({},ue.tourData,{el:ue.tourEl});ue.onShowCallback(e)}function q(e){var t=ae.query('[data-fullscreentour-name="'+e.tourData.name+'"]'),n=e.tourData.templateFetchEndpoint,r={id:e.tourData.id,identifier:e.tourData.identifier,isHighDensityDisplay:ce.isHighDensity()};return t?(e.onLoadCallback(e.tourData),se.createResolved()):ie.get(n,r).then(function(e){var t=ae.createFragmentFromHtml(e.data.html);document.body.appendChild(t)}).then(function(){e.onLoadCallback(e.tourData)})}function L(e){this.tourData=e,this.tourEl=null,this.onLoadCallback=t,this.onShowCallback=t,this.onCloseCallback=t}var j,U,H,V="carousel-next",W="carousel-previous",K="close-message",z=27,G=37,X=39,J=600,Y="disable_selectable",Q="fullscreen-tour",Z="hidden",ee="hide-overflow",te="is-active",ne="no-transition",re="fullscreen-tour-shim",ie=e.getService("ajax"),oe=e.getService("slide-carousel"),ae=e.getService("dom"),se=e.getService("promises"),le=e.getService("resin"),ce=e.getService("screen"),ue=null,de=e.getGlobal("window"),fe=de.requestAnimationFrame||de.webkitRequestAnimationFrame;return L.prototype={load:function(){return q(this)},show:function(){var e=this.tourData.name;ue=this,this.load().then(function(){ue.tourEl=ae.query('[data-fullscreentour-name="'+e+'"]'),B()})},unload:function(){},setOnLoadCallback:function(e){"function"==typeof e&&(this.onLoadCallback=e)},setOnShowCallback:function(e){"function"==typeof e&&(this.onShowCallback=e)},setOnCloseCallback:function(e){"function"==typeof e&&(this.onCloseCallback=e)},_close:O},{create:function(e){return new L(e)}}}),Box.Application.addService("modal",function(e){"use strict";function t(){}function n(){return null!==G?G.modalData.name:null}function r(){return K.sanitize(T.page)}function i(e,t){K.recordAction({application:K.sanitize(T.application),page:G.modalEl.getAttribute("data-resin-page"),component:"contextualmessage",feature:"modal",target:K.sanitize(e),action:K.sanitize(t)})}function o(){var e=r()+"|"+n()+"|"+C.getCurrentSlideName();G.modalEl.setAttribute("data-resin-page",K.sanitize(e))}function a(){G.modalEl.removeAttribute("data-resin-page");var e=G.modalEl.firstChild;T=K.getActionAttributes(e),o()}function s(){C.isOnLastSlide()?V.addClass(G.modalEl,B):V.removeClass(G.modalEl,B),0===C.currentSlideNum?V.addClass(x,q):V.removeClass(x,q)}function l(){V.addClass(G.modalEl,q),V.removeClass(G.modalEl,F),V.removeClass(document.body,L)}function c(){s(),V.removeClass(G.modalEl,q),V.addClass(G.modalEl,F),V.addClass(document.body,L)}function u(){G&&(C.goToNextSlide(),s(),i("next","click"),o(),i("loaded","programmatic"))}function d(e){G&&(C.goToSlide(e.data),s(),i("next","programmatic"),o(),i("loaded","programmatic"))}function f(){G&&(C.goToPrevSlide(),s(),i("previous","click"),o(),i("loaded","programmatic"))}function p(){b(),G&&(l(),C.destroy(),G.onCloseCallback()),G=null}function m(t,n){if(t&&n){p();var r=e.getService("contextual-message");r.createMessageRepresentation(t,n).setIsTriggeredByUserAction(!0).show()}}function h(e){e&&(p(),E.open(e,"_blank"))}function g(e){var t=e.target||e.srcElement,n=t.getAttribute("data-action");switch(n){case I:f();break;case A:u();break;case O:p();break;case D:var r=t.getAttribute("data-actiondata-messagename"),i=t.getAttribute("data-actiondata-messagetype");m(r,i);break;case M:var o=t.getAttribute("data-actiondata-url");h(o)}}function v(e){var t=e.keyCode,n="true"===G.modalEl.getAttribute("data-disable-arrow-key");t!==N||n?t!==R||n?t===P&&(i("close|esc","keypress"),p()):u():f()}function y(){V.on(document.body,"mouseup",g),V.on(document.body,"keyup",v),H.on("modalgotoslide",d),H.on("closemodal",p)}function b(){V.off(document.body,"mouseup",g),V.off(document.body,"keyup",v),H.off("modalgotoslide",d),H.off("closemodal",p)}function _(){y(),x=V.query('[data-action="'+I+'"]',G.modalEl),C=U.create(G.modalEl),C.goToSlide(0),c(),a(),i("loaded","programmatic");var e=$.extend({},G.modalData,{el:G.modalEl});G.onShowCallback(e)}function w(e){if(!z.isHighDensity())return e;for(var t=e.querySelectorAll("figure"),n=0;n<t.length;n++)if(t[n].hasAttribute("data-highres-img")){var r=new Image;r.onload=function(){var e=t[n],r=e.getAttribute("data-highres-img");return function(){e.style.backgroundImage="url("+r+")",e.removeAttribute("data-highres-img")}}(),r.src=t[n].getAttribute("data-highres-img")}return e}function S(e){var t=V.query('[data-modal-name="'+e.modalData.name+'"]'),n=e.modalData.templateFetchEndpoint,r={id:e.modalData.id,identifier:e.modalData.identifier,isHighDensityDisplay:z.isHighDensity()};return t?(w(t),e.onLoadCallback(e.modalData),W.createResolved()):j.get(n,r).then(function(e){var t=V.createFragmentFromHtml(e.data.html),n=w(t);document.body.appendChild(n)}).then(function(){e.onLoadCallback(e.modalData)})}function k(e){this.modalData=e,this.modalEl=null,this.onLoadCallback=t,this.onShowCallback=t,this.onCloseCallback=t}var E,C,x,T,A="carousel-next",I="carousel-previous",O="close-message",D="launch-message",M="go-to-url",P=27,N=37,R=39,F="disable_selectable",B="final-slide",q="hidden",L="no_scroll",j=e.getService("ajax"),U=e.getService("slide-carousel"),H=e.getService("custom-event-bus"),V=e.getService("dom"),W=e.getService("promises"),K=e.getService("resin"),z=e.getService("screen"),G=null;return k.prototype={load:function(){return S(this)},show:function(){var e=this.modalData.name;G=this,this.load().then(function(){G.modalEl=V.query('[data-modal-name="'+e+'"]'),_()})},unload:function(){},setOnLoadCallback:function(e){"function"==typeof e&&(this.onLoadCallback=e)},setOnShowCallback:function(e){"function"==typeof e&&(this.onShowCallback=e)},setOnCloseCallback:function(e){"function"==typeof e&&(this.onCloseCallback=e)},_close:p,_goToSlide:d,_closeModal:p},{create:function(t){return E=e.getGlobal("window"),new k(t)}}}),Box.Application.addService("popout",function(e){"use strict";function t(){}function n(){return V.sanitize(C.page)}function r(){var e=z.popoutEl.getAttribute("data-popout-name"),t=n()+"|"+e;z.popoutEl.setAttribute("data-resin-page",V.sanitize(t))}function i(){z.popoutEl.removeAttribute("data-resin-page");var e=j.query("[data-resin-feature]",z.popoutEl);C=V.getActionAttributes(e),r()}function o(e,t){V.recordAction({application:V.sanitize(C.application),page:z.popoutEl.getAttribute("data-resin-page"),component:"contextualmessage",feature:"popout",target:V.sanitize(e),action:V.sanitize(t)})}function a(){var e=x||q;o("close|"+e.target,e.action),x=null}function s(){G&&(E.destroy(),G=!1,a(),z.onCloseCallback(z.popoutData))}function l(e){var t=U.create(e);return t.init(),t.on("closed",s),t}function c(){if(!G){var e="true"===z.popoutEl.getAttribute("data-minimize-onclose"),t=!e;E=l(t);var n=j.query("."+M,z.popoutEl);E.showMenu(n),G=!0,o("loaded","programmatic");var r=$.extend({},z.popoutData,{el:z.popoutEl});z.onShowCallback(r)}}function u(t){if(G)x=R;else{t.stopPropagation(),o("open|helpbutton","click");var n=e.getService("contextual-message");n.createMessageRepresentationWithContext(z.popoutData.name,"popout",z.popoutData.context).setIsTriggeredByUserAction(!0).show()}}function d(t,n,r){if(t&&n){x=F,E.closeMenu();var i=e.getService("contextual-message"),o=i.createMessageRepresentation(t,n).setIsTriggeredByUserAction(!0);null!==r&&o.registerOnShowCallback(function(){setTimeout(function(){K.fire("modalgotoslide",Number(r))},300)}),o.show()}}function f(e){e&&(x=F,E.closeMenu(),k.open(e,"_blank"))}function p(){x=B,E.closeMenu()}function m(){var e=j.query('[data-popout-content="maximized"]',z.popoutEl),t=j.query('[data-popout-content="minimized"]',z.popoutEl),n=j.query(".popout-container",z.popoutEl);e&&t&&(j.hasClass(e,"hidden")?(j.removeClass(e,"hidden"),j.addClass(t,"hidden"),j.removeClass(n,"minimized"),n.removeAttribute("data-action","minimize-message")):(j.addClass(e,"hidden"),j.removeClass(t,"hidden"),j.addClass(n,"minimized"),n.setAttribute("data-action","minimize-message")))}function h(e){var t=e.target||e.srcElement;if((t.hasAttribute("data-action")||(t=j.getNearest(e.target,"[data-action]"),null!==t))&&t){var n=t.getAttribute("data-action");switch(n){case T:u(e);break;case A:var r=t.getAttribute("data-actiondata-messagename"),i=t.getAttribute("data-actiondata-messagetype"),o=t.getAttribute("data-actiondata-messageslide");d(r,i,o);break;case I:var a=t.getAttribute("data-actiondata-url");f(a);break;case O:p();break;case D:m()}}}function g(e){var t=e.target||e.srcElement,n=t.getAttribute("data-action");n===T&&e.keyCode===P&&G&&(x=N)}function v(){j.on(z.popoutEl,"mouseup",h),j.on(z.popoutEl,"keyup",g)}function y(){j.off(z.popoutEl,"mouseup",h),j.off(z.popoutEl,"keyup",g)}function b(){z.popoutEl&&(y(),j.remove(z.popoutEl),G=!1,z={})}function _(e,t){y(),z=e,z.popoutEl=t||j.query('.contextual-popout[data-popout-name="'+e.popoutData.name+'"]'),i(),v(),e.onLoadCallback(e.popoutData)}function w(e){var t=e.popoutData.templateFetchEndpoint,n={id:e.popoutData.id,identifier:e.popoutData.identifier,isHighDensityDisplay:W.isHighDensity()},r=j.query('.contextual-popout[data-popout-name="'+e.popoutData.name+'"]'),i=j.query(".contextual-popout-container")||document.body;return r?(_(e,r),H.createResolved()):L.get(t,n).then(function(t){var n=j.createFragmentFromHtml(t.data.html);i.appendChild(n),_(e)})}function S(e){this.popoutData=e,this.popoutEl=null,this.onLoadCallback=t,this.onShowCallback=t,this.onCloseCallback=t}var k,E,C,x,T="toggle-popout",A="launch-message",I="go-to-url",O="close-message",D="minimize-message",M="popout-toggle-button",P=27,N={target:"esc",action:"keypress"},R={target:"helpbutton",action:"click"},F={target:"cta1",action:"click"},B={target:"cta2",action:"click"},q={target:"overlay",
action:"click"},L=e.getService("ajax"),j=e.getService("dom"),U=e.getService("menu-toggle"),H=e.getService("promises"),V=e.getService("resin"),W=e.getService("screen"),K=e.getService("custom-event-bus"),z={},G=!1;return S.prototype={load:function(){return w(this)},show:function(){this.load().then(c)},unload:function(){b()},setOnLoadCallback:function(e){"function"==typeof e&&(this.onLoadCallback=e)},setOnShowCallback:function(e){"function"==typeof e&&(this.onShowCallback=e)},setOnCloseCallback:function(e){"function"==typeof e&&(this.onCloseCallback=e)}},{create:function(t){return k=e.getGlobal("window"),new S(t)}}}),Box.Application.addService("message-auctioneer",function(e){"use strict";function t(e,t){var n=e.message,r=t.message,i=r.priority-n.priority;if(0!==i)return i;var o=+r.isExemptFromSuppression-+n.isExemptFromSuppression;if(0!==o)return o;var a=r.createdDate-n.createdDate;return a}function n(e,t){return null===_||_(e,t)}function r(e,t){if(!e)return null;var r=null,i=t.map(function(e){return e.message});do r=e.dequeue();while(null!==r&&!n(r.message,i));return r}function i(e){for(var t=b,n=0,r=t.length;n<r;n++)t[n].call(null,e)}function o(e){for(var t=0;t<e.length;t++)i(e[t].message),e[t].representation.load()}function a(e){for(var t=0;t<e.length;t++)e[t].representation.show()}function s(){var e,t=[],n=[],i=[];do e=r(d,n),null!==e&&(n.push(e),i.push(e.message.type));while(null!==e);for(var s in v)i.indexOf(s)===-1&&(e=r(v[s],[]),null!==e&&t.push(e),v[s].clear());a(n),o(t)}function l(e,t){e.queue(t),null===y&&(y=setTimeout(function(){s(),y=null}.bind(this),f))}function c(e,n){function r(){return{message:e,representation:n}}function i(e,t){"function"==typeof t&&a[e].push(t)}function o(e,t){for(var n=a[e],r=0,i=n.length;r<i;r++)n[r].call(null,t)}this.identifier=e.identifier,this.name=e.name,this.type=e.type,this.context=e.context,this.isTriggeredByUserAction=null,this._representation=n;var a={onLoad:[],onShow:[],onClose:[]};this.setIsTriggeredByUserAction=function(e){return this.isTriggeredByUserAction=e,this},this.load=function(){var n=r();v[e.type]=v[e.type]||g.create(t),l(v[e.type],n)},this.show=function(){if(null===this.isTriggeredByUserAction)throw new Error("setIsTriggeredByUserAction() needs to be called before calling show()");var e=r();d=d||g.create(t),l(d,e)},this.registerOnLoadCallback=function(e){return i(p,e),this},this.registerOnShowCallback=function(e){return i(m,e),this},this.registerOnCloseCallback=function(e){return i(h,e),this},n.setOnLoadCallback(function(){var e=r();o(p,e)}),n.setOnShowCallback(function(e){var t=r();t.message.el=e.el,o(m,t)});var s=this;n.setOnCloseCallback(function(){var e=r();e.wasTriggeredByUserAction=s.isTriggeredByUserAction,o(h,e)})}function u(e,t,n){this.identifier=e,this.name=t,this.type="non-displayable",this.context=n,this.isTriggeredByUserAction=null,this.setIsTriggeredByUserAction=function(e){return this.isTriggeredByUserAction=e,this},this.load=function(){},this.show=function(){if(null===this.isTriggeredByUserAction)throw new Error("setIsTriggeredByUserAction() needs to be called before calling show()")},this.registerOnLoadCallback=function(){return this},this.registerOnShowCallback=function(){return this},this.registerOnCloseCallback=function(){return this}}var d,f=50,p="onLoad",m="onShow",h="onClose",g=e.getService("priority-queue"),v={},y=null,b=[],_=null;return{createDisplayableMessageProxy:function(e,t){return new c(e,t)},createNonDisplayableMessageProxy:function(e){var t=e?e.identifier:null,n=e?e.name:null,r=e?e.context:null;return new u(t,n,r)},registerOnMessagePreLoadCallback:function(e){return b.push(e),this},setMessageEligibilityEvaluator:function(e){if("function"!=typeof e)throw new Error("[message-auctioneer] param to setMessageEligibilityEvaluator should be function!");return _=e,this}}}),Box.Application.addService("message-factory-collection",function(){"use strict";function e(e){if(e.create)return!0;throw new Error("[message-representation-factory] Should define create method")}var t={};return{add:function(n,r){e(r)&&(t[n]=r)},get:function(e){return t[e]||null}}}),Box.Application.addService("message-registration-desk",function(){"use strict";function e(e){e.identifier in i||(i[e.identifier]={}),i[e.identifier][e.context]=e}function t(e,t){e in i&&(1===Object.keys(i[e]).length?delete i[e]:delete i[e][t])}function n(e,t){var n,r;if(!(e in i))return null;if(n=i[e],null===t){if(r=Object.keys(n),r.length>1){var o="Message context needs to be specified when a message has been registered with multiple contexts. ";throw o+="[identifier: "+e+"]",new Error(o)}return 1===r.length?n[r[0]]:null}return t in n?n[t]:null}function r(e){var t=[];return Object.keys(i).map(function(n){Object.keys(i[n]).map(function(r){var o=i[n][r];o.type===e&&t.push(o)})}),t}var i={};return{register:e,unregister:t,get:n,getAllRegisteredMessagesOfType:r}}),Box.Application.addService("pigeon",function(e){"use strict";function t(e){var t=Object.keys(e);return 0!==t.length}function n(e,n){var r=$.extend({},P);return n.map(function(e){r[e.type]=e}),!t(r)||null!==q&&q(r,e)}function r(e,t){return t+"_"+e}function i(e,t){return e in N&&t in N[e]}function o(e){return e in R}function a(e){return!(!e.canBeShownMultipleTimes&&i(e.identifier,e.context)||!e.isExemptFromSuppression&&o(e.type))}function s(e,t){return e.shouldStartSuppressionPeriod&&!t}function l(e){for(var t=D.getAllRegisteredMessagesOfType(e),n=t.length,r=0;r<n;r++){var i=t[r];i.isExemptFromSuppression||D.unregister(i.identifier,i.context)}R[e]=!0}function c(e,t){var n=F[t];return n&&n.identifier===e}function u(e){var t=F[e];if(t){var n=t.representation;F[e]=null,n.unload()}}function d(e){for(var t=[],n=D.getAllRegisteredMessagesOfType(e),r=n.length,i=0;i<r;i++){var o=n[i];o.shouldAutoLoad&&t.push(o)}return t}function f(e){var t=d(e);t.map(function(e){var t=x.createMessageRepresentationWithContext(e.name,e.type,e.context);t.load()})}function p(e){return null!==e&&null!==D.get(e.identifier,e.context)}function m(e,t){return t=t||[],p(e)&&n(e,t)}function h(e,t){var n=D.get(e,t);return!!n&&n.canBeShownMultipleTimes}function g(e,t){for(var n=B[e],r=0,i=n.length;r<i;r++)n[r].call(null,t)}function v(e,t){"function"==typeof t&&B[e].push(t)}function y(e,t){e in N||(N[e]={}),N[e][t]=!0}function b(e){P[e.type]=e}function _(e){delete P[e.type]}function w(e){var t=e.message;F[t.type]={identifier:t.identifier,representation:e.representation},g(T,e)}function S(e){var t=e.message;b(t),h(t.identifier,t.context)||D.unregister(t.identifier,t.context),y(t.identifier,t.context),g(A,e)}function k(e){var t,n=e.message;_(n),s(n,e.wasTriggeredByUserAction)&&l(n.type),t=p(n),t&&h(n.identifier,n.context)||(u(n.type),f(n.type)),g(I,e)}function E(e){c(e.identifier,e.type)||u(e.type)}function C(){M.registerOnMessagePreLoadCallback(E).setMessageEligibilityEvaluator(m)}var x,T="onLoad",A="onShow",I="onClose",O=e.getService("message-factory-collection"),D=e.getService("message-registration-desk"),M=e.getService("message-auctioneer"),P={},N={},R={},F={},B={onLoad:[],onShow:[],onClose:[]},q=null;return x={registerMessage:function(e){var t;a(e)&&(D.register(e),e.shouldAutoShow?(t=this.createMessageRepresentationWithContext(e.name,e.type,e.context),t.setIsTriggeredByUserAction(!1).show()):e.shouldAutoLoad&&(t=this.createMessageRepresentationWithContext(e.name,e.type,e.context),t.setIsTriggeredByUserAction(!1).load()))},unregisterMessage:function(e,t,n){D.unregister(e,t),c(e,n)&&(u(n),f(n))},createMessageRepresentation:function(e,t){var n=null;return this.createMessageRepresentationWithContext(e,t,n)},createMessageRepresentationWithContext:function(e,t,n){var i=r(e,t),o=D.get(i,n);if(!m(o))return M.createNonDisplayableMessageProxy(o);var a=O.get(t);if(null===a)return M.createNonDisplayableMessageProxy(o);var s=a.create(o),l=M.createDisplayableMessageProxy(o,s);return l.registerOnLoadCallback(w),l.registerOnShowCallback(S),l.registerOnCloseCallback(k),l},addMessageRepresentationFactory:function(e,t){O.add(e,t)},registerGlobalOnLoadCallback:function(e){return v(T,e),this},registerGlobalOnShowCallback:function(e){return v(A,e),this},registerGlobalOnCloseCallback:function(e){return v(I,e),this},setCanMessagesCoexistEvaluator:function(e){if("function"!=typeof e)throw new Error("Invalid parameter callback passed in.");return q=e,this},_getRegisteredMessage:function(e,t){return D.get(e,t)}},C(),x}),Box.Application.addService("base64-conversion",function(){"use strict";function e(e){var t=Array.prototype.map.call(e,function(e){return String.fromCharCode(e)}).join("");return t}function t(t){var n=e(t);return btoa(n)}function n(e){var t;return t="undefined"!=typeof Uint8Array?new Uint8Array(e.length):[],Array.prototype.forEach.call(e,function(e,n){t[n]=e.charCodeAt(0)}),t}function r(e){var t=atob(e),r=n(t);return r}function i(e){var t=encodeURIComponent(e),n=t.replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))});return n}function o(e){var t=i(e),r=n(t);return r}function a(e){var t=e.replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n});return decodeURIComponent(t)}function s(t){var n=e(t);return a(n)}return{byteArrayToBase64:t,base64ToByteArray:r,utf8ToByteArray:o,byteArrayToUtf8:s,binaryStringToByteArray:n}}),Box.Application.addService("hex-conversion",function(){"use strict";function e(e){return Array.prototype.map.call(e,function(e){var t=e.toString(16);return t.length<2&&(t="0"+t),t}).join("")}function t(e){var t,n,r=e.length/2,i=0;if(r!==parseInt(r,10))throw new Error("Invalid hex length '"+e.length+"'");for(n=new Uint8Array(r),t=0;t<r;t+=1)n[t]=parseInt(e[i]+e[i+1],16),i+=2;return n}return{byteArrayToHex:e,hexToByteArray:t}}),Box.Application.addService("webcrypto",function(e){"use strict";function t(){return c.crypto||c.msCrypto||c.webkitCrypto}function n(e,t,n){var r=l.getCrypto();return r.subtle.encrypt(e,t,n)}function r(e,t,n){var r=new sjcl.cipher.aes(sjcl.codec.bytes.toBits(t));return sjcl.codec.base64.fromBits(sjcl.mode.cbc.encrypt(r,sjcl.codec.utf8String.toBits(e),sjcl.codec.hex.toBits(n)))}function i(e,t,n){var r=l.getCrypto();return r.subtle.decrypt(e,t,n)}function o(e,t){var n=l.getCrypto();return n===c.msCrypto?u.create(function(r,i){var o=n.subtle.digest({name:e},t);o.oncomplete=function(e){r(e.target.result)},o.onerror=function(e){i(e)}}):n.subtle.digest(e,t)}function a(e,t,n,r){var i=l.getCrypto();return i.subtle.importKey("raw",e,t,n,r)}function s(e){var t=l.getCrypto(),n=new Uint8Array(e);return t.getRandomValues(n),n}var l,c=e.getGlobal("window"),u=e.getService("promises");return l={decrypt:i,digest:o,encrypt:n,encryptSJCL:r,importKey:a,getRandomValues:s,getCrypto:t}}),Box.Application.addService("custom-actions",function(e){"use strict";var t="custom_action_popup",n="office_online_open_popup",r=e.getService("popups-amsterdam"),i=e.getService("url");return{extractCustomActionConfig:function(e){var t={openTarget:e.hasAttribute("data-custom-action-open-target")?e.getAttribute("data-custom-action-open-target"):"server-only"};return"window"===t.openTarget&&(t.windowWidth=e.getAttribute("data-custom-action-width"),t.windowHeight=e.getAttribute("data-custom-action-height")),e.hasAttribute("data-office-online-app-name")&&(t.officeOnlineAppName=e.getAttribute("data-office-online-app-name")),e.hasAttribute("data-adobe-sign-app-name")&&(t.adobeSignAppName=e.getAttribute("data-adobe-sign-app-name")),t},launchCustomActionPopup:function(e,n){r.open(t,{data:{actionId:n,itemTypedId:e}})},executeCustomAction:function(e,t,o,a){var s=a||{},l="",c="",u=s.openTarget;a.officeOnlineAppName&&r.open(n,{data:{appName:a.officeOnlineAppName,itemTypedID:e}}),"window"===u||"tab"===u?(l="customaction_"+t+"_"+e,"window"===u&&(c="width="+s.windowWidth+",height="+s.windowHeight),i.openWindow(o,l,c)):this.executeServerOnlyCustomAction(o)},executeServerOnlyCustomAction:function(t){var n=e.getService("nav"),i=e.getService("xhr"),o=e.getService("notifications-amsterdam");return r.alert($t("Processing your request...","js_custom_action_processing_request")),i.send("get",t).then(i.parseJSONResponse).then(function(e){"success"===e.result?(o.info(e.message||$t("Request executed successfully.","js_custom_action_request_successful")),n.refresh()):o.error(e.message||$t("Request could not be executed. Please refresh and try again.","js_custom_action_request_unsuccessful"))}).caught(function(){o.error($t("Unable to process your request. Please refresh and try again.","js_custom_action_unable_to_process_request"))}).lastly(function(){r.close()})}}}),Box.Application.addService("custom-event-bus",function(){"use strict";var e=new Box.EventTarget;return{fire:function(t,n){e.fire(t,n)},on:function(t,n){e.on(t,n)},off:function(t,n){e.off(t,n)}}}),Box.Application.addService("date-boundaries",function(){"use strict";return{getStartofToday:function(e){var t=new Date(e.getTime());return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t},getStartofYesterday:function(e){return e=this.getStartofToday(e),e.setDate(e.getDate()-1),e},getStartofThisWeek:function(e){return e=this.getStartofToday(e),e.setDate(e.getDate()-e.getDay()),e},getStartofLastWeek:function(e){return e=this.getStartofThisWeek(e),e.setDate(e.getDate()-7),e},getStartofThisMonth:function(e){return e=this.getStartofToday(e),e.setDate(1),e},getStartofLastMonth:function(e){return e=this.getStartofToday(e),e.setMonth(e.getMonth()-1),e.setDate(1),e},getStartofThisYear:function(e){return e=this.getStartofThisMonth(e),e.setMonth(0),e},getStartofLastYear:function(e){return e=this.getStartofThisYear(e),e.setFullYear(e.getFullYear()-1),e}}}),Box.Application.addService("dictionary",function(){"use strict";function e(){this.children={},this.value=""}function t(t){this.root=new e,t&&this.addWords(t)}return e.prototype.add=function(t){if(this.contains(t))return this.children[t];var n=new e;return this.children[t]=n,n},e.prototype.contains=function(e){return this.children.hasOwnProperty(e)},e.prototype.get=function(e){return this.contains(e)?this.children[e]:null},e.prototype.getNextCharacters=function(){return Object.keys(this.children)},e.prototype.hasChildren=function(){return Object.keys(this.children).length>0},e.prototype.isWord=function(){return!!this.value},e.prototype.setValue=function(e){this.value=e},t.prototype.addWords=function(e){e.forEach(this.addWord.bind(this))},t.prototype.addWord=function(e){var t=e.split("").reduce(function(e,t){return e.add(t)},this.root);t.setValue(e)},t.prototype.search=function(e){function t(e){e.isWord()&&n.push(e.value),e.getNextCharacters().forEach(function(n){t(e.get(n))})}var n=[],r=this.searchPrefix(e);return r?(t(r),n):n},t.prototype.searchPrefix=function(e){return e.split("").reduce(function(e,t){return e?e.get(t):null},this.root)},{create:function(e){return new t(e)}}}),Box.Application.addService("dom-fragment",function(e){"use strict";var t=e.getService("dom"),n=e.getService("tooltips-amsterdam");return{setContentFor:function(r){for(var i,o,a,s=0,l=r.length;s<l;s++){if(a=r[s],i=a.getAttribute("data-content-for"),o=t.query(i),!o)return void e.reportError("Could not find "+i);if(e.stopAll(o),e.hasService("tooltips-amsterdam")&&n.hideAll(),$(o).empty(),"TITLE"===o.tagName)document.title=a.firstChild.nodeValue;else for(;a.firstChild;)o.appendChild(a.firstChild);e.startAll(o)}},addClassFor:function(e){e.forEach(function(e){var n=e.getAttribute("data-add-class-for"),r=e.getAttribute("data-class"),i=t.query(n);t.addClass(i,r)})},removeClassFor:function(e){e.forEach(function(e){var n=e.getAttribute("data-remove-class-for"),r=e.getAttribute("data-class"),i=t.query(n);t.removeClass(i,r)})},setAttributeFor:function(e){e.forEach(function(e){var n=e.getAttribute("data-set-attribute-for"),r=e.getAttribute("data-key"),i=e.getAttribute("data-value"),o=t.query(n);o.setAttribute(r,i)})},update:function(e){var n={"[data-content-for]":this.setContentFor,"[data-add-class-for]":this.addClassFor,"[data-remove-class-for]":this.removeClassFor,"[data-set-attribute-for]":this.setAttributeFor},r=t.createFragmentFromHtml(e);for(var i in n)if(n.hasOwnProperty(i)){var o=Array.prototype.slice.call(r.querySelectorAll(i)),a=n[i];a(o)}}}}),Box.Application.addService("drag-download",function(e){"use strict";function t(e){return!!(e.altKey||e.shiftKey||e.metaKey)}function n(e){if(t(e)){var n=e.target.getAttribute("data-downloadurl"),r=e.target.getAttribute("data-id");if(n&&r){var o="/index.php?rm=box_v2_download_file&print_download_url=1&file_id="+encodeURIComponent(r);i.sendSync("POST",o,null,{success:function(t){try{e.originalEvent.dataTransfer.setData("DownloadURL",n+t.responseText)}catch(e){}},error:function(e){404===e.status&&e.abort()}})}}}var r=e.getService("dom"),i=e.getService("xhr");return{isDragDownloadEvent:t,bindDrag:function(e){r.on(e,"dragstart",n)},unbindDrag:function(e){r.off(e,"dragstart",n)}}}),Box.Application.addService("drag-external",function(e){"use strict";function t(e){var t=e.dataTransfer;return t&&(t.files&&t.files.length||t.items&&t.items.length&&"file"===t.items[0].kind||Array.prototype.indexOf.call(t.types,"Files")!==-1)}var n="is-dragging-file",r=e.getService("dom");return{bindDrops:function(e){var i=new Box.EventTarget;if(!e.addEventListener)return i;var o=0;return e.addEventListener("drop",function(a){o&&t(a)&&(a.preventDefault(),a.stopPropagation(),i.fire("drop",a.dataTransfer),o=0,r.removeClass(e,n))}),e.addEventListener("dragenter",function(a){if(t(a)){if(a.preventDefault(),!o){var s=!1;i.fire("dragstart",{block:function(){s=!0}}),s||r.addClass(e,n)}s||o++}}),e.addEventListener("dragleave",function(i){t(i)&&o&&(o--,o||r.removeClass(e,n))}),e.addEventListener("dragover",function(e){e.preventDefault();try{if(e.dataTransfer&&"none"===e.dataTransfer.dropEffect)switch(e.dataTransfer.effectAllowed){case"copy":case"copyMove":e.dataTransfer.dropEffect="copy";break;case"move":e.dataTransfer.dropEffect="move"}}catch(e){}}),i}}}),Box.Application.addService("drag-internal",function(e){"use strict";function t(e,t){E.style.left=e-20+"px",E.style.top=t-20+"px"}function n(){A=!1,D=!1,E.className=u,w.removeClass(document.body,c);var e=w.query("."+f);w.removeClass(e,f),E.attachEvent&&(E.style.display="none")}function r(e){e.stopPropagation(),e.preventDefault()}function i(e,t,n,r){for(;E.firstChild;)E.removeChild(E.firstChild);var i;t&&t.length?(i=document.createElement("img"),i.setAttribute("src",t),n&&n.length&&i.setAttribute("background-position",n),E.appendChild(i)):r&&(i=r.cloneNode(!0),E.appendChild(i));var o=document.createElement("span");w.setText(o,e),E.appendChild(o)}function o(e){if(e.button===v&&!S.isDragDownloadEvent(e)){for(var t=e.target;t&&!t.hasAttribute("draggable");)if(t=t.parentNode,t===document.body)return;A=t,I=e.pageX,O=e.pageY}}function a(e){if(A&&!D&&!(Math.abs(e.pageX-I)+Math.abs(e.pageY-O)<h)){var n=D;D=C(A),n||i(D.title,D.icon,D.iconPosition,D.svg),E.style.display="inline-block",E.className=d,t(e.clientX,e.clientY),w.addClass(document.body,c)}}function s(e){if(D){var t=T(e.target);t&&(x.fire(D.type,{target:t,contents:D}),n(),e.preventDefault())}}function l(e){S.isDragDownloadEvent(e)||r(e)}var c="drag-cursor is-dragging",u="drag-chiclet",d="drag-chiclet is-active",f="is-dragging-over",p=50,m=180,h=5,g=10,v=0,y={ESC:27},b=e.getGlobal("window"),_=b.requestAnimationFrame||b.webkitRequestAnimationFrame,w=e.getService("dom"),S=e.getService("drag-download"),k=e.getService("page-scroll"),E=document.createElement("div");E.className="drag-chiclet",document.body.appendChild(E);var C,x,T,A=!1,I=0,O=0,D=!1;return w.on(document.body,"mousemove",function(e){D&&(_(function(){e.clientY<m?k.incrementScroll(-1*g):b.innerHeight-e.clientY<p&&k.incrementScroll(g),t(e.clientX,e.clientY)}),e.preventDefault())}),w.on(document.body,"mouseup",n),w.on(document.body,"keydown",function(e){e.which===y.ESC&&n()}),{bindDrag:function(e,t){w.on(e,"mousedown",o),C=t,w.on(e,"mousemove",a),w.on(e,"dragstart",l),w.on(e,"selectstart",r)},bindDrops:function(e,t){return e._boundDrops?e._boundDrops:(t||(t=function(e){return e}),x=new Box.EventTarget,T=t,w.on(e,"mouseup",s),w.on(e,"mouseover",function(e){if(D){var n=t(e.target);n&&w.addClass(n,f)}}),w.on(e,"mouseout",function(e){if(D){var n=t(e.target);n&&w.removeClass(n,f)}}),e._boundDrops=x,x)},unbind:function(e){w.off(e,"mousedown",o),w.off(e,"mousemove",a),w.off(e,"dragstart",l),w.off(e,"selectstart",r),w.off(e,"mouseup",s)}}}),Box.Application.addService("embed-context",function(e){"use strict";var t,n="additionalContext",r="embedWidgetConfig",i="isEmbedWidget",o="showItemFeedActions";return{getBasePath:function(){return this.isEmbedWidget()?"/embed":""},getEmbedWidgetConfig:function(n){return this.isEmbedWidget()?(t||(t=e.getGlobalConfig(r)),n?t[n]:t):null},isEmbedWidget:function(){return!!e.getGlobalConfig(i)},requiresAdditionalContext:function(){return!!this.getEmbedWidgetConfig(n)},updateURLWithEmbedWidgetParams:function(t){var r=e.getService("url"),i=this.getEmbedWidgetConfig(),o=Object.keys(i).reduce(function(e,t){var r=i[t];if(t===n){if(!this.requiresAdditionalContext())return e;t="additional_context"}return e[t]=r,e}.bind(this),r.getQueryParams(t));return r.createUrl(t.split("?")[0],o)},setAdditionalContext:function(e){return e.concat(e.indexOf("?")>-1?"&":"?","additional_context="+this.getEmbedWidgetConfig(n))},showItemFeedActions:function(){return this.getEmbedWidgetConfig(o)}}}),Box.Application.addService("file-list-image-loader",function(e){"use strict";var t=4,n=2e3,r=2,i=e.getService("function-utils"),o=e.getService("xhr");return{fetchItemThumbnailURLs:function(e){var a=e.getAttribute("data-id");return i.retryNumOfTimes(function(e,t,n){o.send("GET","/i/"+encodeURIComponent(a)+"/thumbnailURLs").then(o.parseJSONResponse).then(function(n){return n.icon&&n.list?void e(n):void t()},n)},t,n,r)}}}),Box.Application.addService("file-list-manager",function(e){"use strict";function t(e,t){var n=p.getFirstElementChild(e),r=p.query(".tbl-list-item",t);return r?r.parentNode.insertBefore(e,r):t.appendChild(e),n}function n(e,t){var n=p.getFirstElementChild(e),r=n.getAttribute("data-item-type"),i=p.query("[data-group-type="+r+"]",t),o=p.query(".tbl-list-item",i);return o?o.parentNode.insertBefore(e,o):i.appendChild(e),p.removeClass(i,"hidden"),n}function r(e,t){var n=p.getFirstElementChild(e);return t.parentNode.replaceChild(e,t),n}function i(t){var n=t.getAttribute("data-view");if(n){var r=p.query(u[n],t);p.addClass(r,d),m.fetchItemThumbnailURLs(t).then(function(i){r.setAttribute("data-image",i[n]),e.broadcast("loaddeferredimage",{imageElement:t})},function(){p.removeClass(r,d)})}}var o,a="no add",s="refresh",l="add",c="image",u={list:".file-icon",icon:".file-list-representation"},d="is-loading",f="highlight-new-item",p=e.getService("dom"),m=e.getService("file-list-image-loader"),h=e.getService("nav"),g=e.getService("promises"),v=e.getService("xhr");return{SHOULD_NOT_ADD:a,SHOULD_REFRESH:s,SHOULD_ADD:l,makeItemRowRequest:function(e,t,n){return v.send("GET","/i/"+encodeURIComponent(t)+"/row").then(function(t){if(o)return o;var n=this.shouldAddItem(e.substr(2));return n===s?o=h.refresh().then(function(){return t}):g.createResolved(t)}.bind(this),function(){return this.shouldAddItem()!==a&&h.refresh(),n(),g.createRejected()}.bind(this))},addItem:function(i,l){return g.create(function(u,d){this.makeItemRowRequest(i,l,d).then(function(d){o=null;var m=this.shouldAddItem(i.substr(2));if(m===s)return h.refresh(),void u();if(m===a)return void u();var g,v=p.query('.tbl-list-item[data-id="'+l+'"]'),y=p.createFragmentFromHtml(d.responseText),b=p.query(".file-list-body"),_=p.hasClass(b,"icon-view")?"icon":"list";v?g=r(y,v):(g="icon"===_?n(y,b,v):t(y,b,v),p.addClass(g,f)),e.broadcast("filelistitemadded",{fileListItemEl:g}),g.getAttribute("data-icon-type")===c&&this.setItemThumbnailURLs(g),u()}.bind(this)).catch(function(){return d(),g.createRejected()})}.bind(this))},setItemThumbnailURLs:i,removeItem:function(t){var n=p.query('.tbl-list-item[data-id="'+t+'"]');if(n){var r=n.parentNode;r.removeChild(n),e.broadcast("filelistitemremoved",{fileListItemEl:n}),r.children.length||h.refresh()}},shouldAddItem:function(e){var t=this.getCurrentFolder();return t&&t===e?document.querySelector(".file-list-empty")?s:l:a},getCurrentFolder:function(){var e=document.querySelector(".file-list[data-folder-typed-id]");if(e)return e.getAttribute("data-folder-typed-id").substr(2);var t=document.querySelector(".file-list-empty");return t?t.getAttribute("data-folder-typed-id").substr(2):null},getCurrentFileIDs:function(e){e=e||{};var t=e.excludeExtensions,n=e.includeExtensions,r=p.query(".file-list-body");if(r){var i=p.queryAll('.tbl-list-item[data-item-type="file"]',r);return i.filter(function(e){var r=e.getAttribute("data-extension"),i=!0;return t?i=t.indexOf(r)===-1:n&&(i=n.indexOf(r)!==-1),i}).map(function(e){var t=e.getAttribute("data-id");return t?t.substr(2):null}).filter(function(e){return null!==e})}return[]},getCurrentPageType:function(){var e=p.query(".file-list");return e&&e.getAttribute("data-page")||null},getCurrentSortData:function(){var e=p.query(".file-list");return{sortColumn:e&&e.getAttribute("data-sort-column")||null,sortDirection:e&&e.getAttribute("data-sort-direction")||null}}}}),Box.Application.addService("file-list-scroll",function(e){"use strict";var t=e.getService("dom"),n=e.getService("page-scroll"),r=e.getGlobal("window");return{scrollElementIntoView:function(e,i){var o=t.getBoundingClientRect(e),a=o.top<i,s=o.bottom>r.innerHeight,l=!a&&!s;if(!l){var c=o.top+n.getScrollTop();a?n.scrollTo(c-i):n.scrollToBottom(c+o.height)}}}}),Box.Application.addService("file-reader",function(e){"use strict";return{createFileReader:function(){return new FileReader}}}),Box.Application.addService("fileop-comment",function(e){"use strict";var t=e.getService("xhr");return{create:function(e,n){return t.send("POST","/file/"+encodeURIComponent(e)+"/activityfeed/comment","taggedMessage="+encodeURIComponent(n))},remove:function(e,n){return t.send("POST","/file/"+encodeURIComponent(e)+"/activityfeed/comment/delete","commentId="+encodeURIComponent(n))}}}),Box.Application.addService("fileop-create-box3d-package",function(e){"use strict";function t(e){var t={};return e.forEach(function(e){var n=e.properties.filename;n&&(t[n]=n)}),t}function n(e){var t=e?e.match('[^\\/:*?"<>|\r\n]+$'):null;return t?t[0]:null}function r(e){return"document"===e.type&&n(e.properties.filename)}function i(t){var n;try{m=m||e.getGlobal("Box3DShim"),n=m.mapEntities(t.entities,t.version)}catch(e){throw new Error($t("Error searching for entities","box3d_package_invalid_entity_data"))}return n}function o(e){if(!e)return b.createRejected(new Error($t("No file version id supplied to getBox3DEntities()","box3d_package_missing_rep_id")));var t=k+e+E+"?wait=true";return y.loadJS([x]).then(function(){return _.send("GET",t)}).then(function(t){return 200!==t.status||t.response?i(JSON.parse(t.response)):o(e)}).catch(function(){return i({entities:[],version:0})})}function a(e,t){var n=Object.keys(t).length;if(!n)return b.createResolved({});var r={fileId:e.replace("f_",""),filePaths:t,looseMatch:!0};return v.post(S,r).then(function(e){return e.data})}function s(e,i,o){var s=o.filter(r);return s.forEach(function(t){var r=n(t.properties.filename);e[t.properties.filename]={name:t.sid,displayName:r}}),a(i,t(o))}function l(e,t){var n={};return Object.keys(t).forEach(function(r){var i=t[r];n[r]={fileID:i&&i.fileId?i.fileId.toString():void 0,fileVersionID:i&&i.fileVersionId?i.fileVersionId.toString():void 0,parent:e.name,path:i?i.path:void 0,displayPath:i?e.name+"/"+i.path:void 0,resolved:i?!(r.search(/(\.mtl)$/i)>-1):void 0}}),e.resolved=!0,n}function c(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=$.extend(e[n]||{},t[n]))}function u(e){return _.send("GET",e).then(function(e){var t=e.response,n="object"==typeof t?t:JSON.parse(t),r=n.state?n.state:null,i=n.result?n.result:r,o=!1;switch(i){case g.COMPLETE:o=!0;case g.UNKNOWN:case g.STARTING:case g.IN_PROGRESS:return{data:n,ready:o};case g.FAILURE:case g.FAILED:default:throw new Error($t("Error trying to get status of packaging process.","box3d_package_progress_reporting_error"))}})}function d(e,t){return _.send("POST",e,t).then(function(e){var t="string"==typeof e.response?JSON.parse(e.response):e.response;if(200!==e.status||!t||!t.success)throw new Error($t("Package creation unsuccessful.","box3d_package_zip_create_failed"));return t})}function f(e,t,n){if(!(e instanceof Array&&e.length))return b.createRejected($t("No file IDs for package","box3d_package_file_ids_empty"));if(!t)return b.createRejected($t("No package ID provided","box3d_package_missing_package_id"));if(!n)return b.createRejected(T);var r={d:[t],in:e,ParentId:t,ZipFileName:n};return v.post(w,r).then(function(e){if("failure"===e.status)throw new Error($t("Failed to get create data for package creation.","box3d_package_create_submission_error"));return d(e.data.zip_create_url,e.data.zip_create_data).then(function(){return u.bind(this,e.data.progress_reporting_url)})})}function p(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(e[t]);return n}var m,h=e.getGlobal("window"),g={UNKNOWN:"Unknown",STARTING:"Starting",IN_PROGRESS:"InProgress",COMPLETE:"Completed",FAILED:"Failed",FAILURE:"failure"},v=e.getService("ajax"),y=e.getService("assets-dynamic"),b=e.getService("promises"),_=e.getService("xhr"),w="box_v2_create_zip",S="preview_file_association",k=h.location.origin+"/representation/file_version_",E="/3dcg_json.json",C=".box3d",x=h.location.origin+"/js/vendor/3dcg_viewer/box3d-shim.js",T=$t("No package name given for package","box3d_package_missing_name");return{createPackage:function(e,t,n,r,i){if(!e||!n)return b.createRejected(new Error($t("Package creation requires fileID and fileName.","box3d_package_invalid_name_or_id")));var o={fileID:e,fileVersionID:t,name:n,displayName:n,resolved:!1},a=this;return this.getDependencies(o,e).then(function(t){return t[n+e]=o,a.createPackageFromEntities(t,r,i)})},createPackageFromEntities:function(e,t,n){if(!e)return b.createRejected(new Error($t("Cannot make an empty package.","box3d_packages_empty_entity_list")));var r="object"==typeof e?p(e):e,i=[],o=this;return r.forEach(function(e){var t=o.getFormattedPackageId(e);t&&i.push(t)}),this.createPackageFromIds(i,t,n)},createPackageFromIds:function(e,t,n){if(!n)return b.createRejected(T);var r=n.search(/(\.box3d)$/i)>-1?n:n+C;return f(e,t,r)},onDependenciesResolved:function(e,t,n){c(e,n);var r,i=[];for(r in e)if(e.hasOwnProperty(r)){var o=e[r];o.resolved===!1&&i.push(this.getDependencies(o,t).then(function(t){c(e,t)}))}return b.all(i)},getDependencies:function(e,t){if(!e||!t)return b.createRejected(new Error($t("Cannot get dependencies for the current file.","box3d_invalid_get_deps_parameters")));var n={},r=t.replace("f_","");return o(e.fileVersionID).then(s.bind(this,n,r)).then(l.bind(this,e)).then(this.onDependenciesResolved.bind(this,n,r)).then(function(){return n})},getFormattedPackageId:function(e){return e.fileID?e.fileID.replace("f_",""):null}}}),Box.Application.addService("fileop-create-weblink",function(e){"use strict";var t="create_weblink";return{createWeblink:function(n,r,i,o){var a=e.getService("ajax"),s={url:n,folderId:r,name:i,description:o};return a.post(t,s)}}}),Box.Application.addService("fileop-delete",function(e){"use strict";function t(t,n,r){return function(a){var c=a.data,u=c.successItemTypedIds,d=c.isTrashDisabled;u&&(u.forEach(function(e){i.removeItem(e)}),e.broadcast("fileopdeletesuccess"));var f;return f=n?n:1===u.length?$t("Item successfully moved to trash.","fileop_delete_success_singular"):$t("Items successfully moved to trash.","fileop_delete_success"),t?d||r?o.info(f):o.info(f,{buttonText:$t("Undo","fileop_delete_undo")}).then(function(){return s.restoreItemsFromTrash(u,t.substring(2))},function(){return l.createRejected()}):(o.info(f),l.createResolved())}}function n(t){return e.broadcast("fileopdeletefailure"),t&&t.data&&t.data.message&&o.error(t.data.message),
l.createRejected()}var r=e.getService("ajax"),i=e.getService("file-list-manager"),o=e.getService("notifications-amsterdam"),a=e.getService("popups-amsterdam"),s=e.getService("fileop-restore"),l=e.getService("promises");return{delete_:function(i,o,s,c,u){void 0===u&&(u=!0);var d;if(u){var f=i.length>1?$t("Are you sure you want to delete these items?","delete_multiple_confirm_popup"):$t("Are you sure you want to delete this item?","delete_single_confirm_popup");d=a.confirm(f)}else d=l.createResolved();return e.broadcast("fileopdeletestart"),d.then(function(){return r.post("folder_delete_items_post",{itemTypedIds:i})}).then(t(o,s,c)).catch(n)}}}),Box.Application.addService("fileop-deletefromtrash",function(e){"use strict";function t(e){var t=$t("The item was deleted.","delete_selected_success_notification");e&&(t=$t("The selected items were deleted.","delete_selected_multiple_success_notification")),l.info(t)}function n(e){var n=o,r={itemTypedIDs:e};return c.showConfirmBlockingState(),a.post(n,r).then(function(){c.close({enableClose:!0}),t(e.length>1)}).catch(function(e){c.close({enableClose:!0});var t=e&&e.data||{},n=t.message;throw n||(n=$t("There was a problem deleting the selected item(s). Please try again or refresh the page.","delete_selected_from_trash_request_error")),l.error(n),new Error(n)})}function r(){return c.showConfirmBlockingState(),a.post(i).then(function(){c.close({enableClose:!0});var e=$t("All the items in the Trash have been deleted.","popup_action_delete_from_trash_confirmation_entire_trash");l.info(e)}).catch(function(e){c.close({enableClose:!0});var t=e&&e.data||{},n=t.message;throw n||(n=$t("There was a problem deleting all items in the trash. Please try again or refresh the page.","delete_from_trash_request_error")),l.error(n),new Error(n)})}var i="trash_delete_all_items",o="trash_delete_items",a=e.getService("ajax"),s=e.getService("promises"),l=e.getService("notifications-amsterdam"),c=e.getService("popups-amsterdam");return{deleteAllItems:function(){var e=$t("Delete All Items","delete_all_confirmation_title"),t=$t("Are you sure you want to empty the entire contents of the Trash?","popup_action_delete_from_trash_ask_empty_all_description");return c.confirm(t,e,{isBlocking:!0}).then(function(){return r()})},deleteItems:function(e){if(!e.length)return s.createRejected();var t=$t("Permanently Delete Item","delete_from_trash_confirmation_title"),r=$t("Are you sure you want to permanently delete this item?","delete_from_trash_confirmation_text");return e.length>1&&(t=$t("Permanently Delete Items","delete_from_trash_multiple_confirmation_title"),r=$t("Are you sure you want to permanently delete these %1 items?","delete_from_trash_multiple_confirmation_text",e.length)),c.confirm(r,t,{isBlocking:!0}).then(function(){return n(e)})}}}),Box.Application.addService("fileop-description",function(e){"use strict";var t=e.getService("ajax");return{set:function(e,n){return t.post("folder_set_description_for_item_post",{itemTypedId:e,description:n})}}}),Box.Application.addService("fileop-download",function(e){"use strict";function t(){r||(r=f.createElement("iframe"),r.style.display="none",r.name="box-download-target",f.body.appendChild(r))}function n(e){t();var n=f.createElement("form");n.method="post",n.action=e,n.target="box-download-target",n.style.display="none";var r=f.createElement("input");return r.type="hidden",r.name="request_token",r.value=d.requestToken,n.appendChild(r),n}var r,i="box_v2_zip_folder",o="box_v2_zip_shared_folder",a="box_v2_download_file",s="box_download_shared_file",l=$t("The download is greater than 5GB. Please download the files individually or group them into smaller folders.","popup_action_download_error_zip_folder_too_large"),c=$t("Problems downloading archive.","popup_action_download_folder_error"),u=$t("You do not have the permission to download this folder. Please contact the folder owner.","popup_action_download_folder_permission_error"),d=e.getGlobalConfig(),f=e.getGlobal("document"),p=e.getService("ajax"),m=e.getService("notifications-amsterdam"),h=e.getService("popups-amsterdam"),g=e.getService("promises"),v=e.getService("urls-runmode");return{download:function(e,t){return t=t||{},"nginx"!==d.zip_method&&t.size&&t.size>d.file_size_download_limit?h.alert(l):1===e.length&&"f_"===e[0].substr(0,2)?this.downloadFile(e[0],t):this.downloadBulk(e,t)},downloadBulk:function(e,n){var a=i;n=n||{},m.info($t("Your download will begin shortly.","amsterdam_download_start_notification"));var s;return s=1===e.length&&"d_"===e[0].substr(0,2)?{folder_id:e[0].substr(2)}:n.parentFolderID?{folder_id:n.parentFolderID,nodes:e.join(",")}:{nodes:e.join(",")},n.vanityName?(a=o,s.q={shared_item:{vanity_name:n.vanityName}}):n.sharedName&&(a=o,s.q={shared_item:{shared_name:n.sharedName}}),p.get(a,s).then(function(e){var n=e.data||{};return"permission"===n.result?h.alert(u):"success"!==n.result?g.createRejected(n.message):(t(),void(r.src=n.download_url))}).then(null,function(e){return h.alert(e||c)})},downloadFile:function(e,t){var r,i=/(f_\d+)(?:_(\d+))?/.exec(e);t=t||{},t.vanityName?(r=v.get(s),r+="&vanity_name="+t.vanityName):t.sharedName?(r=v.get(s),r+="&shared_name="+t.sharedName):r=v.get(a),r+="&file_id="+i[1],i[2]&&(r+="&file_version_id="+i[2]),r=this.addAdditionalContext(r);var o=n(r);return f.body.appendChild(o),o.submit(),f.body.removeChild(o),g.createResolved()},downloadViaGet:function(t){var n=e.getService("url");n.goToUrlInBackground(t)},addAdditionalContext:function(t){var n=e.getService("embed-context");return n.isEmbedWidget()&&n.requiresAdditionalContext()&&(t=n.setAdditionalContext(t)),t}}}),Box.Application.addService("fileop-edit-weblink-url",function(e){"use strict";var t=e.getService("ajax");return{set:function(e,n){return t.post("edit_weblink_url",{weblinkTypedID:e,url:n})}}}),Box.Application.addService("fileop-favorites",function(e){"use strict";var t="add_to_favorites",n="remove_from_favorites",r="favorites",i=$t("Item added to Favorites.","fileop_favorites_add_to_favorite"),o=$t("Item removed from Favorites.","fileop_favorites_remove_from_favorite"),a=$t("An error occurred adding this item to favorites.","favorites_add_to_favorite_error"),s=$t("An error occurred removing this item from favorites.","favorites_removing_to_favorite_error");return{add:function(n,o,s){var l=e.getService("ajax"),c=e.getService("notifications-amsterdam"),u=e.getService("resin"),d={itemTypedId:n};return s&&u.recordAction({application:"files",page:"explorer",component:"content",feature:r,target:s,action:"click"}),e.broadcast("favoritestarted"),l.post(t,d).then(function(){e.broadcast("favoritesuccess",d),c.info(i)},function(){e.broadcast("favoriteerror",d),c.error(a)})},remove:function(t,i,a){var l=e.getService("ajax"),c=e.getService("notifications-amsterdam"),u=e.getService("resin"),d={itemTypedId:t};return a&&u.recordAction({application:"files",page:"explorer",component:"content",feature:r,target:a,action:"click"}),e.broadcast("unfavoritestarted"),l.post(n,d).then(function(){e.broadcast("unfavoritesuccess",d),c.info(o)},function(){e.broadcast("unfavoriteerror",d),c.error(s)})}}}),Box.Application.addService("fileop-lock",function(e){"use strict";var t="lock_item",n="unlock_item",r="request_unlock",i=e.getService("ajax");return{lock:function(e,n,r){var o={itemTypedID:e,duration:n,preventDownload:r};return i.post(t,o)},unlock:function(e){var t={itemTypedID:e};return i.post(n,t)},requestUnlock:function(e,t,n){var o={itemTypedID:e,message:t,notifyEmail:n};return i.post(r,o)}}}),Box.Application.addService("fileop-movecopy",function(e){"use strict";function t(e,t,n,r){var i=r||{},o={itemTypedIds:t,destTypedId:n};return i.hasOwnProperty("ownershipChangeConfirmationRequired")&&void 0!==i.ownershipChangeConfirmationRequired&&(o.ownershipChangeConfirmationRequired=!!i.ownershipChangeConfirmationRequired),i.makeCollaboratedSubfolderPrivate&&(o.makeCollaboratedSubfolderPrivate=!0),te.post(e,o)}function n(e){return function(t){return e===x&&S.forEach(function(e){re.addItem(_,e)}),t&&t.data&&t.data.message?void ae.error(t.data.message,{duration:-1}):void ae.error(Q,{duration:-1})}}function r(e,r){return function(){if(e===x){var i=k||_;t(E,r,i,{ownershipChangeConfirmationRequired:!1}).then(function(e){if(e.data.result===A){var t=e.data.successes;t.forEach(function(e){i===_?re.addItem(_,e.typedId):re.removeItem(e.typedId)}),ae.info(z)}else ae.error(Z)},n(x))}else{var o=!0,a=!1;ie.delete_(r,w,z,o,a)}}}function i(e,t){return function(){r(e,t)(),se.close({unsafeSkipRefresh:!0})}}function o(e){return function(){oe.navigate("/folder/"+e.slice(2))}}function a(e,t,n){ne.addClass(n,P),r(e,[t])()}function s(e,r,i){ne.addClass(i,P),t(E,[r],e,{makeCollaboratedSubfolderPrivate:!0}).then(function(e){if(e.data.result===A){var t=e.data.successes;t.forEach(function(e){re.removeItem(e.typedId)}),ne.setText(i,U)}else ae.error(ee)},n(x))}function l(e,t){var n=document.createElement("ul");return t.forEach(function(t){var r=document.createElement("li"),i=document.createElement("span");ne.setText(i,t.name);var o=document.createElement("button");o.className="btn action-btn",ne.setText(o,L),o.setAttribute("title",L);var s=e===x?t.typedId:t.createdTypedId;ne.on(o,"click",a.bind(null,e,s,o)),r.appendChild(i),r.appendChild(o),n.appendChild(r)}),n}function c(e,t){var n=[];return t.forEach(function(t){e===x?n.push(t.typedId):n.push(t.createdTypedId)}),n}function u(e,t){var n=document.createElement("li"),r=document.createElement("div");r.className="failed-row-with-action";var i=document.createElement("div");i.className="failed-row-with-action-details";var o=document.createElement("b");ne.setText(o,t.name),i.appendChild(o);var a=document.createElement("p");ne.setText(a,t.message),i.appendChild(a),r.appendChild(i);var l=document.createElement("button");return l.className="btn action-btn",ne.setText(l,j),l.setAttribute("title",j),r.appendChild(l),ne.on(l,"click",s.bind(null,e,t.typedId,l)),n.appendChild(r),n}function d(e,t){if(t.errorCode===q)return u(e,t);var n=document.createElement("li"),r=document.createElement("b");ne.setText(r,t.name),n.appendChild(r);var i=document.createElement("p");return ne.setText(i,t.message),n.appendChild(i),n}function f(e,t){var n=document.createElement("ul");return t.forEach(function(t){var r=d(e,t);n.appendChild(r)}),n}function p(e,t){var n=t.successes,r=t.failures,o=t.destinationTypedID,a=document.createElement("div"),s=document.createElement("h2");if(ne.addClass(s,N),ne.setText(s,e===x?G:X),a.appendChild(s),n.length){var u=document.createElement("h3");u.id="completed-title",ne.addClass(u,R),ne.setText(u,J),a.appendChild(u),a.appendChild(l(e,n))}if(r.length){var d=document.createElement("h3");d.id="failed-title",ne.addClass(d,R),ne.setText(d,Y),a.appendChild(d),a.appendChild(f(o,r))}if(n.length){var p=document.createElement("button"),m=c(e,n);p.id="undo-all-btn",p.setAttribute("title",V),ne.setText(p,V),ne.addClass(p,D),ne.addClass(p,M),ne.on(p,"click",i(e,m)),a.appendChild(p)}var h=document.createElement("button");return h.id="cancel-btn",h.setAttribute("title",K),ne.setText(h,K),ne.addClass(h,D),ne.on(h,"click",function(){se.close({unsafeSkipRefresh:!0})}),a.appendChild(h),a}function m(e,t,n){return t&&!n?ae.info(e,{buttonText:W}):t&&n?ae.warn(e,{buttonText:W,duration:-1}):!t&&n?ae.error(e,{buttonText:W,duration:-1}):void 0}function h(t,n){e.broadcast(t,{currentFolderTypedId:_,destinationFolderTypedId:w,items:n})}function g(e,t){function n(){return this.move(e.itemTypedIDs,e.destTypedID,e.currentTypedID,{ownershipChangeConfirmationRequired:!1,sourceFolderTypedID:e.sourceFolderTypedID})}var r=$t("Change Item Owner","move_action_ownership_change_confirmation_title"),i=t.message;return se.confirm(i,r).then(n.bind(this)).catch(function(){return le.createRejected()})}function v(e,t){function i(n,i){var a=n.target.getAttribute("data-button-index");return a===F?r(e,[i]):a===B?o(t.destinationTypedID):void 0}var a=t.successes||[],s=t.failures||[],l=t.message||"";if(!a.length&&!s.length)return n(e)(),le.createRejected();if(a.length&&h(e+"success",a),s.length&&h(e+"failure",s),1!==a.length||s.length)m(l,a.length,s.length).then(function(){var n=se.create(p(e,t),O);n.show()});else{var c=e===x?a[0].typedId:a[0].createdTypedId,u="d_"===c.slice(0,2)?$:H;ae.info(l,{buttonText:[L,u]}).then(function(e){i(e,c)()},function(){})}return le.createResolved()}function y(e,t){return t&&t.data?t.data.result&&t.data.result===I?(h("movestop"),g.call(this,e,t.data)):v(x,t.data):(n(x)(),le.createRejected())}function b(e){return e&&e.data?v(T,e.data):(n(T)(),le.createRejected())}var _,w,S,k,E="move_items",C="copy_items",x="move",T="copy",A="success",I="confirmation_required",O="move-copy-details-popup",D="btn",M="btn-primary",P="is-disabled",N="popup-heading",R="popup-section-title",F="0",B="1",q="cannot_make_collaborated_subfolder_private",L=$t("Undo","fileop_movecopy_undo"),j=$t("Move","fileop_movecopy_move_anyway"),U=$t("Done","fileop_movecopy_done"),H=$t("Show File","fileop_movecopy_show_file"),$=$t("Show Folder","fileop_movecopy_show_folder"),V=$t("Undo All","fileop_movecopy_undo_all"),W=$t("Details","fileop_movecopy_details"),K=$t("Close","fileop_movecopy_close"),z=$t("Undone!","fileop_movecopy_undone"),G=$t("Move Operation Details","fileop_move_details_popup_title"),X=$t("Copy Operation Details","fileop_copy_details_popup_title"),J=$t("Completed","fileop_movecopy_details_completed_section_title"),Y=$t("Failed","fileop_movecopy_details_failed_section_title"),Q=$t("The operation could not be started. Please contact support or try again later.","fileop_movecopy_did_not_start"),Z=$t("Sorry, an error occurred when trying to undo the move. Go to the destination folder and try moving your items back from there.","move_undo_error_message"),ee=$t("Sorry, an error occurred when trying to change ownership of this folder during the move.","move_collaborated_subfolder_error_message"),te=e.getService("ajax"),ne=e.getService("dom"),re=e.getService("file-list-manager"),ie=e.getService("fileop-delete"),oe=e.getService("nav"),ae=e.getService("notifications-amsterdam"),se=e.getService("popups-amsterdam"),le=e.getService("promises");return{move:function(e,r,i,o){function a(t){var n={itemTypedIDs:e,destTypedID:r,currentTypedID:i,sourceFolderTypedID:s.sourceFolderTypedID};return y.call(this,n,t)}var s=o||{},l={ownershipChangeConfirmationRequired:s.ownershipChangeConfirmationRequired};return S=e,w=r,_=i,k=s.sourceFolderTypedID,h("movestart",e.map(function(e){return{typedId:e}})),t(E,e,r,l).then(a.bind(this),n(x))},copy:function(e,r,i){return S=e,w=r,_=i,h("copystart",e.map(function(e){return{typedId:e}})),t(C,e,r).then(b,n(T))}}}),Box.Application.addService("fileop-open",function(){"use strict";return{}}),Box.Application.addService("fileop-rename",function(e){"use strict";function t(e){switch(e[0]){case"d":return"folder";case"f":return"file";case"l":return"web_link";default:return""}}function n(e,t){switch(e[0]){case"d":return $t('The folder has been renamed to "%1".',"rename_folder_success",t);case"f":return $t('The file has been renamed to "%1".',"rename_file_success",t);case"l":return $t('The link has been renamed to "%1".',"rename_link_success",t);default:return""}}function r(e){switch(e){case"folder":return o;case"file":return a;case"web_link":return s}}function i(){var t=e.getService("resin"),n=e.getGlobalConfig("resinPageName");t.recordAction({application:"files",page:n,component:"modal",feature:"rename",target:"loaded",action:"",data:{loadTime:0}})}var o={heading:$t("Rename folder","rename_folder_prompt"),message:$t("Please enter a new name for the folder.","rename_folder_prompt_body"),conflictMessage:$t("A folder with that name already exists. Please choose a different name.","rename_folder_prompt_conflict_body"),placeholder:$t("My Folder","rename_folder_prompt_placeholder"),title:$t("You may only use alphanumeric characters and some symbols for folder names.","rename_folder_prompt_validation")},a={heading:$t("Rename file","rename_file_prompt"),message:$t("Please enter a new name for the file.","rename_file_prompt_body"),conflictMessage:$t("A file with that name already exists. Please choose a different name.","rename_file_prompt_conflict_body"),placeholder:$t("My file","rename_file_prompt_placeholder"),title:$t("You may only use alphanumeric characters and some symbols for file names.","rename_file_prompt_validation")},s={heading:$t("Rename link","rename_link_prompt"),message:$t("Please enter a new name for the link.","rename_link_prompt_body"),conflictMessage:$t("A link with that name already exists. Please choose a different name.","rename_link_prompt_conflict_body"),placeholder:$t("My link","rename_link_prompt_placeholder"),title:$t("You may only use alphanumeric characters and some symbols for link names.","rename_link_prompt_validation")},l=e.getService("ajax"),c=e.getService("notifications-amsterdam"),u=e.getService("popups-amsterdam");return{rename:function(o,a,s){var d=t(o),f=r(d),p="file"===d?a.substr(a.lastIndexOf(".")+1):null,m="file"===d?a.substr(0,a.lastIndexOf(".")):a;s&&(f.message=f.conflictMessage);var h;u.prompt($.extend({defaultValue:m},f)).then(function(t){return h=t.trim(),e.broadcast("item-name-change",{itemTypedId:o,name:$t("Saving...","rename_saving")}),l.post("folder_set_name_for_item_post",{itemTypedId:o,name:"file"===d?h+"."+p:h})}).then(function(t){var r=n(o,h);return e.broadcast("item-name-change",t.data),c.info(r),t}).catch(function(t){var n=t.data||{};return e.broadcast("item-name-change",{itemTypedId:o,name:a}),"renameConflict"===n.code?this.rename(o,a,!0):c.error(n.message)}.bind(this)),i()}}}),Box.Application.addService("fileop-report",function(){"use strict";return{report:function(){}}}),Box.Application.addService("fileop-restore",function(e){"use strict";function t(e){var t=p,n={};e&&(n={data:{itemTypedIds:e}}),b.open(t,n)}function n(e){return"d_"===e.slice(0,2)}function r(e){return"l_"===e.slice(0,2)}function i(t){var n=e.getService("fileop-delete"),r=!0,i=!1;n.delete_(t,null,C,r,i).then(function(){w.refresh()})}function o(t){if(r(t)){var i=e.getService("url");i.openWindow("/web_link/"+t.slice(2))}else{var o="";o=n(t)?"/folder/":"/file/",w.navigate(o+t.slice(2))}}function a(e){if(0!==e.length){var t=$t("The item was restored.","restore_success_notification"),r="",a=null,s=[],l=e.length>1;l?t=$t("The selected items were restored.","restore_multiple_success_notification"):(r=n(e[0])?E:k,a=e[0],s=[S,r]),y.info(t,{buttonText:s}).then(function(t){var n=t.target.getAttribute("data-button-index");n===x?i([a]):n===T&&o(e[0])})}}function s(e,n){var r=m,i={itemTypedIds:e};return n&&(i.restoreFolderId=n),g.post(r,i).then(function(e){var t=e.data||{};return b.close({enableClose:!0,unsafeSkipRefresh:!0}),a(t.successItemTypedIds),e},function(e){var n=e.data||{};throw b.close({enableClose:!0,unsafeSkipRefresh:!0}),n.code===d||n.code===f?t(n.errorItemTypedIds):n.message&&y.error(n.message),new Error(n)})}function l(){var e=$t("All the items in the Trash were restored.","popup_action_restore_confirmation_entire_trash");y.info(e)}function c(e){var n={};return e&&(n.restoreFolderId=e),g.post(h,n).then(function(e){b.close({enableClose:!0,unsafeSkipRefresh:!0});var n=e.data;if(!n.success)throw n.message===f?(t(),new Error(f)):(y.error(n.message),new Error(n.message));l()},function(){b.close({enableClose:!0,unsafeSkipRefresh:!0});var e=$t("There was a problem restoring all items in the trash. Please try again or refresh the page.","restore_all_error_notification");throw y.error(e),new Error(e)})}function u(e,t){for(var n=0;n<e.length;n++)_.addItem(t,e[n])}var d="restoreFolderPermissionsError",f="invalidParentFolder",p="trash_restore_folder_popup",m="trash_restore_items",h="trash_restore_all_items",g=e.getService("ajax"),v=e.getService("promises"),y=e.getService("notifications-amsterdam"),b=e.getService("popups-amsterdam"),_=e.getService("file-list-manager"),w=e.getService("nav"),S=$t("Undo","fileop_restore_undo"),k=$t("Show File","fileop_restore_show_file"),E=$t("Show Folder","fileop_restore_show_folder"),C=$t("Restored!","fileop_restore_undo_success"),x="0",T="1";return{restoreItemsFromTrash:function(e,t){if(!e.length)return v.createRejected();if(t)return s(e,t).then(function(e){var n=e.data;if(n&&n.successItemTypedIds)return u(n.successItemTypedIds,"d_"+t)});var n=$t("Restore Item","restore_confirmation_title"),r=$t("Are you sure you want to restore this item?","restore_confirmation_text");return e.length>1&&(n=$t("Restore Items","restore_multiple_confirmation_title"),r=$t("Are you sure you want to restore these %1 items?","restore_multiple_confirmation_text",e.length)),b.confirm(r,n,{isBlocking:!0}).then(function(){return b.showConfirmBlockingState(),s(e)})},restoreAllItemsFromTrash:function(e){if(e)return c(e);var t=$t("Restore All Items","restore_all_confirmation_title"),n=$t("Are you sure you want to restore the entire contents of the Trash?","restore_all_confirmation_text");return b.confirm(n,t,{isBlocking:!0}).then(function(){return b.showConfirmBlockingState(),c()})}}}),Box.Application.addService("fileop-sync",function(e){"use strict";var t=e.getService("xhr");return{syncItem:function(e){return t.send("POST","/folders/sync/syncItem?itemTypedID="+encodeURIComponent(e))},unsyncItem:function(e){return t.send("POST","/folders/sync/unsyncItem?itemTypedID="+encodeURIComponent(e))}}}),Box.Application.addService("fileop-task",function(e){"use strict";var t=e.getService("xhr");return{create:function(e,n,r,i){var o=r.reduce(function(e,t){return e+="&assignmentUserIds[]="+encodeURIComponent(t)},""),a="/file/"+encodeURIComponent(e)+"/activityfeed/task",s="taggedMessage="+encodeURIComponent(n)+o+(i?"&dueDate="+encodeURIComponent(i):"");return t.send("POST",a,s)},updateTask:function(e,n,r){return t.send("POST","/file/"+encodeURIComponent(e)+"/activityfeed/task/update","taskId="+encodeURIComponent(n)+"&taggedMessage="+encodeURIComponent(r))},updateAssignment:function(e,n,r){return t.send("POST","/file/"+encodeURIComponent(e)+"/activityfeed/task/assignment","taskAssignmentId="+encodeURIComponent(n)+"&status="+encodeURIComponent(r))},remove:function(e,n){return t.send("POST","/file/"+encodeURIComponent(e)+"/activityfeed/task/delete","taskId="+encodeURIComponent(n))}}}),Box.Application.addService("fileop-versions",function(e){"use strict";var t=e.getService("ajax"),n=e.getService("promises"),r="version_history_make_current",i="version_history_remove",o="version_history_restore";return{showVersionsPopup:function(t){var n=e.getGlobal("Item");n&&n.find_async("f_"+t).then(function(e){e&&e.version_history()})},makeCurrentVersion:function(e){return t.post(r,{fileVersionId:e}).then(function(e){return n.createResolved(e)},function(e){return n.createRejected(e)})},removeVersion:function(e,r){return t.post(i,{fileId:e,fileVersionId:r}).then(function(e){return n.createResolved(e)},function(e){return n.createRejected(e)})},restoreVersion:function(e,r){return t.post(o,{fileId:e,fileVersionId:r}).then(function(e){return n.createResolved(e)},function(e){return n.createRejected(e)})}}}),Box.Application.addService("flyout-toggle",function(e){"use strict";function t(e){m&&m.events.fire(e)}function n(){if(m){var e=m.flyoutEl;c.removeClass(e,p),c.addClass(e,"hidden"),l.hide(e),setTimeout(function(){e.style.display="",e.style.left="",e.style.top="",e.style.right=""},100),t("closed"),m=null}}function r(e,r){var i=e.nextElementSibling;if(i&&(c.hasClass(i,"flyout")||(i=c.queryAll(".flyout",i),i.length))){if(c.hasClass(i,p))return void n();m&&n(),m=r,m.flyoutEl=i,d.wrap(i),i.style.display="block";var o=u.repositionPopout(i,e);o&&(i.style.left="auto",i.style.top=o.top,i.style.right=o.right),setTimeout(function(){c.addClass(i,p),c.removeClass(i,"hidden"),l.show(i)},100),t("opened")}}function i(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===f)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===f)return t}}function o(e){var t=e.target||e.srcElement;return!!c.getNearestUnbounded(t,".flyout")}function a(e){if(m){var r=i(e);if(r){var a=r.nextElementSibling;if(!a||a===m.flyoutEl)return}o(e)||(t("lostfocus"),n())}}function s(e){this.events=new Box.EventTarget,this.flyoutEl=null,this.shouldCloseFlyoutOnBlur="undefined"==typeof e||e,this._globalClickHandler=function(e){a(e)}}var l,c,u,d,f="flyout-toggle-button",p="is-active",m=null;return s.prototype={init:function(){l=e.getService("aria"),c=e.getService("dom"),u=e.getService("popout-reposition"),d=e.getService("focus"),this.shouldCloseFlyoutOnBlur&&c.on(document.body,"mousedown",this._globalClickHandler)},destroy:function(){this.shouldCloseFlyoutOnBlur&&c.off(document.body,"mousedown",this._globalClickHandler)},showFlyout:function(e){r(e,this)},closeFlyout:function(){n()},on:function(e,t){this.events.on(e,t)},off:function(e,t){this.events.off(e,t)}},{create:function(e){return new s(e)}}}),Box.Application.addService("folder-tree",function(e){"use strict";function t(e,t){if(t=t||{},e in _&&t.includeAncestor)return _[e];var n="/index.php?rm=folder_tree_json&baseItem="+encodeURIComponent(e);return t.includeAncestor&&(n+="&includeAncestorsAndBase=true"),_[e]=b.send("GET",n).then(b.parseJSONResponse).catch(function(){delete _[e]}),_[e]}function n(e){var t=e.target;g.hasClass(t,c)&&(this.setSelected(m,!0),a.value="",g.removeClass(i,u),g.removeClass(o,d))}function r(e,t,r){r=r||{},i=g.query(".input-wrapper",e),o=g.query(".results-wrapper",e),a=g.query(".input-wrapper input",e),s=e;var c=this.events=new Box.EventTarget,d=this.elem=g.query(".tree-view",e)||e;this.startingTypedID=t;var p=this.treeView=y.create({allowSelect:r.allowSelect||!1,boundElem:d,onRequestData:function(e){return b.send("GET","/index.php?rm=folder_tree_json&baseItem="+encodeURIComponent(e)).then(b.parseJSONResponse)},idName:"typed_id"});this.setSelected(t,r.setFocus),p.events.on("click",function(e){c.fire("click",e.data)}),this.onclickHandler=n.bind(this),g.on(i,"click",this.onclickHandler),r.allowSelect&&p.events.on("select",function(e){c.fire("select",e.data)});var m=g.query("."+l,e);if(m)return this.quickSearchInstance=v.create(m,h),r.quickSearchResultOnClickHandler?void this.quickSearchInstance.events.on("select",r.quickSearchResultOnClickHandler):void this.quickSearchInstance.events.on("select",function(t){var n=t.data.getAttribute("data-item-typed-id");this.setSelected(n,!0),g.addClass(i,u);var r=g.query(".folder-tree-clear-search",e);r.setAttribute("data-type","clear-search"),g.removeClass(i,f)}.bind(this))}var i,o,a,s,l="quick-search-widget",c="folder-tree-clear-search",u="quick-search-folder-selected",d="has-results",f="has-focus",p="is-loading",m="d_0",h="folder_quick_search",g=e.getService("dom"),v=e.getService("quick-search"),y=e.getService("tree-view"),b=e.getService("xhr"),_={};return r.prototype.setSelected=function(e,n){var r=this;g.addClass(this.elem,p),t(e,{includeAncestor:!0}).then(function(t){r.updateFolderTreeWithSelectedItem(t,e,n)}).catch(function(){t(e).then(function(t){r.updateFolderTreeWithSelectedItem(t,e,n)})})},r.prototype.updateFolderTreeWithSelectedItem=function(e,t,n){if(this.treeView.setState(e.root),n?this.treeView.setFocusAndExpand(t):this.treeView.setExpand(t),this.treeView.setSelection(t,n),this.events.fire("load"),g.removeClass(this.elem,"is-loading"),t!==m){g.addClass(i,u);var r=g.query(".folder-tree-clear-search",s);r.setAttribute("data-type","clear-search"),g.removeClass(i,f)}},r.prototype.destroy=function(){this.quickSearchInstance&&this.quickSearchInstance.destroy(),g.off(i,"click",this.onclickHandler)},{create:function(e,t,n){return new r(e,t,n)}}}),Box.Application.addService("infinite-scroll",function(e){"use strict";function t(e){n.on(e,"scroll",function(e){if(r.length)for(var t=i.clientHeight,n=e.currentTarget||window,o=n.pageYOffset?n.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,a=n.innerHeight?n.innerHeight:(document.documentElement||document.body.parentNode||document.body).clientHeight,s=0;s<r.length;s++)r[s](t-(o+a))})}var n=e.getService("dom"),r=[],i=document.getElementById("content");return{listen:function(e,n){function i(e){a||e<=n&&(a=!0,o.fire("scrolled",function(){a=!1}))}t(e);var o=new Box.EventTarget,a=!1;return r.push(i),o.stop=function(){for(var e=0;e<r.length;e++)if(r[e]===i)return void r.splice(e,1)},o}}}),Box.Application.addService("inline-notice",function(e){"use strict";function t(e,t,n,r){this.type=e;var o=this.el=document.createElement("div");o.className="inline-alert inline-alert-visible inline-alert-"+this.type,o.setAttribute(i,"alert");var s=this.titleEl=document.createElement("span");s.className="inline-alert-title txt-bold";var l=this.bodyEl=document.createElement("div");l.className="inline-alert-body",n&&l.appendChild(a.createFragmentFromHtml(n)),r&&(s.textContent=r),o.appendChild(s),o.appendChild(l),t.insertBefore(o,t.firstChild)}var n="warning",r="error",i="role",o="inline-alert-visible",a=e.getService("dom");return t.prototype.destroy=function(){this.el.parentNode&&this.el.parentNode.removeChild(this.el)},t.prototype.show=function(){a.addClass(this.el,o)},t.prototype.hide=function(){a.removeClass(this.el,o)},t.prototype.updateTitle=function(e){this.titleEl.textContent=e},t.prototype.updateContent=function(e){var t=a.createFragmentFromHtml(e);this.bodyEl.firstChild?this.bodyEl.replaceChild(t,this.bodyEl.firstChild):this.bodyEl.appendChild(t)},{warn:function(e,t,r){return this.create(n,e,t,r)},error:function(e,t,n){return this.create(r,e,t,n)},create:function(e,n,r,i){return new t(e,n,r,i)}}}),Box.Application.addService("item-actions",function(e){"use strict";function t(e){switch(e[0]){case"d":return"folder";case"f":return"file";case"l":return"web_link";default:return""}}function n(e){switch(e[0]){case"d":return"folderdescriptionsetsuccess";case"f":return"filedescriptionsetsuccess";case"l":return"linkdescriptionsetsuccess";default:return""}}var r="access_stats_popup",i="collab_invite_popup",o="edit_weblink_popup",a="file_properties_popup",s="folder_embed_settings_popup",l="share_link_popup",c="item_share_settings",u="item_expiration_popup",d="get_lock_popup",f="get_request_unlock_popup",p="get_unlock_popup",m="move_copy_popup",h="multi_item_share",g="update_tags_popup",v="upload_widget_popup",y="version_history",b="get_watermarking_popup",_=$t("Folder unsynced.","folder_successfully_unsynced"),w=$t("Folder failed to unsync.","folder_failed_to_unsync"),S=$t("Folder synced.","folder_successfully_synced"),k=$t("Folder failed to sync.","folder_failed_to_sync"),E="alreadyUnlocked";return{changeDescription:function(t,r){var i=e.getService("fileop-description");i.set(t,r).then(function(r){e.broadcast(n(t),{description:r.data.description,typedID:t})})},changeWeblinkUrl:function(t,n){var r=e.getService("fileop-edit-weblink-url");r.set(t,n)},openWithBoxEdit:function(t,n){var r=e.getService("box-edit-amsterdam");r.openFile(t,n)},folderEmbedSettings:function(t){var n=e.getService("popups-amsterdam");n.open(s,{resinName:"folderembedsettings",isPostRequest:!0,data:{itemTypedId:t}})},share:function(t){var n=e.getService("url"),r=e.getService("popups-amsterdam"),i=n.getGcmCompatibleRm(l);r.open(i,{isPostRequest:!0,resinName:"share",data:{itemTypedId:t}})},openSharedLinkSettingsPopup:function(t){var n=e.getService("url"),r=e.getService("popups-amsterdam"),i=n.getGcmCompatibleRm(c);r.open(i,{resinName:"sharedlinksettings",data:{itemTypedId:t}})},inviteCollab:function(t){var n=e.getService("popups-amsterdam");n.open(i,{resinName:"invitecollaborators",data:{itemTypedId:t}})},fileProperties:function(t){var n=e.getService("popups-amsterdam");n.open(a,{resinName:"fileproperties",data:{fileID:t.substr(2)}})},rename:function(t,n){var r=e.getService("fileop-rename");r.rename(t,n)},lock:function(t){var n=e.getService("popups-amsterdam");n.open(d,{resinName:"lockfile",data:{itemTypedID:t}})},requestUnlockPopup:function(t){var n=e.getService("popups-amsterdam");
n.open(f,{resinName:"requestunlockfile",data:{itemTypedID:t}})},unlock:function(t){var n=e.getService("fileop-lock"),r=e.getService("notifications-amsterdam");n.unlock(t).then(function(){var n=$t("File successfully unlocked.","file_unlock_success_msg");r.info(n),e.broadcast("fileunlockedsuccess",{itemTypedId:t})}).catch(function(n){var i=n.data;r.error(i.message),i.code===E&&e.broadcast("filealreadyunlocked",{itemTypedId:t})})},showUnlockPopup:function(t){var n=e.getService("popups-amsterdam");n.open(p,{resinName:"unlockfile",data:{itemTypedID:t}})},sync:function(t){var n=e.getService("fileop-sync"),r=e.getService("notifications-amsterdam");n.syncItem(t).then(function(){r.info(S),e.broadcast("syncsuccess",{itemTypedId:t})},function(){r.error(k)})},unsync:function(t){var n=e.getService("fileop-sync"),r=e.getService("notifications-amsterdam");n.unsyncItem(t).then(function(){r.info(_),e.broadcast("unsyncsuccess",{itemTypedId:t})},function(){r.error(w)})},setExpiration:function(n){var r=e.getService("popups-amsterdam");r.open(u,{resinName:"fileexpiration",data:{itemType:t(n),itemId:n.substr(2)}})},showAccessStatsPopup:function(t){var n=e.getService("popups-amsterdam");n.open(r,{resinName:"accessstats",data:{fileID:t.substr(2)}})},showVersionHistoryPopup:function(t){var n=e.getService("popups-amsterdam");n.open(y,{resinName:"versionhistory",data:{fileId:t.substring(2)}})},addToFavorites:function(t){var n=e.getService("fileop-favorites");n.add(t,!1)},removeFromFavorites:function(t){var n=e.getService("fileop-favorites");n.remove(t,!1)},editWeblink:function(t){var n=e.getService("popups-amsterdam");n.open(o,{resinName:"editweblink",data:{weblinkTypedID:t}})},createBox3dPackage:function(t,n,r,i){var o=e.getService("popups-amsterdam");o.open("box3d_create_package_popup",{data:{typedIDs:[t],fileVersionID:n,fileName:r,parentTypedID:i}})},showWatermarkingPopup:function(t){var n=e.getService("popups-amsterdam");n.open(b,{data:{itemTypedID:t}})},download:function(t,n){var r=e.getService("fileop-download"),i={};if(n=n||{},e.hasService("shared-context")){var o=e.getService("shared-context");o.addSharedParams(i),n.currentFolderTypedID&&o.isSharedFolderPage()&&(i.parentFolderID=n.currentFolderTypedID.substr(2))}n.vanityName?i.vanityName=n.vanityName:n.sharedName&&(i.sharedName=n.sharedName),r.download(t,i)},delete_:function(t,n){var r=e.getService("fileop-delete");r.delete_(t,n)},deleteForever:function(t){var n=e.getService("fileop-deletefromtrash");n.deleteItems(t).then(function(){var t=e.getService("nav");t.refresh()})},movecopy:function(t,n){var r=e.getService("popups-amsterdam");r.open(m,{resinName:"movecopy",data:{itemTypedIds:t,currentFolderTypedId:n},width:"520px"})},restore:function(t){var n=e.getService("fileop-restore");n.restoreItemsFromTrash(t).then(function(){var t=e.getService("nav");t.refresh()})},shareViaEmail:function(t,n){var r=e.getService("popups-amsterdam");r.open(h,{resinName:"shareviaemail",data:{itemTypedIDs:t.join(","),folderTypedID:n}})},showUpdateTagsPopup:function(t){var n=e.getService("popups-amsterdam");n.open(g,{resinName:"updatetags",data:{items:t}})},showUploadWidgetPopup:function(t,n){var r=e.getService("popups-amsterdam");r.open(v,{resinName:"uploadwidgetpopup",data:{itemTypedID:t,itemName:n}})}}}),Box.Application.addService("item-clipboard",function(e){"use strict";function t(){return Date.now()}function n(){E.removeItem(d)}function r(e,n,r){var i={};i[f]=e,i[p]=n,i[m]=r,i[h]=t()+c,E.setItem(d,JSON.stringify(i))}function i(){var e=JSON.parse(E.getItem(d)||null);return e?e[h]<t()?(n(),null):e:null}function o(e,t){var n={};n[g]=e,n[f]=t[f],n[p]=t[p],n[m]=t[m],n[g]=e,E.setItem(_,JSON.stringify(n)),C.fire(b,n)}function a(){k.addEventListener("storage",function(e){if(e.key===_){var t=JSON.parse(e.newValue||null);t&&C.fire(b,t)}})}function s(){var e="test";try{return E.setItem(e,e),E.removeItem(e),!0}catch(e){return!1}}function l(){x=s(),x&&a()}var c=36e5,u="Clipboard disabled. User may be in incognito mode.",d="itemClipboardData",f="operation",p="sourceFolderTypedID",m="itemTypedIDs",h="expirationTimestamp",g="destinationFolderTypedID",v="cut",y="copy",b="paste",_="itemClipboardPasteData",w=e.getService("promises"),S=e.getService("fileop-movecopy"),k=e.getGlobal("window"),E=e.getGlobal("localStorage"),C=new Box.EventTarget,x=!1;return l(),{on:function(e,t){C.on(e,t)},off:function(e,t){C.off(e,t)},isEnabled:function(){return x},copyToClipboard:function(e,t){return x?e&&0!==t.length?(r(y,e,t),w.createResolved()):w.createRejected("Nothing to copy"):w.createRejected(u)},cutToClipboard:function(e,t){return x?e&&0!==t.length?(r(v,e,t),w.createResolved()):w.createRejected("Nothing to cut"):w.createRejected(u)},pasteToFolder:function(e){if(!x)return w.createRejected(u);if(!e)return w.createRejected("No destination folder");var t=i();return t&&t[f]&&0!==t[m].length?t[f]===v?S.move(t[m],e,e,{sourceFolderTypedID:t[p]}).then(function(){o(e,t),n()}):S.copy(t[m],e,e).then(function(){o(e,t)}):w.createRejected("Nothing to paste")}}}),Box.Application.addService("keyboard-shortcuts",function(e){"use strict";function t(){I=[]}function n(){return I[I.length-1]}function r(e){for(var t=0;t<I.length;t++){var n=I[t];if(n.name===e)return n}return null}function i(e){var t=[];return e.sections.forEach(function(e){t=t.concat(e.shortcuts)}),t}function o(e){return e.split(" ").reduce(function(e,t,n){return t=t.split("+").map(function(e){return N[e]||e}),0===n?t.join(" + "):$t("%1 then %2","kb_shortcuts_key_combo_sequence_join",e,t.join(" + "))},"")}function a(){var t="other",r="",i={},a=[];n().sections.forEach(function(e){e.shortcuts.forEach(function(e){var n=e.type||t;Array.isArray(i[n])||(i[n]=[]),r=Array.isArray(e.key)?e.key:[e.key],r=r.map(o).join(" / "),i[n].push({key:r,description:e.description})})}),a=[],F.forEach(function(e){i.hasOwnProperty(e)&&a.push({type:e,label:R[e],shortcuts:i[e]})});var s={popupData:{categories:a}},l=e.getService("popups-amsterdam");l.open(k,{data:s,isPostRequest:!0})}function s(){x={"shift+?":a}}function l(e){e||(e="layer-"+A,A++);var t={name:e,sections:[]};return I.push(t),s(),t}function c(e){var t=E.getNearestUnbounded(e,"[data-keyboard-layer]");if(!t)return r(w);var n,i=t.getAttribute("data-keyboard-layer");if(""===i)n=l(),t.setAttribute("data-keyboard-layer",n.name);else if(n=r(i),!n)return l(i);return n}function u(e){return e.split(" ").map(function(e){var t=e.split("+"),n={},r=[];if(1===t.length)return e;var i=t.pop();if(t.forEach(function(e){n[e]=!0}),"alt"in n)throw new Error("The system does not support alt keys at this time, since it requires more complicated logic!");if(O.forEach(function(e){n.hasOwnProperty(e)&&r.push(e)}),r.length!==t.length)throw new Error("Attempted to register invalid key combo: "+e+". Valid modifiers are: ctrl, meta & shift");return r.push(i),r.join("+")}).join(" ")}function d(e){var t=e.toLowerCase(),n=D[t];return n||t}function f(e,t){return e.indexOf("shift")!==-1?P[t]||M[t]:M[t]}function p(e){e.forEach(function(e){var t=e.key,n=e.handler;"string"==typeof t&&(t=[t]),t.forEach(function(e){var t=u(e);x[t]=n})})}function m(e){e.forEach(function(e){var t=e.key;"string"==typeof t&&(t=[t]),t.forEach(function(e){var t=u(e);delete x[t]})})}function h(){var e=n();s();var t=i(e);p(t)}function g(e){if(e.name!==w){var t=n(),r=I.indexOf(e);I.splice(r,1),e===t&&h()}}function v(e,t){var r=!1;e.sections.forEach(function(e){e.name===t.name&&(e.shortcuts=t.shortcuts,r=!0)}),r||e.sections.push(t);var i=n();if(e===i){var o=t.shortcuts;p(o)}}function y(e,t){var r=n();e.sections=e.sections.filter(function(n){if(n.name===t){if(e===r){var i=n.shortcuts;m(i)}return!1}return!0}),e.sections.length||g(e)}function b(e){if(!T){var t=[],n=e.target;e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),e.shiftKey&&t.push("shift");var r=e.key?d(e.key):f(t,e.keyCode);if(O.indexOf(r)===-1){var i=n.hasAttribute("contenteditable")||"INPUT"===n.nodeName||"TEXTAREA"===n.nodeName,o=n.hasAttribute("data-keyboard-layer"),a="?"===r,s="esc"===r,l=i&&!(o&&!a||s);if(!l){t.push(r);var c=t.join("+");if(_&&clearTimeout(_),C.length){var u=C.join(" "),p=Object.keys(x).some(function(e){return 0===e.indexOf(u+" ")});p||(C=[])}C.push(c),_=setTimeout(function(){C=[]},S),c=C.join(" "),x.hasOwnProperty(c)&&x[c](e,c)}}}}var _,w="base-layer",S=1e3,k="get_keyboard_shortcuts_popup",E=e.getService("dom"),C=[],x={},T=!1,A=0,I=[],O=["alt","ctrl","meta","shift"],D={" ":"space",control:"ctrl",arrowleft:"left",arrowright:"right",arrowup:"up",arrowdown:"down",escape:"esc","+":"plus","-":"minus"},M={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"caps",27:"esc",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"meta",93:"meta",186:";",187:"=",188:",",189:"minus",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},P={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",186:":",187:"plus",188:"<",189:"_",190:">",191:"?",219:"{",220:"|",221:"}",222:'"'},N={backspace:"⌫",down:"↓",left:"←",meta:"⌘",right:"→",up:"↑",enter:$t("Enter","kb_shortcuts_word_transformation_enter"),spacebar:$t("Spacebar","kb_shortcuts_word_transformation_spacebar"),shift:$t("Shift","kb_shortcuts_word_transformation_shift"),ctrl:$t("Ctrl","kb_shortcuts_word_transformation_ctrl"),alt:$t("Alt","kb_shortcuts_word_transformation_alt"),esc:$t("Esc","kb_shortcuts_word_transformation_esc"),plus:$t("Plus","kb_shortcuts_word_transformation_plus"),minus:$t("Minus","kb_shortcuts_word_transformation_minus")},R={"item-actions":$t("Item Actions","kb_shortcuts_category_item_actions"),navigation:$t("Navigation","kb_shortcuts_category_navigation"),other:$t("Other","kb_shortcuts_category_other"),preview:$t("Preview","kb_shortcuts_category_preview"),selection:$t("Item Selection","kb_shortcuts_category_selection")},F=["item-actions","selection","navigation","preview","other"],B={init:function(){l(w),E.on(document,"keydown",b)},register:function(e,t){var n=c(t);v(n,e)},deregister:function(e,t){var n=c(t);y(n,e)},getActiveShortcuts:function(){var e=n();return i(e)},pause:function(){T=!0},unpause:function(){T=!1},reset:function(){t(),l(w)},openHelpPopup:a,destroy:function(){t(),s(),E.off(document,"keydown",b)}};return B.init(),B}),Box.Application.addService("logger",function(e){"use strict";function t(){var t=e.getGlobal("XMLHttpRequest"),n=e.getGlobal("ActiveXObject");return t?new t:n?new n("Microsoft.XMLHTTP"):null}function n(e,n,r){var i=l+"?"+$.param(e),o=t();null!==o&&("function"==typeof n&&(o.onreadystatechange=function(){4===o.readyState&&(200!==o.status&&204!==o.status&&1223!==o.status||n())}),o.open("GET",i,!r),o.send())}function r(e,n){var r=t();null!==r&&(r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.send("data="+JSON.stringify(n)))}function i(e){var t=f.getItem(d)||[];t.push(e),f.setItem(d,t)}function o(){var e=f.getItem(d);f.removeItem(d),clearTimeout(s),r(c,e),s=null}function a(t,n,r){var i=[];return i.push("experiment="+encodeURIComponent(t)),i.push("event="+encodeURIComponent(n)),r&&i.push("additional_params="+encodeURIComponent(JSON.stringify(r))),i.push("request_token="+encodeURIComponent(e.getGlobal("request_token"))),i.join("&")}var s,l="/gen204",c="/index.php?rm=box_gen204_batch_record",u=5e3,d="LOGGER_SERVICE_QUEUE",f=e.getService("session-store");return{sendLog:function(e,t,r,i,o,a){r=r||{},o=o||{};var s={category:e,event_type:t,keys_and_values:r,runmode_options:o};n(s,i,a)},sendBatchLog:function(e,t,n,r){n.client_ds=Math.floor((new Date).getTime()/1e3),i({event_type:t,category:e,events:[n]}),r?o():s||(s=setTimeout(o,u))},sendMetric:function(e,t){t=t||{};var r={category:"metrics",event_type:"metrics",keysAndValues:{name:e,value:"+1",type:"counter",tags:t}};n(r)},sendSplitTestLog:function(e,t,r){r=r||{},r.experiment=e;var i={category:"experiment_data",event_type:t,keys_and_values:r};n(i)},sendSplitTestConversion:function(e,n,r){var i=t();if(null!==i){var o=a(e,n,r);i.open("POST","/index.php?rm=experiment_convert",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send(o)}}}}),Box.Application.addService("loading",function(e){"use strict";function t(){this.element=document.createElement("div"),this.element.setAttribute("role","alert"),this.element.setAttribute("aria-label",c),this.element.className="loading-wrapper is-loading";var e=s.getTemplateFragment("spinner-light-large");this.element.appendChild(e)}function n(){l&&l.hideAll()}function r(){return new t}function i(){a=r(),a.show(),a.focus(),n()}function o(){a&&a.hide(),n()}var a,s=e.getService("templates"),l=e.getService("tooltips-amsterdam"),c=$t("Loading","loading_generic_text");return t.prototype.show=function(){document.body.appendChild(this.element)},t.prototype.hide=function(){this.element.parentNode&&(e.stopAll(this.element),this.element.parentNode.removeChild(this.element))},t.prototype.focus=function(){this.element.focus()},{create:r,show:i,hide:o}}),Box.Application.addService("select-menu",function(e){"use strict";function t(e){return f.getNearest(e,"."+s)}function n(e){return f.queryAll("."+l+"."+u,e)}function r(e){var t=e.getAttribute("data-input-name"),r=n(e),i=f.query('input[name="'+t+'"]',e);i.value=r.map(function(e){return e.getAttribute("data-value")}).join(",")}function i(e){var t=n(e),r=f.query('button[data-type="'+d+'"] span',e),i=t.map(function(e){return e.innerText}).join(", ");i?f.setText(r,i):f.setText(r,r.getAttribute("data-default-text"))}function o(e){var r=t(e),i=f.query("."+c,r);f.hasClass(e,u)?(f.removeClass(e,u),n(r).length||f.addClass(i,u)):(f.removeClass(i,u),f.addClass(e,u))}function a(e){var r=t(e);n(r).forEach(function(e){f.removeClass(e,u)}),f.addClass(e,u)}var s="menu-wrapper",l="menu-option",c="menu-multiselect-option-deselect",u="is-selected",d="menu-toggle-button",f=e.getService("dom");return{isMultiSelectEvent:function(e){var n=t(e);return n&&n.hasAttribute("data-multi-select")},isSingleSelectEvent:function(e){var n=t(e);return n&&n.hasAttribute("data-single-select")},selectOption:function(e){if(f.hasClass(e,l)){a(e);var n=t(e);r(n),i(n)}},toggleOption:function(e){if(f.hasClass(e,l)){f.hasClass(e,c)?a(e):o(e);var n=t(e);r(n),i(n)}}}}),Box.Application.addService("menu-toggle-eu",function(e){"use strict";function t(e){m&&m.events.fire(e)}function n(){if(m){var e=m.menuEl,n=c.getNearestUnbounded(e,".menu-wrapper"),r=e.previousElementSibling;l.clearState(r,"expanded"),l.hide(e),c.removeClass(n,p),setTimeout(function(){e.style.display="",e.style.left="",e.style.top="",e.style.right=""},100),t("closed"),m=null}}function r(e,r){var i=e.nextElementSibling;if(i){for(l.show(i),l.setState(e,"expanded");"BUTTON"===i.nodeName&&!c.isVisible(i);)if(i=i.nextSibling,!i)return;var o=c.getNearestUnbounded(i,".menu-wrapper");if(c.hasClass(o,p))return void n();m&&n(),m=r,m.menuEl=i,o=c.getNearestUnbounded(i,".menu-wrapper"),u.wrap(o),i.style.display="block";var a=d.repositionPopout(i,e);a&&(i.style.left="auto",i.style.top=a.top,i.style.right=a.right),setTimeout(function(){c.addClass(o,p)},100),t("opened")}}function i(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===f)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===f)return t}}function o(e){var t=e.target||e.srcElement;return!!c.getNearestUnbounded(t,".menu")}function a(e){if(m){var r=i(e);if(r){var a=r.nextElementSibling;if(!a||a===m.menuEl)return}o(e)||(t("lostfocus"),n())}}function s(e){this.events=new Box.EventTarget,this.menuEl=null,this.shouldCloseMenuOnBlur="undefined"==typeof e||e,this.wrappedGlobalClickHandler=function(e){a(e)}}var l,c,u,d,f="menu-toggle-button",p="is-visible",m=null;return s.prototype={init:function(){l=e.getService("aria"),c=e.getService("dom"),d=e.getService("popout-reposition"),u=e.getService("focus"),this.shouldCloseMenuOnBlur&&c.on(document.body,"mousedown",this.wrappedGlobalClickHandler)},destroy:function(){this.shouldCloseMenuOnBlur&&c.off(document.body,"mousedown",this.wrappedGlobalClickHandler)},showMenu:function(e){r(e,this)},closeMenu:function(){n()},on:function(e,t){this.events.on(e,t)},off:function(e,t){this.events.off(e,t)}},{create:function(e){return new s(e)}}}),Box.Application.addService("menu-toggle",function(e){"use strict";function t(e){f&&f.events.fire(e)}function n(){if(f){var e=f.menuEl,n=l.getNearestUnbounded(e,".menu-wrapper");l.removeClass(n,d),setTimeout(function(){e.style.display=""},100),t("closed"),f=null}}function r(e,r){var i=e.nextElementSibling;if(i){for(;"BUTTON"===i.nodeName&&!l.isVisible(i);)if(i=i.nextSibling,!i)return;var o=l.getNearestUnbounded(i,".menu-wrapper");if(l.hasClass(o,d))return void n();f&&n(),f=r,f.menuEl=i,o=l.getNearestUnbounded(i,".menu-wrapper"),c.wrap(o),i.style.display="block",setTimeout(function(){l.addClass(o,d)},100),t("opened")}}function i(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===u)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===u)return t}}function o(e){var t=e.target||e.srcElement;return!!l.getNearestUnbounded(t,".menu")}function a(e){if(f){var r=i(e);if(r){var a=r.nextElementSibling;if(!a||a===f.menuEl)return}o(e)||(t("lostfocus"),n())}}function s(e){this.events=new Box.EventTarget,this.menuEl=null,this.shouldCloseMenuOnBlur="undefined"==typeof e||e,this.wrappedGlobalClickHandler=function(e){a(e)}}var l,c,u="menu-toggle-button",d="is-visible",f=null;return s.prototype={init:function(){l=e.getService("dom"),c=e.getService("focus"),this.shouldCloseMenuOnBlur&&l.on(document.body,"mousedown",this.wrappedGlobalClickHandler)},destroy:function(){this.shouldCloseMenuOnBlur&&l.off(document.body,"mousedown",this.wrappedGlobalClickHandler)},showMenu:function(e){r(e,this)},closeMenu:function(){n()},on:function(e,t){this.events.on(e,t)},off:function(e,t){this.events.off(e,t)}},{create:function(e){return new s(e)}}}),Box.Application.addService("menus-raw",function(e){"use strict";function t(){_&&_.isOpen()&&_.hide()}function n(e,t,n){var r=e-t,i=e+n,o=window.innerHeight;return i>o&&(r-=i-o),r}function r(e,t,n,r){var i=e-t,o=e+r;return o>n&&(i-=o-n),i}function i(e,t,n,r,i){var o=e-t,a=o+n;r-a<n?v.addClass(i,f):v.removeClass(i,f)}function o(e,t,n){e.style.top="0px";var r=v.getBoundingClientRect(e),i=v.getBoundingClientRect(t),o=v.getBoundingClientRect(n);r.bottom>o.bottom&&(e.style.top=i.height-r.height+"px")}function a(e){for(var t,n,r={},i=e.attributes,o=0,a=i.length;o<a;o++)t=i[o].name,n=i[o].value,0===t.indexOf("data-menu-data")&&(r[t.substr(15)]=n);return r}function s(e){this.focusHandlers=[],this.menuEl=e,this.menuWrapperEl=v.getNearest(this.menuEl,".menu-wrapper"),this.submenuHasKeyboardFocus=!1;var t=this.eventTarget=new Box.EventTarget;this.fire=function(){t.fire.apply(t,arguments)},this.on=function(){t.on.apply(t,arguments)}}var l="is-visible",c="is-loading",u=".submenu",d="has-visible-submenu",f="has-left-aligned-submenu",p="is-right-aligned",m=0,h=0,g=e.getGlobal("document"),v=e.getService("dom"),y=e.getService("aria"),b=e.getService("keyboard-shortcuts");v.on(window,"mousemove",function(e){m=e.clientX,h=e.clientY});var _=null;return v.on(g.body,"mousedown",function(e){var n=e.target;v.getNearest(n,"[aria-haspopup]")||v.getNearest(n,".menu")||t()}),s.prototype={init:function(){v.on(this.menuEl,"click",function(e){var t=v.getNearest(e.target,"[data-menu-event]");if(t){var n=t.getAttribute("data-menu-event");n&&(e.preventDefault(),this.fire("selected",{action:n,data:a(t)}),this.hide())}}.bind(this));var e=v.queryAll("[data-has-submenu]",this.menuEl);v.addClass(e,"with-submenu-arrow"),v.on(e,"mouseover",function(e){this.showSubmenuForElement(e.currentTarget)}.bind(this)),v.on(e,"mouseout",function(e){this.hideSubmenuForElement(e.currentTarget)}.bind(this));var t=v.queryAll("[data-has-submenu] button",this.menuEl);v.on(t,"focus",function(e){this.submenuHasKeyboardFocus||this.showSubmenuForElement(e.currentTarget.parentNode)}.bind(this)),v.on(t,"blur",function(e){this.submenuHasKeyboardFocus||this.hideSubmenuForElement(e.currentTarget.parentNode)}.bind(this))},showSubmenuForElement:function(e){var t=v.query(u,e);t&&(v.hasClass(e,d)||v.addClass(e,d),o(t,e,this.menuEl))},hideSubmenuForElement:function(e){v.removeClass(e,d)},destroy:function(){this.hide(),_===this&&(_=null)},show:function(e,t){var o=!(e&&t);e=e||m,t=t||h,_&&_.hide();var a=v.getNearest(this.menuEl,".file-list-body"),s=v.getNearest(this.menuEl,".tbl-list-item"),u=v.getBoundingClientRect(a),d=v.getBoundingClientRect(s);v.addClass(this.menuEl,c);var f=v.getBoundingClientRect(this.menuEl);v.removeClass(this.menuEl,c),y.show(this.menuEl);var g,b=n(t,d.top,f.height);o?(v.removeClass(this.menuEl,p),g=r(e,d.left,u.right,f.width),this.menuEl.style.left=g+"px",this.menuEl.style.right="auto"):(v.addClass(this.menuEl,p),g=d.right-e,this.menuEl.style.left="auto",this.menuEl.style.right=g+"px"),this.menuEl.style.top=b+"px",this.menuEl.style.display="block",setTimeout(function(){v.addClass(this.menuWrapperEl,l),this.registerKeyboardShortcuts(),this.focusOuterMenu()}.bind(this),0),_=this,i(e,u.left,f.width,u.width,this.menuEl)},deregisterKeyboardShortcuts:function(){b.deregister("raw-menu",this.menuEl)},registerKeyboardShortcuts:function(){b.register({name:"raw-menu",shortcuts:[{key:"esc",handler:this.escKeyHandler.bind(this)},{key:"tab",handler:this.tabKeyHandler.bind(this)},{key:"shift+tab",handler:this.shifttabKeyHandler.bind(this)},{key:"enter",handler:this.enterKeyHandler.bind(this)},{key:"space",handler:this.spaceKeyHandler.bind(this)},{key:"left",handler:this.leftKeyHandler.bind(this)},{key:"right",handler:this.rightKeyHandler.bind(this)},{key:"up",handler:this.upKeyHandler.bind(this)},{key:"down",handler:this.downKeyHandler.bind(this)}]},this.menuEl)},escKeyHandler:function(){this.submenuHasKeyboardFocus?this.moveFocusOutOfSubmenu():t()},enterKeyHandler:function(e){e.preventDefault(),this.focusedClickableEl&&this.focusedClickableEl.click()},spaceKeyHandler:function(e){e.preventDefault(),this.focusedClickableEl&&this.focusedClickableEl.click()},upKeyHandler:function(e){e.preventDefault(),this.moveFocusBackwardInMenu()},downKeyHandler:function(e){e.preventDefault(),this.moveFocusForwardInMenu()},rightKeyHandler:function(){v.hasClass(this.menuEl,f)?this.moveFocusOutOfSubmenu():this.moveFocusIntoSubmenu()},leftKeyHandler:function(){v.hasClass(this.menuEl,f)?this.moveFocusIntoSubmenu():this.moveFocusOutOfSubmenu()},moveFocusIntoSubmenu:function(){if(!this.submenuHasKeyboardFocus){var e=v.query(".submenu li",this.activeLi);e&&(this.submenuHasKeyboardFocus=!0,this.activeLi=e,this.focusOnClickableInsideElement(this.activeLi))}},moveFocusOutOfSubmenu:function(){this.submenuHasKeyboardFocus&&(this.submenuHasKeyboardFocus=!1,this.activeLi=v.getNearest(this.activeLi,"li[data-has-submenu]"),this.focusOnClickableInsideElement(this.activeLi))},moveFocusForwardInMenu:function(){this.activeLi?this.activeLi.nextElementSibling?this.activeLi=this.activeLi.nextElementSibling:this.activeLi=this.activeLi.parentNode.firstElementChild:this.activeLi=v.query("li",this.menuEl),this.focusOnClickableInsideElement(this.activeLi)||this.moveFocusForwardInMenu()},moveFocusBackwardInMenu:function(){if(this.activeLi)this.activeLi===this.activeLi.parentNode.firstElementChild?this.activeLi=this.activeLi.parentNode.lastElementChild:this.activeLi=this.activeLi.previousElementSibling;else{var e=v.queryAll("li:not(.menu-divider)",this.menuEl);this.activeLi=e[e.length-1]}this.focusOnClickableInsideElement(this.activeLi)||this.moveFocusBackwardInMenu()},tabKeyHandler:function(e){e.preventDefault(),this.moveFocusForwardInMenu()},shifttabKeyHandler:function(e){e.preventDefault(),this.moveFocusBackwardInMenu()},hide:function(){_===this&&(_=null),v.removeClass(this.menuWrapperEl,l),this.deregisterKeyboardShortcuts(),y.hide(this.menuEl)},isOpen:function(){return v.hasClass(this.menuWrapperEl,l)},focusOuterMenu:function(){this.menuEl.setAttribute("tabindex",-1),this.menuEl.focus(),this.activeLi=void 0},focusOnClickableInsideElement:function(e){return!!(e&&(this.focusedClickableEl=v.query("a, button",e),this.focusedClickableEl&&v.isVisible(this.focusedClickableEl)))&&(this.focusedClickableEl.focus(),!0)}},{create:function(e){return new s(e)},close:t}}),Box.Application.addService("metadata-store",function(){"use strict";function e(e){return"/"+e.replace(/~/g,"~0").replace(/\//g,"~1")}function t(t,n,r){if(n===r)return void(this.fields.hasOwnProperty(t)&&delete this.fields[t]);var i=e(t);this.fields[t]=[{op:"test",path:i,value:r},{op:"replace",path:i,value:n}]}function n(e){this.fields={},e===i&&(this.setField=t.bind(this))}function r(){this.templates={}}var i="properties";return n.prototype={setField:function(t,n,r){if(n===r)return void(this.fields.hasOwnProperty(t)&&delete this.fields[t]);var i=e(t);""!==n&&""===r?this.fields[t]=[{op:"add",path:i,value:n}]:""!==n&&""!==r?this.fields[t]=[{op:"test",path:i,value:r},{op:"replace",path:i,value:n}]:this.fields[t]=[{op:"test",path:i,value:r},{op:"remove",path:i}]},getPatches:function(){var e=[];return Object.keys(this.fields).forEach(function(t){this.fields[t].forEach(function(t){e.push(t)})},this),e},isEmpty:function(){return!Object.keys(this.fields).length}},r.prototype={_createTemplateStore:function(e){return new n(e)},storeField:function(e,t,n,r){this.templates.hasOwnProperty(e)||(this.templates[e]=this._createTemplateStore(e)),this.templates[e].setField(t,n,r),this.templates[e].isEmpty()&&delete this.templates[e]},removeTemplate:function(e){this.templates.hasOwnProperty(e)&&delete this.templates[e]},getTemplatePatches:function(){var e={};return Object.getOwnPropertyNames(this.templates).forEach(function(t){var n=this.templates[t].getPatches();e[t]=n},this),JSON.stringify(e)},isEmpty:function(){return!Object.keys(this.templates).length}},{create:function(){return new r}}}),Box.Application.addService("nav",function(e){"use strict";function t(){var e=y.getItem(d);return e?JSON.parse(e):null}function n(e,n){this.toState={url:e,data:n},this.fromState=t(),this.continueNavigation=!0}function r(e,t){if(!e)throw new TypeError("Invalid URL provided for Ajax navigation.");var r=u._getRelativeURL(e);return h.create(function(e){var i=new n(r,t),o=b.beforeStateChange.map(function(e){return e(i)});h.all(o).then(function(){i.continueNavigation&&e(i.toState)})})}function i(e){v.href=e}function o(e){if(!e)return null;for(var t=b.intercept,n=e.split("?")[0],r=0,i=t.length;r<i;r++)if(t[r].regex.test(n))return t[r];return null}function a(){var e=g.getState()||{},t={url:e.hash?e.hash.replace(/[?&]_suid=\d+/,""):v.pathname+v.search,data:e.data?e.data.data:null};return t.url=t.url.replace(/\?$/,""),t.title=e.title||p.title,t}function s(){y.setItem(d,JSON.stringify(a()))}function l(){var e=a();g.replaceState(e,e.title,e.url)}function c(t){s(),e.broadcast("navigationend",t)}var u,d="nav:state",f=e.getGlobal("$"),p=e.getGlobal("document"),m=e.getService("dom-fragment"),h=e.getService("promises"),g=e.getGlobal("History"),v=e.getGlobal("location"),y=e.getService("session-store"),b={intercept:[],beforeStateChange:[]},_=!1;return n.prototype.updateState=function(e,t){e&&(this.toState.url=e),t&&(this.toState.data=t)},n.prototype.stopNavigation=function(){this.continueNavigation=!1},u={registerBeforeStateChange:function(e){var t=b.beforeStateChange,n=t.some(function(t){return t===e});if(n)throw new TypeError("beforeStateChange handler already registered: "+e);t.push(e)},unregisterBeforeStateChange:function(e){for(var t=b.beforeStateChange,n=0,r=t.length;n<r;n++)t[n]===e&&t.splice(n,1)},_coreNavigate:function(t,n){var r=t.url,a=o(r),s=n.url,l=o(s),u=!0,d={from:n,to:t};e.broadcast("navigationstart",d),l&&l.exit&&(u=l.exit(t,n)),a&&a.enter&&(u=a.enter(t,n)&&u),u?f.ajax({method:"get",url:r,headers:{"X-Box-Client-Name":"amsterdam","X-Box-Client-Version":"1.0.0"},dataFilter:function(e){return e}}).done(function(e,t,n){m.update(n.responseText),p.body.scrollTop=0,p.documentElement.scrollTop=0,c(d)}).fail(function(){i(r)}):c(d)},_getRelativeURL:function(e){"?"===e.charAt(0)&&(e=v.pathname+e);var t=p.createElement("a");t.href=e;var n="/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname;return n+t.search},init:function(){_||(l(),g.Adapter.bind(window,"statechange",function(){var e=g.getState(),n=e.data,r=t();this._coreNavigate(n,r)}.bind(this)),s(),_=!0)},destroy:function(){f(window).unbind("statechange"),_=!1},getState:function(){var e=g.getState();return e&&e.data?e.data.data:null},intercept:function(t,n){n.enter||n.exit||e.reportError(new TypeError("Second argument missing enter and exit methods.")),b.intercept.push({regex:t,enter:n.enter,exit:n.exit})},removeInterceptor:function(e){b.intercept=b.intercept.filter(function(t){return t.regex!==e})},navigate:function(e,t){r(e,t).then(function(e){g.pushState(e,p.title,e.url)})},redirect:function(e){i(e)},replace:function(e,t){r(e,t).then(function(e){g.replaceState(e,p.title,e.url)})},refresh:function(){var e=t();this._coreNavigate(e,e)},reload:function(e){v.reload(e)},navigateOrRefresh:function(e,n){var r=t();r&&r.url===e?this._coreNavigate(r,r):this.navigate(e,n)}}}),Box.Application.addService("notifications-amsterdam",function(e){"use strict";function t(){return u?u:(u=m.createElement("div"),u.className="notifications-wrapper",m.body.appendChild(u),u)}function n(e,t,n){this.type=e,this.title=t,this.buttons=n,this.uniqueID="notification_"+(new Date).getTime(),this.shown=!1,this.elem=null,this.promise=null}var r="info",i="warn",o="error",a="default",s=27,l=4e3,c={};c[r]="notification-info",c[i]="notification-warning",c[o]="notification-error",c[a]="notification-default";var u,d=e.getService("dom"),f=e.getService("promises"),p=e.getService("templates"),m=e.getGlobal("document"),h=0,g=[];return n.prototype.show=function(e){if(this.shown)return this.promise;this.shown=!0;var n=this.elem=m.createElement("div");["notification","is-hidden",this.type||""].forEach(function(e){d.addClass(n,e)}),n.setAttribute("role","alertdialog"),n.setAttribute("aria-labeledby",this.uniqueID+"_label");var r=p.getTemplateFragment(c[this.type]);r&&n.appendChild(r);var i=m.createElement("span");i.id=this.uniqueID+"_label",d.setText(i,this.title),n.appendChild(i);var o=function(){this.hide()}.bind(this);return this.promise=f.create(function(r,i){this.buttons&&this.buttons.forEach(function(e,t){var i=m.createElement("button");i.className="btn",i.setAttribute("data-button-index",t),d.setText(i,e),n.appendChild(i),n.className+=" has-btn",d.on(i,"click",r)});var o=m.createElement("button");o.className="close-btn",o.setAttribute("aria-label",$t("Dismiss this alert","notification_close_label")),d.setHTML(o,"&#10005;"),o.title=$t("Close","notification_close"),n.appendChild(o),d.on(o,"click",i),t().appendChild(n),setTimeout(function(){d.removeClass(n,"is-hidden"),h++},100),e!==-1&&setTimeout(i,e)}.bind(this)),this.promise.then(o,o),d.on(m.body,"keydown",function(e){e.which===s&&this.hide()}.bind(this)),this.promise},n.prototype.hide=function(){this.shown&&(d.addClass(this.elem,"is-hidden"),setTimeout(function(){this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem),h--}.bind(this),250))},{info:function(e,t){return this._show(r,e,t)},confirm:function(e,t){return this.info(e,t)},default:function(e,t){return this._show(a,e,t)},warn:function(e,t){return this._show(i,e,t)},error:function(e,t){return t=t||{},t.duration=t.duration||-1,this._show(o,e,t)},create:function(e,t,r){var i=new n(e,t,r);return this.addToNotificationsArray(i),i},getNotificationsArray:function(){return g},addToNotificationsArray:function(e){g.push(e)},hideAll:function(){this.getNotificationsArray().forEach(function(e){
e.hide()}),g=[]},_show:function(e,t,n){n=n||{},n.duration=n.duration||l,n.buttonText&&"string"==typeof n.buttonText&&(n.buttonText=[n.buttonText]);var r=this.create(e,t,n.buttonText||null),i=r.show(n.duration);return n.clickHandler=n.clickHandler||function(){},n.hideHandler=n.hideHandler||function(){},n.onhide=n.onhide||function(){},i.then(n.clickHandler,n.hideHandler),i.then(null,n.onhide),i}}}),Box.Application.addService("overlay",function(e){"use strict";function t(t){var n=e.getService("dom"),r=document.createElement("div");return n.addClass(r,"overlay"),n.addClass(r,"hidden"),n.addClass(r,t),document.body.appendChild(r),r}function n(e,n){if("string"==typeof e)throw new Error("HTML strings not allowed for Overlays - use an HTMLElement or DocumentFragment instead.");this.element=e,this.initialized=!1,this.overlay=t(n.className)}var r=null;return n.prototype={_open:function(t,n,i,o){var a=e.getService("dom");i=i||0,o=o||0,r&&r.close(),r=this,this.initialized?e.startAll(this.overlay):(this.initialized=!0,a.setHTML(this.overlay,this.element));var s={of:t,collision:"none"};"below"===n?(s.my="center top",s.at="center+"+i+" bottom+"+o):"left"===n&&(s.my="right center",s.at="left+"+i+" center+"+o),a.removeClass(this.overlay,"hidden"),$(this.overlay).position(s),this.positionParams=$.extend({},s)},openBelow:function(e,t,n){this._open(e,"below",t,n)},openToLeft:function(e,t,n){this._open(e,"left",t,n)},freezePosition:function(e){this.overlay.style.position="fixed",this.overlay.style.top=e+"px"},unfreezePosition:function(){this.overlay.style.position="absolute",$(this.overlay).position(this.positionParams)},focusFirst:function(e){$(this.overlay).find(e).first().focus()},isOpen:function(){var t=e.getService("dom");return!t.hasClass(this.overlay,"hidden")},close:function(){if(r===this&&(r=null),this.isOpen()){var t=e.getService("dom");e.stopAll(this.overlay),t.addClass(this.overlay,"hidden")}},destroy:function(){r===this&&(r=null),this.overlay.parentNode.removeChild(this.overlay)}},{create:function(e,t){return new n(e,t||{})},close:function(){r&&r.close()}}}),Box.Application.addService("page-events",function(e){"use strict";function t(){var e;n=new Promise(function(t){e=t}),o.readyState===r?setTimeout(function(){e()},0):i.addEventListener("load",function(){setTimeout(function(){e()},0)})}var n,r="complete",i=e.getGlobal("window"),o=e.getGlobal("document");return t(),{getAfterPageLoadPromise:function(){return n}}}),Box.Application.addService("page-scroll",function(e){"use strict";var t=e.getGlobal("document"),n=e.getGlobal("window");return{scrollTo:function(e){t.body.scrollTop=e,t.documentElement.scrollTop=e},getScrollTop:function(){return t.documentElement&&t.documentElement.scrollTop||t.body.scrollTop},incrementScroll:function(e){this.scrollTo(this.getScrollTop()+e)},scrollToBottom:function(e){this.scrollTo(e-n.innerHeight)},isScrolling:function(){return this.getScrollTop()>0}}}),Box.Application.addService("pill-selector",function(e){"use strict";function t(e,t){var n;for(n=0;n<e.length;n++)if(e[n].id===t)return n;return-1}function n(e,t,n){n=n||{},this.originalInput=e,this.dataProviderMethod=t,this.wrapperElement=null,this.inputElement=null,this.inputWrapperElement=null,this.inputWrapperElementHeight=0,this.showPlaceholderIfResultEmpty=n.showPlaceholderIfResultEmpty||!1,this.pills=[],this.highlightedPill=null,$.extend(this,new Box.EventTarget)}function r(e,t){e&&t&&(t.placeholder=e.getAttribute("data-placeholder")||"")}function i(e){return function(t,n){switch(n){case"backspace":e.highlightedPill?e.deleteHighlightedPill():e.isCursorAtBeginning()&&e.highlightLastPill();break;case"left":e.highlightedPill?e.movePillHighlightLeft():e.isCursorAtBeginning()&&e.highlightLastPill();break;case"right":e.highlightedPill&&e.movePillHighlightRight()}}}var o=e.getService("dom"),a=e.getService("promises"),s=e.getService("array-utils"),l=e.getService("contact-selector-dropdown"),c=e.getService("strings"),u=e.getService("tooltips-amsterdam"),d=e.getService("keyboard-shortcuts"),f=!1,p="input-has-focus",m="pill-selector-input-wrapper",h="pill-selector-input",g="pill",v="pill-highlighted",y="pill-option-has-focus",b="pill-remover",_="pill-selector",w="is-invalid",S="hidden",k=$t("Remove","pill_selector_remove_pill_label");return n.prototype.init=function(e){this.wrapElement(),this.bindEvents(),r(this.originalInput,this.inputElement),e&&e.length&&this.insertArrayOfPills(e)},n.prototype.destroy=function(){o.removeClass(this.originalInput,S),this.wrapperElement.parentNode.removeChild(this.wrapperElement)},n.prototype.wrapElement=function(){var e=this.wrapperElement=document.createElement("div");e.className=_;var t=this.inputWrapperElement=document.createElement("div");t.className=m;var n=this.inputElement=document.createElement("input");n.type="text",n.className=h+" "+this.originalInput.className,n.setAttribute("autocomplete","off"),t.appendChild(n),e.appendChild(t),this.selectorDropdownWidget=l.create(t),this.originalInput.parentNode.insertBefore(e,this.originalInput),this.inputElement.setAttribute("data-keyboard-layer","pill-selector"),o.addClass(this.originalInput,S)},n.prototype.bindEvents=function(){var e=this;o.on(this.inputElement,"focus",function(){e.removeAllErrors(),o.addClass(e.inputWrapperElement,p),e.inputWrapperElementClientHeight=o.getBoundingClientRect(e.inputWrapperElement).height,d.register({name:"pill-selector",shortcuts:[{key:["backspace","right","left"],description:$t("Edit pill selection","kb_shortcuts_pill_selector_nav_delete_pills"),handler:i(e)}]},e.inputElement)}),o.on(this.inputElement,"blur",function(){f?(e.inputElement.focus(),f=!1):(e.removePillHighlight(),e.selectorDropdownWidget.setItems([]),o.removeClass(e.inputWrapperElement,p),d.deregister("pill-selector",e.inputElement))}),o.on(this.inputElement,"keyup",function(t){if(37!==t.keyCode&&38!==t.keyCode&&39!==t.keyCode&&40!==t.keyCode){var n=e.inputElement.value;if(!n)return void e.clearResults();e.removePillHighlight(),e.search(n)}}),o.on(this.wrapperElement,"click",function(t){var n=t.target||t.srcElement;if(o.hasClass(n,b)){var r=o.getNearest(n,"."+g),i=r.getAttribute("data-id");r.parentNode.removeChild(r),e.inputElement.focus(),e.clearResults(),e.removePillById(i),t.preventDefault(),t.stopPropagation()}}),o.on(this.wrapperElement,"mousedown",function(t){var n=t.target||t.srcElement;o.hasClass(n,m)?f=!1:o.hasClass(n,y)?(e.createPillBeforeInput(n),e.clearResults(),f=!0):o.hasClass(n,g)?(e.movePillHighlight(n),f=!0):(e.inputElement.focus(),f=!1,e.removePillHighlight()),t.stopPropagation()}),this.selectorDropdownWidget.on("dropdownitemselect",function(t){e.createPillBeforeInput(t.data),e.selectorDropdownWidget.setItems([])})},n.prototype.search=function(e){var t=this;if(t.showPlaceholderIfResultEmpty){var n=[{data:{email:"",id:e,type:"user"},id:e,text:e,email:""}];t.selectorDropdownWidget.setItems(n)}this.dataProviderMethod(e).then(function(e){var n=s.filter(e,function(e){return s.every(t.pills,function(t){return!(t.id===e.id||t.data&&e.data&&t.data.id===e.data.id)})});(n.length>0||!t.showPlaceholderIfResultEmpty)&&t.selectorDropdownWidget.setItems(n)}).catch(function(e){if(!e instanceof a.CancellationError)throw e})},n.prototype.insertArrayOfPills=function(e){e.forEach(function(e){this.createPillBeforeInput(e)},this)},n.prototype.createPillBeforeInput=function(e){if(t(this.pills,e.id)!==-1)return void(this.inputElement.value="");var n=document.createElement("span");o.addClass(n,b),o.setHTML(n,"&times;"),n.setAttribute("title",k),n.setAttribute("aria-label",k);var r=document.createElement("span");o.addClass(r,g),o.setText(r,e.text),r.setAttribute("data-id",e.id.toString()),r.appendChild(n),e.data&&"group"===e.data.type&&r.setAttribute("data-group",""),this.inputWrapperElement.insertBefore(r,this.inputElement),this.inputElement.value="",this.inputElement.placeholder="",this.pills.push(e),this.fire("updated"),this.calculateResize()},n.prototype.highlightLastPill=function(){var e=o.queryAll("."+g,this.wrapperElement),t=e&&e[e.length-1];t&&(this.highlightedPill=t,o.addClass(t,v))},n.prototype.calculateResize=function(){var e=o.getBoundingClientRect(this.inputWrapperElement);this.inputWrapperElementClientHeight!==e.height&&(this.fire("resize"),this.inputWrapperElementClientHeight=e.height)},n.prototype.deletePills=function(e){e&&0!==e.length&&(e.forEach(function(e){var t=o.query('.pill[data-id="'+e+'"]',this.inputWrapperElement);t&&(this.inputWrapperElement.removeChild(t),this.removePillById(e))},this),0===this.getPills().length&&r(this.originalInput,this.inputElement),this.inputElement.select(0),this.calculateResize())},n.prototype.deleteHighlightedPill=function(){if(this.highlightedPill){var e=this.highlightedPill.getAttribute("data-id");e&&(this.deletePills([e]),this.highlightedPill=null)}},n.prototype.movePillHighlight=function(e){this.highlightedPill&&o.removeClass(this.highlightedPill,v),this.highlightedPill=e||this.highlightedPill,o.addClass(e,v)},n.prototype.movePillHighlightLeft=function(){var e=this.highlightedPill&&this.highlightedPill.previousSibling;e&&this.movePillHighlight(e)},n.prototype.movePillHighlightRight=function(){var e=this.highlightedPill&&this.highlightedPill.nextSibling;e&&o.hasClass(e,g)?this.movePillHighlight(e):this.removePillHighlight()},n.prototype.removePillHighlight=function(){this.highlightedPill&&o.removeClass(this.highlightedPill,v),this.highlightedPill=null},n.prototype.removePillById=function(e){this.pills.splice(t(this.pills,e),1),this.fire("updated")},n.prototype.clearResults=function(){this.selectorDropdownWidget.setItems([])},n.prototype.isCursorAtBeginning=function(){return!(this.inputElement.selectionStart||this.inputElement.selectionEnd)},n.prototype.getPills=function(){return this.pills},n.prototype.displayError=function(e,t){t=t||{},o.addClass(this.inputWrapperElement,"has-error"),this.inputWrapperElement.setAttribute("data-tooltip",""),t.tooltipPosition&&this.inputWrapperElement.setAttribute("data-tooltip-position",t.tooltipPosition),t.tooltipRelative&&this.inputWrapperElement.setAttribute("data-tooltip-relative",t.tooltipRelative),this.inputWrapperElement.setAttribute("data-tooltip-theme","error"),this.inputWrapperElement.setAttribute("aria-label",e),u.show(this.inputWrapperElement)},n.prototype.removeAllErrors=function(){o.hasClass(this.inputWrapperElement,"has-error")&&(o.removeClass(this.inputWrapperElement,"has-error"),u&&this.inputWrapperElement.hasAttribute("data-tooltip")&&u.hide(this.inputWrapperElement),this.inputWrapperElement.removeAttribute("data-tooltip"),this.inputWrapperElement.removeAttribute("data-tooltip-position"),this.inputWrapperElement.removeAttribute("data-tooltip-relative"),this.inputWrapperElement.removeAttribute("data-tooltip-theme"),this.inputWrapperElement.removeAttribute("aria-label"),this.inputWrapperElement.removeAttribute("data-hover"))},n.prototype.reset=function(){var e=o.queryAll("span[data-id]",this.inputWrapperElement);e.forEach(function(e){this.inputWrapperElement.removeChild(e)},this),this.pills=[],this.highlightedPill=null,this.inputElement.value="",this.selectorDropdownWidget.setItems([]),r(this.originalInput,this.inputElement)},n.prototype.createDataArrayFromString=function(e){var t=[],n=/[^\s[\<(]+@[^\s<>@,\/\\]+\.[^\s\<>,;)]+/gi,r=e.match(n);return r?r.reduce(function(e,t){var n=c.trim(t),r="";return n?(t.indexOf(":")>=0&&(n=t.split(":")[0],r=t.substr(t.indexOf(":")+1)),e.concat({id:n,text:r||n})):e},[]):t},n.prototype.validatePills=function(e,t){var n=!0;return this.pills.forEach(function(t){var r=o.query("."+g+'[data-id="'+t.id+'"]',this.inputWrapperElement);e(t)?(o.removeClass(r,w),r.removeAttribute("aria-invalid")):(o.addClass(r,w),r.setAttribute("aria-invalid","true"),n=!1)},this),t&&!n&&this.displayError(t),n},n.prototype.getPillIDsByType=function(){var e=[],t=[];return this.pills.forEach(function(n){n.data&&"group"===n.data.type?t.push(n.id):e.push(n.id)}),{defaultIDs:e,groupIDs:t}},{create:function(e,t,r){return new n(e,t,r)}}}),Box.Application.addService("pill-selector-v2",function(e){"use strict";function t(e,t){t=t||{},this.mountNode=e,this.selectedItems=t.selectedItems||[],this.unselectedItems=t.items||[];var n={label:t.label||this.mountNode.getAttribute("data-label"),name:t.name||this.mountNode.getAttribute("data-name"),onItemAdd:this.handleItemAdd.bind(this),onItemRemove:this.handleItemRemove.bind(this),onUserInput:t.onUserInput,parseItems:t.parseInput,placeholder:t.placeholder||this.mountNode.getAttribute("data-placeholder"),selectedItems:this.selectedItems,selectorItems:this.unselectedItems,validator:t.validateItem||this.validateItem};this.pillSelector=i.create(o,e),this.setProps(n)}var n=e.getService("function-utils"),r=e.getService("react-components"),i=e.getService("react-component-renderer"),o=r.getComponent("PillSelectorUI");return t.prototype.getSelectedItems=function(){return this.selectedItems},t.prototype.handleItemAdd=function(e){this.updateItemState(this.selectedItems.concat(e),[])},t.prototype.handleItemRemove=function(e,t){var n=this.selectedItems;t<0||t>=n.length||this.updateItemState(n.slice(0,t).concat(n.slice(t+1)),[])},t.prototype.setItems=function(e){var t=this.selectedItems.reduce(function(e,t){return e[t.id]=!0,e},{});this.unselectedItems=e.filter(function(e){return!t.hasOwnProperty(e.id)}),this.updateItemState(null,this.unselectedItems)},t.prototype.setProps=function(e){this.pillSelector.setProps(e)},t.prototype.unmount=function(){this.pillSelector.unmount()},t.prototype.updateItemState=n.debounce(function(e,t){var n={};e&&(this.selectedItems=e,n.selectedItems=e),t&&(this.unselectedItems=t,n.selectorItems=t),this.setProps(n)}),t.prototype.validateItem=function(e){return!!e.trim().length},{create:function(e,n){return new t(e,n)}}}),Box.Application.addService("popout-reposition",function(e){"use strict";var t=10,n=e.getGlobal("window");return{repositionPopout:function(e,r){if(!e||!r)return null;var i=n.innerHeight,o=e.getBoundingClientRect();if(o.bottom<i)return null;var a=r.getBoundingClientRect(),s=-1*Math.min(o.bottom-i,a.top),l=a.width+t;return a.left-o.width<0&&(l=-1*o.width-t),{right:l+"px",top:s+"px"}}}}),Box.Application.addService("popups-amsterdam",function(e){"use strict";function t(t,n){var r=n||"",i=e.getService("resin"),o=e.getGlobalConfig("resinPageName");i.recordAction({application:"files",page:o,component:"modal",feature:r,target:"loaded",action:"",data:{loadTime:t}})}function n(e,t){var n=new Box.EventTarget;this.on=function(){n.on.apply(n,arguments)},this.fire=function(){n.fire.apply(n,arguments)},setTimeout(function(){v.on(t,"click",function(e){var t=v.getNearestUnbounded(e.target||e.srcElement,".popup");t||n.fire("close",e)})},500),v.on(e,"click",function(e){var t=v.getNearest(e.target||e.srcElement,"[data-event-type]");t&&n.fire(t.getAttribute("data-event-type"),e)});var r=this;n.on("close",function(){r.close()})}function r(e,t){var r=this.elem=document.createElement("div");r.className="popup-wrapper disable_selectable",r.setAttribute("data-resin-component","modal"),r.setAttribute("data-keyboard-layer",""),this.spinnerElem=S.getTemplateFragment("spinner-light-large");var i=this.innerElem=document.createElement("div");i.className=t?"popup "+t:"popup",i.setAttribute("tabindex","-1"),i.setAttribute("role","dialog"),e instanceof Element?(i.appendChild(e),r.appendChild(i)):"string"==typeof e?(v.setHTML(i,e),r.appendChild(i)):v.addClass(r,g),n.call(this,i,r)}function i(){o||(o=setTimeout(function(){o=null,b.refresh()},50))}var o,a='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="close"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"><h2 class="popup-heading"><%=heading%></h2><p class="mbn"><%=message%></p><div class="popup-btn-group"><button class="btn btn-primary" data-event-type="close">'+$t("Okay","alert_popup_button_title")+"</button></div></div>",s='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="close"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"><h2 class="popup-heading"><%=heading%></h2><p><%=message%></p><form>\t<input class="popup-prompt-input" type="text" required placeholder="<%=placeholder%>" value="<%=defaultValue%>" title="<%=title%>"><div class="popup-btn-group"><button class="btn popup-cancel-btn" data-event-type="close" type="button">'+$t("Cancel","popup_prompt_button_cancel")+'</button><button class="btn btn-primary" data-event-type="ok">'+$t("Okay","alert_popup_button_title")+"</button></div></form></div>",l='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="close"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"><h2 class="popup-heading"><%=heading%></h2><p class="mbn"><%=message%></p><div class="popup-btn-group"><button class="btn popup-cancel-btn" data-event-type="cancel"><%=cancelBtnText%></button><button class="btn btn-primary popup-confirm-btn" data-event-type="ok"><span class="btn-text"><%=okBtnText%></span></button></div></div>',c='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="close"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"></div>',u=$t("Okay","popup_generic_button_okay"),d=$t("Cancel","popup_generic_button_cancel"),f=$t("Close","popup_generic_button_close"),p=$t("Error","popup_generic_failure_message_title"),m=$t("An error has occurred while loading this feature.","popup_generic_failure_message"),h="is-disabled",g="is-loading",v=e.getService("dom"),y=e.getService("focus"),b=e.getService("nav"),_=e.getService("promises"),w=e.getService("keyboard-shortcuts"),S=e.getService("templates"),k=e.getService("tooltips-amsterdam"),E=!1,C=[],x=0;return r.prototype.show=function(){document.body.appendChild(this.elem),k&&k.hideAll(),x++,v.addClass(document.body,"has-active-popup"),C.push(this),w.register({name:"popups-amsterdam",shortcuts:[{key:"esc",description:$t("Close popup","kb_shortcuts_popups_amsterdam_close_popup"),handler:function(e){this.fire("close",e)}.bind(this)}]},this.elem),e.broadcast("popupopened")},r.prototype.focus=function(){this._focusActivated||(y.wrap(this.elem,!0),this._focusActivated=!0)},r.prototype.resize=function(e){e&&(this.innerElem.style.width=e)},r.prototype.close=function(){if(this.elem.parentNode&&!E){k&&k.hideAll(),w.deregister("popups-amsterdam",this.elem),e.broadcast("popupclosed"),e.stopAll(this.elem),this.elem.parentNode.removeChild(this.elem),x--,x||v.removeClass(document.body,"has-active-popup");for(var t=0;t<C.length;t++)if(C[t]===this)return void C.splice(t,1)}},r.prototype.setContent=function(e){v.removeClass(this.elem,g);var t=v.query(".popup-contents",this.innerElem);v.setHTML(t,e)},r.prototype.query=function(e){return this.innerElem.querySelector(e)},r.prototype.queryAll=r.prototype.$=function(e){return this.innerElem.querySelectorAll(e)},{_triggerPageReload:i,create:function(e,t){return new r(e,t)},alert:function(e,t){var n=this.create();return _.create(function(r){var i=S.createTemplateFragment(a,{closeBtnText:f,heading:t,message:e});n.innerElem.appendChild(i),n.innerElem.setAttribute("aria-label",t),n.elem.appendChild(n.innerElem),n.show(),n.focus(),n.on("close",r)})},prompt:function(e){var t=this.create();return _.create(function(n){e.closeBtnText||(e.closeBtnText=f);var r=S.createTemplateFragment(s,e);t.innerElem.appendChild(r),e.heading&&t.innerElem.setAttribute("aria-label",e.heading),t.elem.appendChild(t.innerElem);var i=v.query("input",t.elem);t.show(),t.focus(),e.defaultValue&&i.select(),e.pattern&&i.setAttribute("pattern",e.pattern),t.on("ok",function(){i.checkValidity&&!i.checkValidity()||(t.close(),n(i.value))}),v.query("form",t.elem).addEventListener("submit",function(e){e.preventDefault(),t.fire("ok")})})},confirm:function(e,t,n){n=n||{};var r=this.create(),i=_.create(function(i,o){var a=S.createTemplateFragment(l,{closeBtnText:f,heading:t,message:e,okBtnText:n.confirmText||u,cancelBtnText:n.cancelText||d});r.innerElem.appendChild(a),r.innerElem.setAttribute("aria-label",t),r.elem.appendChild(r.innerElem);var s=r.query(".popup-confirm-btn"),c=S.getTemplateFragment("spinner");s.appendChild(c),r.show(),r.focus(),r.on("ok",function(){i()}),r.on("cancel",function(){o()})});return n.isBlocking||r.on("ok",r.close.bind(r)),r.on("cancel",r.close.bind(r)),i},open:function(n,r){r=r||{};var i=e.getService("ajax"),o=this.create(),a=S.createTemplateFragment(c,{closeBtnText:f});o.innerElem.appendChild(a),o.elem.appendChild(o.spinnerElem),o.show(),o.hasLoaded=!1,o.on("close",function(){o.hasLoaded&&r.hasUnsafeSideEffects&&this._triggerPageReload()}.bind(this));var s=r.data||{};s["!popup"]="yesplease";var l=e.getGlobal("performance"),u=l.now(),d=r.isPostRequest?i.post:i.get;return d(n,s).then(function(e){o.elem.appendChild(o.innerElem),o.setContent(e.data.html),r.disableAutoFocus||o.focus(),o.resize(r.width);var n=v.query(".popup-heading",o.innerElem);n&&o.innerElem.setAttribute("aria-label",n.innerText),v.addClass(o.innerElem,"is-active"),o.hasLoaded=!0;var i=l.now()-u;t(i,r.resinName),o.focus()}).catch(function(t){"JSON Parse Error"===t.message&&e.reportError("Popup being retrieved is not configured with $this->setUpPopup();"),o.hasLoaded=!0,o.close();var n=t.data||{};this.alert(n.message||m,p)}.bind(this)),o},resize:function(){},close:function(e){var t,n=!1;if(e=e||{},!C.length)return void(e.alternateDestination&&b.navigate(e.alternateDestination));e.enableClose&&(E=!1);do t=C.shift(),t.hasLoaded&&(n=!0),t.close();while(C.length);n&&!e.unsafeSkipRefresh&&this._triggerPageReload()},showConfirmBlockingState:function(){if(C.length){var e=C[C.length-1],t=e.query(".popup-confirm-btn"),n=e.query(".popup-cancel-btn");t&&(v.addClass(t,g),v.addClass(t,h)),n&&v.addClass(n,h),E=!0}},anyPopupsOpen:function(){return C.length>0}}}),Box.Application.addService("preview-auth",function(e){"use strict";function t(){return Date.now()+parseInt(.9*d,10)}function n(e){e in f&&delete f[e]}function r(e){var t=Date.now();e.forEach(function(e){var r=f[e];r&&r.expirationTimestamp<t&&n(e)})}function i(e){return e.map(function(e){return f[e].promise})}function o(e){return e.filter(function(e){return!(e in f)})}function a(e){return e.filter(function(e){return e in f})}function s(e){for(var t=[],n=0,r=e.length;n<r;n+=c)t.push(e.slice(n,n+c));return t}var l="preview_create_tokens",c=100,u=2,d=864e5,f={},p=e.getService("promises");return{setTokenTimeoutMS:function(e){d=e},getTokenRequestLimit:function(){return c},createTokens:function(r){var i=e.getService("ajax"),o=e.getService("shared-context");if(r.length>c)return p.createRejected("Too many token creations requested.");var a={fileIDs:r};o.addSharedParams(a);var s=i.post(l,a).then(function(e){var t=e.data;r.forEach(function(e){f[e].token=t[e]})}).catch(function(){throw r.forEach(function(e){n(e)}),new Error("Auth tokens could not be fetched!")}),u=t();return r.forEach(function(e){f[e]={token:null,promise:s,expirationTimestamp:u}}),s},getTokens:function(e,t){e=e.map(function(e){return e.replace("file_","")}),t="boolean"!=typeof t||t,r(e);var n=a(e),l=o(e),c=[];if(n.length&&(c=c.concat(i(n))),t&&l.length){var d=s(l);if(d.length>u)return p.createRejected("Too many tokens requested at a single time.");d.forEach(function(e){c.push(this.createTokens(e))},this)}return p.all(c).then(function(){var t={};return e.forEach(function(e){f[e]&&(t[e]=f[e].token,t["file_"+e]=f[e].token)}),t})},hasTokenBeenRequested:function(e){return r([e]),e in f}}}),Box.Application.addService("preview-instance",function(){"use strict";var e;return{create:function(){return"function"==typeof Box.Preview&&(e=new Box.Preview),this.instance()},instance:function(){return e}}}),Box.Application.addService("preview-context",function(e){"use strict";function t(){var t=null,r=e.hasService("file-list-manager")?e.getService("file-list-manager"):null,i={isCollectionSupported:function(){return r&&"recents"!==r.getCurrentPageType()},isFullCollectionSupported:function(){if(r){var e=r.getCurrentPageType();return"files"===e||"sharedfolder"===e}return!1},setFileID:function(e){t.fileID=e,t.collectionFileIDs&&t.collectionFileIDs.indexOf(e)!==-1||(t.collectionFileIDs=[e])},setCollectionFileIDs:function(e){var n=t.fileID;e&&e.indexOf(n)!==-1&&(t.collectionFileIDs=e)},setCollectionDataFromFilesList:function(){r&&this.setCollectionFileIDs(r.getCurrentFileIDs())},setSortDataFromFilesList:function(){if(r){var e=r.getCurrentSortData();e&&e.sortColumn&&e.sortDirection&&(t.sortColumn=e.sortColumn,t.sortDirection=e.sortDirection)}},setSidebar:function(e){t.sidebar=e||n},getContext:function(){return $.extend({},t)},clearContext:function(){t={fileID:null,collectionFileIDs:[],sortColumn:null,sortDirection:null,sidebar:n}},getDefaultSidebar:function(){return n}};return i.clearContext(),i}var n="file";return{create:function(){return t()}}}),Box.Application.addService("preview-metrics",function(e){"use strict";function t(e){var t=e.split("-");return t[t.length-1]}function n(n){var s=e.getService("logger"),l=e.getGlobal("document"),c=l.body.getAttribute("data-resin-page")||"files",u=n.file,d=n.file.watermark_info||{},f=n.metrics,p=f.browser,m=f.time,h=f.count,g=f.client||{},v={browser_name:p.name,browser_swf:p.swf,browser_svg:p.svg,browser_mp3:p.mp3,browser_mse:p.mse,browser_dash:p.dash,browser_webgl:p.webgl,browser_box3d:p.box3d,browser_h264_baseline:p.h264.baseline,browser_h264_main:p.h264.main,browser_h264_high:p.h264.high,typedId:"f_"+u.id,file_id:u.id,extension:u.extension,cached:f.cache.hit?o:a,contentType:f.type,isConversionNeeded:f.converted?a:o,isWatermarked:d.is_watermarked?o:a,isFreshOpenPreview:0===h.navigation?o:a,navigation_count:h.navigation,preview_count:h.success,error_count:h.error,country_code:t(f.locale),previewSource:c,preload_time:m.preload,conversion_time:m.conversion,rendering_time:m.rendering,total_load_time:m.total,client_name:g.name,client_version:g.version};n.error?(v.error=n.error,s.sendLog(r,i,v)):s.sendLog(r,r,v)}var r="preview",i="error",o="true",a="false";return{log:n}}),Box.Application.addService("progress-bar",function(e){"use strict";function t(e){this.mountNode=e,this.progressBar=r.create(i,e),this.start()}var n=e.getService("react-components"),r=e.getService("react-component-renderer"),i=n.getComponent("ProgressBar");return t.prototype.start=function(){this.updateProgress(0)},t.prototype.finish=function(){this.updateProgress(100),setTimeout(function(){this.start()}.bind(this),500)},t.prototype.updateProgress=function(e){this.progressBar.setProps({progress:e})},t.prototype.unmount=function(){this.progressBar.unmount()},{create:function(e){return new t(e)}}}),Box.Application.addService("progress-circle",function(e){"use strict";function t(e){return 2*Math.PI*e}function n(e){var n=e.element;e.type===o.CIRCLE&&(e.circle=s.query("svg circle",n),e.circumference=t(e.circle.getAttribute(a)),e.path=s.query("svg path",n))}function r(e,t){var n=e.circumference*t;e.path.style.strokeDashoffset=n}function i(e){this.element=e.element,this.total=e.total,this.type=this.element.getAttribute("data-type"),n(this)}var o={CIRCLE:"circle"},a="r",s=e.getService("dom");return i.prototype.updateProgress=function(e){var t=(e+1)/this.total;this.type===o.CIRCLE&&r(this,t)},{create:function(e){return new i(e)}}}),Box.Application.addService("provider-contacts",function(e){"use strict";function t(e,t){var n=[];return e.hasOwnProperty("contacts")&&e.contacts.forEach(function(e){n.push({data:{email:e.email,id:e.id,type:"user"},id:e.email,text:e.contact_name,email:e.email})}),e.hasOwnProperty("collabs_without_account")&&!t.excludeWithoutAccount&&e.collabs_without_account.forEach(function(e){n.push({data:{email:e.email,id:e.email,type:"collab_without_account"},id:e.email,text:e.email,email:""})}),e.hasOwnProperty("friends_without_account")&&!t.excludeWithoutAccount&&e.friends_without_account.forEach(function(e){n.push({data:{email:e.email,id:e.email,type:"friend_without_account"},id:e.email,text:e.contact_name,email:e.email})}),e.hasOwnProperty("groups")&&e.groups.forEach(function(e){n.push({data:{email:"",id:e.id,type:"group"},id:e.id,text:e.contact_name,email:$t("Group","group_text")})}),0===n.length?[]:n}function n(e,n){return function(o){r&&(r.cancel(),r=null);var l=s.getGcmCompatibleRm(i);return r=a.get(l,{searchString:o,itemTypedId:e,includeSelf:!!n.includeSelf,includeGroups:!!n.includeGroups}),r.then(function(e){return r=null,t(e.data,n)},function(){r=null})}}var r,i="contacts_get",o={title:$t("UPLOADER","contact_selector_uploader"),tooltip:$t("This user does not have permission to add comments or respond to tasks.","contact_selector_uploader_description")},a=e.getService("ajax"),s=e.getService("url");return{searchAllContacts:function(e){return n("",e||{})},searchAllContactsExcludingItemCollaborators:function(e,t){return e?n(e,t||{}):this.searchAllContacts(t)},searchWithItem:function(e){return function(t){return r&&(r.cancel(),r=null),r=a.get("contacts_get_for_item",{search_string:t,item_typed_id:e||"",include_pending_collabs:!1,include_self:!1}),r.then(function(e){r=null;for(var t=[],n=e.data.contacts.length,i=0;i<n;i++)t.push({text:e.data.contacts[i].contact_name,id:""+e.data.contacts[i].id,data:e.data.contacts[i],href:"/profile/"+e.data.contacts[i].id,email:e.data.contacts[i].email,isNotSelectable:e.data.is_uploader[e.data.contacts[i].id],badge:e.data.is_uploader[e.data.contacts[i].id]?o:null});return t},function(){r=null})}}}}),Box.Application.addService("quick-search",function(e){"use strict";function t(e){T.removeClass(e.inputWrapperEl,b),T.removeClass(e.resultsWrapperEl,w),T.removeClass(e.resultsWrapperEl,_),e.resultsListEl.style.height="0"}function n(e){T.addClass(e.inputWrapperEl,b),T.removeClass(e.resultsWrapperEl,w),T.removeClass(e.resultsWrapperEl,_)}function r(e,t){T.removeClass(e.inputWrapperEl,b),T.removeClass(e.resultsWrapperEl,w),T.addClass(e.resultsWrapperEl,_),T.setHTML(e.heightCalculatorEl,t),e.resultsListEl.style.height=e.heightCalculatorEl.offsetHeight+1+"px",e.resultsListEl.style.width=e.inputWrapperEl.offsetWidth+"px",T.setHTML(e.resultsListEl,t),A.recordAction({component:"header",feature:"search",target:"loaded",action:"programmatic",data:{query:e.inputEl.value,resultsCount:T.queryAll("li",e.resultsListEl).length}})}function i(e){T.removeClass(e.inputWrapperEl,b),T.removeClass(e.resultsWrapperEl,_),T.addClass(e.resultsWrapperEl,w),T.setHTML(e.resultsListEl,""),T.setHTML(e.heightCalculatorEl,""),e.resultsListEl.style.height="0"}function o(e){return T.queryAll(".results-list li",e).length}function a(e){return T.query(".results-wrapper ."+S,e)}function s(e){return 0===I.trim(e.value).length}function l(e){var t=a(e.widgetEl);if(t&&T.removeClass(t,S),e.selectionIdx!==-1){var n=o(e.widgetEl),r=T.query(".results-list li:nth-child("+(e.selectionIdx+1)+")",e.widgetEl);0===e.selectionIdx&&0===n?r=T.query(".no-results-indicator",e.widgetEl):e.selectionIdx===n&&(r=T.query(".advanced-search-btn",e.widgetEl)),T.addClass(r,S)}}function c(e,t){var n="/index.php?rm="+t+"&folderID="+e.searchFolderID+"&isStartingSearch="+!e.searchStarted+"&resinSessionID="+A.getSessionId()+"&"+P(e.widgetEl).serialize();return n}function u(e,n){return O.debounce(function(){e.ongoingRequest&&(e.ongoingRequest.abort(),e.ongoingRequest=null);var o=I.trim(e.inputEl.value);if(!o)return t(e),void(e.searchStarted=!1);A.recordActionFromElement(e.inputEl,{data:{query:o}});var a=c(e,n);e.ongoingRequest=D.send("GET",a),e.searchStarted=!0,e.ongoingRequest.then(function(n){if(e.selectionIdx=-1,e.ongoingRequest=null,!e.inputEl.value)return t(e),void(e.searchStarted=!1);var o=I.trim(n.responseText);return o?void r(e,o):void i(e)},function(){t(e),e.ongoingRequest=null})},200,!1)}function d(e){return function(n,r){var i=o(e.widgetEl);switch(r){
case x.ESC:return void t(e);case x.UP:return e.selectionIdx>=0&&(e.selectionIdx--,l(e)),void n.preventDefault();case x.DOWN:return!T.hasClass(e.widgetEl,w)&&e.selectionIdx<i?(e.selectionIdx++,l(e)):s(e.inputEl)||(e.selectionIdx=0,l(e)),void n.preventDefault();case x.ENTER:if(e.isFolderTreeQuickSearch&&n.preventDefault(),e.selectionIdx===-1||e.selectionIdx===i)return;var c=a(e.widgetEl);return c.getAttribute("data-item-typed-id").substr(0,2)===k?e.events.fire("select",c):T.query("a",c).click(),void n.preventDefault()}}}function f(e){return function(){var n=e.inputEl.value;return I.trim(n)?(e.queryCopyEl&&T.setText(e.queryCopyEl,n),void(e.resultsWrapperEl&&e.debouncedSearch())):(t(e),void(e.searchStarted=!1))}}function p(e){return function(t){var n,r=t.target;if(e.isFolderTreeQuickSearch)t.preventDefault(),n=T.getNearest(r,C),e.events.fire("select",n);else{if(r&&"A"===r.nodeName)return;var i=T.getNearest(t.target,"li");i&&(e.events.fire("click",i),t.stopPropagation(),t.preventDefault())}}}function m(e){return function(){T.addClass(e.inputWrapperEl,y),M.register({name:"quick-search",shortcuts:[{key:["enter","up","down","esc"],description:$t("Select search results","kb_shortcuts_quick_search_navigation_keys"),handler:e.keydownHandler}]},e.inputEl)}}function h(e){return function(){M.deregister("quick-search",e.inputEl)}}function g(e){return function(t){T.getNearest(t.target,".quick-search-widget")||T.getNearest(t.target,".pika-lendar")||T.removeClass(e,y)}}function v(e,t){if(this.widgetEl=e,this.inputEl=T.query('input[type="search"]',e),this.inputWrapperEl=T.query(".input-wrapper",e),this.queryCopyEl=T.query(".query-copy",e),this.resultsListEl=T.query(".results-list",e),this.resultsWrapperEl=T.query(".results-wrapper",e),this.debouncedSearch=u(this,t),this.searchFolderID=E,this.searchStarted=!1,this.ongoingRequest=null,this.selectionIdx=-1,this.waitingTimeoutHandle=null,this.events=new Box.EventTarget,this.eventHandlersAttached=!1,this.isFolderTreeQuickSearch=T.hasClass(this.widgetEl,"folder-tree-quick-search"),this.resultsWrapperEl){var n=this.heightCalculatorEl=document.createElement("ul");n.className="height-calculator",n.style.position="absolute",n.style.width="100%",n.style.opacity="0",this.resultsWrapperEl.insertBefore(n,this.resultsListEl.nextSibling)}this.inputEl.setAttribute("data-keyboard-layer","quick-search"),this.keydownHandler=d(this),this.inputHandler=f(this),this.clickHandler=p(this),this.focusHandler=m(this),this.blurHandler=h(this),this.globalMousedownHandler=g(this.inputWrapperEl),this.attachSearchEventHandlers(),this.attachInputEventHandlers()}var y="has-focus",b="is-loading",_="has-results",w="has-no-results",S="is-selected",k="d_",E="0",C=".search-result-item",x={TAB:"tab",ENTER:"enter",SHIFT:"shift",CTRL:"ctrl",OPT:"alt",ESC:"esc",LEFT:"left",UP:"up",RIGHT:"right",DOWN:"down",LEFT_CMD:"meta",RIGHT_CMD:"meta"},T=e.getService("dom"),A=e.getService("resin"),I=e.getService("strings"),O=e.getService("function-utils"),D=e.getService("xhr"),M=e.getService("keyboard-shortcuts"),P=e.getGlobal("jQuery");return v.prototype.reset=function(){t(this)},v.prototype.attachSearchEventHandlers=function(){T.on(this.inputEl,"input",this.inputHandler),T.on(this.resultsListEl,"click",this.clickHandler)},v.prototype.removeSearchEventHandlers=function(){T.off(this.inputEl,"input",this.inputHandler),T.off(this.resultsListEl,"click",this.clickHandler)},v.prototype.attachInputEventHandlers=function(){this.eventHandlersAttached||(T.on(document,"mousedown",this.globalMousedownHandler),T.on(this.inputEl,"focus",this.focusHandler),T.on(this.inputEl,"blur",this.blurHandler),this.eventHandlersAttached=!0)},v.prototype.removeInputEventHandlers=function(){this.eventHandlersAttached&&(T.off(document,"mousedown",this.globalMousedownHandler),T.off(this.inputEl,"focus",this.focusHandler),T.off(this.inputEl,"blur",this.blurHandler),this.eventHandlersAttached=!1)},v.prototype.triggerSearch=function(){n(this),this.debouncedSearch()},v.prototype.setSearchFolderID=function(e){this.searchFolderID=e},v.prototype.focusOnSearchEl=function(){this.inputEl.focus()},v.prototype.destroy=function(){this.removeSearchEventHandlers(),this.removeInputEventHandlers()},{create:function(e,t){return new v(e,t)}}}),Box.Application.addService("react-components",function(e){"use strict";var t=Box.WebAppComponents.common||{},n=Box.WebAppComponents.embed||{},r={ActivityFeedUI:t.ActivityFeedUI,PillSelectorUI:t.PillSelectorUI,ProgressBar:t.ProgressBar,SearchMetadataUI:t.SearchMetadataUI,SearchMetadataFilterUI:t.SearchMetadataFilterUI,SecurityCloudGameUI:n.SecurityCloudGameUI};return{getComponent:function(e){var t=r[e];if(!t)throw new Error("Component '"+e+"' not found.");return t}}}),Box.Application.addService("realtime-events",function(e){"use strict";function t(){M||(D.addEventListener("beforeunload",u),M=!0)}function n(){M&&(D.removeEventListener("beforeunload",u),M=!1)}function r(){i().then(function(){t(),o()})}function i(){return E=h,S.get(d).then(function(e){e.data&&e.data.streamURL?(E=g,x=e.data.streamPosition,C=e.data.streamURL):s()}).catch(s)}function o(){E===g&&(E=v,w=k.send("GET",C,null,{corsRequest:!0}),w.then(k.parseJSONResponse).then(function(e){E=g,w=null,e.message===b?a():e.message===_?o():s()}).catch(function(){w=null,s()}))}function a(){E=y,S.get(f,{streamPosition:x}).then(function(e){e.data&&e.data.newStreamPosition&&e.data.events?(E=g,x=e.data.newStreamPosition,e.data.events.length>0&&c(e.data.events),o()):s()}).catch(s)}function s(){if(A>p||1<<I<=0)return u(),void e.broadcast("realtimeerror");A++,I=1<<I;var t=O.getDelay();T=setTimeout(r,t)}function l(e){var t={};return e.forEach(function(e){var n=e.type.toLowerCase();t[n]||(t[n]=[]),t[n].push(e)}),t}function c(t){var n=l(t),r=Object.keys(n);r.forEach(function(t){e.broadcast("realtime"+t,n[t])})}function u(){clearTimeout(T),E=m,w&&(w.abort(),w=null),C=null,x=null}var d="realtime_get_subscription_info",f="realtime_latest_events",p=15,m="STATUS_NOT_INITIALIZED",h="STATUS_FETCHING_SUBSCRIPTION",g="STATUS_READY",v="STATUS_LISTENING_TO_STREAM",y="STATUS_FETCHING_UPDATES",b="new_change",_="reconnect",w=null,S=e.getService("ajax"),k=e.getService("xhr"),E=m,C=null,x=null,T=null,A=0,I=1,O=null,D=e.getGlobal("window"),M=!1;return O={getStatus:function(){return E},getDelay:function(){return Math.random()*I*1e3},subscribe:function(){E===m&&r()},unsubscribe:function(){n(),u()}}}),Box.Application.addService("resin-tag-tracker",function(e){"use strict";function t(e){return null===e.offsetParent}function n(e){var t=e.split("").reduce(function(e,t){return("string"==typeof e?e.charCodeAt(0):e)+t.charCodeAt(0)})%m.length;return m[t]}function r(e){if(!t(e)){var r=f.show(e,{tooltipText:"x",tooltipPosition:"bottom"});r&&(r.style.cursor="pointer",d.query(".tooltip-inner",r).style.backgroundColor=n(e.getAttribute("data-resin-target")),d.on(r,"contextmenu",function(t){t.preventDefault(),f.hide(e)}),d.on(r,"click",function(t){t.preventDefault();var n=new CustomEvent("tagtracker",{bubbles:!0});e.dispatchEvent(n)}))}}function i(e){var t=e.keyCode||e.which;114===t&&(e.preventDefault(),e.stopPropagation(),a())}function o(){var e=p.createTemplateFragment(h);c.body.appendChild(e),s=d.query(".tag-tracker-events",c.body),d.on(c.body,"keypress",i),u.start(function(e){var t=g,r=$.extend(e.data,{color:n(e.data.target)}),i=r.data;i&&"object"==typeof i&&Object.getOwnPropertyNames(i).length&&(t+="<div>-----Custom Data-----</div>",r.data=Object.getOwnPropertyNames(i).forEach(function(e){r[e]=i[e],t+="<div>"+e+": <%= "+e+" %></div>"})),t+="</li>";var o=p.createTemplateFragment(t,r);s.insertBefore(o,s.firstChild)},{events:{click:"tagtracker"}}),v=!0}function a(){v||o(),f.hideAll(),l=d.queryAll("[data-resin-target]",c),[].forEach.call(l,r)}var s,l,c=e.getGlobal("document"),u=e.getGlobal("Resin"),d=e.getService("dom"),f=e.getService("tooltips-amsterdam"),p=e.getService("templates"),m=["#26C281","#22A7F0","#DF6CE2","#FFDA04","#0EA5F3","#F03354"],h='<div class="tag-tracker-hud"><ul class="tag-tracker-events"><li>Press \'r\' to refresh tags</li><li>Left click a tag to trigger the event</li><li>Right click a tag to hide it</li></ul></div>',g='<li style="color: <%= color %>"><div>Application: <%= application %></div><div>Page: <%= page %></div><div>Component: <%= component %></div><div>Feature: <%= feature %></div><div>Target: <%= target %></div>',v=!1;return{trackTags:a,destroy:function(){v&&(d.off(c.body,"keypress",i),u.stop())}}}),Box.Application.addService("resin",function(e){"use strict";function t(){if(o=e.getService("browser"),!c&&(!o.isIE()||o.isMinBrowser("explorer","10"))){var t=e.getGlobalConfig("showResinTagTracker");r=e.getGlobal("Resin"),a=e.getService("logger"),s=e.getGlobal("document"),t?(i=e.getService("resin-tag-tracker"),i.trackTags()):r.start(function(e){var t=e.data.client;delete e.data.client,e.data.data&&(e.data.data=JSON.stringify(e.data.data)),a.sendBatchLog("resin",t,e.data)},{events:{click:"mouseup",keypress:"keydown"}}),c=!0}}function n(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var r,i,o,a,s,l="data-resin-target",c=!1,u={recordAction:function(e){c&&r&&(e.client="web",e.application||(e.application=s.body.getAttribute("data-resin-application")),e.page||(e.page=s.body.getAttribute("data-resin-page")),r.recordAction(e))},recordActionFromElement:function(e,t){if(c&&!e.getAttribute("data-resin-target")){var r=this.getActionAttributes(e);this.recordAction({application:this.sanitize(t.application||r.application),page:this.sanitize(t.page||r.page),component:this.sanitize(t.component||r.component),feature:this.sanitize(t.feature||r.feature),target:this.sanitize(t.target||r.target),action:this.sanitize(t.action||r.action),data:n(r.data,t.data||{})})}},getSessionId:function(){return sessionStorage.getItem("resin-session-id")},getActionAttributes:function(e){var t,n={};return c&&r&&(t=e.hasAttribute(l),t||e.setAttribute(l,""),n=r.getActionAttributes(e),t||e.removeAttribute(l)),n},sanitize:function(e){return e?e.toLowerCase().replace(/[^a-z0-9|]/g,""):""}};return t(),u}),Box.Application.addService("search-excerpts",function(){"use strict";var e;return{setForCurrentPage:function(t){e=t},getForItem:function(t){var n=e&&e[t]?e[t]:null;return n},clear:function(){e=null}}}),Box.Application.addService("search-filter-formatting-helper",function(){"use strict";return{serializeOwnerPills:function(e){return e.reduce(function(e,t){return(e?e+",":"")+t.data.id+"|"+t.text.replace(/[,\|]/g," ")},"")},parseOwnerInputForPills:function(e){return e.trim()?e.split(",").map(function(e){var t=e.split("|"),n=parseInt(t[0],10);return{text:t[1],id:n,data:{id:n}}}):[]}}}),Box.Application.addService("shared-context",function(e){"use strict";return{addSharedParams:function(t){var n=e.getGlobalConfig()||{};n.vanityName?t.vanityName=n.vanityName:n.sharedName&&(t.sharedName=n.sharedName)},getBasePath:function(t){var n=e.getGlobalConfig()||{};return n.vanityName?"/v/"+(t?encodeURIComponent(n.vanityName):n.vanityName):n.sharedName?"/s/"+(t?encodeURIComponent(n.sharedName):n.sharedName):""},isSharedFolderPage:function(){return!!e.getGlobalConfig("isSharedFolderPage")},getSharedLink:function(){var t="",n=this.getBasePath();if(n){var r=e.getGlobal("window").location,i=r.origin;i||(i=r.protocol+"//"+r.hostname),t=i+n}return t}}}),Box.Application.addService("slide-carousel",function(e){"use strict";function t(e){for(e.isNavigable="false"!==e.paginationContainerEl.getAttribute("data-navigable");e.paginationContainerEl.firstChild;)e.paginationContainerEl.removeChild(e.paginationContainerEl.firstChild);for(var t,n=0,r=e.slideEls.length;n<r;n++){var i=e.slideEls[n];i.setAttribute("data-slide-num",n),t=document.createElement("li"),t.setAttribute("data-type","go-to-slide"),t.setAttribute("data-slide-num",n),s.hasClass(i,l)&&(t.className=l,e.currentSlideNum=n,e.currentSlideName=i.getAttribute(f)),e.paginationContainerEl.appendChild(t)}e.paginationEls=e.paginationContainerEl.childNodes}function n(t){var n=e.getService("progress-circle");t.progressBar=n.create({element:t.progressEl,total:t.slideEls.length})}function r(e){for(var t,n=0,r=e.slideEls.length;n<r;n++)t=e.slideEls[n],s.removeClass(t,u),s.removeClass(t,d),n<e.currentSlideNum&&s.addClass(t,u),n>e.currentSlideNum&&s.addClass(t,d)}function i(e){var t=s.query(".presentation-content",e);if(t){var n,r=s.getComputedCSS(t)["background-image"],i=/url\(['"]?(.+\.gif).*['"]?\)/;null!==(n=i.exec(r))&&(t.style.backgroundImage="url("+n[1]+"?rnd="+Math.random()+")")}}function o(e){return function(t){var n=t.target||t.srcElement,r=n.getAttribute("data-type");if(r&&e.isNavigable)switch(r){case"go-to-slide":e.goToSlide(Number(n.getAttribute("data-slide-num")));break;case"next-slide":e.goToNextSlide();break;case"prev-slide":e.goToPrevSlide();break;default:return}}}function a(e){this.wrapperEl=e,this.isCurrentlyChangingSlides=!1,this.isNavigable=!0,this.slideContainerEl=s.query(".slides",this.wrapperEl),this.slideEls=s.queryAll(".slides > li",this.wrapperEl),this.paginationContainerEl=s.query(".slides-pagination",this.wrapperEl),this.paginationEls=null,this.progressEl=s.query(".progress",this.wrapperEl),this.currentSlideNum=0,this.currentSlideName=this.slideEls[0].getAttribute(f),t(this),r(this),this.mouseUpHandlerRef=o(this),s.on(this.paginationContainerEl,"mouseup",this.mouseUpHandlerRef),this.progressEl&&this.slideEls.length&&n(this)}var s=e.getService("dom"),l="is-active",c=300,u="transition-left",d="transition-right",f="data-slide-name";return a.prototype={goToSlide:function(e){if(e>=this.slideEls.length||e<0||this.isCurrentlyChangingSlides)return!1;this.isCurrentlyChangingSlides=!0;var t=this.paginationEls[e],n=this.slideEls[e],o=this.paginationEls[this.currentSlideNum],a=this.slideEls[this.currentSlideNum];s.removeClass(n,u),s.removeClass(n,d);var p=e>this.currentSlideNum?u:d;s.addClass(a,p),s.removeClass(o,l),s.removeClass(a,l),s.addClass(t,l),s.addClass(n,l),this.currentSlideNum=e,this.currentSlideName=n.getAttribute(f),r(this),i(n);var m=this;return setTimeout(function(){m.isCurrentlyChangingSlides=!1},c),this.progressBar&&this.progressBar.updateProgress(this.currentSlideNum),!0},goToNextSlide:function(e){var t=this.currentSlideNum+1;return this.goToSlide(e?t%this.slideEls.length:t)},goToPrevSlide:function(e){var t=this.currentSlideNum-1;this.goToSlide(e&&t<0?this.slideEls.length-1:t)},getCurrentSlideNum:function(){return this.currentSlideNum},isOnLastSlide:function(){return this.currentSlideNum===this.slideEls.length-1},getCurrentSlideName:function(){return this.currentSlideName||""},destroy:function(){s.off(this.paginationContainerEl,"mouseup",this.mouseUpHandlerRef)}},{create:function(e){return new a(e)}}}),Box.Application.addService("tabview",function(e){"use strict";function t(e){return parseInt(e.getAttribute(A),10)}function n(e,t){e.setAttribute(A,t)}function r(e){var t,n=P.query(v,e),r=P.query(b,e),i=P.queryAll(y,n),o=Array.prototype.slice.call(r.children),a={tabs:i,panels:o,tabHolderEl:n,panelHolderEl:r,isDynamic:!1};a.panels=o.filter(function(e){return!P.hasClass(e,h)||(t=e,!1)}),t&&(a.emptyStateEl=t);var s=P.getNearest(n,S);if(s){var l=P.query(E,s),c=P.query(C,s);a.isDynamic=!0,a.leftArrowEl=l,a.rightArrowEl=c}return a}function i(e){var t=e.data.tabs;if(!t.length)return 0;var n=t[t.length-1];return n.offsetLeft+n.offsetWidth}function o(e){var t=e.data.tabHolderEl,n=parseInt(t.style.left,10)*-1;return n=n||0}function a(e){var n=o(e),r=e.data.leftArrowEl,a=e.data.rightArrowEl,s=i(e);0===n||0===t(e.element)?P.addClass(r,k):P.removeClass(r,k),n+e.viewportWidth>=s?P.addClass(a,k):P.removeClass(a,k)}function s(e){var n=e.data.emptyStateEl;n&&(t(e.element)===-1?P.addClass(n,_):P.removeClass(n,_))}function l(e){e.data.isDynamic&&(a(e),s(e))}function c(e,t){if(e.data.isDynamic){var n=e.data.tabs[t],r=n.offsetLeft,a=e.data.tabHolderEl,s=o(e),c=i(e);if(c<=e.viewportWidth)return a.style.left="0px",void l(e);var u=r;u=Math.min(c-e.viewportWidth,u),s=-1*u,a.style.left=s+"px",l(e)}}function u(e,r,i){if(r===-1)return n(e.element,r),void l(e);var o,a,s=e.element,u=e.data,d=u.tabs,f=u.panels,p=t(s),m=d[r],h=f[r];if(isNaN(p)||(o=d[p],a=f[p],P.removeClass([o,a],_),a&&N.hide(a)),P.addClass([m,h],_),h&&N.show(h),n(s,r),e.data.isDynamic&&c(e,r),!i)if(e.data.isDynamic){var g=u.tabHolderEl;P.on(g,"transitionend",function e(){m.focus(),P.off(g,"transitionend",e)})}else m.focus();e.fire("tabchange",{tab:h?h.getAttribute("data-tab-name"):m.getAttribute("data-tab-btn-name"),isInit:i})}function d(e){var t=e.data,n=t.tabs,r=t.panels,i=-1;if(t.isDynamic){var o=t.tabHolderEl;e.viewportWidth=parseInt(o.offsetWidth,10),l(e)}N.setRole(t.tabHolderEl,"tablist"),n.forEach(function(e,t){var n=r[t],o=e.id,a=P.hasClass(e,_);o||(e.id=w+M++,o=e.id),a&&(i=t),e.setAttribute(T,t),N.setRole(e,"tab"),e.hasAttribute(x)||e.removeAttribute("href"),n&&(N.setRole(n,"tabpanel"),n.setAttribute("aria-labelledby",o))}),u(e,i,!0)}function f(e){var t,n=e.target;if(P.getNearest(n,v))return e.stopPropagation(),e.preventDefault(),t=P.getNearest(n,D),"tab-close"===n.getAttribute("data-type")?void this.fire("tabclose",{tab:t.getAttribute("data-tab-btn-name")}):void(t&&!P.hasClass(t,"is-disabled")&&u(this,parseInt(t.getAttribute(T),10),!1))}function p(e,t){switch(t){case O:return function(t){t.stopPropagation(),t.preventDefault(),e.nextTab()};case I:return function(t){t.stopPropagation(),t.preventDefault(),e.previousTab()}}}function m(e){this.element=e,this.data=r(this.element),this.isInit=!1,$.extend(this,new Box.EventTarget)}var h="tabview-empty-state",g="no-transition",v=".tabs",y=".tab",b=".tab-panels",_="is-selected",w="tab-id-",S=".dynamic-tabs-bar",k="hidden",E=".left-arrow",C=".right-arrow",x="data-ajax",T="data-index",A="data-selected-index",I=-1,O=1,D="["+T+"]",M=0,P=e.getService("dom"),N=e.getService("aria");return m.prototype.init=function(){d(this),this.onclickHandler=f.bind(this),P.on(this.data.tabHolderEl,"click.tabview",this.onclickHandler),this.data.isDynamic&&(this.leftArrowHandler=p(this,I),this.rightArrowHandler=p(this,O),P.on(this.data.leftArrowEl,"click",this.leftArrowHandler),P.on(this.data.rightArrowEl,"click",this.rightArrowHandler)),this.isInit=!0},m.prototype.reInit=function(){this.data=r(this.element),d(this)},m.prototype.destroy=function(){P.off(this.data.tabHolderEl,"click.tabview",this.onclickHandler),this.data.isDynamic&&(P.off(this.data.leftArrowEl,"click",this.leftArrowHandler),P.off(this.data.rightArrowEl,"click",this.rightArrowHandler))},m.prototype.nextTab=function(){var e=this.data,n=t(this.element);return n<e.tabs.length-1&&(u(this,n+1,!1),!0)},m.prototype.previousTab=function(){var e=t(this.element);return e>0&&(u(this,e-1,!1),!0)},m.prototype.goToTab=function(e){var n=P.query('[data-tab-btn-name="'+e+'"]',this.data.tabHolderEl);if(n){var r=parseInt(n.getAttribute(T),10);r!==t(this.element)&&u(this,r,!1)}},m.prototype.closeTab=function(e){var t=P.query('[data-tab-btn-name="'+e+'"]',this.data.tabHolderEl);if(t){var n=parseInt(t.getAttribute(T),10),r=this.data.panels[n];P.remove(t),P.remove(r),P.addClass(this.data.tabHolderEl,g),this.nextTab()||this.previousTab(),this.reInit(),P.removeClass(this.data.tabHolderEl,g)}},{create:function(e){return new m(e)}}}),Box.Application.addService("tags-autocomplete",function(e){"use strict";function t(e){return{id:e,name:e,text:e}}function n(){var t=e.getService("xhr");return t.send("GET",o).then(function(e){var t=JSON.parse(e.responseText),n=t.tags;return n?Object.keys(n).reduce(function(e,t){var r=n[t].name;return e.push(r),e},[]):c.createRejected()})}function r(e){u.addWords(e)}function i(e,n){n=n||[];var r={parseInput:this.parseInput,selectedItems:n.map(t),onUserInput:s.debounce(this.search.bind(this))};this.pillSelector=l.create(e,r),this.updateTags()}var o="/index.php?rm=get_user_tags",a=e.getService("dictionary"),s=e.getService("function-utils"),l=e.getService("pill-selector-v2"),c=e.getService("promises"),u=a.create();return i.prototype.getValue=function(){return this.pillSelector.getSelectedItems().map(function(e){return e.name}).join(",").trim()},i.prototype.parseInput=function(e){return e.split(",").map(function(e){return e.trim()})},i.prototype.search=function(e){var n=e?u.search(e).map(t):[];this.pillSelector.setItems(n)},i.prototype.updateTags=function(){n().then(r)},{create:function(e,t){return new i(e,t)}}}),Box.Application.addService("textarea-resizer",function(){"use strict";function e(e){return e+"px"}function t(e){this.element=e;var t,i=e.getAttribute("rows");t=e.hasAttribute(r)?parseInt(e.getAttribute(r),10):n,e.setAttribute("rows",t),this.maxHeight=e.getBoundingClientRect().height||o,null===i?e.removeAttribute("rows"):e.setAttribute("rows",i)}var n=6,r="data-autogrow-max-rows",i=50,o=200;return t.prototype.resize=function(){this.element.style.height="auto",this.element.style.height=e(Math.min(this.maxHeight,this.element.scrollHeight||i))},{create:function(e){return new t(e)}}}),Box.Application.addService("text-clipboard",function(e){"use strict";function t(e){this.copyInputGroupEl=e,this.copyTriggerEl=u.query(".copy-text-trigger",e),this.copyTargetEl=u.query(".copy-text-target",e),this.copy=this.copy.bind(this),u.on(this.copyTriggerEl,"click",this.copy)}var n=2e3,r=3e3,i="copy-text-success",o=$t("Copy","text_clipboard_copy_btn_text"),a=$t("Copied","text_clipboard_copied_btn_text"),s=e.getGlobal("document"),l=e.getService("tooltips-amsterdam"),c=e.getService("browser"),u=e.getService("dom");return t.prototype.copy=function(){this.copyTargetEl.select();var e=s.execCommand("copy");return e?(this.copySuccessTimeout&&clearTimeout(this.copySuccessTimeout),u.addClass(this.copyInputGroupEl,i),u.setText(this.copyTriggerEl,a),void(this.copySuccessTimeout=setTimeout(function(){u.removeClass(this.copyInputGroupEl,i),u.setText(this.copyTriggerEl,o)}.bind(this),r))):void this.displayCopyTooltip(this.copyTriggerEl)},t.prototype.displayCopyTooltip=function(){var e=this.fallbackMessage();l.show(this.copyTriggerEl,{tooltipText:e,tooltipPosition:"top"}),this.tooltipTimeout&&clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){l.hide(this.copyTriggerEl)}.bind(this),n)},t.prototype.fallbackMessage=function(){var e=c.getOSName(),t=$t("Not Supported","text_clipboard_ios_error_tooltip"),n=$t("Press ⌘-C to Copy","text_clipboard_mac_error_tooltip"),r=$t("Press Ctrl-C to Copy","text_clipboard_other_error_tooltip");return"iOS"===e?t:"Mac"===e?n:r},t.prototype.destroy=function(){u.off(this.copyTriggerEl,"click",this.copy)},{create:function(e){return new t(e)}}}),Box.Application.addService("tooltips-amsterdam",function(e){"use strict";function t(){}function n(e,t){t=t||"body";var n=$(e),r=$(t),i=$.extend({},n.offset(),{width:n.outerWidth(),height:n.outerHeight()});return"body"!==t&&(i.left=n.offset().left-r.offset().left,i.top=n.offset().top-r.offset().top),i.right=i.left+i.width,i.bottom=i.top+i.height,i}function r(e,t,r){var i=n(e),o=n(t),a=D.innerHeight,s=D.innerWidth;switch(r){case"top":return i.top-o.height>0;case"bottom":return i.bottom+o.height<a;case"left":return i.left-o.width>0;case"right":return i.left+i.width+o.width<s;default:return!1}}function i(e,t,n){x.removeClass(e,t),x.addClass(e,n)}function o(t,n,r){var i,o=x.getBoundingClientRect(t).width,a=r.left,s=e.getGlobal("document"),l=s.body.clientWidth;"bottom"!==n&&"top"!==n||(a<0?r.left=0:a+o>l&&(i=a+o-l,r.left=a-i)),t.style.left=r.left+"px",t.style.top=r.top+"px"}function a(e,t){return e.top+(e.height-t.height)/2}function s(e,t){return e.left+(e.width-t.width)/2}function l(e,t){return{left:e.left+e.width+q,top:a(e,t)}}function c(e,t){return{left:e.left-t.width-q,top:a(e,t)}}function u(e,t){return{left:s(e,t),top:e.top-t.height-q}}function d(e,t){return{left:s(e,t),top:e.top+e.height+q}}function f(e,t,r,i){var o=n(i,e),a=n(r,e);switch(t){case"right":return l(a,o);case"left":return c(a,o);case"bottom":return d(a,o);case"top":return u(a,o);default:return l(a,o)}}function p(e){var t=e.getAttribute("aria-describedby"),n=I[t];n&&(e.removeAttribute("aria-describedby"),x.removeClass(e,N),$(n).fadeOut("fast").remove(),delete I[t],O--)}function m(){$(R).remove()}function h(){if(O){for(var e=x.queryAll("["+F+"]"),t=0;t<e.length;t++)p(e[t]);m()}}function g(){var t=e.getGlobal("window");t.addEventListener&&t.addEventListener("scroll",h,!0),A=!0}function v(t){var n=e.getGlobal("document"),r=T.createTemplateFragment(C,t),i=$(t.tooltipRelative);if(!i.length)throw new Error("Tooltip relative container does not exist");if(i.append(r),t.tooltipNl2br){var o=x.query(".tooltip-inner"),a=o.innerHTML,s=a.replace(new RegExp("\n","g"),"<br>");x.setHTML(o,s)}return I[t.id]=n.getElementById(t.id),O++,A||g(),I[t.id]}function y(e,t){if(!t.text)return null;if(!$(e).is(":visible"))return null;var n=I[t.id]||v(t);if("body"===t.tooltipRelative&&(n.style.left=0,n.style.top=0),!r(e,n,t.tooltipPosition)){var a=t.tooltipPosition;t.tooltipPosition=B[t.tooltipPosition],i(n,a,t.tooltipPosition)}return e.setAttribute("aria-describedby",t.id),o(n,t.tooltipPosition,f(t.tooltipRelative,t.tooltipPosition,e,n)),x.addClass(e,N),$(n).show(),n}function b(e){do e+=Math.floor(1e6*Math.random());while(document.getElementById(e));return e}function _(e,t){return $.inArray(e,t)>-1}function w(e,n,r){var i=r.tooltipTrigger.split(" ");return _("click",i)&&"click"===e?P.TOGGLE:"focusin"===e&&_("focus",i)&&!x.hasClass(n,N)?P.SHOW:"focusout"===e&&_("focus",i)&&x.hasClass(n,N)?P.HIDE:"mouseover"===e&&_("hover",i)&&!x.hasClass(n,N)?P.SHOW:"mouseout"===e&&_("hover",i)&&x.hasClass(n,N)?n===document.activeElement&&_("focus")?t():P.HIDE:t()}function S(e){var t=$(e);return{tooltip:t.attr("data-tooltip"),tooltipTrigger:t.attr("data-tooltip-trigger"),tooltipPosition:t.attr("data-tooltip-position"),tooltipTheme:t.attr("data-tooltip-theme"),tooltipText:t.attr("data-tooltip-text"),tooltipRelative:t.attr("data-tooltip-relative"),tooltipClassName:t.attr("data-tooltip-class-name"),tooltipNl2br:void 0!==t.attr("data-tooltip-nl2br")}}function k(e,t){if($(e).is($(t.tooltipRelative)))throw new Error("Tooltip cannot be configured relative to itself")}function E(e,t){var n=$.extend({},M,S(e),t);return n.text=n.tooltipText||e.getAttribute(F+"-text")||e.getAttribute("aria-label"),n.id=e.getAttribute("aria-describedby")||b("tooltip"),k(e,n),n}var C='<div id="<%= id %>" class="tooltip-amsterdam <%= tooltipPosition %> <%= tooltipClassName %> <%= tooltipTheme %>" role="alert"><div class="tooltip-inner"><%= text %></div></div>',x=e.getService("dom"),T=e.getService("templates"),A=!1,I={},O=0,D=e.getGlobal("window"),M={tooltipPosition:"right",tooltipTrigger:"hover focus",tooltipRelative:"body",tooltipClassName:"",tooltipNl2br:!1},P={TOGGLE:"toggle",HIDE:"hide",SHOW:"show"},N="tooltip-active",R=".tooltip-amsterdam",F="data-tooltip",B={right:"left",left:"right",top:"bottom",bottom:"top"},q=10;return{handleEvent:function(e){var t=x.getNearest(e.target,"["+F+"]");if(t){var n=E(t);switch(w(e.type,t,n)){case P.SHOW:this.show(t,n);break;case P.HIDE:this.hide(t,n);break;case P.TOGGLE:this.toggle(t,n);break;default:return}}},show:function(e,t){return y(e,E(e,t))},hide:function(e,t){p(e,E(e,t))},hideAll:function(){h()},toggle:function(e,t){x.hasClass(e,N)?this.hide(e,t):this.show(e,t)}}}),Box.Application.addService("tree-view",function(e){"use strict";function t(){return a?a.cloneNode(!0):(a=l.createFragmentFromHtml('<div class="crawler is-small"><div></div><div></div><div></div></div>'),t())}function n(e,t,n){for(var i,o=[],a=null,s=0;s<e.length;s++)i=new r(e[s],t,n||null),i.previous=a,a&&(a.next=i),o.push(i),a=i;return o}function r(e,t,r){this.id=e[t.params.idName||"id"],this.name=e.name,this.iconClass=e.icon_class,this.expanded=!1,this.selected=!1,e.children?this.children=n(e.children,t,this):this.children=null,this.fetching=!1,this.root=t,this.parent=r,this.previous=null,this.next=null,this.elem=null,this.infoElem=null,this.childrenElem=null,this.expandBtnElem=null,t.registeredNodes[this.id]=this}function i(e){this.events=new Box.EventTarget,this.boundElem=e.boundElem,this.elem=null,this.state=null,this.registeredNodes={},this.params=e,this.currentSelection=null;var t=this;this.setState=function(e){if(t.state=n(e,t),t.elem&&t.boundElem.removeChild(t.elem),t.boundElem.appendChild(t.render()),t.params.selectedNodeID){var r=t.params.selectedNodeID;if(!(r in t.registeredNodes))return;t.registeredNodes[r].setFocus()}}}function o(e,t){for(;!e.getAttribute("data-id");){if(e=e.parentNode,e===t)return null;if(!e||e===document.body)return null}return e.getAttribute("data-id")}var a,s={"tree-view-folder":"folder-plain-svg","tree-view-folder-collab":"folder-collab-svg","tree-view-folder-external":"folder-external-svg"},l=e.getService("dom"),c=e.getService("templates");return r.prototype.render=function(){if(this.elem)return this.elem;var e=document.createElement("li");e.className="tree-view-node",e.setAttribute("role","treeitem"),e.setAttribute("aria-expanded","false"),e.setAttribute("data-id",this.id),e.setAttribute("data-name",this.name),e.appendChild(t()),this.root.params.draggable&&e.setAttribute("draggable","true");var n=this.infoElem=document.createElement("a");if(n.href="#",n.className="tree-view-item",n.setAttribute("data-resin-target","select"),this.iconClass){var r=c.getTemplateFragment(s[this.iconClass]);n.appendChild(r)}var i=document.createElement("span");if(i.setAttribute("title",this.name),l.setText(i,this.name),n.appendChild(i),null===this.children||this.children.length){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("tabindex","-1"),o.className="tree-view-expand",o.title=$t("Toggle Item","tree_view_toggle_item_expanded"),o.setAttribute("data-resin-target","navigate"),this.expandBtnElem=o,e.insertBefore(o,e.firstChild),l.addClass(e,"has-expand-button")}return e.appendChild(n),this.elem=e,this.renderChildren(),e},r.prototype.renderChildren=function(){if(this.children&&this.children.length){var e=document.createElement("ul");e.setAttribute("role","group");for(var t=0;t<this.children.length;t++)e.appendChild(this.children[t].render());this.elem.appendChild(e),this.childrenElem=e}},r.prototype.getLastNode=function(){return this.children&&this.children.length?this.children[this.children.length-1].getLastNode():this},r.prototype.getPrevious=function(){return this.previous?this.previous.expanded?this.previous.getLastNode():this.previous:this.parent||null},r.prototype.getNext=function(e){return!e&&this.expanded&&this.children&&this.children.length?this.children[0]:this.next?this.next:this.parent?this.parent.getNext(!0):null},r.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded)},r.prototype.setExpanded=function(e){if(this.canTryExpanding()){if(e&&null===this.children){if(this.fetching)return;this.fetching=!0,l.addClass(this.elem,"is-loading");var t=this;return void this.root.params.onRequestData(this.id).then(function(r){l.removeClass(t.elem,"is-loading");var i=r.root[0].children;return i&&i.length?(t.children=n(i,t.root,t),t.renderChildren(),void t.setExpanded(e)):void t.setNoChildren()})}this.expanded=e,this.elem.setAttribute("aria-expanded",e?"true":"false")}},r.prototype.setFocus=function(e){e||this.setExpanded(!0),this.parent&&this.parent.setFocus(),this.infoElem.focus()},r.prototype.canTryExpanding=function(){return null===this.children||this.children.length},r.prototype.setNoChildren=function(){this.children=[],this.childrenElem&&this.childrenElem.parentNode.removeChild(this.childrenElem),this.expandBtnElem&&this.expandBtnElem.parentNode.removeChild(this.expandBtnElem),l.removeClass(this.elem,"has-expand-button")},r.prototype.select=function(){if(this.root.params.allowSelect){this.root.currentSelection&&this.root.currentSelection.deselect(),this.selected=!0,l.addClass(this.elem,"is-selected"),this.root.currentSelection=this;var e={id:this.id,name:this.name};this.root.events.fire("select",e)}},r.prototype.deselect=function(){this.selected=!1,l.removeClass(this.elem,"is-selected")},i.prototype.setFocus=function(e){
var t=this.getNode(e);t&&t.setFocus(!0)},i.prototype.setFocusAndExpand=function(e){var t=this.getNode(e);t&&t.setFocus()},i.prototype.setExpand=function(e){var t=this.getNode(e);t&&t.setExpanded(!0)},i.prototype.getNode=function(e){if(e in this.registeredNodes)return this.registeredNodes[e]},i.prototype.render=function(){var e=document.createElement("ul");e.setAttribute("role","tree");for(var t=0;t<this.state.length;t++)e.appendChild(this.state[t].render());var n=this;return l.on(e,"click",function(e){var t=o(e.target);if(t){var r=n.registeredNodes[t];if("tree-view-expand"===e.target.className)return void r.toggleExpanded();n.events.fire("click",t),n.params.allowSelect&&r.select()}}),l.on(e,"dblclick",function(e){var t=o(e.target);if(t){n.events.fire("dblclick",t);var r=n.getNode(t);n.params.allowSelect&&r.select()}}),l.on(e,"keyup",function(e){var t=o(e.target);if(t){var r,i=n.getNode(t);switch(e.keyCode){case 37:!i.expanded&&i.parent?i.parent.setFocus(!0):i.setExpanded(!1);break;case 39:i.expanded&&i.children&&i.children.length?i.children[0].setFocus(!0):i.setExpanded(!1),i.setExpanded(!0);break;case 38:r=i.getPrevious(),r&&r.setFocus(!0);break;case 40:r=i.getNext(),r&&r.setFocus(!0);break;default:return}e.stopPropagation(),e.preventDefault()}}),l.on(e,"keydown",function(e){switch(e.keyCode){case 37:case 39:case 38:case 40:e.preventDefault()}}),this.elem=e,this.elem},i.prototype.setSelection=function(e,t){if(this.currentSelection&&(this.currentSelection.deselect(),this.currentSelection=null),!(e in this.registeredNodes))throw new Error("Attempting to select item that does not exist in the tree");this.registeredNodes[e].select(),t&&this.setFocus(e)},{create:function(e){return new i(e)},_private:{TreeView:i,TreeNode:r,stateToNodes:n,getTreeNodeFromElement:o}}}),Box.Application.addService("first-login-tutorial",function(e){"use strict";function t(t){var n="tutorial-step-"+t;return e.getService(n)}function n(){return I||(I=e.getGlobalConfig("userId")),"tutorial-"+I}function r(){return I||(I=e.getGlobalConfig("userId")),"tutorial-"+I+"-states"}function i(){var e=r(),t=A.getItem(e);return t||(t="{}",A.setItem(e,t)),JSON.parse(t)}function o(){var e=n(),t=A.getItem(e)||"{}";return JSON.parse(t)}function a(){for(var e=null,t=null,n=o(),r=Object.keys(n),i=0;i<r.length;i++){var a=r[i];if(n[a]===R){e=X[a];break}t||n[a]!==N||(t=X[a])}return e||t}function s(t){var n=Object.keys(t),r=n.filter(function(e){return t[e]!==F});0===r.length&&e.broadcast("tutorialcompleted",{progress:t})}function l(t){if(0!==G.length){var n=Object.keys(t),r=n.filter(function(e){return t[e]!==F}),i=r.every(function(e){return G.indexOf(e)>=0});r.length>0&&i&&e.broadcast("tutorialvisiblestepscompleted")}}function c(t,r){var i=n(),a=o();a[t]=r,A.setItem(i,JSON.stringify(a)),e.broadcast("tutorialprogresschanged",{progress:a}),r===F&&(s(a),l(a))}function u(e){var t=o();t[e]===R&&c(e,N)}function d(e){var t=o();t[e]===N&&c(e,R)}function f(e){var t=o();t[e]!==F&&c(e,F)}function p(){for(var e=o(),t=Object.keys(e),r=0;r<t.length;r++){var i=t[r];e[i]===R&&(e[i]=N)}var a=n();A.setItem(a,JSON.stringify(e))}function m(e){var t=i();t[q]&&t[q]!==!1||e.start()}function h(){m(J),d(J.getName())}function g(){J.stop(),u(J.getName())}function v(e){W.forEach(function(n){var r=t(n).isStepAvailable();e[n]=r?N:B});var r=n();A.setItem(r,JSON.stringify(e))}function y(){var e=n();A.removeItem(e)}function b(e){var r=!1;if(W.forEach(function(n){var i=e[n];if(i!==F){var o=t(n).isStepAvailable();o?i===B&&(e[n]=N):e[n]=B,r||(r=i!==e[n])}}),r){var i=n();A.setItem(i,JSON.stringify(e))}}function _(e){var t=i();t[q]=e;var n=r();A.setItem(n,JSON.stringify(t))}function w(){var e=o(),t=0!==Object.keys(e).length;t?b(e):v(e)}function S(e){var t=o();t[e]!==F&&c(e,F),w(),U.recordAction({target:e+"Completed",action:"programmatic"})}function k(){var t=e.getService("contextual-tooltips");te.addEventListener("popstate",function(){t.hide()})}function E(e){S(e),$&&(J=a(),J&&h())}function C(e){var t={stepName:e};Z.post(j,t,{success:E.bind(this,e),error:function(){var e=$t("Sorry, we couldn't mark the task as completed for now. Please try again.","error_mark_task_completion_failure");ee.error(e)}})}function x(){w(),W.forEach(function(e){var n=t(e);n.setName(e),V?n.setMarkAsPerformedCallback(C.bind(this,e)):n.setMarkAsPerformedCallback(E.bind(this,e)),X[e]=n;var r=n.messagesToListenTo;r.forEach(function(e){Y.hasOwnProperty(e)||(Y[e]=[]),Y[e].push(n)})}),K.forEach(function(e){var n=t(e);n.setName(e);var r=n.messagesToListenTo;r.forEach(function(e){Y.hasOwnProperty(e)||(Y[e]=[]),Y[e].push(n)})}),z.forEach(function(e){f(e)}),$?J=a():p()}var T,A,I,O="upload",D="share",M="collaborate",P="create",N="notstarted",R="started",F="done",B="locked",q="closeButtonClicked",L="experiment_data",j="amsterdam_onboarding_gamifiaction_submit_mark_goal_completed",U=e.getService("resin"),H=!1,$=!0,V=!1,W=[],K=[],z=[],G=[],X={},J=null,Y={},Q=(e.getService("dom"),e.getService("logger")),Z=e.getService("ajax"),ee=e.getService("notifications-amsterdam"),te=e.getGlobal("window");return{init:function(){return H?void Q.sendBatchLog(L,"init_already_initialized",{}):(H=!0,A=e.getGlobal("localStorage"),I=e.getGlobalConfig("userId"),this.canUseTutorialService()?(Q.sendBatchLog(L,"initializing_ftux_for_first_time",{}),x(),J&&h(),void k()):void Q.sendBatchLog(L,"no_local_storage_first_login_tutorial",{}))},destroy:function(){this.canUseTutorialService()&&(y(),J=null)},show:function(){if(H)return void Q.sendBatchLog(L,"show_already_initialized",{});if(H=!0,A=e.getGlobal("localStorage"),I=e.getGlobalConfig("userId"),!this.canUseTutorialService())return void Q.sendBatchLog(L,"show_no_local_storage",{});var t=o(),n=0!==Object.keys(t).length;return n?(Q.sendBatchLog(L,"showing_ftux",{}),void x()):void Q.sendBatchLog(L,"show_progress_not_set",{})},getProgressForCurrentUser:o,onMessageReceived:function(e,t){if("contentrefreshed"===e&&J&&setTimeout(h,100),Y.hasOwnProperty(e)){var n=o();Y[e].forEach(function(r){(r.getName()!==P||r.isTutorialStep()||n[O]!==F)&&(r.getName()===M&&n[D]===F||n[r.getName()]!==F&&r.processMessage(e,t))})}},onInternalMessageReceived:function(e,n){switch(e){case"switchpath":J&&J.stop();var r=t(n.stepName);return void(r&&m(r));case"selectstep":return _(!1),J&&g(),J=X[n.stepName],U.recordAction({target:n.stepName+"Started",action:"programmatic"}),void(J&&h());case"markasperformed":return void S(n.stepName);case"stopstep":return g(),U.recordAction({target:J.getName()+"Stopped",action:"programmatic"}),void _(!0)}},canUseTutorialService:function(){if(A||(A=e.getGlobal("localStorage")),"undefined"==typeof T)try{A.setItem("testKey","testValue"),A.removeItem("testKey"),T=!0}catch(e){T=!1}return T},setConfig:function(e,t,n,r,i,o){W=e.slice(),K=t.slice(),z=n.slice(),G=r.slice(),$=i,V=o}}}),Box.Application.addService("contextual-tooltips",function(e){"use strict";function t(e){if(!e.tooltipHeaderMessage)throw new Error("[Contextual Tip] Should always pass a header message!");return M++,e.id=y+M,e.radarID=b+M,e.tooltipBodyMessage||(e.tooltipShowBodyMessageClassName=""),$.extend({},S,e)}function n(){f&&(A.remove(f),f=void 0,p=void 0,m=void 0),h&&(A.remove(h),h=void 0)}function r(){n(),A.off(O,"scroll",r)}function i(e,t){var n=A.getBoundingClientRect(f),r=A.getBoundingClientRect(e),i=$(document).scrollTop();switch(t.tooltipPosition){case"top":f.style.left=r.left-E-k+Math.floor(r.width/2)+"px",f.style.top=r.top+r.height+x+i+"px";break;case"right":f.style.left=r.left-n.width-x+"px",f.style.top=r.top+i+Math.floor(r.height/2)-C-k+"px";break;case"top-right":f.style.left=r.right-n.width+"px",f.style.top=r.top+r.height+x+i+"px";break;case"left":f.style.left=r.right+x+"px",f.style.top=r.top+i+Math.floor(r.height/2)-C-k+"px"}}function o(){p&&m&&i(p,m)}function a(e,t){var n=$(document).scrollTop();!t.radarPosition&&h&&(h.parentNode.removeChild(h),h=null);var r=A.getBoundingClientRect(e);switch(t.radarPosition){case"left":h.style.left=r.left-T+"px",h.style.top=r.top+n+Math.floor(r.height/2)+"px";break;case"right":h.style.left=r.right+"px",h.style.top=r.top+n+Math.floor(r.height/2)+"px"}}function s(){O=e.getGlobal("document"),A.on(O,"scroll",r)}function l(){A.on(D,"resize",o)}function c(e,n){var r=A.query('[data-module="first-login-tutorial"]'),o=t(n),c=I.createTemplateFragment(_,o),u=I.createTemplateFragment(w,o),d=c.querySelector(".tip-message-body");d.innerHTML=o.tooltipBodyMessage,r.appendChild(c),r.appendChild(u),f=A.query("#"+o.id,r),p=e,m=n,h=A.query("#"+o.radarID,r),i(e,n),a(e,n),s(),l()}function u(e,t){g=e,v=t}function d(){g=void 0,v=void 0}var f,p,m,h,g,v,y="contextual_tip_",b="radar_",_='<div data-resin-component="ftuxTooltip" id="<%= id %>" class="contextual-tip <%= tooltipPosition %> <%= tooltipShowBodyMessageClassName %>" role="tooltip"><div class="tip-inner"><div class="tip-pointer"></div><div class="tip-inner-header"><button class="btn-plain btn-minimize-maximize" data-resin-target="<%= stepName %>TooltipClosed" data-type="close-tip"aria-label="'+$t("Hide the Tip","contextual_tip_hide_the_tip")+'">✖</button><div class="tip-message-header" title="<%= tooltipHeaderMessage %>"><%= tooltipHeaderMessage %></div></div><div class="tip-message-body"><%= tooltipBodyMessage %></div></div></div>',w='<div id="<%= radarID %>" class="learn-by-doing-radar <%= radarPosition %>"><div class="learn-by-doing-dot"></div><div class="learn-by-doing-circle"></div></div>',S={tooltipPosition:"left",radarPosition:"right",tooltipShowBodyMessageClassName:"has-body"},k=10,E=20,C=20,x=20,T=50,A=e.getService("dom"),I=e.getService("templates"),O=e.getGlobal("document"),D=e.getGlobal("window"),M=0,P=!1;return{show:function(e,t){n(),P?u(e,t):c(e,t)},hide:n,onContextualMessageShown:function(){P=!0,p&&m&&(u(p,m),n())},onContextualMessageClosed:function(){P=!1,setTimeout(function(){g&&v&&(c(g,v),d())},0)},repositionCurrentTip:o}}),Box.Application.addService("tutorial-step-collaborate",function(e){"use strict";function t(e,t,n,r){x.show(e,{tooltipPosition:n,tooltipHeaderMessage:t.headerMessage,tooltipBodyMessage:t.bodyMessage||"",radarPosition:r,stepName:"collaborate"})}function n(t){t.stopPropagation(),x.hide(),T.off(m,"click",n),e.broadcast("switchpath",{stepName:"share"})}function r(){x.hide(),T.off(A,"click",r),T.off(f,"click",r),T.off(p,"click",r),T.off(m,"click",n),T.off(v,"click",r),T.off(b,"click",r),T.off(_,"click",r),T.off(w,"click",r),y&&y.forEach(function(e){T.off(e,"click",r)})}function i(e){return e&&e.clientWidth&&e.clientHeight}function o(){m=T.query(".tip-message-body .btn-plain"),T.on(m,"click",n)}function a(){return clearTimeout(d),p=T.query(k),v=T.query('[data-module="file-list"]'),i(p)?(y=T.queryAll("a.action-bar-breadcrumb-parent"),b=T.query(".tutorial-progress-tracker-title"),_=T.query('[data-type="minimize-maximize"]'),w=T.query(".main-header-profile"),t(p,{headerMessage:$t("Click 'Invite Collaborators' to add teammates","tutorial_step_one_collaborate_header_msg"),bodyMessage:$t("Add your team to your folder so you have one easy-to-manage place to edit, review and discuss work. Or %1go back%2 to share your file or folder with a simple link.","tutorial_step_one_collaborate_body_msg",'<button class="btn btn-plain" data-resin-target="collaborateTooltipGoBackButton">',"</button>&nbsp;")},"right","right"),T.off(f,"click",a),T.on(A,"click",r),T.on(v,"click",r),T.on(f,"click",r),T.on(p,"click",r),T.on(b,"click",r),T.on(_,"click",r),T.on(w,"click",r),y&&y.forEach(function(e){T.on(e,"click",r)}),void o()):void(d=setTimeout(a,500))}function s(){return clearTimeout(d),h=T.query(E),i(h)?(T.addClass(h,S),f=T.query(".btn.file-list-share-toggle",h),T.on(f,"click",a),void f.click()):void(d=setTimeout(s,100))}function l(){clearTimeout(d);var e=T.query(C);return i(e)?(t(e,{headerMessage:$t("Invite your collaborators to this folder by entering their email address.","tutorial_step_two_collaborate_header_msg")},"left"),void T.on(A,"click",r)):void(d=setTimeout(l,1e3))}var c,u,d,f,p,m,h,g,v,y,b,_,w,S="is-hover",k='.file-list-item-actions .menu-option[data-type="open-invite-collab-popup"]',E='.tbl-list-item[data-item-type="folder"]',C=".invite-selector-wrapper .pill-selector-input-wrapper .pill-selector-input",x=e.getService("contextual-tooltips"),T=e.getService("dom"),A=e.getGlobal("document"),I=e.getService("resin");return{messagesToListenTo:["collabchanged","popupopened","newitemadded","contentrefreshed"],isStepAvailable:function(){var e=T.query(E);return i(e)},start:function(){s()},stop:function(){r()},processMessage:function(t,n){switch(t){case"popupopened":setTimeout(l,1500),I.recordAction({target:"collabStepPopupOpened",action:"click"});break;case"newitemadded":g=n.itemTypedId;break;case"collabchanged":e.broadcast("markasperformed",{stepName:"share"}),I.recordAction({target:"collabStepUserEmailAddNewFolder",action:"programmatic"})}},getName:function(){return u},setName:function(e){u=e},setMarkAsPerformedCallback:function(e){c=e}}}),Box.Application.addService("tutorial-step-create",function(e){"use strict";function t(e,t,n,r){S.show(e,{tooltipPosition:n,tooltipHeaderMessage:t.headerMessage,tooltipBodyMessage:t.bodyMessage||"",radarPosition:r,stepName:"create"})}function n(t){t.preventDefault(),S.hide(),k.off(f,"click",n),k.off(d,"click",n),e.broadcast("switchpath",{stepName:"upload"})}function r(){S.hide(),k.off(f,"click",n),k.off(d,"click",n),k.off(E,"click",r),k.off(u,"click",r),k.off(g,"click",r),k.off(y,"click",r),k.off(b,"click",r),k.off(_,"click",r),v&&v.forEach(function(e){k.off(e,"click",r)})}function i(e){e.keyCode===w&&(r(),C.recordAction({target:"createEscKeyTooltipMinimized",action:"keypress"}),k.off(E,"keyup",i))}function o(e){return e&&e.clientWidth&&e.clientHeight}function a(){d=k.query(".action-bar-create-buttons .upload-menu-btn"),f=k.query(".tip-message-body .btn-plain"),k.on(f,"click",n),k.on(d,"click",n)}function s(){clearTimeout(h);var e=k.query('.action-bar-buttons [data-type="new-folder"]');return g=k.query('[data-module="file-list"]'),v=k.queryAll("a.action-bar-breadcrumb-parent"),o(e)?(y=k.query(".tutorial-progress-tracker-title"),b=k.query('[data-type="minimize-maximize"]'),_=k.query(".main-header-profile"),t(e,{headerMessage:$t("Click 'Folder' to create a new folder","tutorial_step_one_create_header_msg"),bodyMessage:$t("Treat your folder like a workspace that you can share or keep private. Or %1go back%2 to upload you files and folders instead.","tutorial_step_one_create_body_msg",'<button class="btn btn-plain" data-resin-target="createTooltipGoBackButton">',"</button>&nbsp;")},"right","right"),k.on(E,"click",r),k.on(u,"click",r),k.on(g,"click",r),k.off(u,"click",s),k.on(y,"click",r),k.on(b,"click",r),k.on(_,"click",r),v&&v.forEach(function(e){k.on(e,"click",r)}),void a()):void(h=setTimeout(s,500))}function l(){return clearTimeout(h),u=k.query('.action-bar-create-buttons .btn[aria-owns="menu-newdropdown"]'),o(u)?(k.on(u,"click",s),void u.click()):void(h=setTimeout(l,500))}function c(){var e=k.query('.new-folder-popup input[name="folderName"]');return o(e)?void setTimeout(function(){t(e,{headerMessage:$t("Your first workspace on Box! Give it a name and add collaborators if you want to share this workspace.","tutorial_step_two_create_header_msg")},"left"),k.on(E,"click",r),k.on(E,"keyup",i)},500):void(h=setTimeout(c,500))}var u,d,f,p,m,h,g,v,y,b,_,w=27,S=e.getService("contextual-tooltips"),k=e.getService("dom"),E=e.getGlobal("document"),C=e.getService("resin");return{messagesToListenTo:["newitemadded","popupopened"],isAvailable:function(){var e=k.query('.action-bar-buttons [data-type="new-folder"]');return o(e)},isStepAvailable:function(){return u=k.query('.action-bar-create-buttons .btn[aria-owns="menu-newdropdown"]'),o(u)},isTutorialStep:function(){var e=k.query('.tutorial-step[data-step="create"]');return o(e)},start:function(){l()},stop:function(){r()},processMessage:function(t,n){"popupopened"===t&&(c(),C.recordAction({target:"secondaryOpenCreateFolderPopup",action:"click"})),"newitemadded"===t&&(this.isTutorialStep()?p():e.broadcast("setstepcompleteflag"),n.itemTypedId&&n.itemTypedId.indexOf("d")!==-1?C.recordAction({target:"secondaryCompletedCreateFolder",action:"programmatic"}):C.recordAction({target:"secondaryCompletedCreateDocument",action:"programmatic"}))},getName:function(){return m},setName:function(e){m=e},setMarkAsPerformedCallback:function(e){p=e}}}),Box.Application.addService("tutorial-step-download-bfd",function(e){"use strict";function t(){var t=e.getService("contextual-message");t.createMessageRepresentationWithContext(i,o,null).setIsTriggeredByUserAction(!1).show()}var n,r,i="web_trial_box_drive",o="modal",a=e.getService("resin");return{messagesToListenTo:["bfdinstalled"],isStepAvailable:function(){return!0},start:function(){t()},stop:function(){},processMessage:function(e){switch(e){case"bfdinstalled":n(),a.recordAction({target:"downloadbfdfinished",action:"programmatic"})}},getName:function(){return r},setName:function(e){r=e},setMarkAsPerformedCallback:function(e){n=e}}}),Box.Application.addService("tutorial-step-preview",function(e){"use strict";function t(e){return e&&e.clientWidth&&e.clientHeight}function n(e,t,n,r){v.show(e,{tooltipPosition:n,tooltipHeaderMessage:t.headerMessage,tooltipBodyMessage:t.bodyMessage||"",radarPosition:r,stepName:"preview"})}function r(){v.hide(),y.off(b,"click",r),y.off(a,"click",r),y.off(u,"click",r),y.off(f,"click",r),y.off(p,"click",r),y.off(m,"click",r),y.off(h,"click",r),d&&d.forEach(function(e){y.off(e,"click",r)})}function i(){clearTimeout(c);var e=y.query("body.is-preview-visible .preview-close-btn");return t(e)?(f=y.query(".preview-header-left"),void setTimeout(function(){n(e,{headerMessage:$t("Exit Preview mode by clicking %1 button","tutorial_step_two_preview_header_msg","✕")},"top-right"),a=e,y.on(e,"click",r),y.on(b,"click",r),y.on(f,"click",r)},500)):void(c=setTimeout(i,500))}function o(){if(!y.query("body.is-preview-visible")){var e=y.query('.tbl-list-item[data-item-type="file"] .item-name-link');if(u=y.query('[data-module="file-list"]'),d=y.queryAll("a.action-bar-breadcrumb-parent"),!t(e))return void(c=setTimeout(o,500));p=y.query(".tutorial-progress-tracker-title"),m=y.query('[data-type="minimize-maximize"]'),h=y.query(".main-header-profile"),n(e,{headerMessage:$t("Click the file name to preview","tutorial_step_one_preview_header_msg"),bodyMessage:$t("Access and view almost any type of file &mdash; including Powerpoint, PDF and photos &mdash; without downloading.","tutorial_step_one_preview_bonus_msg")},"top","left"),a=e,y.on(b,"click",r),y.on(u,"click",r),y.on(e,"click",r),y.on(p,"click",r),y.on(m,"click",r),y.on(h,"click",r),d&&d.forEach(function(e){y.on(e,"click",r)})}}var a,s,l,c,u,d,f,p,m,h,g=".file-list-empty",v=e.getService("contextual-tooltips"),y=e.getService("dom"),b=e.getGlobal("document"),_=e.getService("resin");return{messagesToListenTo:["previewopen","previewclose"],isStepAvailable:function(){var e=y.query(g,u);return!t(e)},start:function(){o()},stop:function(){r()},processMessage:function(e,t){return"previewopen"===e?(i(),void _.recordAction({target:"previewStepFileOpen",action:"programmatic"})):"previewclose"===e?(s(),void _.recordAction({target:"previewStepFileClosed",action:"programmatic"})):void 0},getName:function(){return l},setName:function(e){l=e},setMarkAsPerformedCallback:function(e){s=e}}}),Box.Application.addService("tutorial-step-share",function(e){"use strict";function t(e){return e&&e.clientWidth&&e.clientHeight}function n(e,t,n,r){F.show(e,{tooltipPosition:n,tooltipHeaderMessage:t.headerMessage,tooltipBodyMessage:t.bodyMessage||"",radarPosition:r,stepName:"share"})}function r(){S=B.query('.tbl-list-item[data-item-type="file"]'),S&&B.removeClass(S,M),B.off(m,"click",r)}function i(t){t.stopPropagation(),F.hide(),B.off(w,"click",i),e.broadcast("switchpath",{stepName:"collaborate"})}function o(){F.hide(),B.off(q,"click",o),B.off(_,"click",o),B.off(b,"click",o),B.off(k,"click",o),B.off(w,"click",i),B.off(C,"click",o),B.off(x,"click",o),B.off(I,"click",o),B.off(O,"click",o),B.off(D,"click",o),T&&T.forEach(function(e){B.off(e,"click",o)})}function a(){B.off(E,"click",a),A=!0}function s(e){e.keyCode===R&&(o(),L.recordAction({target:"shareEscKeyTooltipMinimized",action:"keypress"}),B.off(q,"keyup",s))}function l(){return clearTimeout(y),x=B.query(N),E=B.query(P),t(x)?(v=B.query(".popup-contents .popup-share-link"),void setTimeout(function(){n(x,{headerMessage:$t("Share this file with coworkers by entering their email addresses.","tutorial_step_two_share_header_msg_file")},"left"),B.on(q,"click",o),B.on(x,"click",o),B.on(E,"click",a),B.on(q,"keyup",s)},500)):void(y=setTimeout(l,500))}function c(){return clearTimeout(y),x=B.query(N),E=B.query(P),t(x)?(v=B.query(".popup-contents .popup-share-link"),void setTimeout(function(){n(x,{headerMessage:$t("Share this folder with coworkers by entering their email addresses.","tutorial_step_two_share_header_msg_folder")},"left"),B.on(q,"click",o),B.on(x,"click",o),B.on(E,"click",a),B.on(q,"keyup",s)},500)):void(y=setTimeout(c,500))}function u(){w=B.query(".tip-message-body .btn-plain"),B.on(w,"click",i)}function d(){return clearTimeout(y),b=B.query('.file-list-item-actions .menu-option[data-type="share-btn"]'),C=B.query('[data-module="file-list"]'),k=B.query('.file-list-item-actions .menu-option[data-type="open-invite-collab-popup"]'),t(b)?(I=B.query(".tutorial-progress-tracker-title"),O=B.query('[data-type="minimize-maximize"]'),D=B.query(".main-header-profile"),n(b,{headerMessage:$t("Click 'Get Shared Link' to send your folder","tutorial_step_one_share_header_msg_folder"),bodyMessage:$t("Say goodbye to email attachements! Easily share a large file or folder with a simple link via email. Or %1invite%2 your team to view and edit files in your folder.","tutorial_step_one_share_body_msg",'<button class="btn btn-plain">',"</button>&nbsp;")},"right","right"),B.off(_,"click",d),B.on(q,"click",o),B.on(C,"click",o),B.on(_,"click",o),B.on(b,"click",o),B.on(k,"click",o),B.on(I,"click",o),B.on(O,"click",o),B.on(D,"click",o),void u()):void(y=setTimeout(d,500))}function f(){clearTimeout(y);var e=B.query('.tbl-list-item[data-item-type="folder"]');if(e){if(!t(e))return void(y=setTimeout(f,100));B.addClass(e,M),_=B.query(".btn.file-list-share-toggle",e),B.on(_,"click",d),_.click()}}function p(){if(clearTimeout(y),S=B.query('.tbl-list-item[data-item-type="file"]'),C=B.query('[data-module="file-list"]'),!S)return void f();if(!t(S))return void(y=setTimeout(p,100));I=B.query(".tutorial-progress-tracker-title"),O=B.query('[data-type="minimize-maximize"]'),D=B.query(".main-header-profile"),B.addClass(S,M);var e=B.query(".file-list-item-share",S);T=B.queryAll("a.action-bar-breadcrumb-parent"),n(e,{headerMessage:$t("Click 'Share' to send your file","tutorial_step_one_share_header_msg_file"),bodyMessage:$t("Say goodbye to email attachments! Easily share a large file or folder with a simple link via email.","tutorial_step_one_share_body_msg")},"top-right","right"),m=e,B.on(e,"click",o),B.on(q,"click",o),B.on(C,"click",o),B.on(e,"click",r),B.on(I,"click",o),B.on(O,"click",o),B.on(D,"click",o),T&&T.forEach(function(e){B.on(e,"click",o)})}var m,h,g,v,y,b,_,w,S,k,E,C,x,T,A,I,O,D,M="is-hover",P=".popup-share-link .link-spinner-container .copy-text-trigger",N=".popup-contents .popup-share-link .pill-selector-input",R=27,F=e.getService("contextual-tooltips"),B=e.getService("dom"),q=e.getGlobal("document"),L=e.getService("resin");return{messagesToListenTo:["popupopened","sharelinkvalidemailentered","sharedlinkemailsent","popupclosed"],isStepAvailable:function(){var e=B.query('.tbl-list-item[data-item-type="file"]'),n=B.query('.tbl-list-item[data-item-type="folder"]');return t(e)||t(n)},start:function(){p()},stop:function(){r(),o()},processMessage:function(e,t){switch(e){case"popupopened":S?l():c(),L.recordAction({target:"secondaryOpenInviteCollabPopup",action:"click"});break;case"sharedlinkemailsent":o(),h(),L.recordAction({target:"secondaryInviteCollabEmailSent",action:"programmatic"});break;case"popupclosed":A&&h(),A=!1}},getName:function(){return g},setName:function(e){g=e},setMarkAsPerformedCallback:function(e){h=e}}}),Box.Application.addService("tutorial-step-upload",function(e){"use strict";function t(e){return e&&e.clientWidth&&e.clientHeight}function n(e,t,n,r){_.show(e,{tooltipPosition:n,tooltipHeaderMessage:t.headerMessage,tooltipBodyMessage:t.bodyMessage||"",radarPosition:r,stepName:"upload"})}function r(t){t.preventDefault(),_.hide(),w.off(f,"click",r),w.off(p,"click",r),e.broadcast("switchpath",{stepName:"create"})}function i(e){_.hide(),w.off(f,"click",r),w.off(p,"click",r),w.off(l,"click",i),w.off(S,"click",i),w.off(h,"click",i),w.off(v,"click",i),w.off(y,"click",i),w.off(b,"click",i),g&&g.forEach(function(e){w.off(e,"click",i)})}function o(){f=w.query('.action-bar-create-buttons .btn[aria-owns="menu-newdropdown"]'),p=w.query(".tip-message-body .btn-plain"),w.on(f,"click",r),w.on(p,"click",r)}function a(){clearTimeout(d);var e=w.query(".action-bar-create-buttons .upload-file-handler-target");return h=w.query('[data-module="file-list"]'),t(e)?(g=w.queryAll("a.action-bar-breadcrumb-parent"),v=w.query(".tutorial-progress-tracker-title"),y=w.query('[data-type="minimize-maximize"]'),b=w.query(".main-header-profile"),n(e,{headerMessage:$t("Click 'Files' or 'Folder' to upload content","tutorial_step_one_upload_header_msg"),bodyMessage:$t("Never lose your files again with everything safely stored in Box. Or %1create%2 a folder to keep all your files organized.","tutorial_step_one_upload_body_msg",'<button class="btn btn-plain" data-resin-target="uploadTooltipCreateButton">',"</button>&nbsp;")},"right","right"),w.off(l,"click",a),w.on(S,"click",i),w.on(l,"click",i),w.on(h,"click",i),w.on(v,"click",i),w.on(y,"click",i),w.on(b,"click",i),g&&g.forEach(function(e){w.on(e,"click",i)}),void o()):void(d=setTimeout(a,500))}function s(){return clearTimeout(d),l=w.query(".action-bar-create-buttons .upload-menu-btn"),t(l)?(w.on(l,"click",a),void l.click()):void(d=setTimeout(s,500))}var l,c,u,d,f,p,m,h,g,v,y,b,_=e.getService("contextual-tooltips"),w=e.getService("dom"),S=e.getGlobal("document"),k=e.getService("resin");return{messagesToListenTo:["fileuploadsuccess","filelistitemadded","setstepcompleteflag","contentrefreshed"],isStepAvailable:function(){var e=w.query(".action-bar-create-buttons .upload-menu-btn");return t(e)},start:function(){s()},stop:function(){i(),w.off(l,"click",a)},processMessage:function(e,t){switch(e){case"fileuploadsuccess":m=!0,k.recordAction({target:"uploadStepFileUploadSuccess",action:"programmatic"});break;case"contentrefreshed":case"filelistitemadded":m===!0&&c();break;case"setstepcompleteflag":m=!0}},getName:function(){return u},setName:function(e){u=e},setMarkAsPerformedCallback:function(e){c=e}}}),Box.Application.addService("tutorial-step-send-mobile-link",function(e){"use strict";function t(){var t=e.getService("contextual-message");t.createMessageRepresentationWithContext(i,o,"page_all_files").setIsTriggeredByUserAction(!1).show()}var n,r,i="web_trial_goals_finished",o="modal",a=e.getService("resin");return{messagesToListenTo:["mobilelinksentinwebtrialmodal"],isStepAvailable:function(){return!0},start:function(){t()},stop:function(){},processMessage:function(e){switch(e){case"mobilelinksentinwebtrialmodal":n(),a.recordAction({target:"sendmobilelinkfinished",action:"programmatic"})}},getName:function(){return r},setName:function(e){r=e},setMarkAsPerformedCallback:function(e){n=e}}}),Box.Application.addService("uploads-hierarchy",function(e){"use strict";function t(e){this.file=function(t){return t(e)},this.name=e.name}function n(e){this.name=e,this.folders={},this.typedID=null,this.files=[],this.empty=!0,this.buildPromise=null}function r(e,t){for(var n in e)e.hasOwnProperty(n)&&e[n].upload(t)}function i(e,t,i){for(var o,a,l,c,u={},d=[],f=0;f<e.length;f++)o=e[f],a=t[f],l=(o.webkitGetAsEntry||o.mozGetAsEntry||o.getAsEntry).call(o),l.isFile?d.push(a):l.isDirectory&&(c=new n(l.name),c.build(l),u[l.name]=c);s(d,i),r(u,i)}function o(e,i){var o,a={};Array.prototype.forEach.call(e,function(e){var r=e.webkitRelativePath.split(u).slice(0,-1);if(r.length>0){var i=a;r.forEach(function(a,s){i[a]||(o=new n(a),o.buildPromise=Promise.resolve(),i[a]=o),s===r.length-1?(i[a].files.push(new t(e)),i[a].empty=!1):i=i[a].folders})}}),r(a,i)}function a(t,n){var r=t.map(function(t){return d.create(function(n){t.file(n,function(){n(null),e.broadcast("upload-fail",t.name)})})});return d.all(r).then(function(e){var t=e.filter(function(e){return!!e});s(t,n)})}function s(e,t){var n,r;Array.prototype.forEach.call(e,function(e){n=c(e.name,e.size),n||(r=f.uploadFile(e,t),l(r))})}function l(t){e.broadcast("new-upload",t)}function c(e,t){switch(e){case".DS_Store":case"Thumbs.db":case"desktop.ini":return f.REASON_UNACCEPTABLE_FILE}return null}var u="/",d=e.getService("promises"),f=e.getService("uploads-main"),p=e.getService("uploads-util");return n.prototype.build=function(e){var t=this;this.buildPromise=d.create(function(r){function i(){o.readEntries(function(e){if(!e.length)return void r();t.empty=!1;for(var o,a,s=0;s<e.length;s++)o=e[s],o.isFile?t.files.push(o):(a=new n(o.name),a.build(o),t.folders[o.name]=a);i()},function(){})}var o=e.createReader();i()})},n.prototype.upload=function(e){var t=this;this.buildPromise.then(function(){var n=f.createUploadInstance(t.name,t.name.length,e);l(n),f.createFolder(t.name,e).then(function(e){for(var r in t.folders)t.folders.hasOwnProperty(r)&&t.folders[r].upload(e);a(t.files,e).then(function(){n.setCompleted(e)},n.setFailed)},n.setFailed)})},{uploadIncomingFiles:function(e,t){e.items?i(e.items,e.files,t):e.files[0].webkitRelativePath?o(e.files,t):s(e.files,t)},bindFolderUploadHandler:function(e,t){var n=this;return p.bindUploadHandler(e,function(e){n.uploadIncomingFiles(e,t)},!0,!0)},fileFilter:c}}),Box.Application.addService("uploads-main",function(e){"use strict";function t(e,t){this.html5UploadUrl=e,this.multiputUploadUrl=t}function n(e,t,n,i,o){this.name=e,this.size=t,this.destinationFolder=n,this.destinationFile=i,this.progress=0,this.concurrentHttpRequests=o||1,this.configOverride=T;var a,s,l=this,c=new Box.EventTarget,u=_.create(function(e,t){a=e,s=t});this.cancel=function(){l.setCancelled()},this.on=function(){return c.on.apply(c,arguments)},this.off=function(){return c.off.apply(c,arguments)},this.setProgress=function(e){l.progress=e,c.fire("progress",e)},this.setCompleted=function(e){l.completed=!0,l.progress=100,c.fire("completed",e),a(e)},this.setFailed=function(e,t){e=e||g,l.failed=!0,l.progress=100;var n=r(e);t&&(n={reason:r(e),error:t}),c.fire("error",n),s(e)},this.setCancelled=function(){l.cancelled=!0,l.progress=100,c.fire("cancelled"),s(d)},this.getPromise=function(){return u}}function r(e){switch(e){case d:return $t("Upload cancelled.","upload_failed_cancelled");case f:return $t("Too many uploads are being attempted right now. Please try again later.","upload_failed_rate_limit");case p:return $t("Upload timed out.","upload_failed_timeout");case m:return $t("Item was too large.","upload_failed_too_big");case h:return $t("Item not acceptable.","upload_failed_unacceptable");case u:case g:return $t("Something went wrong with the upload. Please try again.","upload_failed_unknown");default:return e}}function i(e,t,n,r){n+=n.indexOf("?")!==-1?"&":"?";var i={upload_type:"html5",upload_session_id:t,last_modified_date:new Date(e.lastModifiedDate).toUTCString(),request_token:y.requestToken};return r.destinationFolder&&(i.folder_id=S.getUntypedID(r.destinationFolder)),r.fileTypedID&&(i.file_id=S.getUntypedID(r.fileTypedID)),r.protectedParams&&(i.protected_params=r.protectedParams),y.realtimeSubscriberID&&(i.realtime_subscriber_id=y.realtimeSubscriberID),n+=k.encode(i)}function o(e,t,n){e.addEventListener(t,n)}function a(e,t,n,r){var i=new XMLHttpRequest;return o(i,"load",function(){if(413===i.status)return void n.setFailed(m);if(503===i.status)return void n.setFailed(f);
if(i.status<200||i.status>399)return void r();var e;try{e=JSON.parse(i.responseText)}catch(e){return void r()}n.setCompleted("f_"+e.id)}),o(i,"error",r),o(i,"timeout",r),o(i,"abort",function(){n.setCancelled()}),o(i.upload,"error",r),o(i.upload,"progress",function(e){n.setProgress(parseInt(e.loaded,10)/t.size*100)}),i.open("POST",e,!0),i.withCredentials="true",i.setRequestHeader("X-Box","360"),i.setRequestHeader("X-File-Name",encodeURIComponent(t.name)),i.setRequestHeader("X-File-Size",t.size),i.setRequestHeader("Content-Type","application/octet-stream"),i.send(t),i}function s(e,t,n,r){if(!r||"item_name_in_use"!==r.code||e.destinationFile||0!==e.progress)r&&r.data&&r.data.message?e.setFailed(r.data.message):e.setFailed();else{var i=r.context_info,o=i?i.conflicts:null;if(o&&"file"===o.type&&o.id){var a="f_"+o.id;e.destinationFile=a,n.fileTypedID=a,c(e,t,n)}}}function l(e,t,n,r){var i=r.uploadSessionID,o=e.configOverride.multiputUploadUrl||r.urlOptions.multiput_upload_url,a=o+"/"+r.uploadSessionID;if(n.protectedParams){var l={protected_params:n.protectedParams};a+="?"+k.encode(l)}var c=e.destinationFolder?S.getUntypedID(e.destinationFolder):null,u=e.destinationFile?S.getUntypedID(e.destinationFile):null;null!==u&&(c=null);var d=E.createAccessTokenWithExpiration(r.apiToken.access_token,r.apiToken.expires_in),f=E.createMultiputUpload(t,i,a,d,c,u);f.onProgress=function(n){e.setProgress(n/t.size*100)},f.onFailure=s.bind(null,e,t,n),f.onCompleted=function(t){e.setCompleted("f_"+t.id)},e.cancel=function(){f&&f.cancel(),e.setCancelled()},f.createSession()}function c(e,t,n){var r,o=!1;e.cancel=function(){o||r&&r.abort()},S.startUpload(t.name,t.size,e.destinationFolder,e.destinationFile,x).then(function(e){return S.maybeUpdateURLOptionsInData(e,C)}).then(function(s){x=s.urlOptions.external_ip,n.protectedParams=s.urlOptions.protected_params||"";var c=!!s.urlOptions.multiput_upload_url&&!!s.apiToken&&!!s.apiToken.access_token;if(c)return void l(e,t,n,s);w.updateUploadConcurrency(e.concurrentHttpRequests,1),e.concurrentHttpRequests=1;var u=e.configOverride.html5UploadUrl||s.urlOptions.html5_upload_url,d=i(t,s.uploadSessionID,u,n);b.retryNumOfTimes(function(n,i,s){r=a(d,t,e,i),e.getPromise().then(function(){o=!0,n()},function(){s("hard rejected upload")})},v).then(null,function(t){"hard rejected upload"!==t&&e.setFailed()})},function(t){if(S.logStartUploadError(t),t&&t.data&&t.data.message){var n=t.data.error||null;return void e.setFailed(t.data.message,n)}e.setFailed()})}var u="bad_request",d="cancelled",f="rate_limit",p="timeout",m="too_big",h="unacceptable_file",g="unknown",v=2,y=e.getGlobalConfig();y.uploads=y.uploads||{};var b=e.getService("function-utils"),_=e.getService("promises"),w=e.getService("uploads-queueing"),S=e.getService("uploads-util"),k=e.getService("url-amsterdam"),E=e.getService("uploads-multiput"),C=10,x=null,T=new t(null,null);return{configOverride:T,REASON_BAD_REQUEST:u,REASON_CANCELLED:d,REASON_RATE_LIMIT:f,REASON_TIMEOUT:p,REASON_TOO_BIG:m,REASON_UNACCEPTABLE_FILE:h,REASON_UNKNOWN:g,createUploadInstance:function(e,t,r,i){var o=E.config.parallelism,a=new n(e,t,r,i,o);return a},createFolder:function(e,t,n){return S.createFolder(e,t,n)},uploadFile:function(e,t){var n=this.createUploadInstance(e.name,e.size,t);return w.queueUpload(n,function(){c(n,e,{destinationFolder:t})}),n},uploadFileVersion:function(e,t,n){var r=this.createUploadInstance(e.name,e.size,t,n);return w.queueUpload(r,function(){c(r,e,{destinationFolder:t,fileTypedID:n})}),r},bindFileUploadHandler:function(t,n,r){var i=this;return S.bindUploadHandler(t,function(t){var o;if(r)o=i.uploadFileVersion(t.files[0],n,r),e.broadcast("new-upload",o);else if(n)for(var a=0;a<t.files.length;a++)o=i.uploadFile(t.files[a],n),e.broadcast("new-upload",o)},n&&!r)}}}),Box.Application.addService("uploads-multiput",function(e){"use strict";function t(e,t,n,r,i,o,a,s,l,c){this.parallelism=e,this.partSize=t,this.digestReadahead=n,this.retries=r,this.initialRetryDelayMs=i,this.maxRetryDelayMs=o,this.requestTimeout=a,this.console=s,this.refreshTokenPollIntervalMs=l,this.refreshTokenIfTtlLessThanMs=c}function n(e,t){this.accessToken=e,t=t||A;var n=new Date;n.setTime(n.getTime()+1e3*t),this.expiresAt=n}function r(e,t,n){this.index=e,this.offset=t,this.size=n,this.state=m,this.uploadedBytes=0,this.numUploadRetriesPerformed=0,this.numDigestRetriesPerformed=0,this.sha256=null,this.xhr=null,this.timing={}}function i(e,t,n,r,i,s,l){if(null!==i&&null!==s)throw new Error("Both destinationFolder and destinationFile set");this.file=e,this.initialFileSize=this.file.size,this.initialFileLastModified=a.getFileLastModifiedAsISONoMSIfPossible(this.file),this.uploadSessionId=t,this.sessionEndpoints={createSession:n,uploadPart:null,listParts:null,commit:null,abort:null,logEvent:null},this.sessionEndpoints.logEvent=n.replace(/files\/\d+/,"files")+"/log",this.token=r,this.destinationFolder=i?String(i):null,this.destinationFile=s?String(s):null,this.config=l||I,this.fileSha1=null,this.totalUploadedBytes=0,this.partsNotStarted=0,this.partsDigestComputing=0,this.partsDigestReady=0,this.partsUploading=0,this.partsUploaded=0,this.firstUnuploadedPartIndex=0,this.onProgress=null,this.onCompleted=null,this.onFailure=null,this.createSessionNumRetriesPerformed=0,this.createSessionXhr=null,this.partSize=null,this.parts=null,this.commitRetryCount=0,this.commitXhr=null,this.ended=!1,this.worker=o.createWorker(),this.worker.addEventListener("message",this.onWorkerMessage.bind(this)),this.clientId=null}var o=e.getService("uploads-sha1-worker"),a=e.getService("uploads-util"),s=e.getService("url"),l=e.getService("promises"),c=e.getService("function-utils"),u=e.getService("hex-conversion"),d=e.getService("base64-conversion"),f=e.getService("webcrypto"),p=e.getService("file-reader"),m=0,h=2,g=3,v=4,y="commit_conflict",b="create_session_misc_error",_="create_session_retries_exceeded",w="file_changed_during_upload",S="part_upload_retries_exceeded",k="commit_retries_exceeded",E="web_worker_error",C="file_reader_received_not_found_error",x="part_digest_retries_exceeded",T="logged_out",A=3600,I=new t(5,null,5,5,5e3,6e4,12e4,(!1),5e3,12e4);return n.prototype.expiresInMs=function(){var e=new Date;return this.expiresAt.getTime()-e.getTime()},i.prototype.getClientId=function(){return this.clientId||(this.clientId=u.byteArrayToHex(f.getRandomValues(new Uint8Array(8)))),this.clientId},i.prototype.createSession=function(){if(!this.ended){var e={file_size:this.file.size,file_name:this.file.name};this.destinationFolder&&(e.folder_id=this.destinationFolder),this.config.partSize&&(e.part_size=this.config.partSize),this.createSessionXhr=this.createXhr("POST",this.sessionEndpoints.createSession,this.createSessionLoaded.bind(this),this.handleCreateSessionError.bind(this));var t={client_id:this.getClientId()};this.createSessionXhr.setRequestHeader("X-Box-Client-Event-Info",JSON.stringify(t)),this.createSessionXhr.send(JSON.stringify(e))}},i.prototype.createSessionLoaded=function(){if(!this.ended)try{var e=this.createSessionXhr.status;if(201===e)this.createSessionSuccess(JSON.parse(this.createSessionXhr.responseText));else if(e>=500&&e<600)this.handleCreateSessionError();else{var t=a.tryParseJson(this.createSessionXhr.responseText),n=t?t.code:null;if(409===e&&"session_conflict"===n)return void this.createSessionSuccess(t.context_info.session);if(403===e&&"storage_limit_exceeded"===n||403===e&&"access_denied_insufficient_permissions"===n||409===e&&"item_name_in_use"===n)return void this.callFailureCallbackIfExists(t);this.sessionFailed(t,b,JSON.stringify({status:e,response:t}))}}catch(e){this.sessionFailed(null,b,this.formatErrorForLogEvent(e))}},i.prototype.failSessionIfFileChangeDetected=function(){var e=this.file.size,t=a.getFileLastModifiedAsISONoMSIfPossible(this.file);return(e!==this.initialFileSize||t!==this.initialFileLastModified)&&(this.sessionFailed(null,w,JSON.stringify({oldSize:this.initialFileSize,newSize:e,oldLastModified:this.initialFileLastModified,newLastModified:t})),!0)},i.prototype.createSessionSuccess=function(e){this.partSize=e.part_size;var t=e.session_endpoints;this.sessionEndpoints.uploadPart=t.upload_part,this.sessionEndpoints.listParts=t.list_parts,this.sessionEndpoints.commit=t.commit,this.sessionEndpoints.abort=t.abort,this.sessionEndpoints.logEvent=t.log_event,this.populateParts(),this.processNextParts(),this.scheduleTokenRefresh()},i.prototype.handleCreateSessionError=function(){if(!this.ended){if(this.createSessionNumRetriesPerformed>=this.config.retries){this.consoleLog("Too many create session failures, failing upload");var e=a.tryParseJson(this.createSessionXhr.responseText);this.sessionFailed(e,_,JSON.stringify({status:this.createSessionXhr.status,response:e}))}else this.createSessionRetry();this.createSessionXhr=null}},i.prototype.createSessionRetry=function(){this.createSessionXhr=null;var e=this.getBoundedExpBackoffRetryDelay(this.config.initialRetryDelayMs,this.config.maxRetryDelayMs,this.createSessionNumRetriesPerformed);this.createSessionNumRetriesPerformed++,this.consoleLog("Retrying create session in "+e+" ms"),setTimeout(this.createSession.bind(this),e)},i.prototype.populateParts=function(){this.partsNotStarted=Math.ceil(this.file.size/this.partSize),this.parts=[];for(var e=0;e<this.partsNotStarted;++e){var t=e*this.partSize,n=new r(e,t,Math.min(t+this.partSize,this.file.size)-t);this.parts.push(n)}},i.prototype.processNextParts=function(){if(!this.failSessionIfFileChangeDetected()){if(this.partsUploaded===this.parts.length&&this.fileSha1)return void this.commitSession();for(this.updateFirstUnuploadedPartIndex();this.canStartMorePartUploads();)this.uploadNextPart();this.shouldComputeDigestForNextPart()&&this.computeDigestForNextPart()}},i.prototype.updateFirstUnuploadedPartIndex=function(){for(var e=this.firstUnuploadedPartIndex;e<this.parts.length;++e){var t=this.parts[e];if(e!==this.firstUnuploadedPartIndex||t.state!==v)break;this.firstUnuploadedPartIndex=e+1}},i.prototype.canStartMorePartUploads=function(){return!this.ended&&this.partsUploading<this.config.parallelism&&this.partsDigestReady>0},i.prototype.uploadNextPart=function(){for(var e=this.firstUnuploadedPartIndex;e<this.parts.length;e++){var t=this.parts[e];if(t.state===h){this.partsDigestReady--,this.partsUploading++,this.uploadPart(t);break}}},i.prototype.shouldComputeDigestForNextPart=function(){return!this.ended&&0===this.partsDigestComputing&&this.partsNotStarted>0&&this.partsDigestReady<this.config.digestReadahead},i.prototype.computeDigestForNextPart=function(){for(var e=this.firstUnuploadedPartIndex;e<this.parts.length;e++){var t=this.parts[e];if(t.state===m){this.partsNotStarted--,this.partsDigestComputing++,this.computeDigestForPart(t);break}}},i.prototype.computeDigestForPart=function(e){var t,n=this.file.slice(e.offset,e.offset+e.size),r=p.createFileReader(),i=Date.now(),o=l.create(function(e,i){r.readAsArrayBuffer(n),r.onload=function(){t=Date.now(),e(r.result)},r.onerror=function(e){i(e)}}),a=o.then(function(e){return f.digest("SHA-256",e)});return l.all([o,a]).spread(function(n,r){this.sendPartToWorker(e,n),e.sha256=r,e.state=h,this.partsDigestReady++;var o=Date.now();e.timing={partDigestTime:o-i,readTime:t-i,subtleCryptoTime:o-t},this.processNextParts()}.bind(this)).catch(this.onPartDigestError.bind(this,e))},i.prototype.onPartDigestError=function(e,t){if(this.consoleLogFunc(function(){return"Error computing digest for part "+JSON.stringify(e)+": "+JSON.stringify(t)}),"NotFoundError"===t.name||"NOT_FOUND_ERR"===t.name)return void this.sessionFailed(null,C,JSON.stringify(t));if(!this.failSessionIfFileChangeDetected()){if(e.numDigestRetriesPerformed>=this.config.retries)return void this.sessionFailed(null,x,JSON.stringify(t));var n=this.getBoundedExpBackoffRetryDelay(this.config.initialRetryDelayMs,this.config.maxRetryDelayMs,e.numDigestRetriesPerformed);e.numDigestRetriesPerformed++,this.consoleLogFunc(function(){return"Retrying digest work for part "+JSON.stringify(e)+" in "+n+" ms"}),setTimeout(this.computeDigestForPart.bind(this,e),n)}},i.prototype.uploadPart=function(e){if(!this.ended){e.state=g,this.updateProgress(e,0),this.consoleLogFunc(function(){return"Uploading part "+JSON.stringify(e)+" Parts state: "+this.partsStateForLog()}.bind(this));var t=Date.now();e.xhr=this.createXhr("PUT",this.sessionEndpoints.uploadPart,function(){e.timing.uploadTime=Date.now()-t,this.partUploadLoaded(e)}.bind(this),this.partUploadError.bind(this,e,"XHR error"),function(t){this.updateProgress(e,parseInt(t.loaded,10))});var n=d.byteArrayToBase64(new Uint8Array(e.sha256));e.xhr.setRequestHeader("Digest","sha-256="+n);var r="bytes "+e.offset+"-"+(e.offset+e.size-1)+"/"+this.file.size;e.xhr.setRequestHeader("Content-Range",r);var i={documentHidden:document.hidden,digest_retries:e.numDigestRetriesPerformed,timing:e.timing,parts_uploading:this.partsUploading};e.xhr.setRequestHeader("X-Box-Client-Event-Info",JSON.stringify(i));var o=this.file.slice(e.offset,e.offset+e.size,"application/octet-stream");e.xhr.timeout=0,a.xhrSendWithIdleTimeout(e.xhr,o,this.config.requestTimeout,this.partUploadError.bind(this,e,"idle timeout"))}},i.prototype.partUploadLoaded=function(e){if(e.xhr&&!this.ended){var t=!1;if(200===e.xhr.status)try{var n=JSON.parse(e.xhr.responseText).part;n.part_id&&(e.id=n.part_id,t=!0)}catch(t){this.consoleLog("Unable to extract part ID from response: "+e.xhr.responseText)}else if(416===e.xhr.status)try{var r=JSON.parse(e.xhr.responseText);if(r&&"range_overlaps_existing_part"===r.code&&r.context_info){var i=r.context_info.conflicting_part;i&&i.offset===e.offset&&i.size===e.size&&i.part_id&&(this.consoleLog("Recovering from conflicting part, id="+i.part_id),e.id=i.part_id,t=!0)}}catch(e){}t?this.partUploadSuccess(e):this.partUploadError(e,e.xhr.status+" status")}},i.prototype.partUploadSuccess=function(e){this.partsUploading--,this.partsUploaded++,e.state=v,e.xhr=null,this.updateProgress(e,e.size),this.consoleLogFunc(function(){return"Upload completed: "+JSON.stringify(e)+". Parts state: "+this.partsStateForLog()}.bind(this)),this.processNextParts()},i.prototype.partUploadError=function(e,t){if(e.xhr&&!this.ended){this.consoleLogFunc(function(){return"Upload failure "+t+" for part "+JSON.stringify(e)+". XHR state: "+e.xhr.readyState+". Parts state "+this.partsStateForLog()}.bind(this));var n={messsage:t,part:{uploadedBytes:e.uploadedBytes,id:e.id,index:e.index,offset:e.offset},xhr_ready_state:e.xhr.readyState,xhr_status_text:e.xhr.statusText};if(this.logEvent("part_failure",JSON.stringify(n)),e.xhr=null,e.numUploadRetriesPerformed>=this.config.retries)this.sessionFailed(null,S,JSON.stringify(n));else{var r=this.getBoundedExpBackoffRetryDelay(this.config.initialRetryDelayMs,this.config.maxRetryDelayMs,e.numUploadRetriesPerformed);e.numUploadRetriesPerformed++,this.consoleLog("Retrying uploading part "+JSON.stringify(e)+" in "+r+" ms"),setTimeout(this.uploadPartRetry.bind(this,e),r)}}},i.prototype.uploadPartRetry=function(e){if(!this.ended){var t=JSON.stringify(e);e.uploadedBytes<e.size?(e.numRetriesPerformed++,this.uploadPart(e)):this.listParts(e.index,1).then(function(n){this.consoleLog("Parts listed: "+JSON.stringify(n)),n&&1===n.length&&n[0].offset===e.offset&&n[0].part_id?(this.consoleLog("Part "+t+" is available on server. Not re-uploading."),e.id=n[0].part_id,this.partUploadSuccess(e)):(this.consoleLog("Part "+t+" is not available on server. Re-uploading."),e.numRetriesPerformed++,this.uploadPart(e))}.bind(this)).catch(function(n){n&&n.status&&this.consoleLog("Error "+n.status+" while listing part "+t+". Re-uploading."),e.numRetriesPerformed++,this.uploadPart(e)}.bind(this))}},i.prototype.listParts=function(e,t){var n={};"number"==typeof e&&(n.offset=e),"number"==typeof t&&(n.limit=t);var r=s.updateQueryStringParameters(this.sessionEndpoints.listParts,n);return l.create(function(e,t){var n=this.createXhr("GET",r,function(){if(200===n.status){var r;try{r=JSON.parse(n.responseText)}catch(e){return this.consoleLog("Error while parsing list API response: "+n.responseText),void t({statusText:"Error while parsing list API response"})}e(r.entries)}else t({status:n.status,statusText:n.statusText})},function(){t({status:n.status,statusText:n.statusText})});n.send(null)}.bind(this))},i.prototype.updateProgress=function(e,t){this.ended||(this.totalUploadedBytes+=t-e.uploadedBytes,e.uploadedBytes=t,this.onProgress&&this.onProgress(this.totalUploadedBytes))},i.prototype.onWorkerMessage=function(e){if(!this.ended){var t=e.data;if("partDone"===t.type){this.partsDigestComputing--;var n=t.part;this.parts[n.index].timing.fileDigestTime=t.duration,this.processNextParts()}else"done"===t.type?(this.fileSha1=t.sha1,this.worker.terminate(),this.partsUploaded===this.parts.length&&this.commitSession()):"error"===t.type&&this.onWorkerError(t)}},i.prototype.onWorkerError=function(e){this.sessionFailed(null,E,JSON.stringify(e))},i.prototype.sendPartToWorker=function(e,t){if(!this.ended){var n={index:e.index,offset:e.offset,size:e.size};this.worker.postMessage({part:n,fileSize:this.file.size,partContents:t},[t]),this.consoleLogFunc(function(){return"Part sent to worker: "+JSON.stringify(e)+". Parts state: "+this.partsStateForLog()}.bind(this))}},i.prototype.commitSession=function(){if(!this.ended){for(var t=[],n=0,r=0,i=0,o=0,l=0;l<this.parts.length;++l){var c=this.parts[l];n+=c.timing.readTime,r+=c.timing.subtleCryptoTime,i+=c.timing.fileDigestTime,o+=c.timing.uploadTime,t.push({part_id:c.id,offset:c.offset,size:c.size})}var f={parts:t,attributes:{}},p=a.getFileLastModifiedAsISONoMSIfPossible(this.file);p&&(f.attributes.content_modified_at=p);var m={},h=e.getGlobalConfig("realtimeSubscriberID");h&&(m.realtime_subscriber_id=h);var g=s.updateQueryStringParameters(this.sessionEndpoints.commit,m);this.commitXhr=this.createXhr("POST",g,this.commitLoaded.bind(this),this.commitFailure.bind(this));var v=d.byteArrayToBase64(u.hexToByteArray(this.fileSha1));this.commitXhr.setRequestHeader("Digest","sha="+v);var y={avg_part_read_time:Math.round(n/this.parts.length),avg_part_digest_time:Math.round(r/this.parts.length),avg_file_digest_time:Math.round(i/this.parts.length),avg_part_upload_time:Math.round(o/this.parts.length)};this.commitXhr.setRequestHeader("X-Box-Client-Event-Info",JSON.stringify(y)),this.commitXhr.send(JSON.stringify(f))}},i.prototype.commitLoaded=function(){if(!this.ended&&this.commitXhr){if(201===this.commitXhr.status){var e=JSON.parse(this.commitXhr.responseText);this.ended=!0,this.onCompleted&&this.onCompleted(e)}else if(202===this.commitXhr.status||429===this.commitXhr.status){var t=parseInt(this.commitXhr.getResponseHeader("Retry-After"),10);this.commitRetry(1e3*t)}else this.commitFailure();this.commitXhr=null}},i.prototype.commitFailure=function(){if(!this.ended){if(409===this.commitXhr.status){this.consoleLog("Received 409 on commit");var e=a.tryParseJson(this.commitXhr.responseText);this.sessionFailed(e,y,JSON.stringify({response:e}))}else if(this.commitRetryCount>=this.config.retries){this.consoleLog("Too many commit failures, failing upload");var e=a.tryParseJson(this.commitXhr.responseText);this.sessionFailed(e,k,JSON.stringify({status:this.commitXhr.status,response:e}))}else this.commitRetry();this.commitXhr=null}},i.prototype.commitRetry=function(e){var t=this.getBoundedExpBackoffRetryDelay(this.config.initialRetryDelayMs,this.config.maxRetryDelayMs,this.commitRetryCount);this.commitXhr&&202===this.commitXhr.status||this.commitRetryCount++,this.commitXhr=null;var n=e||t;this.consoleLog("Retrying commit in "+n+" ms"),setTimeout(this.commitSession.bind(this),n)},i.prototype.sessionFailed=function(e,t,n){this.ended=!0,this.callFailureCallbackIfExists(e),c.retryNumOfTimes(function(e,r){this.logEvent(t,n).then(e,r)}.bind(this),this.config.retries,this.config.initialRetryDelayMs).then(this.abortSession.bind(this)).catch(this.abortSession.bind(this))},i.prototype.callFailureCallbackIfExists=function(e){this.onFailure&&this.onFailure(e)},i.prototype.cancel=function(){if(!this.ended){if(this.ended=!0,this.parts)for(var e=0;e<this.parts.length;++e){var t=this.parts[e];t.state=m,t.xhr&&(t.xhr.abort(),t.xhr=null)}this.abortSession()}},i.prototype.abortSession=function(){if(this.worker&&this.worker.terminate(),this.sessionEndpoints.abort){var e=this.createXhr("DELETE",this.sessionEndpoints.abort);e.send(null)}},i.prototype.getBoundedExpBackoffRetryDelay=function(e,t,n){var r=e*Math.pow(2,n);return r>t?t:r},i.prototype.logEvent=function(e,t){return l.create(function(n,r){if(this.sessionEndpoints.logEvent){var i=this.createXhr("POST",this.sessionEndpoints.logEvent,function(){200===i.status?n():r()},r),o={event_type:e};t&&(o.event_info=t),i.send(JSON.stringify(o))}else n()}.bind(this))},i.prototype.formatErrorForLogEvent=function(e){var t={name:e.name,message:e.message,stack:e.stack};return JSON.stringify(t)},i.prototype.scheduleTokenRefresh=function(){setTimeout(this.refreshTokenIfNecessary.bind(this),this.config.refreshTokenPollIntervalMs)},i.prototype.refreshTokenIfNecessary=function(){this.ended||(this.token.expiresInMs()<this.config.refreshTokenIfTtlLessThanMs?(this.consoleLog("Access token expires in "+this.token.expiresInMs()+" ms, refreshing"),this.refreshToken()):this.scheduleTokenRefresh())},i.prototype.refreshToken=function(){this.ended||a.getScopedUploadToken(this.destinationFolder,this.destinationFile).then(this.refreshTokenLoaded.bind(this),this.refreshTokenError.bind(this))},i.prototype.refreshTokenLoaded=function(e){if(!this.ended){var t=new n(e.accessToken,e.expiresIn);this.consoleLog("Got new access token, expires in "+e.expiresIn+" seconds, at "+t.expiresAt),this.token=t,this.scheduleTokenRefresh()}},i.prototype.refreshTokenError=function(e){if(!this.ended){if(e&&e.data&&"requestTokenInvalid"===e.data.code)return void this.sessionFailed(e.data,T,JSON.stringify(e.data));this.consoleLog("Error refreshing token"),this.scheduleTokenRefresh()}},i.prototype.createXhr=function(e,t,n,r,i){var o=new XMLHttpRequest;return n&&o.addEventListener("load",n.bind(this)),r&&(o.addEventListener("error",r.bind(this)),o.upload.addEventListener("error",r.bind(this)),o.addEventListener("timeout",r.bind(this))),i&&o.upload.addEventListener("progress",i.bind(this)),o.open(e,t,!0),o.setRequestHeader("Authorization","Bearer "+this.token.accessToken),o.timeout=this.config.requestTimeout,o.withCredentials="true",o},i.prototype.partsStateForLog=function(){var e={notStarted:this.partsNotStarted,digestComputing:this.partsDigestComputing,digestReady:this.partsDigestReady,uploading:this.partsUploading,uploaded:this.partsUploaded,firstUnuploadedPart:this.firstUnuploadedPartIndex};if(null!==this.parts){for(var t=[],n=this.firstUnuploadedPartIndex;n<this.parts.length&&this.parts[n].state!==m;n++)t.push(this.parts[n]);e.partsWindow=t}return JSON.stringify(e)},i.prototype.consoleLog=function(e){this.config.console&&window.console&&console.log((new Date).toString()+" "+e)},i.prototype.consoleLogFunc=function(e){if(this.config.console&&window.console){var t=e();this.consoleLog(t)}},{config:I,MultiputPart:r,AccessTokenWithExpiration:n,createAccessTokenWithExpiration:function(e,t){return new n(e,t)},createMultiputUpload:function(e,t,n,r,o,a,s){return new i(e,t,n,r,o,a,s)}}}),Box.Application.addService("uploads-queueing",function(){"use strict";function e(e){for(var t,n=0;n<a.length;n++)t=a[n],t.upload===e&&a.splice(n,1)}function t(t,n){a.push({upload:t,callback:n}),t.getPromise().then(null,function(){e(t)})}function n(t){function n(){o-=t.concurrentHttpRequests,r()}e(t),o+=t.concurrentHttpRequests,t.getPromise().then(n,n)}function r(){if(a.length){var e=a.shift();e.callback(),n(e.upload)}}var i=6,o=0,a=[];return{setMaxConcurrent:function(e){i=e},updateUploadConcurrency:function(e,t){if(o+=t-e,a.length){var n=a[0];o+n.upload.concurrentHttpRequests<=i&&r()}},queueUpload:function(e,r){o+e.concurrentHttpRequests<=i?(r(),n(e)):t(e,r)}}}),Box.Application.addService("uploads-reachability",function(e){"use strict";function t(){s.setItem(d,JSON.stringify(f))}function n(e){return e.expirationTimestampMS>Date.now()}function r(e,t){if(f[e]){var r=f[e][t];if(r&&n(r))return r}return null}function i(e,n,r,i){f[e]||(f[e]={}),f[e][n]={isReachable:i,expirationTimestampMS:r},t()}function o(){try{return JSON.parse(s.getItem(d))}catch(e){return null}}function a(){var e=o();if(e)for(var t in e)if(e.hasOwnProperty(t))for(var r in e[t])if(e[t].hasOwnProperty(r)){var i=e[t][r];n(i)&&(f[t]||(f[t]={}),f[t][r]=i)}}var s=e.getService("local-store"),l=e.getService("promises"),c=e.getService("uploads-xhr"),u=e.getGlobal("XMLHttpRequest"),d="uploads-reachability-cached-results",f={};return a(),t(),{isReachable:function(e,t,n,o,a){var s=r(e,t);if(s)return l.createResolved(s.isReachable);var c=Date.now()+1e3*o;return this.makeReachabilityRequest(n,a).then(function(){return i(e,t,c,!0),!0},function(){return i(e,t,c,!1),!1})},makeReachabilityRequest:function(e,t){var n=new u,r=e+"?reachability_test=run";return n.open("POST",r),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("X-File-Name","reachability_pseudofile.txt"),n.setRequestHeader("X-File-Size","1234"),n.timeout=t,n.withCredentials=!0,n.send("reachability_file=test_file_data"),c.create2xxPromise(n)},getUnreachableHostURLs:function(e){var t=f[e];if(!t)return[];var r=[];for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];n(o)&&!o.isReachable&&r.push(i)}return r}}}),Box.Application.addService("uploads-sha1-worker",function(){"use strict";function e(e,t,n){"use asm";var r=new e.Int32Array(n);function i(e,t){e=e|0;t=t|0;var n=0,i=0,o=0,a=0,s=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0,h=0,g=0;o=r[t+320>>2]|0;s=r[t+324>>2]|0;c=r[t+328>>2]|0;d=r[t+332>>2]|0;p=r[t+336>>2]|0;for(n=0;(n|0)<(e|0);n=n+64|0){a=o;l=s;u=c;f=d;m=p;for(i=0;(i|0)<64;i=i+4|0){g=r[n+i>>2]|0;h=((o<<5|o>>>27)+(s&c|~s&d)|0)+((g+p|0)+1518500249|0)|0;p=d;d=c;c=s<<30|s>>>2;s=o;o=h;r[e+i>>2]=g}for(i=e+64|0;(i|0)<(e+80|0);i=i+4|0){g=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;h=((o<<5|o>>>27)+(s&c|~s&d)|0)+((g+p|0)+1518500249|0)|0;p=d;d=c;c=s<<30|s>>>2;s=o;o=h;r[i>>2]=g}for(i=e+80|0;(i|0)<(e+160|0);i=i+4|0){g=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;h=((o<<5|o>>>27)+(s^c^d)|0)+((g+p|0)+1859775393|0)|0;p=d;d=c;c=s<<30|s>>>2;s=o;o=h;r[i>>2]=g}for(i=e+160|0;(i|0)<(e+240|0);i=i+4|0){g=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;h=((o<<5|o>>>27)+(s&c|s&d|c&d)|0)+((g+p|0)-1894007588|0)|0;p=d;d=c;c=s<<30|s>>>2;s=o;o=h;r[i>>2]=g}for(i=e+240|0;(i|0)<(e+320|0);i=i+4|0){g=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;h=((o<<5|o>>>27)+(s^c^d)|0)+((g+p|0)-899497514|0)|0;p=d;d=c;c=s<<30|s>>>2;s=o;o=h;r[i>>2]=g}o=o+a|0;s=s+l|0;c=c+u|0;d=d+f|0;p=p+m|0}r[t+320>>2]=o;r[t+324>>2]=s;r[t+328>>2]=c;r[t+332>>2]=d;r[t+336>>2]=p}return{hash:i}}function t(t){for(var n={getDataType:function(e){if("string"==typeof e)return"string";if(e instanceof Array)return"array";if("undefined"!=typeof global&&global.Buffer&&global.Buffer.isBuffer(e))return"buffer";if(e instanceof ArrayBuffer)return"arraybuffer";if(e.buffer instanceof ArrayBuffer)return"view";if(e instanceof Blob)return"blob";throw new Error("Unsupported data type.")}},r={fill:0},i=function(e){for(e+=9;e%64>0;e+=1);return e},o=function(e,t){var n=new Uint8Array(e.buffer),r=t%4,i=t-r;switch(r){case 0:n[i+3]=0;case 1:n[i+2]=0;case 2:n[i+1]=0;case 3:n[i+0]=0}for(var o=(t>>2)+1;o<e.length;o++)e[o]=0},a=function(e,t,n){e[t>>2]|=128<<24-(t%4<<3),e[((t>>2)+2&-16)+14]=n/(1<<29)|0,e[((t>>2)+2&-16)+15]=n<<3},s=function(e,t,n,r,i){var o,a=this,s=i%4,l=(r+s)%4,c=r-l;switch(s){case 0:e[i]=a.charCodeAt(n+3);case 1:e[i+1-(s<<1)|0]=a.charCodeAt(n+2);case 2:e[i+2-(s<<1)|0]=a.charCodeAt(n+1);case 3:e[i+3-(s<<1)|0]=a.charCodeAt(n)}if(!(r<l+s)){for(o=4-s;o<c;o=o+4|0)t[i+o>>2]=a.charCodeAt(n+o)<<24|a.charCodeAt(n+o+1)<<16|a.charCodeAt(n+o+2)<<8|a.charCodeAt(n+o+3);switch(l){case 3:e[i+c+1|0]=a.charCodeAt(n+c+2);case 2:e[i+c+2|0]=a.charCodeAt(n+c+1);case 1:e[i+c+3|0]=a.charCodeAt(n+c)}}},l=function(e,t,n,r,i){var o,a=this,s=i%4,l=(r+s)%4,c=r-l;switch(s){case 0:e[i]=a[n+3];case 1:e[i+1-(s<<1)|0]=a[n+2];case 2:e[i+2-(s<<1)|0]=a[n+1];case 3:e[i+3-(s<<1)|0]=a[n]}if(!(r<l+s)){for(o=4-s;o<c;o=o+4|0)t[i+o>>2|0]=a[n+o]<<24|a[n+o+1]<<16|a[n+o+2]<<8|a[n+o+3];switch(l){case 3:e[i+c+1|0]=a[n+c+2];case 2:e[i+c+2|0]=a[n+c+1];case 1:e[i+c+3|0]=a[n+c]}}},c=function(e,t,n,r,i){var o,a=this,s=i%4,l=(r+s)%4,c=r-l,u=new Uint8Array(reader.readAsArrayBuffer(a.slice(n,n+r)));switch(s){case 0:e[i]=u[3];case 1:e[i+1-(s<<1)|0]=u[2];case 2:e[i+2-(s<<1)|0]=u[1];case 3:e[i+3-(s<<1)|0]=u[0]}if(!(r<l+s)){for(o=4-s;o<c;o=o+4|0)t[i+o>>2|0]=u[o]<<24|u[o+1]<<16|u[o+2]<<8|u[o+3];switch(l){case 3:e[i+c+1|0]=u[c+2];case 2:e[i+c+2|0]=u[c+1];case 1:e[i+c+3|0]=u[c]}}},u=function(e){switch(n.getDataType(e)){case"string":return s.bind(e);case"array":return l.bind(e);case"buffer":return l.bind(e);case"arraybuffer":return l.bind(new Uint8Array(e));case"view":return l.bind(new Uint8Array(e.buffer,e.byteOffset,e.byteLength));case"blob":return c.bind(e)}},d=new Array(256),f=0;f<256;f++)d[f]=(f<16?"0":"")+f.toString(16);var p=function(e){for(var t=new Uint8Array(e),n=new Array(e.byteLength),r=0;r<n.length;r++)n[r]=d[t[r]];return n.join("")},m=function(e){var t;if(e<=65536)return 65536;if(e<16777216)for(t=1;t<e;t<<=1);else for(t=16777216;t<e;t+=16777216);return t},h=function(t){if(t%64>0)throw new Error("Chunk size must be a multiple of 128 bit");r.offset=0,r.maxChunkLen=t,r.padMaxChunkLen=i(t),r.heap=new ArrayBuffer(m(r.padMaxChunkLen+320+20)),r.h32=new Int32Array(r.heap),r.h8=new Int8Array(r.heap),r.core=new e({Int32Array:Int32Array,DataView:DataView},{},r.heap),r.buffer=null};h(t||65536);var g=function(e,t){r.offset=0;var n=new Int32Array(e,t+320,5);n[0]=1732584193,n[1]=-271733879,n[2]=-1732584194,n[3]=271733878,n[4]=-1009589776},v=function(e,t){var n=i(e),s=new Int32Array(r.heap,0,n>>2);return o(s,e),a(s,e,t),n},y=function(e,t,n,i){u(e)(r.h8,r.h32,t,n,i||0)},b=function(e,t,n,i,o){var a=n;y(e,t,n),o&&(a=v(n,i)),r.core.hash(a,r.padMaxChunkLen)},_=function(e,t){var n=new Int32Array(e,t+320,5),r=new Int32Array(5),i=new DataView(r.buffer);return i.setInt32(0,n[0],!1),i.setInt32(4,n[1],!1),i.setInt32(8,n[2],!1),i.setInt32(12,n[3],!1),i.setInt32(16,n[4],!1),r},w=this.rawDigest=function(e){var t=e.byteLength||e.length||e.size||0;g(r.heap,r.padMaxChunkLen);var n=0,i=r.maxChunkLen;for(n=0;t>n+i;n+=i)b(e,n,i,t,!1);return b(e,n,t-n,t,!0),_(r.heap,r.padMaxChunkLen)};this.digest=this.digestFromString=this.digestFromBuffer=this.digestFromArrayBuffer=function(e){return p(w(e).buffer)},this.resetState=function(){return g(r.heap,r.padMaxChunkLen),this},this.append=function(e){var t,n=0,i=e.byteLength||e.length||e.size||0,o=r.offset%r.maxChunkLen;for(r.offset+=i;n<i;)t=Math.min(i-n,r.maxChunkLen-o),y(e,n,t,o),o+=t,n+=t,o===r.maxChunkLen&&(r.core.hash(r.maxChunkLen,r.padMaxChunkLen),o=0);return this},this.getState=function(){var e,t=r.offset%r.maxChunkLen;if(t)e=r.heap.slice(0);else{var n=new Int32Array(r.heap,r.padMaxChunkLen+320,5);e=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}return{offset:r.offset,heap:e}},this.setState=function(e){if(r.offset=e.offset,20===e.heap.byteLength){var t=new Int32Array(r.heap,r.padMaxChunkLen+320,5);t.set(new Int32Array(e.heap))}else r.h32.set(new Int32Array(e.heap));return this};var S=this.rawEnd=function(){var e=r.offset,t=e%r.maxChunkLen,n=v(t,e);r.core.hash(n,r.padMaxChunkLen);var i=_(r.heap,r.padMaxChunkLen);return g(r.heap,r.padMaxChunkLen),i};this.end=function(){return p(S().buffer)}}return{createWorker:function(){function n(){var e=new t;e.resetState();var n=0;self.onmessage=function(t){var r=t.data,i=r.part,o=r.fileSize,a=r.partContents,s=Date.now();try{if(i.offset!==n)throw new Error("Out of order parts given to worker");
if(e.append(a),self.postMessage({type:"partDone",part:r.part,duration:Date.now()-s,partContents:a},[a]),n+=i.size,i.offset+i.size===o){var l=e.end();self.postMessage({type:"done",sha1:l})}}catch(e){var c={type:"error",name:e.name,message:e.message,part:i};self.postMessage(c)}}}var r=new Blob([e.toString(),";\n",t.toString(),";\n","var setupWorker = ",n.toString(),";\n","setupWorker();"],{type:"text/javascript"}),i=(window.URL||window.webkitURL).createObjectURL(r),o=new Worker(i);return o.oldTerminate=o.terminate,o.terminate=function(){(window.URL||window.webkitURL).revokeObjectURL(i),o.oldTerminate()},o}}}),Box.Application.addService("uploads-util",function(e){"use strict";function t(e){return/\w_(.*)/.exec(e)[1]}function n(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}function r(e){return 1===e.fast_upload?f.isReachable(e.external_ip,e.host_url,e.html5_upload_url,e.retest_seconds,e.timeout_ms):d.createResolved(!0)}var i=2,o="upload_process_log_event",a="START_UPLOAD_ERROR",s=e.getService("ajax"),l=e.getService("dom"),c=e.getService("function-utils"),u=e.getService("logger"),d=e.getService("promises"),f=e.getService("uploads-reachability"),p=e.getService("browser");return{REASON_HOST_NOT_REACHABLE:"host not reachable",REASON_MALFORMED_URL_OPTIONS_RESPONSE:"malformed box_upload_options response",REASON_ALL_SUGGESTED_HOSTS_NOT_REACHABLE:"all suggested hosts not reachable",addHostsToExcludeIfNeeded:function(e,t){if(t){var n=f.getUnreachableHostURLs(t);n.length>0&&(e.hosts_to_exclude=n)}},createFolder:function(e,n,r){var o=t(n);return c.retryNumOfTimes(function(t,i){s.post("box_create_subfolder_path",{"relative_folder_path[]":e,parent_folder_id:o,should_rename:r?"false":"true",upload_type:"html5"}).then(function(e){var r=e.data;return"success"!==r.status?void i(r.message):(t(r.subfolder_typed_id),void Box.Application.broadcast("upload-folder-created",{parent:n,id:r.subfolder_typed_id}))},function(){i("connection error")})},i)},startUpload:function(e,n,r,i,o){return d.create(function(a,l){var c=this.supportsMultiput(),u={name:e,folder_id:t(r),size:n,client_supports_multiput:c};i&&(u.file_id=t(i)),this.addHostsToExcludeIfNeeded(u,o),s.post("box_start_upload",u).then(function(e){var t=e.data;return"success"!==t.status?void l():void a({uploadSessionID:t.upload_session_id,urlOptions:t.url_options,apiToken:t.api_token})},l)}.bind(this))},getFileLastModifiedAsISONoMSIfPossible:function(e){if(n(e.lastModifiedDate))return this.toISOStringNoMS(e.lastModifiedDate);if(e.lastModified){var t=new Date(e.lastModified);if(n(t))return this.toISOStringNoMS(t)}return null},getScopedUploadToken:function(e,t){return d.create(function(n,r){var i={};e?i.folder_id=e:i.file_id=t,s.post("box_upload_get_scoped_token",i).then(function(e){var t=e.data;t.access_token&&t.expires_in?n({accessToken:t.access_token,expiresIn:t.expires_in}):r()},r)})},getURLOptions:function(e){var t={};return this.addHostsToExcludeIfNeeded(t,e),s.post("box_upload_options",t).then(function(e){return e.data&&e.data.url_options?d.createResolved(e.data.url_options):d.createRejected(this.REASON_MALFORMED_URL_OPTIONS_RESPONSE)}.bind(this))},getURLOptionsWithReachabilityTesting:function(e,t){var n=e;return c.retryNumOfTimes(function(e,t,i){this.getURLOptions(n).then(function(e){return d.all([e,r(e)])}).spread(function(r,i){n=r.external_ip,i?e(r):t(this.REASON_HOST_NOT_REACHABLE)}.bind(this)).catch(i)}.bind(this),t).catch(function(e){return e===this.REASON_HOST_NOT_REACHABLE?d.createRejected(this.REASON_ALL_SUGGESTED_HOSTS_NOT_REACHABLE):d.createRejected(e)}.bind(this))},testReachabilityAndMaybeGetNewURLOptions:function(e,t){return r(e).then(function(n){return n?e:this.getURLOptionsWithReachabilityTesting(e.external_ip,t)}.bind(this))},maybeUpdateURLOptionsInData:function(e,t){return this.testReachabilityAndMaybeGetNewURLOptions(e.urlOptions,t).then(function(t){return e.urlOptions=t,e})},maybeUpdateURLOptionsInResponse:function(e,t){var n=e.data;return this.testReachabilityAndMaybeGetNewURLOptions(n.url_options,t).then(function(t){return e.data.url_options=t,e})},bindUploadHandler:function(e,t,n,r){function i(){var e=document.createElement("input");return e.type="file",e.className="upload-handler-picker",n&&(e.multiple=!0),r&&(e.setAttribute("webkitdirectory",""),e.setAttribute("directory","")),e.style.height=0,e.style.overflow="hidden",e.style.width=0,e.style.display="none",e}var o=document.createElement("label");o.className="upload-handler-wrapper menu-option";for(var a;e.firstChild;)a=e.firstChild,e.removeChild(a),o.appendChild(a);o.appendChild(i());var s=this;return o.addEventListener("change",function(){var e=l.query('input[type="file"]',o);e&&e.files.length&&(t.call(s,e),l.remove(e),o.appendChild(i()))},!0),e.appendChild(o),o},getUntypedID:t,logStartUploadError:function(e){var t=e===this.REASON_ALL_SUGGESTED_HOSTS_NOT_REACHABLE;u.sendLog(o,a,{all_suggested_hosts_not_reachable:t})},toISOStringNoMS:function(e){return e.toISOString().replace(/\.[0-9]{3}/,"")},xhrSendWithIdleTimeout:function(e,t,n,r){function i(){o&&(clearInterval(o),o=null)}var o,a=0,s=Date.now();e.upload.addEventListener("progress",function(e){e.loaded>a&&(a=e.loaded,s=Date.now())}),e.addEventListener("abort",i),e.addEventListener("load",i),e.addEventListener("error",i),o=setInterval(function(){Date.now()-s<=n||(e.abort(),i(),r&&r())},1e3),e.send(t)},tryParseJson:function(e){try{return JSON.parse(e)}catch(e){return null}},supportsMultiput:function(){return p.isFileApiSupported()&&p.isInlineWorkerSupported()&&p.isSubtleCryptoSupported()}}}),Box.Application.addService("uploads-xhr",function(e){"use strict";var t=e.getService("promises");return{create2xxPromise:function(e){return t.create(function(t,n){e.onreadystatechange=function(){4===e.readyState&&(2===(e.status/100|0)?t(e):n(e))},e.onerror=function(){n(e)},e.ontimeout=function(){n(e)}})}}}),Box.Application.addService("url-amsterdam",function(){"use strict";function e(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function t(e){return window.encodeURIComponent(e).replace(/%20/g,"+")}function n(e){return window.decodeURIComponent(e.replace(/\+/g," "))}function r(n){if("string"==typeof n||"number"==typeof n)return t(n);for(var r=[],i=e(n).sort(),o=0;o<i.length;o++){var a=i[o],s=n[a];void 0===s?r.push(t(a)):r.push(t(a)+"="+t(s))}return r.join("&")}function i(e,t){if(!e||"?"===e)return{};e&&"?"===e[0]&&(e=e.substr(1));for(var r=e.split("&"),i={},o=0,a=r.length;o<a;o++){var s=r[o].split("=");!s[0]||t&&void 0===s[1]||(i[n(s[0])]=n(s[1]))}return i}return{encode:r,decode:i}}),Box.Application.addService("url",function(e){"use strict";function t(e){return decodeURIComponent(e.replace(i," "))}function n(){return r.location.pathname&&0===r.location.pathname.indexOf("/master/content")}var r=e.getGlobal("window"),i=/\+/g,o=/([^&=]+)=?([^&]*)/g,a=/\?(.*)/;return{getCurrentWindowUrl:function(){return r.location.hash||r.location.href},getHostDomain:function(){var e=r.location.hostname.split("."),t=e.length;return e[t-2]+"."+e[t-1]},getGcmCompatibleRm:function(e){return n()&&(e="box_master_gcm_"+e),e},getGcmCompatibleRmUrl:function(e){return"/index.php?rm="+this.getGcmCompatibleRm(e)},updateQueryStringParameter:function(e,t,n){var r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),i=e.indexOf("?")!==-1?"&":"?",o=!n&&"number"!=typeof n,a=e.match(r),s=encodeURIComponent(t),l=encodeURIComponent(n);return o&&a?e.replace(r,"&"):o?e:a?e.replace(r,"$1"+s+"="+l+"$2"):e+i+s+"="+l},updateQueryStringParameters:function(e,t){var n=e;for(var r in t)t.hasOwnProperty(r)&&(n=this.updateQueryStringParameter(n,r,t[r]));return n},createUrl:function(e,t){var n,r;"?"===e[e.length-1]&&(e=e.slice(0,e.length-1));for(r in t)t.hasOwnProperty(r)&&(n=t[r],e=this.updateQueryStringParameter(e,r,n));return e},goToUrl:function(t){var n=e.getGlobal("open_link_in_new_window"),i=e.getGlobal("path_prefix");return t=this.addAdditionalContext(t),n&&t&&i&&t.indexOf(i)<0?void r.open(t):void(r.location.href=t)},goToUrlInBackground:function(t){var n=e.getService("dom"),r=e.getGlobal("document"),i=n.query("#downloadiframe"),o=!1;i||(i=r.createElement("iframe"),o=!0),t=this.addAdditionalContext(t),i.src=t,i.style.display="none",i.setAttribute("id","downloadiframe"),o&&r.body.appendChild(i)},openWindow:function(e,t,n,i){return e?(t=t||"",n=n||"",i=i||!1,e=this.addAdditionalContext(e),r.open(e,t,n,i)):null},addAdditionalContext:function(t){var n=e.getGlobal("additional_context");if(n&&t.indexOf("additional_context")<0){var r="additional_context="+encodeURIComponent(n);t+=(t.indexOf("?")>0?"&":"?")+r}return t},formatLegacyQueryParams:function(e){function t(e){for(var n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]?t(e[n]):"boolean"==typeof e[n]&&(e[n]=e[n]?1:0))}return t(e),{q:e}},encodePathComponent:function(e){return e=encodeURIComponent(e).replace(/%2F/g,"%252F").replace(/%23/g,"%2523").replace(/%26/g,"%2526")},decodePathComponent:function(e){return e=e.replace(/%2526/g,"%26").replace(/%2523/g,"%23").replace(/%252F/g,"%2F"),t(e)},getQueryParams:function(e){var n,r,i=e.match(a),s={};if(i)for(r=i[1];n=o.exec(r);)s[t(n[1])]=t(n[2]);return s},getQueryParamString:function(e){var t=e.match(a);return t?t[1]:""},getCurrentQueryParams:function(){var e=this.getCurrentWindowUrl();return this.getQueryParams(e)}}}),Box.Application.addService("urls-runmode",function(){"use strict";return{formatQuery:function(e){function t(e,n,r){if(n=n||"",r=r||[],"string"==typeof e||"number"==typeof e)r.push(n+"="+encodeURIComponent(e));else if("boolean"==typeof e)r.push(n+"="+(e?1:0));else for(var i in e)e.hasOwnProperty(i)&&(r=t(e[i],n+"["+i+"]",r));return r}return t(e,"q").join("&")},get:function(e,t){var n="/index.php?rm="+e;return t&&(n+="&"+this.formatQuery(t)),n}}}),Box.Application.addService("user-preferences",function(e){"use strict";var t="save_user_view_preferences",n="save_user_column_widths",r="save_user_item_list_sidebar_tab_preference",i="set_user_homepage",o=1,a=9,s=e.getService("ajax");return{saveUserViewPreferences:function(e,n){var r={view:e};return n>=o&&n<=a&&(r.viewSize=n),s.post(t,r)},saveUserColumnWidths:function(e){var t={columnWidths:e};return s.post(n,t)},saveUserItemListSidebarTabPreference:function(e){var t={tab:e};return s.post(r,t)},setUserHomepage:function(e){var t={homepage:e};return s.post(i,t)}}}),Box.Application.addService("datepicker",function(e){"use strict";function t(e){e.fire("change",{formattedValue:e.formattedInputEl?e.formattedInputEl.value:""})}function n(e){return function(n){var r=n.getTime(),i=n.getTimezoneOffset(),a=i*o,s=r-a;e.formattedInputEl&&(e.formattedInputEl.value=s),e.removeError(),e.clearButtonEl&&p.removeClass(e.clearButtonEl,d),t(e)}}function r(){this.picker.setDate(null),p.addClass(this.clearButtonEl,d),this.formattedInputEl&&(this.formattedInputEl.value=""),t(this)}function i(e){var t=e.getAttribute("data-epoch-holder");if(!f)throw new Error("Missing i18n parameters for the datepicker service");$.extend(this,new Box.EventTarget),this.inputEl=f.field=e,t&&(this.formattedInputEl=p.query('input[name="'+t+'"]',e.parentNode)),this.onSelect=f.onSelect=n(this),f.setDefaultDate=!0;var i=e.getAttribute("data-min-date");i=i?parseInt(i,10):0,this.minDate=f.minDate=new Date(i);var o=e.getAttribute("data-max-date");o&&(o=parseInt(o,10),this.maxDate=f.maxDate=new Date(o)),this.picker=new Pikaday(f),this.clearButtonEl=p.query(u,e.parentNode),this.clearButtonEl&&(e.value||p.addClass(this.clearButtonEl,d),this.clearButtonHandler=r.bind(this),p.on(this.clearButtonEl,"click",this.clearButtonHandler))}var o=6e4,a="is-invalid",s="data-tooltip",l="data-tooltip-theme",c="data-tooltip-text",u=".date-picker-clear-btn",d="hidden",f=e.getGlobalConfig("pikadayI18N"),p=e.getService("dom"),m=e.getService("tooltips-amsterdam");return i.prototype={show:function(){this.picker.show()},hide:function(){this.picker.hide()},getDate:function(){return this.picker.getDate()},destroy:function(){this.picker.destroy(),this.clearButtonEl&&p.off(this.clearButtonEl,"click",this.clearButtonHandler)},setError:function(e){p.addClass(this.inputEl,a),this.inputEl.setAttribute(s,""),this.inputEl.setAttribute(l,"error"),this.inputEl.setAttribute(c,e)},removeError:function(){p.hasClass(this.inputEl,a)&&(p.removeClass(this.inputEl,a),m&&m.hide(this.inputEl),this.inputEl.removeAttribute(s),this.inputEl.removeAttribute(l),this.inputEl.removeAttribute(c))}},{create:function(e){return new i(e)}}}),Box.Application.addService("custom-date-range",function(e){"use strict";function t(e){if(!e)return null;var t=e.value;return t&&(t=parseInt(t,10)),t}function n(t,n){if(!t||!n)return!1;var r=t.value,i=n.value;return!(!r||!i)&&(r>i?(e.broadcast("invaliddaterangeerror"),!1):(e.broadcast("clearerrormessage"),!0))}function r(e){var t=o.query(".datepicker.from-date",e),r=o.query(".datepicker.to-date",e);this.widgetEl=e,this.fromTimeInputEl=o.query('input[name="updatedTimeFrom"]',e),this.toTimeInputEl=o.query('input[name="updatedTimeTo"]',e),this.isShowing=!1,this.fromDatepickerInstance=a.create(t),this.toDatepickerInstance=a.create(r),this.fromDatepickerInstance.on("change",function(){n(this.fromTimeInputEl,this.toTimeInputEl)}.bind(this)),this.toDatepickerInstance.on("change",function(){n(this.fromTimeInputEl,this.toTimeInputEl)}.bind(this))}var i="is-visible",o=e.getService("dom"),a=e.getService("datepicker");return r.prototype.show=function(){o.addClass(this.widgetEl,i),this.isShowing=!0},r.prototype.hide=function(){o.removeClass(this.widgetEl,i),this.isShowing=!1},r.prototype.destroy=function(){this.fromDatepickerInstance.destroy(),this.toDatepickerInstance.destroy()},r.prototype.validate=function(){if(!this.fromTimeInputEl||!this.toTimeInputEl)return!1;var t=this.fromTimeInputEl.value,r=this.toTimeInputEl.value;return t&&r?n(this.fromTimeInputEl,this.toTimeInputEl):(e.broadcast("emptydateerror"),!1)},r.prototype.getDateRange=function(){var e={};return e.fromDate=t(this.fromTimeInputEl),e.toDate=t(this.toTimeInputEl),e},r.prototype.isVisible=function(){return this.isShowing},{create:function(e){return new r(e)}}}),Box.Application.addService("item-list-selection",function(e){"use strict";function t(e,t){function r(e){return e.getAttribute("data-id")}function i(e){return e.map(function(e){return r(e)})}function o(e){return e.map(function(e){return{id:e.getAttribute("data-id"),name:e.getAttribute("data-name"),canFavorite:e.hasAttribute("data-can-favorite"),isFavorited:e.getAttribute("data-is-favorited")||!1,actions:e.getAttribute("data-available-actions")||"",tags:e.getAttribute("data-tags")||""}})}function a(e){return n.hasClass(e,S.selectionClass)}function s(){return T||(T=Array.prototype.slice.call(e.querySelectorAll(S.itemSelector+"[data-id]"))),T}function l(t){return e.querySelector(S.itemSelector+'[data-id="'+t+'"]')}function c(){var t=e.querySelector(S.itemSelector);return t?r(t):null}function u(){var e=s();return i(e)}function d(){var e=s();return i(e.filter(a))}function f(){var e=s();return o(e.filter(a))}function p(e){var t=Array.isArray(e)?e:[e];t.forEach(function(e){var t=l(e);t&&(t.querySelector(S.checkboxSelector).checked=!0,n.addClass(t,S.selectionClass))})}function m(){var e=u();p(e)}function h(e){var t=Array.isArray(e)?e:[e];t.forEach(function(e){var t=l(e);t&&(t.querySelector(S.checkboxSelector).checked=!1,n.removeClass(t,S.selectionClass))})}function g(){var e=u();h(e)}function v(e){var t=u(),n=t.indexOf(E),r=t.indexOf(C),i=t.indexOf(e);n!==-1&&r!==-1&&i!==-1&&(r<=n&&n<=i?(h(t.slice(r,n+1)),p(t.slice(n,i+1))):r<=i&&i<=n?(h(t.slice(r,i+1)),p(t.slice(i,n+1))):n<=r&&r<=i?p(t.slice(n,i+1)):n<=i&&i<=r?(h(t.slice(i,r+1)),p(t.slice(n,i+1))):i<=n&&n<=r?(h(t.slice(n,r+1)),p(t.slice(i,n+1))):i<=r&&i<=n&&p(t.slice(i,n+1)))}function y(e,t){return e.length===t.length&&e.every(function(e,n){return e===t[n]})}function b(){var e=d();y(e,x)||(k.fire("updated",f()),x=e)}function _(){E=C=null}function w(){T=null}var S=t||{},k=new Box.EventTarget,E=null,C=null,x=[],T=null;return S.itemSelector=S.itemSelector||".tbl-list-item",S.checkboxSelector=S.checkboxSelector||"input[type=checkbox]",S.selectionClass=S.selectionClass||"selected-item",{select:function(e){E=C=e,p(e),b()},selectOnly:function(e){E=C=e,g(),p(e),b()},selectAll:function(){_(),m(),b()},selectOnlyFirst:function(){var e=c();e&&this.selectOnly(e)},selectOnlyLast:function(){var e=u().pop();e&&this.selectOnly(e)},selectNext:function(){if(C){var e=u()[u().indexOf(C)+1];this.select(e)}},selectPrevious:function(){if(C){var e=u()[u().indexOf(C)-1];this.select(e)}},selectOnlyNext:function(){if(C){var e=u()[u().indexOf(C)+1];this.selectOnly(e)}},selectOnlyPrevious:function(){if(C){var e=u()[u().indexOf(C)-1];this.selectOnly(e)}},unselect:function(e){_(),h(e),b()},unselectAll:function(){_(),g(),b()},toggle:function(e){this.isSelected(e)?this.unselect(e):this.select(e)},selectRange:function(e){!E&&this.isNoneSelected()&&(E=C=c()),E?(v(e),C=e,b()):this.select(e)},toggleAll:function(){return this.isAllSelected()?void this.unselectAll():void this.selectAll()},isSelected:function(e){var t=l(e);return a(t)},isAllSelected:function(){var e=u(),t=d();return e.length===t.length},isNoneSelected:function(){var e=d();return 0===e.length},refresh:function(){_(),w(),b()},on:function(e,t){k.on(e,t)},off:function(e,t){k.off(e,t)}}}var n=e.getService("dom");return{create:function(e,n){return t(e,n)}}}),Box.Application.addService("xhr",function(e){"use strict";function t(t,n,i,o){o=o||{};var a,s=e.getGlobal("XMLHttpRequest");if(window.XMLHttpRequest)a=new s;else{if(!window.ActiveXObject)return null;a=new ActiveXObject("MSXML2.XMLHTTP.3.0")}var l=!o.sync;return a.open(t,n,l),o.corsRequest||(a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("X-Requesting-Application","EndUser"),a.setRequestHeader("X-Box-Client-Name","amsterdam"),a.setRequestHeader("X-Box-Client-Version","1.0.0"),r.requestToken&&a.setRequestHeader("X-Request-Token",r.requestToken)),"string"==typeof i&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a}var n=e.getService("promises"),r=e.getGlobalConfig();return{send:function(e,r,i,o){var a=t(e,r,i,o);a.send(i||null);var s=!1,l=n.create(function(e,t){a.onreadystatechange=function(){return s?null:void(4===a.readyState&&(2===(a.status/100|0)?e(a):t(a)))},a.onerror=function(){return s?null:void t(a)}});return l.abort=function(){s=!0,a.abort()},l},parseJSONResponse:function(e){return n.create(function(t,n){var r;try{r=JSON.parse(e.responseText)}catch(e){return void n(e)}t(r)})},handleLegacyAJAXResponse:function(e){return n.create(function(t,n){var r;try{r=JSON.parse(e.responseText)}catch(e){return void n(e)}return"data"in r?void t(r.data):void n(r)})},sendSync:function(e,n,r,i){i=i||{},i.sync=!0;var o=t(e,n,r,i);return o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<300?i.success&&i.success(o):i.error&&i.error(o))},o.onerror=function(){i.error&&i.error(o)},o.send(r||null),o}}});
//# sourceMappingURL=/webapp_assets/js/enduser/en-US-9f3c2c22b3.js.map